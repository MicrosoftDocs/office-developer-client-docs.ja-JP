---
title: セキュリティ レベル、メール展開、リモート フォーム テンプレート
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
ms.assetid: 7fc438ad-ae26-3632-3444-371537eaecb3
description: Microsoft InfoPath では、フォーム テンプレートをある場所から別の場所に移動し、添付ファイルとして電子メール メッセージに送信し、デジタル署名またはインストールされた完全信頼フォーム テンプレートを作成できます。
ms.openlocfilehash: 799f2b19bfc4daa4a177d789a811d20ca09e7153
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/23/2019
ms.locfileid: "32299854"
---
# <a name="security-levels-email-deployment-and-remote-form-templates"></a><span data-ttu-id="a3e76-103">セキュリティ レベル、メール展開、リモート フォーム テンプレート</span><span class="sxs-lookup"><span data-stu-id="a3e76-103">Security levels, email deployment, and remote form templates</span></span>

<span data-ttu-id="a3e76-104">Microsoft InfoPath では、フォーム テンプレートをある場所から別の場所に移動し、添付ファイルとして電子メール メッセージに送信し、デジタル署名またはインストールされた完全信頼フォーム テンプレートを作成できます。</span><span class="sxs-lookup"><span data-stu-id="a3e76-104">Microsoft InfoPath supports moving form templates from one location to another, sending them as an attachment to an email message, and creating Full Trust form templates that are digitally signed or installed.</span></span>
  
## <a name="security-levels"></a><span data-ttu-id="a3e76-105">セキュリティ レベル</span><span class="sxs-lookup"><span data-stu-id="a3e76-105">Security levels</span></span>

<span data-ttu-id="a3e76-p101">フォーム テンプレートには、フォームの場所に応じて、3 つのセキュリティ レベルのいずれかが適用されます。以降では、これらの 3 つのセキュリティ レベルについて説明します。</span><span class="sxs-lookup"><span data-stu-id="a3e76-p101">Form templates can have one of three security levels, depending on where the form is located. These three security levels are described in the following sections.</span></span> 
  
### <a name="restricted"></a><span data-ttu-id="a3e76-108">Restricted</span><span class="sxs-lookup"><span data-stu-id="a3e76-108">Restricted</span></span>

<span data-ttu-id="a3e76-p102">制限ありのセキュリティ レベルでは、フォーム テンプレートの外部との通信はできません。このセキュリティ レベルは、有害なフォームによって、コンピューターから悪意を持ったユーザーにデータが送信される事態を防ぐことを狙いとしています。このセキュリティ モードでの実行中は、次の機能は正しく動作しません。</span><span class="sxs-lookup"><span data-stu-id="a3e76-p102">The Restricted security level does not allow any communication outside the form template. This security level is intended to prevent harmful forms from transmitting any data from your computer to a malicious attacker. When running in this security mode, the following features will not work:</span></span>
  
- <span data-ttu-id="a3e76-112">HTML 作業ウィンドウ</span><span class="sxs-lookup"><span data-stu-id="a3e76-112">HTML Task Panes</span></span>  
- <span data-ttu-id="a3e76-113">SharePoint クエリ</span><span class="sxs-lookup"><span data-stu-id="a3e76-113">SharePoint Query</span></span>
- <span data-ttu-id="a3e76-114">SharePoint への送信</span><span class="sxs-lookup"><span data-stu-id="a3e76-114">SharePoint Submit</span></span>
- <span data-ttu-id="a3e76-115">XML ファイル クエリ</span><span class="sxs-lookup"><span data-stu-id="a3e76-115">XML File Query</span></span>
- <span data-ttu-id="a3e76-116">データベース クエリ</span><span class="sxs-lookup"><span data-stu-id="a3e76-116">Database Query</span></span>
- <span data-ttu-id="a3e76-117">データベースへの送信</span><span class="sxs-lookup"><span data-stu-id="a3e76-117">Database Submit</span></span>
- <span data-ttu-id="a3e76-118">Web サービス クエリ</span><span class="sxs-lookup"><span data-stu-id="a3e76-118">Web Service Query</span></span>
- <span data-ttu-id="a3e76-119">Web サービスへの送信</span><span class="sxs-lookup"><span data-stu-id="a3e76-119">Web Service Submit</span></span>
- <span data-ttu-id="a3e76-120">カスタム コードによる送信</span><span class="sxs-lookup"><span data-stu-id="a3e76-120">Custom Code Submit</span></span>
- <span data-ttu-id="a3e76-121">ホスティング環境への送信</span><span class="sxs-lookup"><span data-stu-id="a3e76-121">Hosting Environment Submit</span></span>
- <span data-ttu-id="a3e76-122">ActiveX コントロール</span><span class="sxs-lookup"><span data-stu-id="a3e76-122">ActiveX Controls</span></span>
- <span data-ttu-id="a3e76-123">ロール</span><span class="sxs-lookup"><span data-stu-id="a3e76-123">Roles</span></span>
- <span data-ttu-id="a3e76-124">SharePoint ワークフロー</span><span class="sxs-lookup"><span data-stu-id="a3e76-124">SharePoint Workflow</span></span>
- <span data-ttu-id="a3e76-125">新規ドキュメントを開く操作に関する規則</span><span class="sxs-lookup"><span data-stu-id="a3e76-125">Rules that open a New Document</span></span>
- <span data-ttu-id="a3e76-126">マネージ コード</span><span class="sxs-lookup"><span data-stu-id="a3e76-126">Managed Code</span></span>
- <span data-ttu-id="a3e76-127">外部の印刷表示</span><span class="sxs-lookup"><span data-stu-id="a3e76-127">External Print View</span></span>
- <span data-ttu-id="a3e76-128">リンクされた画像</span><span class="sxs-lookup"><span data-stu-id="a3e76-128">Linked Images</span></span>
    
### <a name="domain"></a><span data-ttu-id="a3e76-129">ドメイン</span><span class="sxs-lookup"><span data-stu-id="a3e76-129">Domain</span></span>

<span data-ttu-id="a3e76-p103">ドメインのセキュリティ レベルでは、フォームが特定のインターネット ドメインに限定され、フォームからのアクセス先は、そのドメインが位置するゾーンに対する Internet Explorer の設定によって制限されます。フォームは所定のドメイン内の他のデータ ソースとは通信できますが、通常、ゾーンでドメイン間通信が有効になっていない限り、他のドメインからデータを受信することはできません。このレベルは、ブラウザー互換のフォーム テンプレートに適用できる一番低いセキュリティ レベルです。</span><span class="sxs-lookup"><span data-stu-id="a3e76-p103">The Domain security level restricts a form to a particular Internet domain and its permissions are restricted to the Internet Explorer settings for the zone where the domain is located. The form is allowed to communicate with other data sources inside its own domain but is typically not allowed to retrieve data from other domains unless the zone allows cross-domain communication. This is the minimum security level allowed for browser-compatible form templates.</span></span>
  
### <a name="full-trust"></a><span data-ttu-id="a3e76-133">完全信頼</span><span class="sxs-lookup"><span data-stu-id="a3e76-133">Full Trust</span></span>

<span data-ttu-id="a3e76-p104">完全信頼のセキュリティ レベルでは、フォームが実際に使用されるコンピューター上で、フォームを完全に信頼して実行できます。このセキュリティ レベルは、クライアント コンピューターに格納されている信頼されたルート発行元に一致する署名が付いているフォームをサーバー上で操作する場合か、フォームをクライアント コンピューターにインストールする場合に限り使用できます。どちらの場合も、 **requireFullTrust** 属性を "yes" に設定する必要があります。この値を設定すると、フォームからオブジェクト モデルの呼び出し (ファイルの保存など) が可能になり、これよりも制限が厳しいセキュリティ レベルでの実行時に表示される特定のセキュリティ関連ダイアログ ボックスが表示されなくなります。</span><span class="sxs-lookup"><span data-stu-id="a3e76-p104">The Full Trust security level allows you to run a form with full trust on the computer where the form will be used. This security level can only be used when you are working with a form located on a server that is signed with a signature that matches a trusted root publisher on your computer, or by installing the form. Both methods require setting the **requireFullTrust** attribute to "yes". By using this setting, the form can access object model calls such as file save, and certain security prompts that appear when you run at a more restrictive security level are disabled.</span></span> 
  
> [!NOTE]
> <span data-ttu-id="a3e76-p105">[!メモ] InfoPath のデザイン モードで生成したフォームには必ずセキュリティ レベルが関連付けられます。InfoPath では、フォームは関連付けられているセキュリティ レベルで開きます。フォームに関連付けられているセキュリティ レベルが、そのフォームに実際に適用可能なセキュリティ レベルよりも高い場合、そのフォームは開きません。</span><span class="sxs-lookup"><span data-stu-id="a3e76-p105">All forms generated in the InfoPath designer have a security level associated with them. InfoPath opens forms at their associated security level. If the security level associated with the form is higher than the security level that can be granted to it, the form will not open.</span></span> 
  
<span data-ttu-id="a3e76-p106">完全信頼のセキュリティ レベルは、インストールされているフォーム テンプレートまたは署名済みのフォーム テンプレートにのみ設定できます。それ以外のテンプレートの場合、適用できる信頼レベルは最高でドメイン レベルになります。完全信頼のセキュリティ レベルが自動的に設定されることはありません。</span><span class="sxs-lookup"><span data-stu-id="a3e76-p106">The Full Trust security level can only be set for installed or signed form templates; otherwise, the maximum trust level is Domain. InfoPath will not set a security level to Full Trust automatically.</span></span>
  
<span data-ttu-id="a3e76-143">開いたフォームには、そのフォームが保存されている場所に応じて、セキュリティ レベルが割り当てられます。</span><span class="sxs-lookup"><span data-stu-id="a3e76-143">Forms are granted security levels based on the location from which the form is opened.</span></span>
  
## <a name="trust-levels"></a><span data-ttu-id="a3e76-144">信頼レベル</span><span class="sxs-lookup"><span data-stu-id="a3e76-144">Trust levels</span></span>

<span data-ttu-id="a3e76-145">フォーム テンプレートに割り当てることのできる信頼レベルの上限は、次の表で示すように、[開かれたフォーム] の場所とその他の確認コードに基づいて決まります。</span><span class="sxs-lookup"><span data-stu-id="a3e76-145">The highest level of trust that can be granted to a form template is determined by the Opened From location and other verification code, as described in the following table.</span></span> <span data-ttu-id="a3e76-146">表にリストされている属性 (HTTP、UNC、requireFullTrustなど) は、フォームに付与できる信頼レベルを決定し、InfoPath クライアントで開いたフォームに適用するエントリです。</span><span class="sxs-lookup"><span data-stu-id="a3e76-146">The attributes listed in the table (for example, HTTP, UNC,  *requireFullTrust*) are entries that are used to determine the level of trust that can be granted to a form, and apply to forms opened in the InfoPath client.</span></span> 
  
|<span data-ttu-id="a3e76-147">割り当て可能な最高の信頼レベル</span><span class="sxs-lookup"><span data-stu-id="a3e76-147">Highest Level of Trust Granted</span></span>|<span data-ttu-id="a3e76-148">完全信頼</span><span class="sxs-lookup"><span data-stu-id="a3e76-148">Full Trust</span></span>|<span data-ttu-id="a3e76-149">クライアント コンピューター (サンドボックス内)</span><span class="sxs-lookup"><span data-stu-id="a3e76-149">Client Computer (Sandboxed)</span></span>|<span data-ttu-id="a3e76-150">イントラネット (サンドボックス内)</span><span class="sxs-lookup"><span data-stu-id="a3e76-150">Intranet (Sandboxed)</span></span>|<span data-ttu-id="a3e76-151">インターネット (サンドボックス内)</span><span class="sxs-lookup"><span data-stu-id="a3e76-151">Internet (Sandboxed)</span></span>|<span data-ttu-id="a3e76-152">Restricted</span><span class="sxs-lookup"><span data-stu-id="a3e76-152">Restricted</span></span>|
|:-----|:-----:|:-----:|:-----:|:-----:|:-----:|
|<span data-ttu-id="a3e76-153">**ファイル: アクセス パス=開かれたフォームの場所**</span><span class="sxs-lookup"><span data-stu-id="a3e76-153">**file: Access Path=Opened From Location**</span></span> <br/> |||<span data-ttu-id="a3e76-154">X</span><span class="sxs-lookup"><span data-stu-id="a3e76-154">X</span></span>  <br/> |||
|<span data-ttu-id="a3e76-155">**ファイル: アクセス パス\<\>開かれたフォームの場所、またはアクセス パス未指定 (フォームの保存場所は不問)**</span><span class="sxs-lookup"><span data-stu-id="a3e76-155">**file: Access Path\<\>Opened From Location or no Access Path (regardless of where the form came from)**</span></span> <br/> |||||<span data-ttu-id="a3e76-156">X</span><span class="sxs-lookup"><span data-stu-id="a3e76-156">X</span></span>  <br/> |
|<span data-ttu-id="a3e76-157">**開かれたフォームの場所: イントラネット HTTP または HTTPS**</span><span class="sxs-lookup"><span data-stu-id="a3e76-157">**Opened From Location: Intranet HTTP or HTTPS**</span></span> <br/> |||<span data-ttu-id="a3e76-158">X</span><span class="sxs-lookup"><span data-stu-id="a3e76-158">X</span></span>  <br/> |||
|<span data-ttu-id="a3e76-159">**開かれたフォームの場所: インターネット HTTP または HTTPS**</span><span class="sxs-lookup"><span data-stu-id="a3e76-159">**Opened From Location: Internet HTTP or HTTPS**</span></span> <br/> ||||<span data-ttu-id="a3e76-160">X</span><span class="sxs-lookup"><span data-stu-id="a3e76-160">X</span></span>  <br/> ||
|<span data-ttu-id="a3e76-161">**開かれたフォームの場所: UNC**</span><span class="sxs-lookup"><span data-stu-id="a3e76-161">**Opened From Location: UNC**</span></span> <br/> |||<span data-ttu-id="a3e76-162">X</span><span class="sxs-lookup"><span data-stu-id="a3e76-162">X</span></span>  <br/> |||
|<span data-ttu-id="a3e76-163">**インストールされているテンプレート (requireFullTrust="yes")**</span><span class="sxs-lookup"><span data-stu-id="a3e76-163">**Installed Template (requireFullTrust="yes")**</span></span> <br/> |<span data-ttu-id="a3e76-164">X</span><span class="sxs-lookup"><span data-stu-id="a3e76-164">X</span></span>  <br/> |||||
|<span data-ttu-id="a3e76-165">**インストールされているテンプレート (requireFullTrust="no")**</span><span class="sxs-lookup"><span data-stu-id="a3e76-165">**Installed Template (requireFullTrust="no")**</span></span> <br/> ||<span data-ttu-id="a3e76-166">X</span><span class="sxs-lookup"><span data-stu-id="a3e76-166">X</span></span>  <br/> ||||
|<span data-ttu-id="a3e76-167">**信頼された発行元の証明書で署名済みのテンプレート**</span><span class="sxs-lookup"><span data-stu-id="a3e76-167">**Template with trusted publisher certificate**</span></span> <br/> |<span data-ttu-id="a3e76-168">X</span><span class="sxs-lookup"><span data-stu-id="a3e76-168">X</span></span>  <br/> |||||
|<span data-ttu-id="a3e76-169">**エクスポートしたフォーム ファイル**</span><span class="sxs-lookup"><span data-stu-id="a3e76-169">**Exported Form Files**</span></span> <br/> |||<span data-ttu-id="a3e76-170">X</span><span class="sxs-lookup"><span data-stu-id="a3e76-170">X</span></span>  <br/> |||
   
## <a name="form-open-behavior"></a><span data-ttu-id="a3e76-171">フォームを開く動作</span><span class="sxs-lookup"><span data-stu-id="a3e76-171">Form open behavior</span></span>

<span data-ttu-id="a3e76-p108">InfoPath エディターでフォーム ファイルを開く際には、一連の条件に従って、そのフォームを開くときに適用するセキュリティ レベルと、フォームを開くかどうかが判定されます。InfoPath フォームをエディターで開いた場合、フォームは適切なセキュリティ レベルで開くか、または読み込まれないかのどちらかになります。フォームが適用可能なレベルよりも高いセキュリティ レベルを要求している場合 (フォームは **trustLevel** 属性または **requireFullTrust** 属性を使用して特定のセキュリティ レベルを要求できます)、そのフォームの読み込みは許可されません。要求レベルが妥当な場合は、要求したセキュリティ レベルでフォームが読み込まれます。フォーム テンプレートが要求したセキュリティ レベルで開くことを許可されない場合、ユーザー側でフォームを開くことができず、エラー メッセージが表示されます。</span><span class="sxs-lookup"><span data-stu-id="a3e76-p108">All form files opened in the InfoPath editor are bound by a set of conditions that determine the security level at which the form will open and whether it will open. When an InfoPath form is opened in the editor, it will be either opened with an appropriate security level, or it will not load. If a form requests a higher security level than it can be granted (a form can request a specific security level using the **trustLevel** or **requireFullTrust** attribute), it will not be allowed to load. Otherwise, it will be loaded with the security level it requests. If the form template is not allowed to open with the requested security level, the user will not be able to open the form and will receive an error message.</span></span> 
  
<span data-ttu-id="a3e76-177">次の表は、各セキュリティ レベルでフォームを開くために必要な条件と、ユーザーがフォームを開こうとした場合に起こる動作を示しています。</span><span class="sxs-lookup"><span data-stu-id="a3e76-177">The following table describes the conditions required for opening a form at each security level and the resultant behavior when the user attempts to open the form.</span></span>
  
|<span data-ttu-id="a3e76-178">エディターが開くかどうか</span><span class="sxs-lookup"><span data-stu-id="a3e76-178">Editor Opens/Fails</span></span>|<span data-ttu-id="a3e76-179">完全信頼 (requireFullTrust="yes")</span><span class="sxs-lookup"><span data-stu-id="a3e76-179">Full Trust (requireFullTrust="yes")</span></span>|<span data-ttu-id="a3e76-180">ドメイン信頼 (trustLevel="Domain" または空白)</span><span class="sxs-lookup"><span data-stu-id="a3e76-180">Domain Trust (trustLevel="Domain" or blank)</span></span>|<span data-ttu-id="a3e76-181">制限あり (trustLevel="Restricted")</span><span class="sxs-lookup"><span data-stu-id="a3e76-181">Restricted (trustLevel="Restricted")</span></span>|
|:-----|:-----|:-----|:-----|
|<span data-ttu-id="a3e76-182">**信頼済み (インストール済みまたは信頼された証明書で署名済み)**</span><span class="sxs-lookup"><span data-stu-id="a3e76-182">**Trusted (installed or trusted certificate)**</span></span> <br/> |<span data-ttu-id="a3e76-183">完全信頼レベルで開く</span><span class="sxs-lookup"><span data-stu-id="a3e76-183">Editor opens at Full Trust level</span></span>  <br/> |<span data-ttu-id="a3e76-184">該当なし</span><span class="sxs-lookup"><span data-stu-id="a3e76-184">N/A</span></span>  <br/> |<span data-ttu-id="a3e76-185">該当なし</span><span class="sxs-lookup"><span data-stu-id="a3e76-185">N/A</span></span>  <br/> |
|<span data-ttu-id="a3e76-186">**ドメイン信頼: クライアント コンピューター**</span><span class="sxs-lookup"><span data-stu-id="a3e76-186">**Domain Trust: Client Computer**</span></span> <br/> |<span data-ttu-id="a3e76-187">開けない</span><span class="sxs-lookup"><span data-stu-id="a3e76-187">Fails to open</span></span>  <br/> |<span data-ttu-id="a3e76-188">ドメイン レベルで開く</span><span class="sxs-lookup"><span data-stu-id="a3e76-188">Editor opens at Domain level</span></span>  <br/> |<span data-ttu-id="a3e76-189">制限ありレベルで開く</span><span class="sxs-lookup"><span data-stu-id="a3e76-189">Editor opens at Restricted level</span></span>  <br/> |
|<span data-ttu-id="a3e76-190">**ドメイン信頼: イントラネット**</span><span class="sxs-lookup"><span data-stu-id="a3e76-190">**Domain Trust: Intranet**</span></span> <br/> |<span data-ttu-id="a3e76-191">開けない</span><span class="sxs-lookup"><span data-stu-id="a3e76-191">Fails to open</span></span>  <br/> |<span data-ttu-id="a3e76-192">ドメイン レベルで開く</span><span class="sxs-lookup"><span data-stu-id="a3e76-192">Editor opens at Domain level</span></span>  <br/> |<span data-ttu-id="a3e76-193">制限ありレベルで開く</span><span class="sxs-lookup"><span data-stu-id="a3e76-193">Editor opens at Restricted level</span></span>  <br/> |
|<span data-ttu-id="a3e76-194">**ドメイン信頼: インターネット**</span><span class="sxs-lookup"><span data-stu-id="a3e76-194">**Domain Trust: Internet**</span></span> <br/> |<span data-ttu-id="a3e76-195">開けない</span><span class="sxs-lookup"><span data-stu-id="a3e76-195">Fails to open</span></span>  <br/> |<span data-ttu-id="a3e76-196">ドメイン レベルで開く</span><span class="sxs-lookup"><span data-stu-id="a3e76-196">Editor opens at Domain level</span></span>  <br/> |<span data-ttu-id="a3e76-197">制限ありレベルで開く</span><span class="sxs-lookup"><span data-stu-id="a3e76-197">Editor opens at Restricted level</span></span>  <br/> |
|<span data-ttu-id="a3e76-198">**制限あり**</span><span class="sxs-lookup"><span data-stu-id="a3e76-198">**Restricted**</span></span> <br/> |<span data-ttu-id="a3e76-199">開けない</span><span class="sxs-lookup"><span data-stu-id="a3e76-199">Fails to open</span></span>  <br/> |<span data-ttu-id="a3e76-200">開けない</span><span class="sxs-lookup"><span data-stu-id="a3e76-200">Fails to open</span></span>  <br/> |<span data-ttu-id="a3e76-201">制限ありレベルで開く</span><span class="sxs-lookup"><span data-stu-id="a3e76-201">Editor opens at Restricted level</span></span>  <br/> |
   
## <a name="specifying-a-security-level"></a><span data-ttu-id="a3e76-202">セキュリティ レベルの指定</span><span class="sxs-lookup"><span data-stu-id="a3e76-202">Specifying a security level</span></span>

<span data-ttu-id="a3e76-p109">InfoPath のフォーム デザイン ウィンドウでは、フォームで使用されている機能に基づいて適切なセキュリティ レベル (制限ありまたはドメイン) が自動的に選択されます。選択されるセキュリティ設定は、ユーザーとデータを確実に保護できるように、まず制限ありレベルから検討され、可能な限り制限の強い設定になります。自動選択された設定は、次の手順に従って手動で上書きし、フォームにより適したセキュリティ レベルを選択できます。</span><span class="sxs-lookup"><span data-stu-id="a3e76-p109">The InfoPath form designer automatically selects the appropriate security level (either Restricted or Domain) based on the features that you are using in the form. The security setting is always as restrictive as possible, starting at Restricted, to help ensure a greater level of protection for you and your data. Users can manually override this automated setting to select a level of security that is more appropriate for the form by following these steps:</span></span>
  
1. <span data-ttu-id="a3e76-206">[ **ファイル**] タブをクリックし、[ **情報**] タブの [ **フォームのオプション**] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="a3e76-206">Click the **File** tab, and then click **Form Options** on the **Info** tab.</span></span> 
    
2. <span data-ttu-id="a3e76-207">[ **カテゴリ**] ボックスの一覧で [ **セキュリティと信頼**] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="a3e76-207">In the **Categories** list, click **Security and Trust**.</span></span>
    
3. <span data-ttu-id="a3e76-208">[ **自動的にセキュリティ レベルを設定する (推奨)**] チェック ボックスをオフにします。</span><span class="sxs-lookup"><span data-stu-id="a3e76-208">Uncheck the **Automatically determine security level (recommended)** check box.</span></span> 
    
4. <span data-ttu-id="a3e76-209">必要なセキュリティ レベルを選択します。</span><span class="sxs-lookup"><span data-stu-id="a3e76-209">Select the desired security level.</span></span>
    
## <a name="mail-deployment-and-browser-enabled-form-templates"></a><span data-ttu-id="a3e76-210">メールの展開とブラウザーが有効なフォーム テンプレート</span><span class="sxs-lookup"><span data-stu-id="a3e76-210">Mail deployment and browser-enabled form templates</span></span>

<span data-ttu-id="a3e76-211">InfoPath を使用すると、フォーム テンプレートを添付ファイルとして電子メール メッセージに送信し、ある場所から別の場所に移動できます。</span><span class="sxs-lookup"><span data-stu-id="a3e76-211">InfoPath allows you to send your form templates as an attachment to an email message and to move them from one location to another.</span></span> <span data-ttu-id="a3e76-212">社内用のフォームを配布する場合や、リモート ユーザーにフォームを配布する場合は、メールによる配信が簡単で効率的です。</span><span class="sxs-lookup"><span data-stu-id="a3e76-212">Mail deployment is an easy and effective way to distribute forms for interoffice use and also to deploy forms to remote users.</span></span>
  
<span data-ttu-id="a3e76-213">また、InfoPath Forms Services を搭載した Microsoft SharePoint Server 2010 が実装されている場合は、ユーザーが InfoPath をコンピューターにインストールしていなくても Web ブラウザーでフォームに記入できるようなフォーム テンプレートを作成できます。</span><span class="sxs-lookup"><span data-stu-id="a3e76-213">Alternatively, if you have Microsoft SharePoint Server 2010 with InfoPath Forms Services available, you can create form templates that enable users who do not have InfoPath installed to fill out forms in a Web browser.</span></span>
  
## <a name="understanding-form-identity"></a><span data-ttu-id="a3e76-214">フォーム ID について</span><span class="sxs-lookup"><span data-stu-id="a3e76-214">Understanding form identity</span></span>

<span data-ttu-id="a3e76-p111">InfoPath のデザイン モードで作成するフォームには ID が割り当てられます。InfoPath では、この ID 情報に基づいて、フォームをキャッシュ内のフォーム テンプレートに関連付け、フォームの更新情報が共有の場所に公開された場合に更新データを取得できます。既定の設定では、InfoPath のフォーム テンプレートにはフォーム ID とアクセス パスの 2 種類の ID が作成されます。</span><span class="sxs-lookup"><span data-stu-id="a3e76-p111">All forms in the InfoPath designer are created with an identity. This identity information helps InfoPath associate forms with form templates in the cache and to retrieve updates to forms when they are posted to a shared location. By default, InfoPath creates two identities for form templates: a Form ID and an Access Path.</span></span> 
  
### <a name="form-id"></a><span data-ttu-id="a3e76-218">フォーム ID</span><span class="sxs-lookup"><span data-stu-id="a3e76-218">Form ID</span></span>

<span data-ttu-id="a3e76-p112">フォーム ID は、プレフィックス、フォーム名、フォームの名前空間に基づいた一意の識別子です。この ID は、フォーム ファイルをクライアント コンピューターのキャッシュ内にある関連フォーム テンプレートに正しく対応付けられるように、一意の名前であることが必要です。フォーム ID は、フォーム定義ファイル (.xsf) で name 属性で指定されます (例:  `name="urn:MyForm:MyCompany:Template1:myXSD-1583-78-G3V94-23-47"`)。</span><span class="sxs-lookup"><span data-stu-id="a3e76-p112">The Form ID is a unique identifier based on a prefix, the form name, and the form namespace. The identifier should be a unique name that can be used to correctly associate form files with the associated form template in the client computer cache. The Form ID is specified as the name attribute (for example,  `name="urn:MyForm:MyCompany:Template1:myXSD-1583-78-G3V94-23-47"`) in the form definition file (.xsf).</span></span> 
  
### <a name="access-path"></a><span data-ttu-id="a3e76-222">アクセス パス</span><span class="sxs-lookup"><span data-stu-id="a3e76-222">Access Path</span></span>

<span data-ttu-id="a3e76-p113">アクセス パスは、フォーム テンプレートの正しい場所や更新データの受信場所の判断材料となる、場所の識別子です。フォーム テンプレートの保存時または発行時に、保存先または発行先が既定のアクセス パスになります。フォームがクライアント コンピューター上で開かれるたびに、そのフォームと、キャッシュに保存されているフォーム テンプレートとの関連付けが行われます。この関連付け処理は、次の順序で進められます。</span><span class="sxs-lookup"><span data-stu-id="a3e76-p113">The Access Path is a location identifier that is used to determine the correct location for the form template and also the location to receive updates. When saved or published, where the form template is saved or published becomes the default Access Path. Each time that a form is opened on the client computer, the form attempts to associate itself with a cached form. It will attempt to do this in the following order:</span></span>
  
1. <span data-ttu-id="a3e76-227">フォーム ID が一致する完全信頼のフォーム テンプレートが検索されます。</span><span class="sxs-lookup"><span data-stu-id="a3e76-227">Look for a fully trusted form template with a matching Form ID.</span></span>
    
2. <span data-ttu-id="a3e76-228">アクセス パスが一致するフォーム テンプレートがキャッシュ内で検索されます。</span><span class="sxs-lookup"><span data-stu-id="a3e76-228">Look for a form template in the cache with a matching Access Path.</span></span>
    
3. <span data-ttu-id="a3e76-229">フォーム ID が一致するフォーム テンプレートがキャッシュ内で検索されます。</span><span class="sxs-lookup"><span data-stu-id="a3e76-229">Look for a form template in the cache with a matching Form ID.</span></span>
    
<span data-ttu-id="a3e76-p114">一致するテンプレートが見つかると、その関連フォーム テンプレートを使用してフォームが開きます。アクセス パスが一致した場合は、そのアクセス パスを使用してフォーム テンプレートの更新データが取得されます。この方法により、フォームの社内管理、メンテナンス、更新処理を効率化できます。一致するテンプレートが見つからなかった場合、信頼レベルがドメイン レベルのときは、フォームは開きません。アクセス パスは、フォーム定義ファイル (.xsf) で **publishUrl** 属性で指定されます。</span><span class="sxs-lookup"><span data-stu-id="a3e76-p114">Once matched, the form will open with the associated form template. In cases in which the match was made with an Access Path, InfoPath will use the Access Path to retrieve updates to the form template. This method simplifies enterprise administration, maintenance, and update of forms. In cases in which the match cannot be made and the trust level is Domain, the form will not open. The Access Path is specified as the **publishUrl** attribute in the form definition file (.xsf).</span></span> 
  
<span data-ttu-id="a3e76-235">各フォーム テンプレートに ID プロパティが 2 つあるのと同様に、フォーム テンプレートの状態 (アクセス パス、フォーム ID のどちらか、またはその両方が割り当てられているかどうか) やネットワーク接続の状態に基づいて、キャッシュ内で一致するエントリを特定するためのヒューリスティックも一式あります。</span><span class="sxs-lookup"><span data-stu-id="a3e76-235">Just as there are two identification properties for each form template, there is a set of heuristics to specifically determine the resulting entries in the cache, based on the condition of the form template (whether it has an Access Path, a Form ID, or both) and the state of the network connection.</span></span>
  
## <a name="designing-a-form-to-send-as-an-attachment-to-an-email-message"></a><span data-ttu-id="a3e76-236">電子メール メッセージへの添付ファイルとして送信するフォームを設計する</span><span class="sxs-lookup"><span data-stu-id="a3e76-236">Designing a form to send as an attachment to an email message</span></span>

<span data-ttu-id="a3e76-237">InfoPath デザイナーで作成されたフォームはすべて、電子メール メッセージの添付ファイルとしてユーザーに送信できます。</span><span class="sxs-lookup"><span data-stu-id="a3e76-237">All forms that are created in the InfoPath designer can be sent to users as an attachment to an email message.</span></span> <span data-ttu-id="a3e76-238">メールの展開は、オフィス間で使用するフォームを配布したり、リモート ユーザーにフォームを展開したりするための簡単で効果的な方法です。</span><span class="sxs-lookup"><span data-stu-id="a3e76-238">Email deployment is an easy and effective way to distribute forms for interoffice use and also to deploy forms to remote users.</span></span>
  
### <a name="to-mail-a-form-template-to-other-users"></a><span data-ttu-id="a3e76-239">フォーム テンプレートを他のユーザーにメールで送信するには</span><span class="sxs-lookup"><span data-stu-id="a3e76-239">To mail a form template to other users</span></span>

1. <span data-ttu-id="a3e76-240">[ファイル] **タブを** クリックし、[発行] **を** クリックし、[メール] ボタン **をクリック** します。</span><span class="sxs-lookup"><span data-stu-id="a3e76-240">Click the **File** tab, click **Publish**, and then click the **Email** button.</span></span> 
    
2. <span data-ttu-id="a3e76-241">**発行ウィザード** で続いて表示される 2 ページに必要事項を記入し、各ページの記入が済んだら [ **次へ**] をクリックして、最後に [ **発行**] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="a3e76-241">Fill out the next two pages of the **Publishing Wizard** clicking **Next** to continue after each page, and then click **Publish**.</span></span>
    
3. <span data-ttu-id="a3e76-242">電子メール メッセージが表示され、受信者の一覧と、その他の手順を入力できます。</span><span class="sxs-lookup"><span data-stu-id="a3e76-242">An email message is displayed enabling you to fill in the list of recipients and any additional instructions that you may have for them.</span></span>
    
4. <span data-ttu-id="a3e76-p116">記入が済んだら、[ **送信**] をクリックします。フォームとフォーム テンプレートがメッセージに添付されます。</span><span class="sxs-lookup"><span data-stu-id="a3e76-p116">After you are finished, click **Send**. The form and the form template will be attached to the message.</span></span>
    
## <a name="email-deployment-restricted-domain-and-full-trust-form-templates"></a><span data-ttu-id="a3e76-245">メールの展開: 制限付き、ドメイン、および完全信頼フォーム テンプレート</span><span class="sxs-lookup"><span data-stu-id="a3e76-245">Email deployment: restricted, domain, and Full Trust form templates</span></span>

<span data-ttu-id="a3e76-246">制限付きフォーム テンプレートを電子メールで展開すると、データ接続のない動的フォームをどこからでも開くことができる。</span><span class="sxs-lookup"><span data-stu-id="a3e76-246">Email deployment of Restricted form templates allows dynamic forms without data connections to be opened from anywhere.</span></span> <span data-ttu-id="a3e76-247">受信者は、電子メールの添付ファイルとして送信されたフォーム テンプレートを、Microsoft Outlook 2010または受信者が添付ファイルを保存した場所から直接開きます。</span><span class="sxs-lookup"><span data-stu-id="a3e76-247">Recipients can open form templates sent as email attachments either directly from Microsoft Outlook 2010 or from wherever the recipient has saved the attachment.</span></span> <span data-ttu-id="a3e76-248">また、Outlook 2010 を使用して、フォームをメッセージ内で直接編集できます。</span><span class="sxs-lookup"><span data-stu-id="a3e76-248">Additionally, Outlook 2010 allows users to edit forms directly in the message.</span></span>
  
<span data-ttu-id="a3e76-249">ドメイン信頼レベルを持つフォーム テンプレートは、発行された場所から開く必要がありますが、発行ウィザードで電子メール受信者の一覧に発行することで、電子メール メッセージへの添付ファイルとして送信できます。</span><span class="sxs-lookup"><span data-stu-id="a3e76-249">Form templates with the Domain trust level must be opened from their published location, but by publishing to a list of email recipients in the Publishing Wizard, they can be sent as an attachment to an email message.</span></span> <span data-ttu-id="a3e76-250">この添付ファイルを開くと、該当するテンプレートの実際の発行先へのリンクとして機能します。</span><span class="sxs-lookup"><span data-stu-id="a3e76-250">When the attachment is opened, it functions as a link to the actual published location of the template.</span></span> <span data-ttu-id="a3e76-251">InfoPath エディターで実際に開かれるのは、発行先にあるフォーム テンプレートです。</span><span class="sxs-lookup"><span data-stu-id="a3e76-251">The form template at that location is what is actually opened in the InfoPath editor.</span></span>
  
<span data-ttu-id="a3e76-252">電子メール添付ファイルとして送信されるドメイン レベルのフォーム テンプレートを使用すると、他の種類のドキュメントを使用した場合と似たものになります。たとえば、ブックMicrosoft ExcelドキュメントMicrosoft Wordします。</span><span class="sxs-lookup"><span data-stu-id="a3e76-252">Using a Domain-level form template sent as an email attachment resembles using any other kind of document; for example, a Microsoft Excel workbook or a Microsoft Word document.</span></span> <span data-ttu-id="a3e76-253">ユーザーはフォームをクリックするだけで開いて使用できます。</span><span class="sxs-lookup"><span data-stu-id="a3e76-253">A user can just click on the form to open and use it.</span></span> <span data-ttu-id="a3e76-254">また、ドメイン レベルで更新がある場合、ユーザーがそのメリットを余すことなく活用できます。</span><span class="sxs-lookup"><span data-stu-id="a3e76-254">In addition, all the benefits of Domain-level updates are available to users.</span></span>
  
<span data-ttu-id="a3e76-255">完全信頼アクセスを要求するフォーム テンプレートを電子メールで送信できますが、これらのテンプレートに署名するか、開くことができません。</span><span class="sxs-lookup"><span data-stu-id="a3e76-255">You can email form templates that request Full Trust access, but these templates must be signed or they will not be allowed to open.</span></span> <span data-ttu-id="a3e76-256">ドメインまたは制限付きアクセスを要求するフォーム テンプレートは、電子メールの添付ファイルとして送信するために署名する必要があります。</span><span class="sxs-lookup"><span data-stu-id="a3e76-256">Form templates requesting Domain or Restricted access do not have to be signed to be sent as an email attachment.</span></span> <span data-ttu-id="a3e76-257">これらのテンプレートについては、署名されている場合でも、自動更新が可能かどうかを確認する目的以外では署名が確認または検証されることはありません。</span><span class="sxs-lookup"><span data-stu-id="a3e76-257">InfoPath does not check or verify the signature, even if the template is signed, except to see whether it can be updated automatically.</span></span> <span data-ttu-id="a3e76-258">ただし、ドメイン レベルまたは制限ありレベルのフォーム テンプレートにデジタル署名をすると、自動更新機能を利用できます。</span><span class="sxs-lookup"><span data-stu-id="a3e76-258">You could digitally sign a Domain or Restricted form template and still have automatic update capability.</span></span> <span data-ttu-id="a3e76-259">その場合は、デジタル署名があることで、キャッシュ競合のメッセージが表示されなくなります。</span><span class="sxs-lookup"><span data-stu-id="a3e76-259">In this case, the digital signature will prevent any cache conflict messages from appearing.</span></span>
  
## <a name="sharing-forms-by-email-message-or-from-a-common-shared-location"></a><span data-ttu-id="a3e76-260">電子メール メッセージまたは共通の共有場所からフォームを共有する</span><span class="sxs-lookup"><span data-stu-id="a3e76-260">Sharing forms by email message or from a common shared location</span></span>

<span data-ttu-id="a3e76-261">電子メール メッセージによって展開されるフォームを作成する場合は、特定の質問を考慮する必要があります。</span><span class="sxs-lookup"><span data-stu-id="a3e76-261">Certain questions should be considered when you are creating a form that will be deployed by email message.</span></span>
  
- <span data-ttu-id="a3e76-p121">**フォームを定期的に更新するかどうか**。作成したフォームを定期的に更新する必要がある場合は、フォームを他のユーザーに送信する前に、共有の場所に発行しておきます。これにより、共有の場所にフォームの新しいバージョンを発行するだけでフォームを更新できますが、その場所にアクセスできないユーザーには即座にフォーム テンプレートを配布できます。</span><span class="sxs-lookup"><span data-stu-id="a3e76-p121">**Will your form be updated regularly?** If you are developing a form that must be updated regularly, the form should be published to a shared location before it is sent to other users. This practice enables you to update the form by publishing newer versions to the shared location but it also enables you to immediately distribute the form template to users who may not have access to the shared location.</span></span> 
    
   <span data-ttu-id="a3e76-265">フォームが更新され、電子メール メッセージによって配布された場合、ユーザーは、コンピューターに古いバージョンが保存され、アクセス パスが変更されている場合、新しいフォームを開く際にキャッシュ競合メッセージを取得します。</span><span class="sxs-lookup"><span data-stu-id="a3e76-265">If a form is updated and then distributed by email message, users will get a cache conflict message when they try to open the new form, if they have an older version stored on their computer and the Access Path has changed.</span></span> <span data-ttu-id="a3e76-266">受信者は、どちらのバージョンを使用するかを選択する必要があります。</span><span class="sxs-lookup"><span data-stu-id="a3e76-266">The user will be prompted to choose which version they want to use.</span></span> <span data-ttu-id="a3e76-267">更新済みのフォームが、受信者のコンピューター上のフォームと同じ場合でも、使用するコピーの選択を求めるキャッシュ競合のメッセージは依然として表示されます。</span><span class="sxs-lookup"><span data-stu-id="a3e76-267">Even if the updated form is the same as the one on the user's computer, the user will get a cache conflict message and be prompted to choose which copy they want to use.</span></span> <span data-ttu-id="a3e76-268">後者の場合のベスト プラクティスは、メール配信の代わりに共有の場所を利用してフォームを共有することです。</span><span class="sxs-lookup"><span data-stu-id="a3e76-268">The best practice to use in the latter case is to share the form from a shared location instead.</span></span>
    
- <span data-ttu-id="a3e76-269">**フォームでデータ接続の必要があるか、または制限ありのセキュリティ レベルでは使用できないその他の機能をフォームで使用するかどうか**。</span><span class="sxs-lookup"><span data-stu-id="a3e76-269">**Does your form access a data connection or use other features not supported at the Restricted security level?**</span></span> <span data-ttu-id="a3e76-270">ドメイン レベルのセキュリティを必要とするフォームを作成する場合は、フォームをユーザーが開けるように共有の場所に発行する必要があります。</span><span class="sxs-lookup"><span data-stu-id="a3e76-270">If you are developing a form that requires Domain-level security, InfoPath requires you to publish the form to a shared location for users to be able to open it.</span></span> <span data-ttu-id="a3e76-271">フォーム テンプレートは要求するセキュリティ レベルでのみ開くので、InfoPath がドメイン レベルのセキュリティを付与できない場合、電子メール メッセージから直接開いたフォームは開かれません。</span><span class="sxs-lookup"><span data-stu-id="a3e76-271">Because form templates will only open at the security level they request, forms opened directly from an email message will not open if InfoPath cannot grant Domain-level security.</span></span> 
    
## <a name="benefits-of-using-signed-form-templates"></a><span data-ttu-id="a3e76-272">署名付きフォーム テンプレートを使用する利点</span><span class="sxs-lookup"><span data-stu-id="a3e76-272">Benefits of using signed form templates</span></span>

- <span data-ttu-id="a3e76-273">フォーム テンプレートを完全信頼のセキュリティ レベルで開くことができます。</span><span class="sxs-lookup"><span data-stu-id="a3e76-273">It allows the form template to open with Full Trust security.</span></span>
    
- <span data-ttu-id="a3e76-274">フォームが新しい場所に移動した場合でも、キャッシュ競合のメッセージが表示されなくなります。</span><span class="sxs-lookup"><span data-stu-id="a3e76-274">It avoids the cache conflict message if the form is moved to a new location.</span></span>
    
<span data-ttu-id="a3e76-p124">さらに、フォーム テンプレートが署名されていると、自動更新機能という別のメリットもあります。詳細については、「[署名済み InfoPath フォーム テンプレートを展開する](deploying-signed-infopath-form-templates.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="a3e76-p124">Additionally, if a form template is signed, you get the added benefit of the automatic update functionality. For more information, see [Deploying Signed InfoPath Form Templates](deploying-signed-infopath-form-templates.md).</span></span>
  
### <a name="example-updating-domain-or-restricted-templates"></a><span data-ttu-id="a3e76-277">例: ドメインまたは制限付きテンプレートの更新</span><span class="sxs-lookup"><span data-stu-id="a3e76-277">Example: Updating domain or restricted templates</span></span>

<span data-ttu-id="a3e76-278">次の例は、ドメイン または制限付きアクセスを要求する更新された署名済みフォーム テンプレートが古いコピーを上書きする方法を示しています。</span><span class="sxs-lookup"><span data-stu-id="a3e76-278">The following example shows how an updated, signed form template requesting either Domain or Restricted access can overwrite an older copy:</span></span> 
  
1. <span data-ttu-id="a3e76-279">"A" が署名済みのフォーム テンプレートを "B" に送信します。</span><span class="sxs-lookup"><span data-stu-id="a3e76-279">"A" sends a signed form template to "B".</span></span>
    
2. <span data-ttu-id="a3e76-280">"B" がフォーム テンプレートを開きます。</span><span class="sxs-lookup"><span data-stu-id="a3e76-280">"B" opens the form template.</span></span>
    
3. <span data-ttu-id="a3e76-281">"A" がフィールドを追加するなどしてフォーム テンプレートを更新します。</span><span class="sxs-lookup"><span data-stu-id="a3e76-281">"A" updates the form template (for example, adds more fields).</span></span>
    
4. <span data-ttu-id="a3e76-282">"A" が更新後のフォーム テンプレートを "B" に送信します。</span><span class="sxs-lookup"><span data-stu-id="a3e76-282">"A" sends the updated form template to "B".</span></span>
    
5. <span data-ttu-id="a3e76-283">"B" が更新後のフォーム テンプレートを開きます。</span><span class="sxs-lookup"><span data-stu-id="a3e76-283">"B" opens the updated form template.</span></span>
    
### <a name="example-deploying-restricted-form-templates-on-an-extranet"></a><span data-ttu-id="a3e76-284">例: エクストラネットへの制限付きフォーム テンプレートの展開</span><span class="sxs-lookup"><span data-stu-id="a3e76-284">Example: Deploying restricted form templates on an extranet</span></span>
  
1. <span data-ttu-id="a3e76-285">ドメイン フォーム テンプレートを、ドメイン フォーム テンプレートを実行している web サイトにMicrosoft SharePoint Foundation 2010。</span><span class="sxs-lookup"><span data-stu-id="a3e76-285">Save the Domain form template on a website that is running Microsoft SharePoint Foundation 2010.</span></span>
    
2. <span data-ttu-id="a3e76-286">フォーム テンプレートのセキュリティ レベルを [制限あり] に変更します。</span><span class="sxs-lookup"><span data-stu-id="a3e76-286">Change the form template security level to Restricted.</span></span>
    
3. <span data-ttu-id="a3e76-287">フォーム テンプレートをコンピューターのデスクトップに保存します。</span><span class="sxs-lookup"><span data-stu-id="a3e76-287">Save the form template on your computer desktop.</span></span>
    
4. <span data-ttu-id="a3e76-288">URL を削除します (URL はユーザーがフォームの発行先にアクセスできる場合にのみ必要です)。</span><span class="sxs-lookup"><span data-stu-id="a3e76-288">Remove the URL (required only if users have access to the original publish location).</span></span>
    
5. <span data-ttu-id="a3e76-289">フォームをエクストラネット上のユーザーに送信します。</span><span class="sxs-lookup"><span data-stu-id="a3e76-289">Send the form to users on an extranet.</span></span>
    
6. <span data-ttu-id="a3e76-290">ユーザーにフォームをインストールするように指示します。</span><span class="sxs-lookup"><span data-stu-id="a3e76-290">Have the users install the form.</span></span>
    
7. <span data-ttu-id="a3e76-291">ユーザーに記入済みのフォームを返信するように指示します。</span><span class="sxs-lookup"><span data-stu-id="a3e76-291">Have users send the form back to you after filling it out.</span></span>
    
8. <span data-ttu-id="a3e76-292">SharePoint Foundation 2010 を実行している Web サイトにフォームを保存し、フォーム ライブラリ 設定ページの [このライブラリにドキュメントを再リンク] オプションを使用してフォーム **を再リンク** します。</span><span class="sxs-lookup"><span data-stu-id="a3e76-292">Save the form back to the website that is running SharePoint Foundation 2010 and relink the form by using the **Relink documents to this Library** option in the **Form Library Settings** page.</span></span> 
    
## <a name="signature-verification-failure"></a><span data-ttu-id="a3e76-293">署名検証の失敗</span><span class="sxs-lookup"><span data-stu-id="a3e76-293">Signature verification failure</span></span>

<span data-ttu-id="a3e76-p125">完全信頼レベルのアクセスを要求する署名済みのフォーム テンプレートに対して署名が認証されない場合、このフォーム テンプレートは開きません。署名の検証がエラーになる原因としては、次のような理由が考えられます。</span><span class="sxs-lookup"><span data-stu-id="a3e76-p125">A signed form template that requests full trust access but for which the signature cannot be authenticated will not open. Signature verification can fail for any of the following reasons:</span></span>
  
- <span data-ttu-id="a3e76-296">ルート証明書が、信頼されたルート証明書ストアに存在しない。</span><span class="sxs-lookup"><span data-stu-id="a3e76-296">The root certificate is not in the trusted root certificate store.</span></span>
    
- <span data-ttu-id="a3e76-297">フォーム テンプレートの署名に使用された証明書の有効期限が切れている。</span><span class="sxs-lookup"><span data-stu-id="a3e76-297">The certificate that was used to sign the form template has expired.</span></span>
    
- <span data-ttu-id="a3e76-298">フォーム テンプレートの署名に使用された証明書が失効した。</span><span class="sxs-lookup"><span data-stu-id="a3e76-298">The certificate that was used to sign the form template was revoked.</span></span>
    
- <span data-ttu-id="a3e76-299">フォーム テンプレートの署名が破損している (フォーム テンプレートが署名後に変更された可能性があります)。</span><span class="sxs-lookup"><span data-stu-id="a3e76-299">The signature on the form template is corrupted (an indication that the form template was altered after it was signed).</span></span>
    
<span data-ttu-id="a3e76-300">署名済みのフォーム テンプレートが要求するアクセス レベルがドメインまたは制限ありの場合は、テンプレートの自動更新が可能かどうかを確認する場合以外には、署名が確認または検証されることはありません。</span><span class="sxs-lookup"><span data-stu-id="a3e76-300">If a signed form template requests Domain or Restricted access, InfoPath will not check or verify the signature except to determine whether the template can be updated automatically.</span></span>
  
## <a name="infrastructure-registry-keys-for-form-migration-open-behavior"></a><span data-ttu-id="a3e76-301">フォーム移行オープン動作のインフラストラクチャ レジストリ キー</span><span class="sxs-lookup"><span data-stu-id="a3e76-301">Infrastructure registry keys for form migration open behavior</span></span>

<span data-ttu-id="a3e76-p126">ユーザーが開こうとしたフォームとフォーム ID が一致するフォーム テンプレートが見つかった場合に、このフォーム テンプレートの信頼レベルがドメイン レベルで、該当ドメインがフォームの  *href*  属性と一致しないときは、エラー メッセージが表示されます。これにより、見つかったフォーム テンプレートを使用して作成されたことが明らかではないフォームが開かれる事態を阻止できます。</span><span class="sxs-lookup"><span data-stu-id="a3e76-p126">When a user attempts to open a form, and the form is matched against a form template by its Form ID, InfoPath will display an error message if the form template has a Domain trust level and the domain does not match the  *href*  attribute of the form. This prevents forms from being opened that were not explicitly created by using the form template.</span></span> 
  
<span data-ttu-id="a3e76-p127">InfoPath では、フォーム ID が同じ複数のフォーム テンプレートは共存できません。システム管理者は 4 つのレジストリ キーを別途指定することで、フォーム テンプレートに照らして XML ファイルを開くかどうかをユーザーが選択できるようにすることができます。このモデルを利用して、管理者はフォームが開かれるときの動作も設定できます。</span><span class="sxs-lookup"><span data-stu-id="a3e76-p127">InfoPath does not allow form templates with the same Form ID to coexist. Four additional registry keys help system administrators give users the option of whether to allow the XML file to open against a form template. This model also lets administrators set the open behavior they want for forms.</span></span>
  
<span data-ttu-id="a3e76-p128">次の表は、前述のレジストリ キーの既定の設定を示しています。これらのレジストリ キーがない場合は、表に記載されている既定値が適用されます。</span><span class="sxs-lookup"><span data-stu-id="a3e76-p128">The following table describes the default settings for the registry keys. If these registry keys are absent, the default value specified in the table will be enforced.</span></span>
  
<span data-ttu-id="a3e76-p129">[名前] の値は、Internet Explorer のドメイン設定に対応しています。これらの値によって、対応するセキュリティ ゾーンでフォームが開かれるときの動作として、フォームを開く操作をブロックするか許可するか、またはフォームを開くかどうかをユーザーが選択できるようにするかを指定できます。</span><span class="sxs-lookup"><span data-stu-id="a3e76-p129">The Name values correspond to the Internet Explorer domain settings. These values determine the form open behavior in these security zones, either blocking or allowing the opening of the form, or giving the user the option to open the form.</span></span>
  
|<span data-ttu-id="a3e76-311">**[名前] 値**</span><span class="sxs-lookup"><span data-stu-id="a3e76-311">**Name value**</span></span>|<span data-ttu-id="a3e76-312">**Block**</span><span class="sxs-lookup"><span data-stu-id="a3e76-312">**Block**</span></span>|<span data-ttu-id="a3e76-313">**User Interface**</span><span class="sxs-lookup"><span data-stu-id="a3e76-313">**User Interface**</span></span>|<span data-ttu-id="a3e76-314">**Allow**</span><span class="sxs-lookup"><span data-stu-id="a3e76-314">**Allow**</span></span>|
|:-----|:-----|:-----|:-----|
|<span data-ttu-id="a3e76-315">**Internet**</span><span class="sxs-lookup"><span data-stu-id="a3e76-315">**Internet**</span></span> <br/> |<span data-ttu-id="a3e76-316">X</span><span class="sxs-lookup"><span data-stu-id="a3e76-316">X</span></span>  <br/> |||
|<span data-ttu-id="a3e76-317">**Intranet**</span><span class="sxs-lookup"><span data-stu-id="a3e76-317">**Intranet**</span></span> <br/> ||<span data-ttu-id="a3e76-318">X</span><span class="sxs-lookup"><span data-stu-id="a3e76-318">X</span></span>  <br/> ||
|<span data-ttu-id="a3e76-319">**Client Computer**</span><span class="sxs-lookup"><span data-stu-id="a3e76-319">**Client Computer**</span></span> <br/> |||<span data-ttu-id="a3e76-320">X</span><span class="sxs-lookup"><span data-stu-id="a3e76-320">X</span></span>  <br/> |
|<span data-ttu-id="a3e76-321">**Trusted Site**</span><span class="sxs-lookup"><span data-stu-id="a3e76-321">**Trusted Site**</span></span> <br/> |||<span data-ttu-id="a3e76-322">X</span><span class="sxs-lookup"><span data-stu-id="a3e76-322">X</span></span>  <br/> |
   
<span data-ttu-id="a3e76-323">レジストリ キーのパスはです `HKEY_CURRENT_USER\Software\Microsoft\Office\14.0\InfoPath\Open Behaviors` 。</span><span class="sxs-lookup"><span data-stu-id="a3e76-323">The registry key path is `HKEY_CURRENT_USER\Software\Microsoft\Office\14.0\InfoPath\Open Behaviors`.</span></span>

<span data-ttu-id="a3e76-324">フォームが開かれるときの動作 (Open Behaviors) は次のように定義されます。</span><span class="sxs-lookup"><span data-stu-id="a3e76-324">The form open behavior is defined as follows:</span></span>
  
- <span data-ttu-id="a3e76-p130">`Block [REG_DWORD = 0]`- [ヘルプ] ボタンの付いたエラー ダイアログ ボックスが表示されます。フォームが該当するセキュリティ ゾーンで実行されていて、テンプレートのドメインと一致しない場合は、XML ファイルを開けません。</span><span class="sxs-lookup"><span data-stu-id="a3e76-p130">`Block [REG_DWORD = 0]`- An error dialog with a Help button will be shown. InfoPath will not allow the XML file to open when the form is running in the specified security zone and does not match the template domain.</span></span> 
    
- <span data-ttu-id="a3e76-p131">`User Interface [REG_DWORD = 1]`- [はい]/[いいえ] 型のダイアログ ボックスが表示されます。フォームが該当するセキュリティ ゾーンで実行されていて、テンプレートのドメインと一致しない場合は、見つかったフォーム テンプレートに照らして XML ファイルを開くかどうかの選択をユーザーに求めます。</span><span class="sxs-lookup"><span data-stu-id="a3e76-p131">`User Interface [REG_DWORD = 1]`- The Yes/No dialog box will be shown. InfoPath will prompt the user to open the XML file against the form template when the form is running in the specified security zone and does not match the template domain.</span></span> 
    
- <span data-ttu-id="a3e76-p132">`Allow [REG_DWORD = 2]`- エラーや警告のダイアログ ボックスが表示されることなく XML ファイルが開きます。 フォームが該当するセキュリティ ゾーンで実行されていて、テンプレートのドメインと一致しない場合でも、XML ファイルを開くことができます。</span><span class="sxs-lookup"><span data-stu-id="a3e76-p132">`Allow [REG_DWORD = 2]`- The XML file will open without an error or warning dialog. InfoPath will allow the XML file to open when the form is running in the specified security zone and does not match the template domain.</span></span> 
    
<span data-ttu-id="a3e76-p133">ドメイン セキュリティ レベルで実行しているフォーム テンプレートに照らしてフォームが開かれた場合に、このテンプレートの「キャッシュ元」の場所 (キャッシュされたフォームの実際の保存場所) のセキュリティ ドメインがフォームの **href** 属性と一致しないときは、前述のレジストリがチェックされ、フォームを開くときの動作が判定されます。許容される動作は、テンプレートが位置するセキュリティ ゾーン (  *CachedFromLocation*  値) に基づいて決まります。</span><span class="sxs-lookup"><span data-stu-id="a3e76-p133">If a form is opened against a form template running at the Domain security level, and the security domain of the template's "cached from" location (that is, where the form is cached from) and the form's **href** attribute do not match, InfoPath will check the registry to define the form open behavior. Allowed behavior will be based on the security zone in which the template is located (the  *CachedFromLocation*  value).</span></span> 
  
<span data-ttu-id="a3e76-333">たとえば、フォームとフォーム ID が一致するフォーム テンプレートが見つかったものの、アクセス パスは一致していない場合、このフォーム テンプレートのキャッシュ元がインターネット上の場所のときは、[ヘルプ] ボタンの付いたエラー ダイアログ ボックスが表示されます。</span><span class="sxs-lookup"><span data-stu-id="a3e76-333">For example, when a form matches a form template based on Form ID but not on Access Path, and the form template is cached from an Internet location, InfoPath will show an error dialog with a Help button.</span></span>
  
> [!NOTE]
> <span data-ttu-id="a3e76-334">[!メモ] InfoPath のフォームは、ドメインが Internet Explorer の制限されたドメインである場合は開きません。このため、Internet Explorer の制限付きサイトに対応するレジストリ キーはありません。</span><span class="sxs-lookup"><span data-stu-id="a3e76-334">InfoPath forms will not open when the domain is an Internet Explorer Restricted domain; therefore, there is no registry key for Internet Explorer Restricted Sites.</span></span> 
  

