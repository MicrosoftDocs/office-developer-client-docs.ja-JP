---
title: フォーム イベントに応答する
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
keywords:
- イベントの順序 [infopath 207],イベント [InfoPath 2007],応答,イベント [InfoPath 2007],順序,InfoPath 2007,イベントに応答する,EventArgs クラス [InfoPath 2007]
localization_priority: Normal
ms.assetid: 754db64b-179f-4385-8dd9-c20c9407b186
description: ユーザーがフォームに入力する際に発生する各種イベントに応答するコードを書くことができます。InfoPath 内でイベントの作業を実行するには、デザイン モードのフォーム テンプレートの作業中にイベント ハンドラーを追加します。
ms.openlocfilehash: 0db3209dfe005f2a87ad65f3fc89b1714ec7d95c
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/28/2019
ms.locfileid: "33407684"
---
# <a name="respond-to-form-events"></a><span data-ttu-id="4e48e-105">フォーム イベントに応答する</span><span class="sxs-lookup"><span data-stu-id="4e48e-105">Respond to Form Events</span></span>

<span data-ttu-id="4e48e-p102">ユーザーがフォームに入力する際に発生する各種イベントに応答するコードを書くことができます。InfoPath 内でイベントの作業を実行するには、デザイン モードのフォーム テンプレートの作業中にイベント ハンドラーを追加します。</span><span class="sxs-lookup"><span data-stu-id="4e48e-p102">You can write code to respond to various events that can occur as a user fills out a form. To work with events in InfoPath, you add event handlers while working with a form template in design mode.</span></span>
  
<span data-ttu-id="4e48e-p103">InfoPath イベント ハンドラーは常にデザイン モードで作成する必要があります。これは、InfoPath ではイベントを **InternalStartup** メソッドにシンクするための正しい宣言が自動的に追加され、イベント ハンドラーのコード スケルトンがフォームのコード ファイル (FormCode.cs または FormCode.vb) に挿入されるためです。イベント ハンドラーを作成した後、フォームのコード ファイルの宣言は変更しないでください。</span><span class="sxs-lookup"><span data-stu-id="4e48e-p103">InfoPath event handlers should always be created in design mode because InfoPath automatically adds the correct declaration for sinking the event to the **InternalStartup** method and inserts the event handler's code skeleton into a form's code file (FormCode.cs or FormCode.vb). After you have created an event handler, you should not alter its declaration in the form's code file.</span></span> 
  
<span data-ttu-id="4e48e-110">InfoPath イベント ハンドラーの作成について詳しくは、「[イベント ハンドラーを追加する方法](how-to-add-an-event-handler.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="4e48e-110">For information about creating the InfoPath event handlers, see [Add an Event Handler](how-to-add-an-event-handler.md).</span></span>
  
## <a name="overview-of-the-event-classes"></a><span data-ttu-id="4e48e-111">イベント クラスの概要</span><span class="sxs-lookup"><span data-stu-id="4e48e-111">Overview of the Event Classes</span></span>

<span data-ttu-id="4e48e-p104">[Microsoft.Office.InfoPath](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.aspx) 名前空間によって提供される InfoPath モデルでは、12 個のイベントを実装する 3 つのクラスを実装します。イベントはフォーム テンプレート ビジネス ロジックにより発生させ、処理することができます。次の表に、各 InfoPath イベント オブジェクト、関連付けられたイベント、およびその機能を示します。</span><span class="sxs-lookup"><span data-stu-id="4e48e-p104">The InfoPath model provided by the [Microsoft.Office.InfoPath](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.aspx) namespace implements three classes that implement the 12 events that can be raised and handled by form template business logic. The following table lists each of the InfoPath event objects, the events they are associated with, and a description of the functionality they provide.</span></span> 
  
|<span data-ttu-id="4e48e-114">**名前**</span><span class="sxs-lookup"><span data-stu-id="4e48e-114">**Name**</span></span>|<span data-ttu-id="4e48e-115">**イベント**</span><span class="sxs-lookup"><span data-stu-id="4e48e-115">**Events**</span></span>|<span data-ttu-id="4e48e-116">**説明**</span><span class="sxs-lookup"><span data-stu-id="4e48e-116">**Description**</span></span>|
|:-----|:-----|:-----|
|[<span data-ttu-id="4e48e-117">ButtonEvent</span><span class="sxs-lookup"><span data-stu-id="4e48e-117">ButtonEvent</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.ButtonEvent.aspx) <br/> |[<span data-ttu-id="4e48e-118">Clicked</span><span class="sxs-lookup"><span data-stu-id="4e48e-118">Clicked</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.ButtonEvent.Clicked.aspx) <br/> |<span data-ttu-id="4e48e-119">**ButtonEvent** クラスは、フォーム上の [ **ボタン**] コントロールがクリックされると発生する **Clicked** イベントを実装します。</span><span class="sxs-lookup"><span data-stu-id="4e48e-119">The **ButtonEvent** class implements the **Clicked** event that is raised when a **Button** control is clicked on a form.</span></span>  <br/> |
|[<span data-ttu-id="4e48e-120">FormEvents</span><span class="sxs-lookup"><span data-stu-id="4e48e-120">FormEvents</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormEvents.aspx) <br/> |[<span data-ttu-id="4e48e-121">ContextChanged</span><span class="sxs-lookup"><span data-stu-id="4e48e-121">ContextChanged</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormEvents.ContextChanged.aspx) <br/> [<span data-ttu-id="4e48e-122">Loading</span><span class="sxs-lookup"><span data-stu-id="4e48e-122">Loading</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormEvents.Loading.aspx) <br/> [<span data-ttu-id="4e48e-123">Merge</span><span class="sxs-lookup"><span data-stu-id="4e48e-123">Merge</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormEvents.Merge.aspx) <br/> [<span data-ttu-id="4e48e-124">Save</span><span class="sxs-lookup"><span data-stu-id="4e48e-124">Save</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormEvents.Save.aspx) <br/> [<span data-ttu-id="4e48e-125">Sign</span><span class="sxs-lookup"><span data-stu-id="4e48e-125">Sign</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormEvents.Sign.aspx) <br/> [<span data-ttu-id="4e48e-126">Submit</span><span class="sxs-lookup"><span data-stu-id="4e48e-126">Submit</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormEvents.Submit.aspx) <br/> [<span data-ttu-id="4e48e-127">VersionUpgrade</span><span class="sxs-lookup"><span data-stu-id="4e48e-127">VersionUpgrade</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormEvents.VersionUpgrade.aspx) <br/> [<span data-ttu-id="4e48e-128">ViewSwitched</span><span class="sxs-lookup"><span data-stu-id="4e48e-128">ViewSwitched</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormEvents.ViewSwitched.aspx) <br/> |<span data-ttu-id="4e48e-129">**FormEvents** クラスは、InfoPath フォーム テンプレート自体に固有のイベントを実装します。</span><span class="sxs-lookup"><span data-stu-id="4e48e-129">The **FormEvents** class implements the events that are specific to an InfoPath form template itself:</span></span>  <br/> <span data-ttu-id="4e48e-130">**ContextChanged**</span><span class="sxs-lookup"><span data-stu-id="4e48e-130">**ContextChanged**</span></span> <br/> <span data-ttu-id="4e48e-131">コンテキスト ノードが変更されると発生します。</span><span class="sxs-lookup"><span data-stu-id="4e48e-131">Occurs after the context node changes.</span></span>  <br/> <span data-ttu-id="4e48e-132">**Loading**</span><span class="sxs-lookup"><span data-stu-id="4e48e-132">**Loading**</span></span> <br/> <span data-ttu-id="4e48e-133">フォーム テンプレートが読み込まれた後、ビューが初期化される前に発生します。</span><span class="sxs-lookup"><span data-stu-id="4e48e-133">Occurs when the form template has been loaded, but before any views have been initialized.</span></span>  <br/> <span data-ttu-id="4e48e-134">**Merge**</span><span class="sxs-lookup"><span data-stu-id="4e48e-134">**Merge**</span></span> <br/> <span data-ttu-id="4e48e-135">[ **フォームの結合**] コマンドがユーザー インターフェイスから起動される、または  `/aggregate` コマンド ライン スイッチを指定して InfoPath が開始されると発生します。</span><span class="sxs-lookup"><span data-stu-id="4e48e-135">Occurs when the **Merge Forms** command is invoked from the user interface, or InfoPath is started with the  `/aggregate` command-line switch.</span></span>  <br/> <span data-ttu-id="4e48e-136">**Save**</span><span class="sxs-lookup"><span data-stu-id="4e48e-136">**Save**</span></span> <br/> <span data-ttu-id="4e48e-137">ユーザー インターフェイスから [ **保存**] または [ **名前を付けて保存**] コマンドが使用される、または [XmlForm](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.Save.aspx) クラスの [Save](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.SaveAs.aspx) メソッドおよび [SaveAs](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.aspx) メソッドが使用されると発生します。</span><span class="sxs-lookup"><span data-stu-id="4e48e-137">Occurs when the **Save** or **Save As** commands are used from the user interface, or when the [Save](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.Save.aspx) and [SaveAs](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.SaveAs.aspx) methods of the [XmlForm](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.aspx) class are used.</span></span>  <br/> <span data-ttu-id="4e48e-138">**Sign**</span><span class="sxs-lookup"><span data-stu-id="4e48e-138">**Sign**</span></span> <br/> <span data-ttu-id="4e48e-139">[ **デジタル署名**] ダイアログ ボックスで署名することになる署名データが選択されると発生します。</span><span class="sxs-lookup"><span data-stu-id="4e48e-139">Occurs after a set of signed data has been selected to sign through the **Digital Signatures** dialog box.</span></span>  <br/> <span data-ttu-id="4e48e-140">**Submit**</span><span class="sxs-lookup"><span data-stu-id="4e48e-140">**Submit**</span></span> <br/> <span data-ttu-id="4e48e-141">ユーザー インターフェイスから [ **送信**] コマンドが使用される、または [XmlForm](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.Submit.aspx) クラスの **Submit** メソッドが使用されると発生します。</span><span class="sxs-lookup"><span data-stu-id="4e48e-141">Occurs when the **Submit** command is used from the user interface, or the [Submit](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.Submit.aspx) method of the **XmlForm** class is used.</span></span>  <br/> <span data-ttu-id="4e48e-142">**VersionUpgrade**</span><span class="sxs-lookup"><span data-stu-id="4e48e-142">**VersionUpgrade**</span></span> <br/> <span data-ttu-id="4e48e-143">開かれているフォームのバージョン番号が、基になっているフォーム テンプレートのバージョン番号よりも古いと発生します。</span><span class="sxs-lookup"><span data-stu-id="4e48e-143">Occurs when the version number of the form being opened is older than the version number of the form template on which it is based.</span></span>  <br/> <span data-ttu-id="4e48e-144">**ViewSwitched**</span><span class="sxs-lookup"><span data-stu-id="4e48e-144">**ViewSwitched**</span></span> <br/> <span data-ttu-id="4e48e-145">フォームのビューの切り替えが成功した後で発生します。</span><span class="sxs-lookup"><span data-stu-id="4e48e-145">Occurs after a view of a form has been successfully switched.</span></span>  <br/> |
|[<span data-ttu-id="4e48e-146">XmlEvent</span><span class="sxs-lookup"><span data-stu-id="4e48e-146">XmlEvent</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlEvent.aspx) <br/> |[<span data-ttu-id="4e48e-147">Changed</span><span class="sxs-lookup"><span data-stu-id="4e48e-147">Changed</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlEvent.Changed.aspx) <br/> [<span data-ttu-id="4e48e-148">Changing</span><span class="sxs-lookup"><span data-stu-id="4e48e-148">Changing</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlEvent.Changing.aspx) <br/> [<span data-ttu-id="4e48e-149">Validating</span><span class="sxs-lookup"><span data-stu-id="4e48e-149">Validating</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlEvent.Validating.aspx) <br/> |<span data-ttu-id="4e48e-150">フォーム インスタンスの基になっている XML ドキュメントのデータに対する変更によって発生するイベントを実装します。</span><span class="sxs-lookup"><span data-stu-id="4e48e-150">Implements the events raised by changes to the data in the underlying XML document of a form instance:</span></span>  <br/> <span data-ttu-id="4e48e-151">**Changed**</span><span class="sxs-lookup"><span data-stu-id="4e48e-151">**Changed**</span></span> <br/> <span data-ttu-id="4e48e-152">フォームの基になっている XML ドキュメントの変更が受け付けられ、 **Validating** イベントが発生した後、発生します。</span><span class="sxs-lookup"><span data-stu-id="4e48e-152">Occurs after changes to a form's underlying XML document have been accepted and after the **Validating** event has occurred.</span></span>  <br/> <span data-ttu-id="4e48e-153">**Changing**</span><span class="sxs-lookup"><span data-stu-id="4e48e-153">**Changing**</span></span> <br/> <span data-ttu-id="4e48e-154">フォームの基になっている XML ドキュメントに対する変更が行われた後で、変更が受け付けられる前に発生します。</span><span class="sxs-lookup"><span data-stu-id="4e48e-154">Occurs after changes to a form's underlying XML document have been made but before the changes have been accepted.</span></span>  <br/> <span data-ttu-id="4e48e-155">**Validating**</span><span class="sxs-lookup"><span data-stu-id="4e48e-155">**Validating**</span></span> <br/> <span data-ttu-id="4e48e-156">フォームの基になっている XML ドキュメントの変更が受け付けられた後、 **Changed** イベントが発生する前に発生します。</span><span class="sxs-lookup"><span data-stu-id="4e48e-156">Occurs after changes to a form's underlying XML document have been accepted but before the **Changed** event has occurred.</span></span>  <br/> <span data-ttu-id="4e48e-157">**XmlEvent** クラスは、 [RaiseUndoRedoForChanged](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlEvent.RaiseUndoRedoForChanged.aspx) プロパティも実装します。このプロパティは、元に戻す操作またはやり直し操作が実行されたときに **Changed** イベントが発生するかどうかを取得または設定します。  </span><span class="sxs-lookup"><span data-stu-id="4e48e-157">The **XmlEvent** class also implements the [RaiseUndoRedoForChanged](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlEvent.RaiseUndoRedoForChanged.aspx) property, which gets or sets whether the **Changed** event will be raised when an undo or redo operation occurs.</span></span>  <br/> |
   
> [!NOTE]
>  <span data-ttu-id="4e48e-158">**Changed** イベントと **Changing** イベントは、フォームの空白ではないフィールドが変更されたときに 1 回だけ発生します。一方、 [Microsoft.Office.Interop.InfoPath.SemiTrust](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.aspx) 名前空間によって提供される InfoPath 2003 と InfoPath 2003 互換のオブジェクト モデルの類似したイベント ( [OnBeforeChange](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust._DataDOMEventSink_Event.OnBeforeChange.aspx) と [OnAfterChange](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust._DataDOMEventSink_Event.OnAfterChange.aspx) ) は、フォームの空白ではないフィールドの変更時に 2 回発生します。つまり、古い値が削除されたときに 1 回、新しい値が挿入されたときにもう 1 回発生します。</span><span class="sxs-lookup"><span data-stu-id="4e48e-158">The **Changed** and **Changing** events fire only once when a change is made in a non-blank field in the form, whereas the comparable events in InfoPath 2003 and the InfoPath 2003-compatible object model provided by the [Microsoft.Office.Interop.InfoPath.SemiTrust](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.aspx) namespace ( [OnBeforeChange](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust._DataDOMEventSink_Event.OnBeforeChange.aspx) and [OnAfterChange](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust._DataDOMEventSink_Event.OnAfterChange.aspx) ) fire twice on changes to a non-blank field: once when the old value is deleted, and again when the new value is inserted.</span></span> 
  
## <a name="overview-of-the-eventargs-classes"></a><span data-ttu-id="4e48e-159">EventArgs クラスの概要</span><span class="sxs-lookup"><span data-stu-id="4e48e-159">Overview of the EventArgs Classes</span></span>

<span data-ttu-id="4e48e-p105">12 個の各イベントには、イベント ハンドラーに渡される **EventArgs** オブジェクトが関連付けられています。このオブジェクトにより、イベント ハンドラー コードで使用できるイベントの状態情報およびその他の機能が提供されます。次の表に、InfoPath イベント、関連付けられた **EventArgs** オブジェクト、およびオブジェクトのプロパティとメソッドで提供される機能の簡単な説明を示します。オブジェクトの特定のプロパティとメソッドの詳細については、表の **EventArgs** オブジェクトの名前をクリックし、トピックの [メンバー] リンクをクリックしてください。</span><span class="sxs-lookup"><span data-stu-id="4e48e-p105">Each of the 12 events have an **EventArgs** object associated with the event that are passed to the event handler for the event to provide state information and other functionality that can be used in the event handler code. The following table lists the InfoPath events with their associated **EventArgs** objects and a brief description of the functionality provided by the properties and methods of the object. For details on the specific properties and methods of the object, click the name of the **EventArgs** object in the table, and then click on the Members link in the topic.</span></span> 
  
|<span data-ttu-id="4e48e-163">**イベント**</span><span class="sxs-lookup"><span data-stu-id="4e48e-163">**Event**</span></span>|<span data-ttu-id="4e48e-164">**EventsArgs クラス**</span><span class="sxs-lookup"><span data-stu-id="4e48e-164">**EventsArgs Class**</span></span>|<span data-ttu-id="4e48e-165">**説明**</span><span class="sxs-lookup"><span data-stu-id="4e48e-165">**Description**</span></span>|
|:-----|:-----|:-----|
|<span data-ttu-id="4e48e-166">**Clicked**</span><span class="sxs-lookup"><span data-stu-id="4e48e-166">**Clicked**</span></span> <br/> |[<span data-ttu-id="4e48e-167">ClickedEventArgs</span><span class="sxs-lookup"><span data-stu-id="4e48e-167">ClickedEventArgs</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.ClickedEventArgs.aspx) <br/> |<span data-ttu-id="4e48e-168">コントロール ID を取得します。</span><span class="sxs-lookup"><span data-stu-id="4e48e-168">Gets the control ID.</span></span>  <br/> <span data-ttu-id="4e48e-169">[ **ボタン**] コントロールを含む、フォームの基になる XML ドキュメントで、最も内側の XML ノードに置かれている **XPathNavigator** オブジェクトを取得します。</span><span class="sxs-lookup"><span data-stu-id="4e48e-169">Get an **XPathNavigator** object positioned at the innermost XML node of the form's underlying XML document that contains the **Button** control.</span></span>  <br/> |
|<span data-ttu-id="4e48e-170">**ContextChanged**</span><span class="sxs-lookup"><span data-stu-id="4e48e-170">**ContextChanged**</span></span> <br/> |[<span data-ttu-id="4e48e-171">ContextChangedEventArgs</span><span class="sxs-lookup"><span data-stu-id="4e48e-171">ContextChangedEventArgs</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.ContextChangedEventArgs.aspx) <br/> |<span data-ttu-id="4e48e-172">イベントが発生したときに実行されたコンテキスト変更の種類を取得します。</span><span class="sxs-lookup"><span data-stu-id="4e48e-172">Gets the type of context change that was performed when the event occurred.</span></span>  <br/> <span data-ttu-id="4e48e-173">操作を元に戻したかやり直したことによって、コンテキスト変更が発生したかどうかを示す値を取得します。</span><span class="sxs-lookup"><span data-stu-id="4e48e-173">Gets a value indicating whether the context change event occurred in response to undoing or redoing an operation.</span></span>  <br/> <span data-ttu-id="4e48e-174">イベントが発生したコンテキスト ノードに置かれていた **XPathNavigator** への参照を取得します。</span><span class="sxs-lookup"><span data-stu-id="4e48e-174">Gets a reference to an **XPathNavigator** positioned at the context node that raised the event.</span></span>  <br/> |
|<span data-ttu-id="4e48e-175">**Loading**</span><span class="sxs-lookup"><span data-stu-id="4e48e-175">**Loading**</span></span> <br/> |[<span data-ttu-id="4e48e-176">LoadingEventArgs</span><span class="sxs-lookup"><span data-stu-id="4e48e-176">LoadingEventArgs</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.LoadingEventArgs.aspx) <br/> |<span data-ttu-id="4e48e-177">読み込み後にフォームを開くビューを指定します。</span><span class="sxs-lookup"><span data-stu-id="4e48e-177">Specifies the view in which to open the form after loading.</span></span>  <br/> <span data-ttu-id="4e48e-178">**XmlFormCancelEventArgs** オブジェクトへの参照を取得します。</span><span class="sxs-lookup"><span data-stu-id="4e48e-178">Gets a reference to the **XmlFormCancelEventArgs** object.</span></span>  <br/> <span data-ttu-id="4e48e-179">\*\*\*\* コマンド ライン オプションを使用して、またはフォームを開く URL のクエリ パラメーターを使用して指定された入力パラメーターを含む `/InputParameters` を取得します。</span><span class="sxs-lookup"><span data-stu-id="4e48e-179">Gets an **IDictionary** containing any input parameters specified using the  `/InputParameters` command-line option, or specified using query parameters in a URL to open the form.</span></span>  <br/> |
|<span data-ttu-id="4e48e-180">**Merge**</span><span class="sxs-lookup"><span data-stu-id="4e48e-180">**Merge**</span></span> <br/> |[<span data-ttu-id="4e48e-181">MergeEventArgs</span><span class="sxs-lookup"><span data-stu-id="4e48e-181">MergeEventArgs</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.MergeEventArgs.aspx) <br/> |<span data-ttu-id="4e48e-182">**XmlFormCancelEventArgs** オブジェクトへの参照を取得します。</span><span class="sxs-lookup"><span data-stu-id="4e48e-182">Gets a reference to the **XmlFormCancelEventArgs** object.</span></span>  <br/> <span data-ttu-id="4e48e-183">結合操作で結合されるフォームの数を取得します。</span><span class="sxs-lookup"><span data-stu-id="4e48e-183">Gets the count of the number of forms being merged in a merging operation.</span></span>  <br/> <span data-ttu-id="4e48e-184">現在結合されているフォームの、ゼロベースのインデックスを取得します。</span><span class="sxs-lookup"><span data-stu-id="4e48e-184">Gets the zero-based index of the form that is currently being merged.</span></span>  <br/> <span data-ttu-id="4e48e-185">現在のフォームのみを取り消すのか、または結合操作全体を取り消すのかを判別するために、 **Cancel** プロパティと共に使用する値を取得または設定します。</span><span class="sxs-lookup"><span data-stu-id="4e48e-185">Gets or sets a value that is used with the **Cancel** property to determine whether to cancel only the current form or the entire merging operation.</span></span>  <br/> <span data-ttu-id="4e48e-186">現在結合されているフォームの基になっている XML ドキュメントのルート ノードに配置されている **XPathNavigator** オブジェクトを取得します。</span><span class="sxs-lookup"><span data-stu-id="4e48e-186">Gets an **XPathNavigator** object positioned at the root node of the underlying XML document of the form that is currently being merged.</span></span>  <br/> |
|<span data-ttu-id="4e48e-187">**Save**</span><span class="sxs-lookup"><span data-stu-id="4e48e-187">**Save**</span></span> <br/> |[<span data-ttu-id="4e48e-188">SaveEventArgs</span><span class="sxs-lookup"><span data-stu-id="4e48e-188">SaveEventArgs</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SaveEventArgs.aspx) <br/> |<span data-ttu-id="4e48e-189">ユーザーによって要求された保存操作を実行します。</span><span class="sxs-lookup"><span data-stu-id="4e48e-189">Performs the save operation requested by the user.</span></span>  <br/> <span data-ttu-id="4e48e-190">イベントの取り消しに使用できる **SaveCancelEventArgs** オブジェクトへの参照を取得します。</span><span class="sxs-lookup"><span data-stu-id="4e48e-190">Gets a reference to the **SaveCancelEventArgs** object that can be used to cancel the event.</span></span>  <br/> <span data-ttu-id="4e48e-191">イベントに対するイベント ハンドラーで使用するファイル名を取得します。</span><span class="sxs-lookup"><span data-stu-id="4e48e-191">Gets the file name to be used in the event handler for the event.</span></span>  <br/> <span data-ttu-id="4e48e-192">保存操作が "保存" 操作として実行されるか "名前を付けて保存" として実行されるかを取得します。</span><span class="sxs-lookup"><span data-stu-id="4e48e-192">Gets whether the save operation will be performed as a "save" operation or as a "save as" operation.</span></span>  <br/> |
|<span data-ttu-id="4e48e-193">**Sign**</span><span class="sxs-lookup"><span data-stu-id="4e48e-193">**Sign**</span></span> <br/> |[<span data-ttu-id="4e48e-194">SignEventArgs</span><span class="sxs-lookup"><span data-stu-id="4e48e-194">SignEventArgs</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SignEventArgs.aspx) <br/> |<span data-ttu-id="4e48e-195">[ **デジタル署名**] ダイアログ ボックスを表示するかどうかを取得または設定します。</span><span class="sxs-lookup"><span data-stu-id="4e48e-195">Gets or sets whether to display the **Digital Signatures** dialog box.</span></span>  <br/> <span data-ttu-id="4e48e-196">イベントを発生させた署名可能なデータのセットを取得します。</span><span class="sxs-lookup"><span data-stu-id="4e48e-196">Gets the set of signable data that raised the event.</span></span>  <br/> |
|<span data-ttu-id="4e48e-197">**Submit**</span><span class="sxs-lookup"><span data-stu-id="4e48e-197">**Submit**</span></span> <br/> |[<span data-ttu-id="4e48e-198">SubmitEventArgs</span><span class="sxs-lookup"><span data-stu-id="4e48e-198">SubmitEventArgs</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SubmitEventArgs.aspx) <br/> |<span data-ttu-id="4e48e-199">イベントを取り消す **XmlFormCancelEventArgs** オブジェクトへの参照を取得します。</span><span class="sxs-lookup"><span data-stu-id="4e48e-199">Gets a reference to the **XmlFormCancelEventArgs** object for cancelling the event.</span></span>  <br/> |
|<span data-ttu-id="4e48e-200">**VersionUpgrade**</span><span class="sxs-lookup"><span data-stu-id="4e48e-200">**VersionUpgrade**</span></span> <br/> |[<span data-ttu-id="4e48e-201">VersionUpgradeEventArgs</span><span class="sxs-lookup"><span data-stu-id="4e48e-201">VersionUpgradeEventArgs</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.VersionUpgradeEventArgs.aspx) <br/> |<span data-ttu-id="4e48e-202">イベントを取り消す **XmlFormCancelEventArgs** オブジェクトへの参照を取得します。</span><span class="sxs-lookup"><span data-stu-id="4e48e-202">Gets a reference to the **XmlFormCancelEventArgs** object for cancelling the event.</span></span>  <br/> <span data-ttu-id="4e48e-203">アップグレード中のフォーム ドキュメントのバージョン番号を取得します。</span><span class="sxs-lookup"><span data-stu-id="4e48e-203">Gets the version number of the form document being upgraded.</span></span>  <br/> <span data-ttu-id="4e48e-204">アップグレード中のフォームに関連付けられたフォーム テンプレートのバージョン番号を取得します。</span><span class="sxs-lookup"><span data-stu-id="4e48e-204">Gets the version number of the form template associated with the form being upgraded.</span></span>  <br/> |
|<span data-ttu-id="4e48e-205">**ViewSwitched**</span><span class="sxs-lookup"><span data-stu-id="4e48e-205">**ViewSwitched**</span></span> <br/> |[<span data-ttu-id="4e48e-206">ViewSwitchedEventArgs</span><span class="sxs-lookup"><span data-stu-id="4e48e-206">ViewSwitchedEventArgs</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.ViewSwitchedEventArgs.aspx) <br/> |<span data-ttu-id="4e48e-207">**ViewSwitchedEventArgs** クラスには、イベントに対して **System.Object** から継承される以外のプロパティとメソッドはありません。</span><span class="sxs-lookup"><span data-stu-id="4e48e-207">The **ViewSwitchedEventArgs** class does not provide any properties and methods for the event other than those inherited from **System.Object**.</span></span>  <br/> |
|<span data-ttu-id="4e48e-208">**Changed**</span><span class="sxs-lookup"><span data-stu-id="4e48e-208">**Changed**</span></span> <br/> |[<span data-ttu-id="4e48e-209">XmlEventArgs</span><span class="sxs-lookup"><span data-stu-id="4e48e-209">XmlEventArgs</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlEventArgs.aspx) <br/> |<span data-ttu-id="4e48e-210">現在変更中のノードを返す XPath 式を含む **XPathExpression** オブジェクトを取得します。</span><span class="sxs-lookup"><span data-stu-id="4e48e-210">Gets an **XPathExpression** object which contains an XPath expression that returns the node that is currently being changed.</span></span>  <br/> <span data-ttu-id="4e48e-211">変更中のノードの新しい値を取得します。</span><span class="sxs-lookup"><span data-stu-id="4e48e-211">Gets the new value for the node being changed.</span></span>  <br/> <span data-ttu-id="4e48e-212">削除中のノードの親であるノードを示す **XPathNavigator** オブジェクトを取得します。</span><span class="sxs-lookup"><span data-stu-id="4e48e-212">Gets an **XPathNavigator** object pointing to the node which is the parent of the node being deleted.</span></span>  <br/> <span data-ttu-id="4e48e-213">変更中のノードの元の値を取得します。</span><span class="sxs-lookup"><span data-stu-id="4e48e-213">Gets the original value of the node that is being changed.</span></span>  <br/> <span data-ttu-id="4e48e-214">ノードが変更されたときに発生した操作の種類を示す [XmlOperation](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlOperation.aspx) 列挙を取得します。</span><span class="sxs-lookup"><span data-stu-id="4e48e-214">Gets an [XmlOperation](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlOperation.aspx) enumeration that indicates the type of operation that occurred when the node was changed.</span></span>  <br/> <span data-ttu-id="4e48e-215">変更中のノードを示す **XPathNavigator** オブジェクトを取得します。</span><span class="sxs-lookup"><span data-stu-id="4e48e-215">Gets an **XPathNavigator** object pointing at the node that is being changed.</span></span>  <br/> <span data-ttu-id="4e48e-216">変更中のノードが、元に戻すまたはやり直す操作の一部であるかどうかを示す値を取得します。</span><span class="sxs-lookup"><span data-stu-id="4e48e-216">Gets a value that indicates whether the node being changed is part of an undo or redo operation.</span></span>  <br/> |
|<span data-ttu-id="4e48e-217">**Changing**</span><span class="sxs-lookup"><span data-stu-id="4e48e-217">**Changing**</span></span> <br/> |[<span data-ttu-id="4e48e-218">XmlChangingEventArgs</span><span class="sxs-lookup"><span data-stu-id="4e48e-218">XmlChangingEventArgs</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlChangingEventArgs.aspx) <br/> |<span data-ttu-id="4e48e-219">イベントに関連付けられた **XmlFormCancelEventArgs** オブジェクトを取得します。</span><span class="sxs-lookup"><span data-stu-id="4e48e-219">Gets an **XmlFormCancelEventArgs** object associated with the event.</span></span>  <br/> <span data-ttu-id="4e48e-220">上記の **XmlEventArgs** オブジェクトの機能をすべて継承します。</span><span class="sxs-lookup"><span data-stu-id="4e48e-220">Inherits all of the functionality listed above for the **XmlEventArgs** object.</span></span>  <br/> |
|<span data-ttu-id="4e48e-221">**Validating**</span><span class="sxs-lookup"><span data-stu-id="4e48e-221">**Validating**</span></span> <br/> |[<span data-ttu-id="4e48e-222">XmlValidatingEventArgs</span><span class="sxs-lookup"><span data-stu-id="4e48e-222">XmlValidatingEventArgs</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlValidatingEventArgs.aspx) <br/> |<span data-ttu-id="4e48e-223">指定した値を持つカスタム エラー情報の入った [FormError](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormError.aspx) オブジェクトを作成し、それをフォームの [FormErrorCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormErrorCollection.aspx) オブジェクトに追加します。</span><span class="sxs-lookup"><span data-stu-id="4e48e-223">Creates a [FormError](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormError.aspx) object that contains custom error information with the specified values and adds it to the [FormErrorCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormErrorCollection.aspx) object of the form.</span></span>  <br/> <span data-ttu-id="4e48e-224">上記の **XmlEventArgs** オブジェクトの機能をすべて継承します。</span><span class="sxs-lookup"><span data-stu-id="4e48e-224">Inherits all of the functionality listed above for the **XmlEventArgs** object.</span></span>  <br/> |
   
## <a name="using-the-eventargs-objects"></a><span data-ttu-id="4e48e-225">EventArgs オブジェクトを使用する</span><span class="sxs-lookup"><span data-stu-id="4e48e-225">Using the EventArgs Objects</span></span>

<span data-ttu-id="4e48e-p106">イベント ハンドラーを作成する際、InfoPath は、プロジェクトのフォーム コード ファイル内でイベント ハンドラーの宣言を作成します。イベント ハンドラーの宣言内で、InfoPath は、イベント ハンドラーに渡されるパラメーターの名前として **e** を使用します。このパラメーターには、イベント発生時に状態情報とその他の機能を提供するイベント ハンドラーに関連付けられる **EventArgs** オブジェクトが含まれます。</span><span class="sxs-lookup"><span data-stu-id="4e48e-p106">When you create an event handler, InfoPath creates the event handler's declaration in the project's form code. In the declaration of the event handler, InfoPath uses **e** as the name of the parameter that is passed to the event handler. This parameter contains the **EventArgs** object that is associated with the event handler for providing state information and other functionality when the event occurs.</span></span> 
  
<span data-ttu-id="4e48e-229">たとえば、[ **開発**] タブの [ **Loading イベント**] をクリックすることで、デザイン モードで **Loading** イベントのイベント ハンドラーを作成する際、InfoPath は、 [LoadingEventArgs](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.LoadingEventArgs.aspx) オブジェクトを受け取るイベント ハンドラーの宣言をフォーム コード ファイルに追加し、次のイベント ハンドラー宣言にコードを追加するためのコード エディターを開きます。</span><span class="sxs-lookup"><span data-stu-id="4e48e-229">For example, when you create an event handler for the **Loading** event in design mode (by clicking **Loading Event** menu on the **Developer** tab), InfoPath adds the declaration for the event handler that receives the [LoadingEventArgs](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.LoadingEventArgs.aspx) object to the form code file, and then opens the code editor so that you can add your code to the following event handler declaration.</span></span> 
  
```cs
public void FormEvents_Loading(object sender, LoadingEventArgs e)
{
   // Write your code here.
}
```

```vb
Public Sub FormEvents_Loading(ByVal sender As Object, _
   ByVal e As LoadingEventArgs)
   ' Write your code here.
End Sub
```

<span data-ttu-id="4e48e-p107">イベント ハンドラーのコードを書く際、 **e** パラメーターを通じて渡される **EventArgs** イベント オブジェクトによって実装されるプロパティとメソッドを使用できます。 たとえば、次の **Changing** イベント ハンドラーでは、 [XmlChangingEventArgs](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlEventArgs.NewValue.aspx) オブジェクトの [NewValue](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlChangingEventArgs.aspx) プロパティ ( [XmlEventArgs](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlEventArgs.aspx) クラスから継承) を使用して、変更されたフィールドの値が確認されます。ユーザーがフィールドを変更し、空白にした場合、 [XmlChangingEventArgs](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlFormCancelEventArgs.Message.aspx) オブジェクトの [CancelableArgs](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlFormCancelEventArgs.aspx) プロパティを使用して、 [XmlFormCancelEventArgs](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlChangingEventArgs.CancelableArgs.aspx) クラスの **Message** プロパティにアクセスし、ユーザーにエラーを表示し、 **XmlFormCancelEventArgs.Cancel** プロパティを **true** に設定してイベントを取り消し、ユーザーが行った変更内容をロールバックします。</span><span class="sxs-lookup"><span data-stu-id="4e48e-p107">When writing code for an event handler, you can use the properties and methods implemented by the **EventArgs** object that is passed through the **e** parameter. For example, in the following **Changing** event handler, the [NewValue](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlEventArgs.NewValue.aspx) property of the [XmlChangingEventArgs](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlChangingEventArgs.aspx) object (which is inherited from the [XmlEventArgs](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlEventArgs.aspx) class) is used to check the value of the field that was just changed. If the user changed the field and left it blank, the [Message](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlFormCancelEventArgs.Message.aspx) property of the [XmlFormCancelEventArgs](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlFormCancelEventArgs.aspx) class is accessed using the [CancelableArgs](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlChangingEventArgs.CancelableArgs.aspx) property of the **XmlChangingEventArgs** object to display an error to the user, and the **XmlFormCancelEventArgs.Cancel** property is set to **true**, to cancel the event and roll back the changes the user made.</span></span>
  
```cs
public void field1_Changing(object sender, LoadingEventArgs e)
{
   // Determine whether there is a new value.
   if (e.NewValue == "")
   {
      // The value is blank, so display an error message
      // and roll back the changes.
      e.CancelableArgs.Message = 
         "You must supply a value for this field.";
      e.CancelableArgs.Cancel = true;
      return;
   }
}
```

```vb
Public Sub field1_Changing(ByVal sender As Object, _
   ByVal e As LoadingEventArgs)
   ' Determine whether there is a new value.
   If (e.NewValue = "") Then
      ' The value is blank, so display an error message 
      ' and roll back the changes.
      e.CancelableArgs.Message = _
         "You must supply a value for this field."
      e.CancelableArgs.Cancel = True
      Return
   End If
End Sub
```


