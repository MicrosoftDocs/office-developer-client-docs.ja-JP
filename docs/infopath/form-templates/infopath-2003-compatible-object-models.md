---
title: InfoPath 2003 互換オブジェクト モデル
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
keywords:
- infopath 2003-compatible form templates, object model,InfoPath 2003-compatible object model,object models [InfoPath 2003], compatible with InfoPath 2007,object models [InfoPath 2007], InfoPath 2003 compatible
localization_priority: Normal
ms.assetid: e4511af6-d7e7-44ad-a50d-1b7ee04f8215
description: Microsoft InfoPath は COM (コンポーネント オブジェクト モデル) アプリケーションとして作成されており、外部オートメーションとフォーム テンプレート スクリプトの両方のプログラミング インターフェイスを COM インターフェイスとして公開します。
ms.openlocfilehash: f3351a0fee6e23de0785aa28b0970c6a90361f16
ms.sourcegitcommit: ef717c65d8dd41ababffb01eafc443c79950aed4
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 10/04/2018
ms.locfileid: "25389030"
---
# <a name="infopath-2003-compatible-object-models"></a><span data-ttu-id="e874d-104">InfoPath 2003 互換オブジェクト モデル</span><span class="sxs-lookup"><span data-stu-id="e874d-104">InfoPath 2003 compatible object models</span></span>

<span data-ttu-id="e874d-p101">Microsoft InfoPath は COM (コンポーネント オブジェクト モデル) アプリケーションとして作成されており、外部オートメーションとフォーム テンプレート スクリプトの両方のプログラミング インターフェイスを COM インターフェイスとして公開します。マネージ コード言語 (Visual C# および Visual Basic) を使用する InfoPath ソリューションの作成をサポートするために、InfoPath セットアップ プログラムによって 3 つの相互運用アセンブリがインストールされます。相互運用アセンブリとは、マネージ コードとアンマネージ コードの仲介役として機能する .NET アセンブリで、COM オブジェクトのメンバーを、対応する .NET マネージ メンバーにマップします。</span><span class="sxs-lookup"><span data-stu-id="e874d-p101">Microsoft InfoPath is written as a Component Object Model (COM) application and exposes its programmability interfaces for both external automation and form template script as COM interfaces. To support the creation of InfoPath solutions that use the Visual C# and Visual Basic managed-code languages, the InfoPath setup program installs three interop assemblies. Interop assemblies are .NET assemblies that act as a bridge between managed and unmanaged code, mapping COM object members to equivalent .NET managed members.</span></span> 
  
<span data-ttu-id="e874d-108">InfoPath によってインストールされる 3 つの相互運用アセンブリのファイルを以下に示します。</span><span class="sxs-lookup"><span data-stu-id="e874d-108">The files for the three interop assemblies installed by InfoPath are named:</span></span>
  
- <span data-ttu-id="e874d-109">Microsoft.Office.Interop.InfoPath.dll</span><span class="sxs-lookup"><span data-stu-id="e874d-109">Microsoft.Office.Interop.InfoPath.dll</span></span>
    
- <span data-ttu-id="e874d-110">Microsoft.Office.Interop.InfoPath.SemiTrust.dll</span><span class="sxs-lookup"><span data-stu-id="e874d-110">Microsoft.Office.Interop.InfoPath.SemiTrust.dll</span></span>
    
- <span data-ttu-id="e874d-111">Microsoft.Office.Interop.InfoPath.Xml.dll</span><span class="sxs-lookup"><span data-stu-id="e874d-111">Microsoft.Office.Interop.InfoPath.Xml.dll</span></span>
    
<span data-ttu-id="e874d-112">ここでは、Microsoft.Office.Interop.InfoPath.SemiTrust 相互運用アセンブリによって公開されるオブジェクト モデルについて説明します。このアセンブリは、InfoPath フォーム テンプレート (.xsn) 内からマネージ コード ビジネス ロジックを書いたり実行したりするためだけに使用されます。</span><span class="sxs-lookup"><span data-stu-id="e874d-112">This topic discusses the object model exposed through the Microsoft.Office.Interop.InfoPath.SemiTrust interop assembly, which is used exclusively for writing and running managed-code business logic from within InfoPath form templates (.xsn).</span></span> 
  
<span data-ttu-id="e874d-113">Microsoft.Office.Interop.InfoPath アセンブリおよび Microsoft.Office.Interop.InfoPath.Xml アセンブリの詳細については、[Microsoft.Office.Interop.InfoPath](https://msdn.microsoft.com/library/microsoft.office.interop.infopath.aspx) 名前空間および [Microsoft.Office.Interop.InfoPath.Xml](https://msdn.microsoft.com/library/microsoft.office.interop.infopath.xml) 名前空間のドキュメントを参照してください。</span><span class="sxs-lookup"><span data-stu-id="e874d-113">For information about the Microsoft.Office.Interop.InfoPath and Microsoft.Office.Interop.InfoPath.Xml assemblies, see the documentation for the [Microsoft.Office.Interop.InfoPath](https://msdn.microsoft.com/library/microsoft.office.interop.infopath.aspx) and [Microsoft.Office.Interop.InfoPath.Xml](https://msdn.microsoft.com/library/microsoft.office.interop.infopath.xml) namespaces.</span></span> 
  
## <a name="important-installation-information"></a><span data-ttu-id="e874d-114">インストールに関する重要な情報</span><span class="sxs-lookup"><span data-stu-id="e874d-114">Important installation information</span></span>

<span data-ttu-id="e874d-p102">既定では、InfoPath セットアップ プログラムのインストール オプションで [ **標準**] を選択すると、Microsoft.Office.Interop.InfoPath.SemiTrust アセンブリと Microsoft.Office.Interop.InfoPath.Xml アセンブリのコピーが C:\Program Files\Microsoft Office\Office14 フォルダーにインストールされます。また、Microsoft.Office.Interop.InfoPath アセンブリと Microsoft.Office.Interop.InfoPath.Xml アセンブリがグローバル アセンブリ キャッシュ (GAC) にインストールされます。グローバル アセンブリ キャッシュ (GAC) の内容は、C:\Windows\Assembly フォルダーから見ることができます。</span><span class="sxs-lookup"><span data-stu-id="e874d-p102">By default, the **Typical** installation option of the InfoPath setup program installs copies of the Microsoft.Office.Interop.InfoPath.SemiTrust and Microsoft.Office.Interop.InfoPath.Xml assemblies in the C:\Program Files\Microsoft Office\Office14 folder. The Microsoft.Office.Interop.InfoPath and Microsoft.Office.Interop.InfoPath.Xml assemblies are also installed in the Global Assembly Cache (GAC), the contents of which can be viewed from the C:\Windows\Assembly folder.</span></span> 
  
<span data-ttu-id="e874d-p103">これらのアセンブリがインストールされていない場合は、Microsoft InfoPath が正しくインストールされていることを確認する必要があります。セットアップを実行する前に .NET Framwork 2.0 以降がインストールされていれば、[ **標準**] を選択して InfoPath をインストールすると、InfoPath セットアップ プログラムの [ **.NET プログラミング サポート**] オプションが [ **マイ コンピューターから実行**] に設定されます。コンピューターでこれらの相互運用アセンブリを使用できない場合は, .NET Framework 2.0 以降がインストールされていることを確認する必要があります。その後、[ **コントロール パネル**] の [ **プログラムの追加と削除**] を実行して、[ **.NET プログラミング サポート**] オプションを [ **マイ コンピューターから実行**] に設定します。</span><span class="sxs-lookup"><span data-stu-id="e874d-p103">If these assemblies are not installed, you should confirm that Microsoft InfoPath was installed correctly. As long as the .NET Framework 2.0 or later is installed before running setup, the **.NET Programmability Support** option in the InfoPath setup program is set to **Run from My Computer** for a **Typical** installation of InfoPath. If these interop assemblies are not available on your computer, you must confirm that the .NET Framework 2.0 or later is installed, and then run **Add or Remove Programs** from the **Control Panel** and set the **.NET Programmability Support** option to **Run from My Computer**.</span></span>
  
<span data-ttu-id="e874d-120">.NET Framework 2.0 再配布可能バージョンのダウンロードの詳細については、「[.NET Framework 2.0 再配布可能バージョン](https://www.microsoft.com/downloads/details.aspx?displaylang=en&amp;FamilyID=0856eacb-4362-4b0d-8edd-aab15c5e04f5)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="e874d-120">For information on downloading the .NET Framework 2.0 Redistributable, see [.NET Framework 2.0 Redistributable. ](https://www.microsoft.com/downloads/details.aspx?displaylang=en&amp;FamilyID=0856eacb-4362-4b0d-8edd-aab15c5e04f5)</span></span>
  
## <a name="the-microsoftofficeinteropinfopathsemitrust-namespace"></a><span data-ttu-id="e874d-121">Microsoft.Office.Interop.InfoPath.SemiTrust 名前空間</span><span class="sxs-lookup"><span data-stu-id="e874d-121">The Microsoft.Office.Interop.InfoPath.SemiTrust namespace</span></span>

<span data-ttu-id="e874d-p104">Microsoft Office InfoPath 2003 Service Pack 1 および Microsoft Office InfoPath 2003 Toolkit for Visual Studio® .NET がリリースされるまでは、InfoPath フォーム テンプレートのすべてのプログラム ロジックは、Microsoft Script Editor (MSE) の開発環境で書かれた Microsoft JScript または Microsoft VBScript を使用して作成されていました。MSE で書かれたスクリプトは実行時に解釈され、IPEDITOR.dll ダイナミック リンク ライブラリによって公開される COM オブジェクト モデルにアクセスします。</span><span class="sxs-lookup"><span data-stu-id="e874d-p104">Prior to the release of Microsoft Office InfoPath 2003 Service Pack 1 and the Microsoft Office InfoPath 2003 Toolkit for Visual Studio® .NET, all programming logic for InfoPath form templates was created using Microsoft JScript or Microsoft VBScript written in the Microsoft Script Editor (MSE) development environment. Script written in MSE is interpreted at run time and accesses the COM object model exposed by the IPEDITOR.dll dynamic link library.</span></span>
  
<span data-ttu-id="e874d-p105">プログラム ロジックに Visual C# や Visual Basic のマネージ コード言語を使用するフォーム テンプレートの作成をサポートするために、共通言語ランタイム (CLR) をホストできるようにするための機能が InfoPath に追加され、InfoPath によって公開される COM オブジェクト モデルとマネージ コードとの相互運用を安全な形で実現するための Microsoft.Office.Interop.InfoPath.SemiTrust 相互運用アセンブリが作成されました。InfoPath マネージ コード フォーム テンプレートに適用されるセキュリティ モデルについては、「[コードを含むフォーム テンプレートのセキュリティ モデルについて](about-the-security-model-for-form-templates-with-code.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="e874d-p105">To support the creation of form templates that use managed-code languages such as Visual C# and Visual Basic for programming logic, functionality was added to InfoPath to enable hosting the common language runtime (CLR) and the Microsoft.Office.Interop.InfoPath.SemiTrust interop assembly was created to enable managed code to interoperate with the COM object model exposed by InfoPath in a secure manner. For information on the security model that applies to InfoPath managed-code form templates, see [About the Security Model for Form Templates with Code](about-the-security-model-for-form-templates-with-code.md).</span></span> 
  
<span data-ttu-id="e874d-p106">InfoPath フォーム テンプレートの特定のタスクのマネージ コードを書くプロセスは、同じプログラミング タスクをスクリプトを書いて実行する場合とよく似ていますが、Visual Studio 2012 の [ **オブジェクト ブラウザー**] で **Microsoft.Office.Interop.InfoPath.SemiTrust** 名前空間を表示したときに公開される InfoPath 2003 互換オブジェクト モデルは、スクリプトの場合より、はるかに複雑に見えます。これは、InfoPath 2003 互換オブジェクト モデルをサポートするために使用される .NET Framework の相互運用技術では、COM サーバーのすべてのパブリック インターフェイスに加えて, .NET Framework 自体が必要とする追加のコンストラクトも COM サーバーで公開される必要があるためです。</span><span class="sxs-lookup"><span data-stu-id="e874d-p106">Although the process of writing managed code for a given task in an InfoPath form template is very similar to performing the same programming task by writing script, the InfoPath 2003-compatible object model exposed when viewing the **Microsoft.Office.Interop.InfoPath.SemiTrust** namespace from the **Object Browser** in Visual Studio 2012 looks much more complex. This is because the .NET Framework interoperability technology used to support the InfoPath 2003-compatible object model requires a COM server to expose all of its public interfaces, as well as some additional constructs required by the .NET Framework itself.</span></span> 
  
### <a name="how-com-objects-are-exposed-to-the-infopath-2003-compatible-object-model"></a><span data-ttu-id="e874d-128">COM オブジェクトが InfoPath 2003 互換オブジェクト モデルに公開されるしくみ</span><span class="sxs-lookup"><span data-stu-id="e874d-128">How COM objects are exposed to the InfoPath 2003 compatible object model</span></span>

<span data-ttu-id="e874d-p107">JScript、VBScript、Visual Basic などの高水準言語 (.NET バージョンの Visual Basic や Visual C# は含まない) を使用して COM サーバーをネイティブで操作する場合、公開されるオブジェクト モデルは、基になる COM クラスや COM インターフェイスより単純になります。たとえば、これらの言語を使用した場合、InfoPath の **UI** オブジェクトでは 7 つのメソッドのセット (ユーザーにメッセージ ボックスを表示するための **Alert** メソッドなど) が公開されます。</span><span class="sxs-lookup"><span data-stu-id="e874d-p107">When working natively with a COM server from high-level languages such as JScript, VBScript, or Visual Basic (but not the .NET version of Visual Basic and Visual C#), the object model that is exposed is simpler than the underlying COM classes and interfaces. For example, when working from these languages, the InfoPath **UI** object exposes a set of seven methods, such as the **Alert** method for displaying a message box to users.</span></span> 
  
<span data-ttu-id="e874d-p108">ただし、 **UI** オブジェクトをサポートする基になる COM コンストラクトは、実際には 3 つのエンティティで構成されています。 **UI** と **UI2** という 2 つのインターフェイスと、この 2 つのインターフェイスのメンバーを実装する COM コクラスです。 **UI** インターフェイスに 2 つのバージョンがあるのは、COM フレームワークでは、インターフェイスの実装を呼び出すプログラムやコンポーネントの下位互換性を維持するために、インターフェイスの定義を変更せずにおく必要があるためです。</span><span class="sxs-lookup"><span data-stu-id="e874d-p108">However, the underlying COM constructs that support the **UI** object are actually composed of three entities: two interfaces named **UI** and **UI2**, and a COM coclass that implements the members of these two interfaces. There are two versions of the **UI** interface because the COM framework requires the definition of an interface to remain fixed to maintain backward compatibility for programs and components that call an implementation of that interface.</span></span> 
  
<span data-ttu-id="e874d-p109">この例では、InfoPath の最初のリリースのために定義された **UI** インターフェイスによって、 **Alert** メソッドなどの 4 つのメソッドが提供されます。 **UI2** インターフェイスは、InfoPath Service Pack 1 リリースのために定義されたもので、 **UI** インターフェイスの 2 番目のバージョンと見なすことができます。 **UI2** インターフェイスでは、元の **UI** インターフェイスの 4 つのメソッドが継承されているほか、3 つの新しいメソッド ( **Confirm** メソッドなど) が追加されています。スクリプトでもマネージ コードでも、  \*\*\*\* を使用して `XDocument.UI.Confirm` メソッドを呼び出すコード行を書くことができますが、基になるコードで実際に呼び出されるのは、COM コクラスに実装されている **UI2** インターフェイスの **Confirm** メソッドです。</span><span class="sxs-lookup"><span data-stu-id="e874d-p109">In this case, the **UI** interface, which was defined for the initial release of InfoPath, provides four methods, including the **Alert** method. The **UI2** interface can be considered a second version of the **UI** interface, and it was defined for the InfoPath Service Pack 1 release. The **UI2** interface inherits the four methods of the original **UI** interface and adds three new methods, such as the **Confirm** method. Although you can write a line of code either in script or managed code that calls the **Confirm** method using  `XDocument.UI.Confirm`, the underlying code is actually calling the **Confirm** method of the **UI2** interface from the implementation of that method in the COM coclass.</span></span> 
  
<span data-ttu-id="e874d-p110">スクリプト環境に公開されるオブジェクト モデルではこれらの詳細が隠されていますが、マネージ コードから COM サーバーを操作する必要がある相互運用アセンブリでは、コクラスと両方のインターフェイスが公開されます。MSE スクリプト環境で使用される単一の **UI** オブジェクトに対して、 **Microsoft.Office.Interop.InfoPath.SemiTrust** 名前空間では次の 3 つのアイテムが公開されます。</span><span class="sxs-lookup"><span data-stu-id="e874d-p110">The object model as it is exposed to scripting hides these details, but the interop assembly required to work with a COM server from managed code exposes the coclass and both interfaces publicly. For the single **UI** object used in the MSE scripting environment, the **Microsoft.Office.Interop.InfoPath.SemiTrust** namespace exposes the following three items:</span></span> 
  
- <span data-ttu-id="e874d-139">[UI](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.UI.aspx) インターフェイス</span><span class="sxs-lookup"><span data-stu-id="e874d-139">[UI](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.UI.aspx) interface</span></span> 
    
- <span data-ttu-id="e874d-140">[UI2](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.UI2.aspx) インターフェイス</span><span class="sxs-lookup"><span data-stu-id="e874d-140">[UI2](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.UI2.aspx) interface</span></span> 
    
- <span data-ttu-id="e874d-141">[UIObject](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.UIObject.aspx) コクラス インターフェイス</span><span class="sxs-lookup"><span data-stu-id="e874d-141">[UIObject](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.UIObject.aspx) coclass interface</span></span> 
    
<span data-ttu-id="e874d-p111">これら 3 つのインターフェイスのすべてが [ **オブジェクト ブラウザー**] で公開され、この名前空間のクラス ライブラリ ドキュメントにも含まれています。ただし、実際に使用するのは、 **UI** オブジェクトを実装する **UIObject** コクラス インターフェイスと、 **UIObject** コクラス インターフェイスによって実装されるインターフェイスの最新バージョンである **UI2** インターフェイスのメンバーのみです。 **UIObject** コクラス インターフェイスにその親の [XDocument](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.XDocument.aspx) オブジェクトからアクセスするには、スクリプトの場合と同様に、 [UI](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust._XDocument2.UI.aspx) アクセサー プロパティを使用します。いくつかの重要な例外を除いては、InfoPath の最初のリリースから含まれていて InfoPath Service Pack 1 のリリース時に更新されたすべてのオブジェクトに、このパターンが当てはまります。</span><span class="sxs-lookup"><span data-stu-id="e874d-p111">Although all three of these interfaces are exposed in the **Object Browser** and are contained in the Class Library documentation for the namespace, you only work with the **UIObject** coclass interface, which implements the **UI** object, and with the members of the **UI2** interface, which is the most current version of the interface that is implemented by the **UIObject** coclass interface. To access the **UIObject** coclass interface from its parent [XDocument](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.XDocument.aspx) object, just as in script, you use the [UI](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust._XDocument2.UI.aspx) accessor property. Except for a few notable exceptions, this is the pattern for all objects from the original release of InfoPath that were updated when InfoPath Service Pack 1 was released.</span></span> 
  
<span data-ttu-id="e874d-p112">**Certificate** オブジェクトなど、InfoPath Service Pack 1 で追加された新しいオブジェクトでは、基本的なパターンは同じですが、状況がいくぶん単純になります。この場合、関係のあるアイテムは 2 つだけです。1 つは、 [CertificateObject](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.CertificateObject.aspx) コクラス インターフェイス、もう 1 つは、 [CertificateObject](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Certificate.aspx) コクラス インターフェイスによって実装される最新かつ唯一のインターフェイスである **Certificate** インターフェイスのメンバーです。このオブジェクトに親からアクセスするには、スクリプトから InfoPath COM オブジェクトを使用する場合と同様に、 [Certificate](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Signature.Certificate.aspx) アクセサー プロパティを使用します。</span><span class="sxs-lookup"><span data-stu-id="e874d-p112">While the pattern is basically the same, the situation is slightly simpler for the entirely new objects that were added in InfoPath Service Pack 1, such as the **Certificate** object. In this case, there are only two items to be concerned with: the [CertificateObject](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.CertificateObject.aspx) coclass interface and the members of the [Certificate](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Certificate.aspx) interface, which is the most recent and only interface implemented by the **CertificateObject** coclass interface. Just as when using InfoPath COM objects from script, the [Certificate](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Signature.Certificate.aspx) accessor property is used to access the object from its parent.</span></span> 
  
<span data-ttu-id="e874d-p113">コレクションのインターフェイスにも同じパターンが当てはまります。ただし、コレクションのコクラス インターフェイスの名前には、"Object" ではなく "Collection" が付きます。たとえば、COM **DataAdapters** コレクションのコクラス インターフェイスの名前は [DataAdaptersCollection](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.DataAdaptersCollection.aspx) で、このコクラス インターフェイスが実装するインターフェイスは [DataAdapters](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.DataAdapters.aspx) インターフェイスです。コレクションへのアクセスに [XDocument](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust._XDocument2.DataAdapters.aspx) 親オブジェクトの **DataAdapters** アクセサー プロパティを使用する点も同様です。</span><span class="sxs-lookup"><span data-stu-id="e874d-p113">This same pattern applies to the interfaces for collections, except the coclass interface for a collection has "Collection" appended to its name instead of "Object". For example, the coclass interface for the COM **DataAdapters** collection is named [DataAdaptersCollection](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.DataAdaptersCollection.aspx) and the interface it implements is the [DataAdapters](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.DataAdapters.aspx) interface. Similarly, the [DataAdapters](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust._XDocument2.DataAdapters.aspx) accessor property of the **XDocument** parent object is used to access the collection.</span></span> 
  
<span data-ttu-id="e874d-p114">この命名パターンには 3 つの例外があります。COM **Application** オブジェクトと COM **XDocument** オブジェクトのコクラス インターフェイスの名前には、"Object" が付きません。これらの名前は、対応する COM オブジェクトと同じ [Application](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Application.aspx) および **XDocument** になります。また、 **Application** コクラス インターフェイスと **XDocument** コクラス インターフェイスによって実装されるインターフェイスの名前は、先頭にアンダースコア文字 (_) が付いて、 [_Application2](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust._Application2.aspx) および [_XDocument2](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust._XDocument2.aspx) になります。3 つ目の例外は、COM **DataObject** オブジェクトです。このオブジェクトのコクラス インターフェイスの名前は、 [DataSourceObject](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.DataSourceObject.aspx) です。ただし、このコクラス インターフェイスが実装するインターフェイスは、他の InfoPath COM オブジェクトと同様に、 [DataObject](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.DataObject.aspx) になります。</span><span class="sxs-lookup"><span data-stu-id="e874d-p114">There are three exceptions to this naming pattern. The coclass interfaces for the COM **Application** and **XDocument** objects do not have "Object" appended to their names. Their names are identical to their corresponding COM objects: [Application](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Application.aspx) and **XDocument**. Additionally, the names of the interfaces implemented by the **Application** and **XDocument** coclass interfaces are prefixed with the underscore character (_): [_Application2](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust._Application2.aspx) and [_XDocument2](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust._XDocument2.aspx) . The third exception is the COM **DataObject** object. The coclass interface for this object is named [DataSourceObject](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.DataSourceObject.aspx) , but just like other InfoPath COM objects, the interface it implements is the [DataObject](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.DataObject.aspx) interface.</span></span> 
  
### <a name="how-microsoft-xml-core-services-msxml-50-for-microsoft-office-objects-are-exposed-to-the-infopath-2003-compatible-object-model"></a><span data-ttu-id="e874d-157">Microsoft XML Core Services (MSXML) 5.0 for Microsoft Office オブジェクトが InfoPath 2003 互換オブジェクト モデルに公開されるしくみ</span><span class="sxs-lookup"><span data-stu-id="e874d-157">How Microsoft XML Core Services (MSXML) 5.0 for Microsoft Office objects are exposed to the InfoPath 2003 compatible object model</span></span>

<span data-ttu-id="e874d-p115">COM サーバーでもある Microsoft XML Core Services (MSXML) によって提供されるオブジェクト モデルのオブジェクトとメンバーのサブセットが、Microsoft.Office.Interop.InfoPath.SemiTrust 相互運用アセンブリによって公開されるインターフェイスでラップされます。これが必要になるのは、InfoPath COM オブジェクト モデルの一部のメンバーが MSXML に依存しており、それらのメンバーに安全な形でアクセスできるようにする必要があるからです。MSXML オブジェクト モデルのオブジェクトやメンバーをラップする **Microsoft.Office.Interop.InfoPath.SemiTrust** 名前空間のインターフェイスの名前は、MSXML COM サーバーによって公開される名前と同じです。ほとんどの場合、これらの名前には、"IXMLDOM" というプレフィックスが付いています。これは、それらが XML Document Object Model (DOM) の操作に使用されるためです。たとえば、フォームの基になる XML ドキュメントへの参照を取得するために使用される [XDocument](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust._XDocument2.DOM.aspx) インターフェイスの **DOM** プロパティは、Microsoft.Office.Interop.InfoPath.SemiTrust 相互運用アセンブリによってラップされた [IXMLDOMDocument](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.IXMLDOMDocument.aspx) インターフェイスを返します。 **IXMLDOMDocument** インターフェイスのメンバーを呼び出して使用する方法は、マネージ コードを使用しないフォーム テンプレートでスクリプトを使用する場合と基本的に同じです。</span><span class="sxs-lookup"><span data-stu-id="e874d-p115">A subset of the objects and members of the object model provided by Microsoft XML Core Services (MSXML), which is also a COM server, are wrapped by interfaces exposed by the Microsoft.Office.Interop.InfoPath.SemiTrust interop assembly. The reason this is necessary is that some of the members of the InfoPath COM object model rely on MSXML and must be able to access these members in a secure manner. The names of interfaces in the **Microsoft.Office.Interop.InfoPath.SemiTrust** namespace that wrap the objects and members of the MSXML object model are the same as the names exposed by the MSXML COM server. In most cases, these names are prefixed with "IXMLDOM" because they are used to work with the XML Document Object Model (DOM). For example, the [DOM](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust._XDocument2.DOM.aspx) property of the **XDocument** interface, which is used to return a reference to a form's underlying XML document, returns the [IXMLDOMDocument](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.IXMLDOMDocument.aspx) interface that is wrapped by the Microsoft.Office.Interop.InfoPath.SemiTrust interop assembly. You call and use the members of the **IXMLDOMDocument** interface in basically the same way as when using script in form templates that don't use managed code.</span></span> 
  
<span data-ttu-id="e874d-164">マネージ コード フォーム テンプレートで Microsoft XML Core Services (MSXML) for Microsoft Office オブジェクト モデルのメンバーを使用する方法の詳細については、「[InfoPath 2003 オブジェクト モデルを使用して MSXML および System.Xml を操作する](working-with-msxml-and-system-xml-using-the-infopath-2003-object-model.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="e874d-164">For more information on using members of the Microsoft XML Core Services (MSXML) for Microsoft Office object model in managed-code form templates, see [Working with MSXML and System.Xml Using the InfoPath 2003 Object Model](working-with-msxml-and-system-xml-using-the-infopath-2003-object-model.md).</span></span>
  
### <a name="using-intellisense"></a><span data-ttu-id="e874d-165">IntelliSense を使用する</span><span class="sxs-lookup"><span data-stu-id="e874d-165">Using IntelliSense</span></span>

<span data-ttu-id="e874d-p116">`thisXDocument` 変数と  `thisApplication` 変数は、マネージ コード フォーム テンプレートで InfoPath 2003 互換オブジェクト モデルに対して書かれるほとんどのコードで使用されます。これらの変数は、既定のクラス ファイル FormCode.cs または FormCode.vb の  `_Startup` メソッドで初期化されます。この  `thisXDocument` 変数と  `thisApplication` 変数を使用して、 [XDocument](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.XDocument.aspx) コクラス インターフェイスと [Application](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Application.aspx) コクラス インターフェイスのメンバーにアクセスすることができます。いずれかの変数の名前を入力し、続けてピリオドを入力すると、IntelliSense のステートメント入力候補機能により、対応するコクラス インターフェイスのメンバーの一覧が表示されます。このように操作を続けることで、使用するオブジェクト モデル メンバーにアクセスできます。</span><span class="sxs-lookup"><span data-stu-id="e874d-p116">For most of the code you write against the InfoPath 2003-compatible object model in a managed-code form template, you will use the  `thisXDocument` and  `thisApplication` variables that are initialized in the  `_Startup` method of the default FormCode.cs or FormCode.vb class file. You can use the  `thisXDocument` and  `thisApplication` variables to access the members of the [XDocument](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.XDocument.aspx) and [Application](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Application.aspx) coclass interfaces. After you type the name of either variable followed by a period, IntelliSense statement completion will display the list members of the corresponding coclass interface. You can continue in this fashion to access the object model member you want to work with.</span></span> 
  
<span data-ttu-id="e874d-170">次の単純な例では、 `thisXDocument` 変数を使用して [Alert](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.UI2.Alert.aspx) メソッドにアクセスし、  [](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust._Application2.Version.aspx) 変数からアクセスした `thisApplication` プロパティを使用して InfoPath アプリケーションのバージョンを表示しています。</span><span class="sxs-lookup"><span data-stu-id="e874d-170">The following shows a simple example that uses the  `thisXDocument` variable to access the [Alert](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.UI2.Alert.aspx) method to display the version of the InfoPath application by using the [Version](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust._Application2.Version.aspx) property accessed from the  `thisApplication` variable.</span></span> 
  
```cs
thisXDocument.UI.Alert(thisApplication.Version);
```

```vb
thisXDocument.UI.Alert(thisApplication.Version)
```

### <a name="using-the-class-library-reference-documentation"></a><span data-ttu-id="e874d-171">クラス ライブラリ リファレンス ドキュメントを使用する</span><span class="sxs-lookup"><span data-stu-id="e874d-171">Using the Class Library reference documentation</span></span>

<span data-ttu-id="e874d-p117">**Microsoft.Office.Interop.InfoPath.SemiTrust** 名前空間のクラス ライブラリ リファレンス ドキュメントの構成は、コクラス インターフェイスと、そのコクラス インターフェイスによって実装される継承インターフェイスとの関係を反映しています。詳細については、このトピックの前方にある「COM オブジェクトが InfoPath 2003 互換オブジェクト モデルに公開されるしくみ」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="e874d-p117">The organization of the **Microsoft.Office.Interop.InfoPath.SemiTrust** namespace Class Library reference documentation reflects the relationships between coclass interfaces and the inherited interfaces they implement. This is described in the "How COM Objects are Exposed to Managed Code" section earlier in this topic.</span></span> 
  
<span data-ttu-id="e874d-p118">**Microsoft.Office.Interop.InfoPath.SemiTrust** 名前空間のリファレンス ドキュメントの構成と命名体系は、一見わかりにくく見えますが、そのトピックの構成は、InfoPath に付属の『InfoPath 開発者リファレンス』の一部である『InfoPath オブジェクト モデル リファレンス』と基本的に同じです。 **Application** インターフェイスと **XDocument** インターフェイスのトピックを例外として、その他の COM コクラス インターフェイスのすべてのトピックは、『InfoPath スクリプト リファレンス』の対応する "オブジェクト" および "コレクション" のトピックに対応しています。たとえば、 **Microsoft.Office.Interop.InfoPath.SemiTrust** 名前空間のリファレンス ドキュメントのトピック「UIObject インターフェイス」および「WindowsCollection インターフェイス」は、InfoPath オブジェクト モデル リファレンスのスクリプト リファレンスの同等の内容を持つトピック「UI オブジェクト」および「Windows コレクション」に対応しています。</span><span class="sxs-lookup"><span data-stu-id="e874d-p118">Although the organization and naming of the **Microsoft.Office.Interop.InfoPath.SemiTrust** namespace reference documentation appears confusing at first, the topics are basically organized in the same way as the InfoPath Object Model Reference that is part of the InfoPath Developer's Reference, which is included with InfoPath. With the exception of the topics for the **Application** and **XDocument** interfaces, all of the COM coclass interface topics map to the equivalent "Object" and "Collection" topics from the InfoPath scripting reference. For example, the "UIObject Interface" and the "WindowsCollection Interface" topics of the **Microsoft.Office.Interop.InfoPath.SemiTrust** namespace reference documentation correspond to similar content in the "UI Object" and "Windows Collection" topics of the InfoPath Object Model Reference scripting reference.</span></span> 
  
<span data-ttu-id="e874d-p119">ただし、トピックの冒頭のインターフェイスの説明に続くコクラス インターフェイスのメンバーへのリンクでは、空のトピックが表示されます。コクラス インターフェイスによって実装されるメンバーの一覧を表示するには、そのコクラスによって継承される最も新しいインターフェイスのトピックを開き、そのメンバーの表を開く必要があります。継承インターフェイスへのリンクは、コクラス インターフェイスのトピックの「解説」セクションの先頭にあります。</span><span class="sxs-lookup"><span data-stu-id="e874d-p119">However, the link to the members of the coclass interface following the description of the interface at the beginning of the topic displays an empty topic. To display the list of members that are implemented by the coclass interface, you must open the topic for the most recent interface that is inherited by the coclass, and then open the table of its members. A link to the inherited interface is provided at the beginning of the Remarks section in the coclass interface topic.</span></span>
  
<span data-ttu-id="e874d-p120">コード エディターで F1 キーを押した場合の動作は、インターフェイスのメンバーを操作している場合がほとんどなので、F1 ヘルプを呼び出したメンバーが直接表示される以外は、ほとんど同じです。ただし、メンバーがバージョン付きのインターフェイスから実装される場合があるという点で、初めは混乱する可能性があります。たとえば、「 `thisXDocument.UI.Alert`」と入力し、 `Alert` にカーソルを置いて F1 キーを押すと、「UI2.Alert メソッド」というタイトルのトピックが表示されます。これは、 **Alert** メソッドが **UI2** インターフェイスのメンバーの実装であるからです。</span><span class="sxs-lookup"><span data-stu-id="e874d-p120">When you press F1 in the Code Editor, the behavior is similar, except that the member on which you invoke F1 Help will be displayed directly, because you are most typically working with members of an interface. However, the fact that a member can be implemented from a versioned interface may be confusing the first time you encounter it. For example, if you type  `thisXDocument.UI.Alert` and place the cursor on  `Alert` and press F1, a topic titled "UI2.Alert Method" is displayed. This is because the **Alert** method is an implementation of a member of the **UI2** interface.</span></span> 
  
### <a name="passing-optional-parameters-to-infopath-object-model-members"></a><span data-ttu-id="e874d-184">InfoPath オブジェクト モデルのメンバーにオプションのパラメーターを渡す</span><span class="sxs-lookup"><span data-stu-id="e874d-184">Passing optional parameters to InfoPath object model members</span></span>

<span data-ttu-id="e874d-p121">InfoPath 2003 互換オブジェクト モデルのメンバーにオプションのパラメーターが含まれていて、そのパラメーターの値を指定しない場合は、代わりに **Type.Missing** フィールドを渡す必要があります。実際の値を省略する場合に **Type.Missing** フィールドを渡さないと、ビルド エラーが発生します。これは、Visual C# と Visual Basic のどちらで書かれたコードにも当てはまります。たとえば、 [ViewObject](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.View.SelectNodes.aspx) インターフェイスの [SelectNodes](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.ViewObject.aspx) メソッドには、  _varEndNode_ と  _varViewContext_ という 2 つのオプション パラメーターが含まれています。これらのオプション パラメーターに対して実際の値を指定しないコード行は、次のようになっている必要があります。</span><span class="sxs-lookup"><span data-stu-id="e874d-p121">If an InfoPath 2003-compatible object model member contains an optional parameter, and you do not specify a value for that parameter, you must pass the **Type.Missing** field for that parameter instead. Failure to pass the **Type.Missing** field when an actual value is omitted will result in a build error. This is true for code written in both Visual C# and Visual Basic. For example, the [SelectNodes](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.View.SelectNodes.aspx) method of the [ViewObject](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.ViewObject.aspx) interface includes two optional parameters:  _varEndNode_ and  _varViewContext_. A line of code that does not specify actual values for these optional parameters should look like the following examples.</span></span>
  
```cs
IXMLDOMNode group1 = 
   thisXDocument.DOM.selectSingleNode("/my:myFields/my:group1");
thisXDocument.View.SelectNodes(group1, Type.Missing, Type.Missing);
```

```vb
Dim group1 As IXMLDOMNode = _
   thisXDocument.DOM.selectSingleNode("/my:myFields/my:group1")
thisXDocument.View.SelectNodes(group1, Type.Missing, Type.Missing)
```

### <a name="about-common-language-specification-compliance"></a><span data-ttu-id="e874d-190">共通言語仕様の準拠</span><span class="sxs-lookup"><span data-stu-id="e874d-190">About common language specification compliance</span></span>

<span data-ttu-id="e874d-p122">Microsoft.Office.Interop.InfoPath.SemiTrust アセンブリのすべてのインターフェイスとメンバーは、内部で **CLSCompliant** 属性が **false** に設定されています。リファレンス ドキュメントは一部 **System.Reflection** を使用して生成されるため、各インターフェイスおよびメンバーの説明に、"このインターフェイス/メソッド/プロパティは CLS に準拠していません" という記述が含まれています。しかし、実際には、 [Microsoft.Office.Interop.InfoPath.SemiTrust](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.aspx) 名前空間のほとんどのインターフェイスとメンバーが CLS に準拠しています。</span><span class="sxs-lookup"><span data-stu-id="e874d-p122">Internally, every interface and member in the Microsoft.Office.Interop.InfoPath.SemiTrust assembly has its **CLSCompliant** attribute set to **false**. Because the reference documentation is generated in part using **System.Reflection**, the description of each interface and member has the phrase "This interface/method/property is not CLS-compliant" appended to it. However, most of the interfaces and members of the [Microsoft.Office.Interop.InfoPath.SemiTrust](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.aspx) namespace actually are CLS-compliant.</span></span> 
  
## <a name="see-also"></a><span data-ttu-id="e874d-194">関連項目</span><span class="sxs-lookup"><span data-stu-id="e874d-194">See also</span></span>

- [<span data-ttu-id="e874d-195">InfoPath 2003 オブジェクト モデルを使用したフォーム テンプレート開発のための一般的な作業</span><span class="sxs-lookup"><span data-stu-id="e874d-195">Common Tasks for Developing Form Templates Using the InfoPath 2003 Object Model</span></span>](common-tasks-for-developing-form-templates-using-infopath-object-model.md)
- [<span data-ttu-id="e874d-196">コードを含むフォーム テンプレートのためのセキュリティ モデルについて</span><span class="sxs-lookup"><span data-stu-id="e874d-196">About the Security Model for Form Templates with Code</span></span>](about-the-security-model-for-form-templates-with-code.md)
- [<span data-ttu-id="e874d-197">InfoPath 2003 オブジェクト モデルを使用してフォーム テンプレートを作成する</span><span class="sxs-lookup"><span data-stu-id="e874d-197">Creating Form Templates Using the InfoPath 2003 Object Model</span></span>](creating-form-templates-using-the-infopath-2003-object-model.md)
- [<span data-ttu-id="e874d-198">InfoPath 2003 オブジェクト モデルを理解する</span><span class="sxs-lookup"><span data-stu-id="e874d-198">Understanding the InfoPath 2003 Object Model</span></span>](understanding-the-infopath-2003-object-model.md)

