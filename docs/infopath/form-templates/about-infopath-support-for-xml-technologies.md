---
title: InfoPath の XML テクノロジのサポートについて
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
ms.assetid: 074181a2-3a75-824c-049d-549aabff0f9f
description: Microsoft InfoPath は、ワープロや電子メールのアプリケーションなどの従来のドキュメント編集環境の最高のものと、フォーム パッケージの厳密なデータ取り込み機能とを組み合わせたハイブリッドなツールです。 この記事では、InfoPath を使用して取り組むべき問題について説明し、問題の解決に使用される設計方針および XML の業界標準について説明します。
ms.openlocfilehash: 20831635fba8d76b9d6b45f42a5308ab7236db20
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/28/2019
ms.locfileid: "33407229"
---
# <a name="about-infopath-support-for-xml-technologies"></a><span data-ttu-id="4033c-104">XML テクノロジのための InfoPath サポートについて</span><span class="sxs-lookup"><span data-stu-id="4033c-104">About InfoPath Support for XML Technologies</span></span>

<span data-ttu-id="4033c-105">Microsoft InfoPath は、ワープロや電子メールのアプリケーションなどの従来のドキュメント編集環境の最高のものと、フォーム パッケージの厳密なデータ取り込み機能とを組み合わせたハイブリッドなツールです。</span><span class="sxs-lookup"><span data-stu-id="4033c-105">Microsoft InfoPath is a hybrid tool that combines the best of a traditional document editing experience, such as a word processor or email application, with the rigorous data-capture capabilities of a forms package.</span></span> <span data-ttu-id="4033c-106">この記事では、InfoPath を使用して取り組むべき問題について説明し、問題の解決に使用される設計方針および XML の業界標準について説明します。</span><span class="sxs-lookup"><span data-stu-id="4033c-106">This article describes the problems InfoPath is designed to address and explains the design principles and XML industry standards used to solve these problems.</span></span>
  
## <a name="introduction"></a><span data-ttu-id="4033c-107">概要</span><span class="sxs-lookup"><span data-stu-id="4033c-107">Introduction</span></span>

<span data-ttu-id="4033c-p103">InfoPath はハイレベルな XML オーサリング ツールで、これを使用することで、一般的なエンドユーザーが、カスタム定義された XML スキーマに属する XML ドキュメントを作成できます。ユーザーが XML ドキュメントを編集する際に、ドキュメントへの変更は XML スキーマによって制御されます。</span><span class="sxs-lookup"><span data-stu-id="4033c-p103">InfoPath is a high-level XML authoring tool that enables ordinary end-users to create XML documents that belong to a custom-defined XML schema. When the user edits an XML document, modifications to the document are controlled by the XML schema.</span></span>
  
<span data-ttu-id="4033c-p104">ユーザーは、ドキュメントに XSLT スタイル シートを適用することで表示される、リッチで形式化されたビューを通じて、XML ドキュメントを扱うことができます。XML ドキュメントのリーフ ノードや属性値は、テキスト ボックスやチェック ボックスなどのフィールドとして表示され、ノードの階層構造はフィールドのグループとしてレンダリングされます。</span><span class="sxs-lookup"><span data-stu-id="4033c-p104">The user interacts with the XML document through a rich, formatted view that is displayed by applying an XSLT style sheet to the document. A leaf node or attribute value from the XML document is displayed as a field, such as a text box or check box, whereas a hierarchy of nodes is rendered as a group of fields.</span></span>
  
<span data-ttu-id="4033c-p105">InfoPath は、選択中のフィールドやフィールド グループに有効な編集操作を表示することで、XML データの、有効で、構造化された編集を可能にします。この構造化された編集によって、ユーザーは、リッチで動的なビューで表示されるフィールドのグループを使用して作業することで、要素および属性を確認せずに、有効な XML 要素および属性の追加や削除ができます。</span><span class="sxs-lookup"><span data-stu-id="4033c-p105">InfoPath enables validated, structured editing of XML data by showing the editing actions that are valid for the field or field group that is currently selected. This structured editing enables the user to add and remove valid XML elements and attributes by working with groups of fields displayed in rich dynamic views, without seeing the elements and attributes.</span></span>
  
<span data-ttu-id="4033c-p106">InfoPath は、XML が登場する前は解決できなかったデータ収集の領域の問題を解決します。InfoPath は、XML の階層構造のデータ モデルを使用するフィールドのグループを追加することによって拡張できるフォームを提供して、フォーム アプリケーションの厳密な検証機能を活かしながらワープロのドキュメントの柔軟性を組み込みます。複雑な XSLT 変換は、XML データの動的で使用しやすいビューを提供する、このソリューションの不可欠な部分です。</span><span class="sxs-lookup"><span data-stu-id="4033c-p106">InfoPath solves a problem in the area of data gathering that could not be solved before the advent of XML: by providing forms that can grow by adding groups of fields that use the hierarchical data model of XML, InfoPath adds the flexibility of word processor documents to the rigorous validation features of a forms application. Complex XSLT transformations are an integral part of this solution that provides dynamic, easy-to-use views of the XML data.</span></span>
  
## <a name="limitations-of-traditional-forms-and-documents-for-gathering-data"></a><span data-ttu-id="4033c-116">データ収集に関しての従来のフォームやドキュメントの制限事項</span><span class="sxs-lookup"><span data-stu-id="4033c-116">Limitations of Traditional Forms and Documents for Gathering Data</span></span>

<span data-ttu-id="4033c-117">ユーザーが企業のデータを収集するときに、静的なフォームよりも優れた柔軟性が必要になる一方で、ワープロのドキュメントよりも構造化された編集と検証が必要なことが頻繁にあります。</span><span class="sxs-lookup"><span data-stu-id="4033c-117">When gathering corporate data, users often want more flexibility than static forms provide, but more structured editing and validation than word processor documents provide.</span></span>
  
<span data-ttu-id="4033c-p107">従来のフォームは静的で、長さが限られていました。繰り返し行の数が固定されていて、フォームへの記入中は拡張できません。従来のフォームは、リッチな編集機能がないので、使用しにくく、ユーザーがすべての情報を 1 回のパスで提供する必要があることがよくあります。</span><span class="sxs-lookup"><span data-stu-id="4033c-p107">Traditional forms are static and limited in length. They have a fixed number of repeating rows, and cannot be extended when the form is being filled out. Traditional forms are difficult to use because they do not have rich editing features. Often, the user must provide all the information in one pass.</span></span>
  
<span data-ttu-id="4033c-p108">一方で、ワープロを使用して作成された従来のドキュメントでは、ユーザーはコンテンツの追加と削除を自由にできますが、完全で、構造化された、有効な情報を入力する方法についてのガイダンスはほとんど提供されません。ドキュメント内で定義されたフィールドでは、データの値およびデータの型の検証は、行われないか、または、最小限です。自動的に再利用したり、簡単に参照できるように、フィールド内のデータが適切に分類されていません。データは、構造化されておらず、形式が自由です。"地区"、"都市"、および "州" フィールドのグループへの "住所" ラベルの適用など、情報のグループ化ができません。</span><span class="sxs-lookup"><span data-stu-id="4033c-p108">On the other hand, traditional documents created by using a word processor enable the user to freely add and remove content, but provide little guidance about how to enter complete, structured, and valid information; any fields that are defined in the document have minimal or no validation of data values and data types. Data in the fields is not properly labeled to enable easy referencing and automatic reuse. The data is free-form rather than structured; you cannot group information, such as applying an "Address" label to a group of "Street", "City", and "State" fields.</span></span>
  
<span data-ttu-id="4033c-p109">このように、柔軟性がある一方で構造化された編集の必要性がありますが、XML が登場する前はこういったテクノロジは利用できなかったので、開発者は、大掛かりなコーディングが必要なカスタム アプリケーションを作成する必要がありました。カスタム アプリケーションはコストが高く、変更が困難で、検証のためにカスタムのコーディングが必要です。カスタム アプリケーションには、エンドユーザーのトレーニングが必要なことが多く、結果のデータを他のビジネス プロセスに再利用することは困難です。</span><span class="sxs-lookup"><span data-stu-id="4033c-p109">Thus there is a need for such flexible yet structured editing, but because this kind of technology was not available before the advent of XML, developers have had to create custom applications, which require extensive coding. Custom applications are expensive and difficult to modify, and require custom coding for validation. Custom applications often require end-user training, and it is difficult to reuse the resulting data for other business processes.</span></span>
  
## <a name="providing-structured-editing-by-displaying-xml-data-as-field-groups"></a><span data-ttu-id="4033c-127">XML データをフィールド グループとして表示することによる、構造化された編集の実現</span><span class="sxs-lookup"><span data-stu-id="4033c-127">Providing Structured Editing by Displaying XML Data as Field Groups</span></span>

<span data-ttu-id="4033c-p110">要素および属性を表示せず、DOM ツリーをカスタム定義された XML スキーマに従って有効な状態に保ったままで、XML 要素および属性の追加と削除のための簡単なユーザー インターフェイスをどのように実現するかという、技術的な設計上の重要な問題を解決する必要がありました。ユーザー インターフェイスでは、オプションのサブツリーの挿入、サブツリーの選択肢の置換、既存のサブツリーの拡張などの、DOM ツリーの編集を自然に行うことができるようにする必要がありました。</span><span class="sxs-lookup"><span data-stu-id="4033c-p110">An important technical design problem that had to be solved was how to provide an easy user interface for adding and removing XML elements and attributes, without showing the elements and attributes, but keeping the DOM tree valid according to the custom-defined XML schema. The user interface needed to provide a natural way to edit the DOM tree that includes inserting optional subtrees, replacing choices of subtrees, and extending existing subtrees.</span></span>
  
<span data-ttu-id="4033c-p111">このような簡単なユーザー インターフェイスを実現するために、DOM サブツリーは、フィールド グループ、または、セクションとして表示されます。フィールド グループとは、テキスト ボックスやドロップダウン リストなどの UI コントロールのグループで、ユーザーが階層構造の XML データを視覚的に表示させて編集できる簡単なユーザー インターフェイスとして使用されます。DOM サブツリーが他のサブツリーを含むことや、選択肢や繰り返しになることができるのと同様に、フィールド グループは、他のフィールド グループを含むことや、選択肢や繰り返しになることができます。サブツリーは、ユーザーがフィールド グループにマウス ポインターを置き、フィールド グループ上に表示されるドロップダウン メニューをクリックして、[ **\<フィールド グループ名\> の挿入**] を選択したときに、DOM ツリーに追加されます。</span><span class="sxs-lookup"><span data-stu-id="4033c-p111">To provide this easy user interface, a DOM subtree is displayed as a field group, or section. A field group is a group of UI controls, such as text boxes and drop-down lists, and serves as an easy user interface that enables the user to visualize and edit hierarchical XML data. A field group can contain other field groups and can be optional or repeating, just as a DOM subtree can contain other subtrees and can be optional or repeating. A subtree is added to the DOM tree when the user rests the mouse pointer over a field group, clicks the drop-down menu that appears on the field group, and then selects **Insert \<field group name\>**.</span></span>
  
<span data-ttu-id="4033c-p112">InfoPath は、編集の制約とガイドを行う特定の XML スキーマを使用して、このような XML データの構造化された編集を実現します。スキーマによって、フィールド グループのドロップダウン メニューに [ **挿入**] および [ **削除**] のコマンドが表示されるかどうかが制御されます。スキーマは検証にも使用されます。InfoPath は、XML スキーマがない XML ドキュメントの編集を可能にするために、XML ドキュメントからスキーマを生成できます。</span><span class="sxs-lookup"><span data-stu-id="4033c-p112">InfoPath provides this structured editing of XML data by using the specified XML schema to constrain and guide editing. The schema controls whether the **Insert** and **Remove** commands appear on the drop-down menu for a field group. The schema is also used for validation. To enable editing of an XML document for which there is no XML schema, InfoPath can generate a schema from the XML document.</span></span> 
  
## <a name="providing-easy-to-use-views-of-xml-data-by-using-xslt-transformations"></a><span data-ttu-id="4033c-138">XSLT 変換の使用による、XML データの使いやすいビューの実現</span><span class="sxs-lookup"><span data-stu-id="4033c-138">Providing Easy-to-Use Views of XML Data by Using XSLT Transformations</span></span>

<span data-ttu-id="4033c-p113">技術的な設計上の課題として、どのように UI のビューのコンテンツを XML データの構造とは大きく異なった形で構成できるようにするかという課題を解決する必要もありました。ユーザーが最も理解しやすく、簡単にデータの読み取りや編集ができる方法でデータを提示するには、設計者が、DOM データ ツリー内とは異なる順序でデータを表示でき、一部のデータはビューから省略でき、隣接したデータ ツリーのノードを別々のビューに再構成でき、データ ツリーのさまざまな部分から 1 つのビューへデータを集められる必要があります。</span><span class="sxs-lookup"><span data-stu-id="4033c-p113">Another technical design challenge that needed to be solved was how to enable the content of the UI views to be organized very differently than the structure of the XML data. To present the data in a way that makes the most sense for the user and enables the user to easily read and edit the data, the designer must be able to display data in a different sequence than in the DOM data tree, omit some data from a view, reorganize adjacent data tree nodes into separate views, and collect data from different parts of the data tree into a single view.</span></span>
  
<span data-ttu-id="4033c-p114">そのため、ビューのコンテンツの順序と構造は、DOM ツリーのノードの順序と構造に依存しない必要があります。このように、表示とデータに構造上の依存関係がないため、ビュー内のグループ化されたフィールドと DOM ツリー内のノードとの間での、複雑で動的なバインドやマッピングが必要です。</span><span class="sxs-lookup"><span data-stu-id="4033c-p114">The order and structure of the content of the views must therefore be independent of the order and structure of the DOM tree nodes. This structural independence of presentation and data requires a complex, dynamic binding or mapping between the grouped fields in the views and the nodes in the DOM tree.</span></span>
  
<span data-ttu-id="4033c-p115">InfoPath では、ビューとデータの間のこういった複雑なマッピングを実現するために、XSL 変換 (XSLT) を拡張して使用します。XSLT は、複雑な XSLT 変換をサポートし、動的で柔軟性のあるコンテンツの表示を行うリッチなビューをサポートする、強力なスタイル シート 言語です。ビューごとに 1 つの XSLT ファイルが使用されます。スタイル シートの利用は、SGML および XML のオーサリング ツールでの一般的で定着しているデザイン手法で、XSLT は、こういった複雑な変換に使用されるスタイルシートの W3C 標準です。</span><span class="sxs-lookup"><span data-stu-id="4033c-p115">To provide this complex mapping between views and data, InfoPath uses XSL Transformations (XSLT) extensively. XSLT is a powerful style sheet language that supports complex XSLT transformations and supports rich views with dynamic, flexible presentation of content. One XSLT file is used for each view. By using a style sheet is a common, well-established design approach in SGML and XML authoring tools, and XSLT is the W3C standard for stylesheets that are used for this kind of complex transformation.</span></span>
  
<span data-ttu-id="4033c-p116">ユーザーが DOM 内のサブツリーの構造を変更するたびに全体の XSLT 変換を実行するのを避けるために、アルゴリズムを使用して、ビューのどの部分を更新する必要があるかを特定します。そのため、XSLT スタイル シートの関連する部分のみが適用され、ビューの影響がある部分が更新されます。</span><span class="sxs-lookup"><span data-stu-id="4033c-p116">To avoid running the whole XSLT transformation every time that the user modifies the structure of a subtree in the DOM, algorithms are used to determine which part of the view must be refreshed. Then only the relevant part of the XSLT style sheet is applied, and the affected part of the view is refreshed.</span></span>
  
## <a name="how-xml-standards-are-used-when-editing-a-form"></a><span data-ttu-id="4033c-149">フォームの編集時に XML 標準が使用されるしくみ</span><span class="sxs-lookup"><span data-stu-id="4033c-149">How XML Standards Are Used When Editing a Form</span></span>

<span data-ttu-id="4033c-150">InfoPath は、次のような XML 標準を基にして構築されています。</span><span class="sxs-lookup"><span data-stu-id="4033c-150">InfoPath is built from the ground up on XML standards that includes the following:</span></span>
  
- <span data-ttu-id="4033c-151">拡張マークアップ言語 (XML) 1.0 Second Edition</span><span class="sxs-lookup"><span data-stu-id="4033c-151">Extensible Markup Language (XML) 1.0 Second Edition</span></span>
    
- <span data-ttu-id="4033c-152">XML の名前空間</span><span class="sxs-lookup"><span data-stu-id="4033c-152">Namespaces in XML</span></span>
    
- <span data-ttu-id="4033c-153">XML パス言語 (XPath) 1.0</span><span class="sxs-lookup"><span data-stu-id="4033c-153">XML Path Language (XPath) 1.0</span></span>
    
- <span data-ttu-id="4033c-154">XML スキーマ (XSD) 1.0 パート 1: 構造、および、パート 2: データ型</span><span class="sxs-lookup"><span data-stu-id="4033c-154">XML Schema (XSD) 1.0 Part 1: Structures, and Part 2: Datatypes</span></span>
    
- <span data-ttu-id="4033c-155">拡張スタイルシート言語変換 (XSLT) 1.0</span><span class="sxs-lookup"><span data-stu-id="4033c-155">Extensible Stylesheet Language Transformations (XSLT) 1.0</span></span>
    
- <span data-ttu-id="4033c-156">拡張ハイパーテキスト マークアップ言語 (XHTML) 1.0</span><span class="sxs-lookup"><span data-stu-id="4033c-156">Extensible Hypertext Markup Language (XHTML) 1.0</span></span>
    
- <span data-ttu-id="4033c-157">カスケード スタイル シート (CSS)</span><span class="sxs-lookup"><span data-stu-id="4033c-157">Cascading Style Sheets (CSS)</span></span>
    
- <span data-ttu-id="4033c-158">ドキュメント オブジェクト モデル (DOM) 1.0</span><span class="sxs-lookup"><span data-stu-id="4033c-158">Document Object Model (DOM) 1.0</span></span>
    
- <span data-ttu-id="4033c-159">XML デジタル署名 (XML DSig)</span><span class="sxs-lookup"><span data-stu-id="4033c-159">XML Digital Signatures (XML DSig)</span></span>
    
- <span data-ttu-id="4033c-160">簡易オブジェクト アクセス プロトコル (SOAP) 1.1</span><span class="sxs-lookup"><span data-stu-id="4033c-160">Simple Object Access Protocol (SOAP) 1.1</span></span>
    
- <span data-ttu-id="4033c-161">Web サービス記述言語 (WSDL) 1.1</span><span class="sxs-lookup"><span data-stu-id="4033c-161">Web Services Description Language (WSDL) 1.1</span></span>
    
- <span data-ttu-id="4033c-162">Universal Description, Discovery, and Integration (UDDI) 1.0</span><span class="sxs-lookup"><span data-stu-id="4033c-162">Universal Description, Discovery, and Integration (UDDI) 1.0</span></span>
    
<span data-ttu-id="4033c-p117">たとえば、InfoPath は、さまざまなビジネス プロセスで再利用できる標準的な XML、XSLT、および XSD ファイルを使用し、生成します。InfoPath では、MSXML、SOAP Toolkit、および .NET System.XML 名前空間を使用してこれらの標準をサポートし、XML Web サービスの完全に統合されたサポートを提供します。</span><span class="sxs-lookup"><span data-stu-id="4033c-p117">For example, InfoPath uses and generates standard XML, XSLT, and XSD files that can be reused in various business processes. InfoPath uses MSXML, the SOAP Toolkit, and the .NET System.XML namespace to support these standards, and provides full integrated support for XML Web services.</span></span>
  
<span data-ttu-id="4033c-p118">図 1 は、 **customer** フィールド グループ用の状況依存のドロップダウン メニューを示しています。ユーザーは、別の **customer** フィールド グループを追加したり、この **customer** フィールド グループを削除したり、このフィールド グループ内の購入アイテムの表に **item** 行を追加したり、このフィールド グループ内にオプションの **actions** フィールド グループを挿入したりすることができます。[ **ここをクリックしてください**] のリンクを使用して、別の方法で **actions** フィールド グループを挿入できます。購入アイテムの各行に、短いドロップダウン メニューが表示されます。</span><span class="sxs-lookup"><span data-stu-id="4033c-p118">Figure 1 shows the context-sensitive drop-down menu for a **customer** field group, which enables the user to add another **customer** field group, remove this **customer** field group, insert an **item** row in the table of purchase items in this field group, or insert an optional **actions** field group within this field group. The **Click here** link provides another way to insert the **actions** field group. A shorter drop-down menu appears on each purchase-item row.</span></span> 
  
1. <span data-ttu-id="4033c-p119">InfoPath では、ユーザーは、InfoPath フォーム テンプレートを基にして新しい XML ドキュメントを作成したり、フォーム テンプレートが基になっている既存の XML ドキュメントを開いたりします。XML ドキュメントは、フォーム テンプレートへの参照を含む XML データ ファイルで、XML 名前空間を使用できます。</span><span class="sxs-lookup"><span data-stu-id="4033c-p119">In InfoPath, the user creates a new XML document based on an InfoPath form template, or opens an existing XML document that is based on a form template. The XML document is an XML data file that contains a reference to the form template and can use XML namespaces.</span></span> 
    
    <span data-ttu-id="4033c-p120">フォーム テンプレートは、特別なカスタム定義の XML スキーマに準拠した XML ドキュメントの構造化された編集を可能にするファイルのセットです。フォーム テンプレートを構成するファイルは、一般的なフォルダー内に個別のファイルとしてパッケージされている場合と、キャビネット フォルダー内に存在するファイルとしてパッケージされている場合があります。どちらの場合も、ファイルは、標準的な XML ファイルと、マネージ コード アセンブリなどのオプションのサポート ファイルです。</span><span class="sxs-lookup"><span data-stu-id="4033c-p120">A form template is the set of files that provide structured editing of XML documents that comply with a particular custom-defined XML schema. The files that make up the form template may be packaged as individual files inside a ordinary folder or as files residing in a cabinet folder. In either case, the files are standard XML files and optional supporting files such as managed code assemblies.</span></span>
    
2. <span data-ttu-id="4033c-173">XML 署名を使用して XML ドキュメントにデジタル署名が行われている場合は、InfoPath は、XML ファイルを開く前に、XML ファイルの一貫性を確認します。</span><span class="sxs-lookup"><span data-stu-id="4033c-173">If the XML document is digitally signed using XML Signature, InfoPath confirms that the XML file is consistent before it opens it.</span></span>
    
3. <span data-ttu-id="4033c-174">InfoPath は、XML ドキュメントの DOM データ ツリーをインメモリで作成します。</span><span class="sxs-lookup"><span data-stu-id="4033c-174">InfoPath creates a DOM data tree of the XML document in-memory.</span></span>
    
4. <span data-ttu-id="4033c-p121">DOM ツリーに XSLT 変換が適用され、ユーザーにドキュメントを適切に表示するビューが生成されます。XML ドキュメントの先頭の要素をビューの下部に表示でき、異なる表示方法で別のビューに表示することもできます。ビューは、テキスト ボックス、リッチ テキスト ボックス、日付の選択、ドロップダウン リストなどの、テキストおよびコントロールを含むセクションなどの UI コンテナーで構成されます。コンテナーは、他のコンテナーを含むこともできます。</span><span class="sxs-lookup"><span data-stu-id="4033c-p121">XSLT transformations are applied to the DOM tree, producing views that show an appropriate presentation of the document to the user. Elements at the beginning of the XML document could be displayed at the bottom of the view and also in a different arrangement in another view. The views consist of UI containers such as sections that contain text and controls, such as text boxes, rich text boxes, date pickers, and drop-down lists. Containers can also contain other containers.</span></span>
    
5. <span data-ttu-id="4033c-179">XSLT 変換によって、出力結果として XHTML が生成されて、XHTML の表示を制御するために CSS が使用されます。</span><span class="sxs-lookup"><span data-stu-id="4033c-179">The XSLT transformation produces XHTML as output, and then a CSS is used to control the presentation of the XHTML.</span></span>
    
6. <span data-ttu-id="4033c-p122">XML スキーマで、データ ツリーのノードへのノードの追加が許可されている場合は、ノードにマッピングされたフィールドまたはフィールド グループには、ユーザーがフィールド グループの追加や削除を行うことができるドロップダウン メニューがあります。ユーザーは、繰り返しまたはオプションのフィールド グループの追加、値の入力、オプションの選択、あるいは、リッチ テキストの入力を行って、ドキュメントを編集します。XML スキーマのノードが XHTML のスキーマに関連付けられている場合は、InfoPath によってリッチ テキストを作成するための UI が表示されます。ユーザーがリッチ テキストを入力すると、XHTML コンテンツが DOM 内のサブツリーとして作成されます。</span><span class="sxs-lookup"><span data-stu-id="4033c-p122">If the XML schema allows adding nodes to a node of the data tree, the field or field group that is mapped to the node has a drop-down menu that enables the user to add or remove field groups. The user edits the document by adding a repeating or optional field group, entering a value, selecting an option, or entering rich text. If an XML schema node is associated with the schema for XHTML, InfoPath presents a UI for creating rich text. When the user enters rich text, XHTML content is created as a subtree in the DOM.</span></span>
    
7. <span data-ttu-id="4033c-p123">DOM ツリーは、常に有効な状態に維持されます。ユーザーが XML ドキュメントを編集すると、関連付けられた XML スキーマに対しての編集内容の検証が行われます。DOM 構造およびリーフ ノードの値に対して試行された変更は、データ型および値が有効であることを確認するために、XML スキーマに対して検証が行われます。試行された変更が無効な場合は、検証のダイアログ ボックスが開き、変更は DOM ツリーに適用されません。変更が有効な場合は、DOM ツリーが更新されます。</span><span class="sxs-lookup"><span data-stu-id="4033c-p123">The DOM tree is always kept valid. As the user edits the XML document, the edits are validated against the associated XML schema. The attempted changes to the DOM structure and leaf node values are validated against the XML schema to ensure that their data types and values are valid. If the attempted changes are invalid, a validation dialog box opens, and the changes are not applied to the DOM tree. If the changes are valid, the DOM tree is updated.</span></span>
    
8. <span data-ttu-id="4033c-189">XSLT スタイル シートの必要な部分のみを DOM ツリーに適用することで、ビューの変更された部分が更新されます。</span><span class="sxs-lookup"><span data-stu-id="4033c-189">The changed part of the view is refreshed, by applying only the required parts of the XSLT style sheet to the DOM tree.</span></span>
    
9. <span data-ttu-id="4033c-p124">ユーザーは、単純な HTTP または SOAP を使用して、XML ドキュメントの保存や XML ドキュメントの送信ができます。XML スキーマに照らして有効でない場合は、ユーザーは、ドキュメントの送信が許可されません。</span><span class="sxs-lookup"><span data-stu-id="4033c-p124">The user can save the XML document or submit the XML document by using plain HTTP or SOAP. The user is not allowed to submit the document unless it is valid according to the XML schema.</span></span>
    
## <a name="how-xml-standards-are-used-when-designing-a-form"></a><span data-ttu-id="4033c-192">フォームの設計時に XML 標準が使用されるしくみ</span><span class="sxs-lookup"><span data-stu-id="4033c-192">How XML Standards Are Used When Designing a Form</span></span>

<span data-ttu-id="4033c-p125">既存の XML スキーマを利用したり、XML Web サービスやデータベースに接続して XML スキーマを取得したり、新しいフォームや XML データ ファイルからスキーマを自動的に生成したりすることによって、フォームを設計できます。こういったシナリオを、以下の手順で説明します。図 3 は、フォーム テンプレートの設計のための基本的なユーザー インターフェイスを示しています。</span><span class="sxs-lookup"><span data-stu-id="4033c-p125">You can design a form by starting with an existing XML schema, by connecting to an XML Web service or database and obtaining its XML schema, or by automatically generating a schema from a new form or from an XML data file. These scenarios are described in the following procedures. Figure 3 shows the basic user interface for designing a form template.</span></span>
  
1. <span data-ttu-id="4033c-p126">[ **XML/スキーマ**] フォーム テンプレートを選択して、InfoPath Designer で新しいフォームを作成し、既存の XML スキーマ ファイルをデータ ソースとして選択します。XML スキーマが作業ウィンドウに読み込まれ、ツリー コントロールとして表示されます。</span><span class="sxs-lookup"><span data-stu-id="4033c-p126">Create a new form in the InfoPath Designer by selecting the **XML or Schema** form template, and then select an existing XML schema file as the data source. The XML schema is loaded into the task pane and shown as a tree control.</span></span> 
    
2. <span data-ttu-id="4033c-p127">デザイン レイアウト ツールを使用して、1 つのビューまたは複数のビューで、行や背景デザインなどの UI コントロールのレイアウトを行います。これによって、一部の XSLT 要素が生成されます。XSLT ビューおよび XML スキーマは、自動的にフォーム テンプレートと関連付けられます。</span><span class="sxs-lookup"><span data-stu-id="4033c-p127">Use the design layout tools to lay out the UI controls, such as rows and the background design, in one or more views. This generates some of the XSLT elements. The XSLT views and the XML schema are automatically associated with the form template.</span></span>
    
3. <span data-ttu-id="4033c-p128">ドラッグアンドドロップを使用して、ビュー内で UI コントロールに XML スキーマの要素をマッピングします。InfoPath は、スキーマの要素の種類を基にして、XML スキーマの要素に合った適切なコントロールの選択を支援します。たとえば、XML データ型が DATE の場合、InfoPath は、日付の選択のコントロールを勧めます。InfoPath で、XML スキーマでの選択肢を基に、オプションまたは繰り返しのフィールドのグループを挿入できます。XML スキーマの要素を UI コントロールにマッピングすると、XSLT 構造が生成されます。</span><span class="sxs-lookup"><span data-stu-id="4033c-p128">Map the XML schema elements to the UI controls in the views by using drag-and-drop. InfoPath helps you choose appropriate controls for the XML schema elements, based on the kind of the schema elements. For example, if the XML data type is date, InfoPath suggests a date picker control. Based on choices in the XML schema, InfoPath can insert groups of optional or repeating fields. Mapping the XML schema elements to the UI controls generates the XSLT structure.</span></span>
    
4. <span data-ttu-id="4033c-p129">フォーム テンプレートを保存します。通常のフォルダー内の個別のファイルとして、または、キャビネット フォルダー内のファイルとして、フォーム テンプレートを構成するファイルを保存できます。どちらの場合でも、ファイルは標準的な XML ファイルです。これで、ユーザーが使用できるように、フォーム テンプレートの準備ができます。</span><span class="sxs-lookup"><span data-stu-id="4033c-p129">Save the form template. You can save the files that make up the form template as individual files in a regular folder or as files inside a cabinet folder. In either case, the files are standard XML files. The form template is now ready for the user to use.</span></span>
    
<span data-ttu-id="4033c-p130">フォーム テンプレートには、InfoPath でフォームが開かれたときに構造化された編集を可能にするのに必要な、すべてのセマンティック情報が含まれます。フォーム テンプレートには、マニフェスト ファイル、ビューを定義する XSLT ファイル、データを検証するのに必要な情報、および XML Web サービス用のオプションのリソース識別子が含まれます。</span><span class="sxs-lookup"><span data-stu-id="4033c-p130">A form template contains all the semantic information that is needed to provide structured editing when a form is opened in InfoPath. A form template includes a manifest file, the XSLT files that define the views, the information that is needed to validate data, and an optional resource identifier for an XML Web service.</span></span>
  
<span data-ttu-id="4033c-p131">マニフェストまたはフォーム定義ファイルは、フォーム テンプレートに必要なすべてのファイルのための共通のハブであり、エントリ ポイントです。マニフェストには、フォーム テンプレート内の他のファイルへの参照が含まれ、データの検証および構造化された編集の実現に必要な情報が含まれます。XML スキーマの検証情報は、最終的なユーザー インターフェイスのためにカスタマイズされ、マニフェスト ファイルに追加されます。たとえば、スキーマで、特定のサブツリー内で複数のオプションの要素の挿入が許可されている場合は、ユーザーが 1 つの UI 操作を実行したときに複数のオプションの要素が追加されるように UI を設計できます。このカスタマイズは、一般的なユーザーに優れたユーザー エクスペリエンスを提供するために重要です。</span><span class="sxs-lookup"><span data-stu-id="4033c-p131">The manifest, or form definition file , is the common hub and entry point for all of the files that are required by the form template. The manifest contains references to the other files in the form template, and contains the information that is needed to validate data and provide structured editing. The XML schema validation information is customized for the resulting user interface and added to the manifest file. For example, if the schema allows inserting multiple optional elements in a specific subtree, you can design the UI so that multiple optional elements are added when the user performs a single UI operation. This customization is important for providing a great user experience for the ordinary user.</span></span> 
  
<span data-ttu-id="4033c-p132">既存の XML Web サービスを使用して XML スキーマを提供して、フォームを設計することもできます。その場合は、次の手順を実行します。</span><span class="sxs-lookup"><span data-stu-id="4033c-p132">You can also design a form by using an existing XML Web service to provide the XML schema. To do this:</span></span>
  
1. <span data-ttu-id="4033c-219">UDDI を使用して、関連する Web サービスを探します。</span><span class="sxs-lookup"><span data-stu-id="4033c-219">Use UDDI to locate relevant Web services.</span></span>
    
2. <span data-ttu-id="4033c-p133">使用する Web サービスを選択します。InfoPath は、Web サービスに関連付けられた WSDL ファイルを読み取り、使用される XML スキーマを特定します。</span><span class="sxs-lookup"><span data-stu-id="4033c-p133">Select the Web service to use. InfoPath reads the WSDL file associated with the Web service and identifies the XML schema to be used.</span></span>
    
3. <span data-ttu-id="4033c-222">XML スキーマを開いて、読み込みます。</span><span class="sxs-lookup"><span data-stu-id="4033c-222">Open the XML schema to load it.</span></span>
    
4. <span data-ttu-id="4033c-223">UI コントロールのレイアウトを行い、XML スキーマの要素および属性と関連付けます。</span><span class="sxs-lookup"><span data-stu-id="4033c-223">Lay out the UI controls and associate them with XML schema elements and attributes.</span></span>
    
5. <span data-ttu-id="4033c-224">SOAP を使用する Web サービスへの XML ドキュメントの送信方法を定義します。</span><span class="sxs-lookup"><span data-stu-id="4033c-224">Define how to submit the XML document to the Web service that uses SOAP.</span></span>
    
<span data-ttu-id="4033c-225">フォームを最初から設計して、XML スキーマを自動的に生成する必要がある場合は、次の手順を実行します。</span><span class="sxs-lookup"><span data-stu-id="4033c-225">If you want to design a form from scratch and automatically generate the XML schema:</span></span>
  
1. <span data-ttu-id="4033c-226">[ **ファイル**] タブで、[ **空白のフォーム**] または [ **空白のフォーム (InfoPath Filler)**] フォーム テンプレートのどちらかを選択し、[ **フォームのデザイン**] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="4033c-226">On the **File** tab, select either the **Blank Form** or **Blank Form (InfoPath Filler)** form template, and then click **Design Form**.</span></span>
    
2. <span data-ttu-id="4033c-p134">[ **ホーム**] タブで、[ **コントロール**] グループの右下隅の矢印をクリックして、[ **コントロール**] 作業ウィンドウを表示し、[ **自動的にデータ ソースを作成する**] チェック ボックスがオンになっていることを確認します。このチェック ボックスは、既定でオンになっています。</span><span class="sxs-lookup"><span data-stu-id="4033c-p134">On the **Home** tab, click the arrow in the lower-right corner of the **Controls** group to display the **Controls** task pane, and then make sure that the **Automatically create the data source** check box is selected. (By default, this check box is selected.)</span></span> 
    
3. <span data-ttu-id="4033c-p135">UI コントロールのレイアウトを行います。レイアウトを行うと、InfoPath によって自動的に XML スキーマが作成され 、要素および属性が UI コントロールにマッピングされます。</span><span class="sxs-lookup"><span data-stu-id="4033c-p135">Lay out the UI controls. As you lay them out, InfoPath automatically creates the XML schema and maps its elements and attributes to the UI controls.</span></span>
    
<span data-ttu-id="4033c-231">整形式の XML データ ファイルを利用してフォームを設計するには、次の手順を実行します。</span><span class="sxs-lookup"><span data-stu-id="4033c-231">To design a form by starting with any well-formed XML data file:</span></span>
  
1. <span data-ttu-id="4033c-232">[ **File**] タブで、[ **XML/スキーマ**] フォーム テンプレートを選択し、[ **フォームのデザイン**] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="4033c-232">On the **File** tab, select the **XML or Schema** form template, and then click **Design Form**.</span></span>
    
2. <span data-ttu-id="4033c-p136">**データ ソース ウィザード**で、データ ソースとして使用する XML ファイルを選択します。XML データ ファイルを基にして、自動的に XML スキーマが作成されます。</span><span class="sxs-lookup"><span data-stu-id="4033c-p136">In the **Data Source Wizard**, select the XML file that you want to use as the data source. An XML schema is automatically created, based on the XML data file.</span></span>
    
3. <span data-ttu-id="4033c-235">このセクションで前述したとおりに、UI コントロールのレイアウトを行います。</span><span class="sxs-lookup"><span data-stu-id="4033c-235">Lay out the UI controls as described earlier in this section.</span></span>
    
## <a name="designed-as-an-ideal-client-for-web-services"></a><span data-ttu-id="4033c-236">Web サービスのための理想的なクライアントとしての設計</span><span class="sxs-lookup"><span data-stu-id="4033c-236">Designed as an Ideal Client for Web Services</span></span>

<span data-ttu-id="4033c-p137">幅広い業界全体での Web サービスのサポートが可能になりつつあります。SOAP、UDDI、WSDL などの Web サービスの標準を使用することにより、多数のバックエンドおよび中間層のシステムを構成して通信できます。このような Web サービスに対応したシステムには、データベース、ワークフロー システム、エンタープライズ リソース プラニング (ERP)、カスタマー リレーションシップ マネジメント (CRM) などのシステムが含まれます。InfoPath は、Web サービスを使用して送信されている XML データの表示と編集のための理想的な UI を提供します。図 4 は、XML Web サービスのための統合されたサポートを示しています。</span><span class="sxs-lookup"><span data-stu-id="4033c-p137">Broad industry-wide support for Web services is becoming available. Many back-end and middle-tier systems can be configured to communicate by using Web services standards such as SOAP, UDDI, and WSDL. These Web services-enabled systems include databases, workflow systems, enterprise resource planning (ERP), customer relationship management (CRM), and other systems. Now, InfoPath provides an ideal UI to view and edit the XML data that is being sent through Web services. Figure 4 shows the integrated support for XML Web services.</span></span>
  
<span data-ttu-id="4033c-p138">InfoPath は、データがコンピューター間で完全な XML ドキュメントとして送信される、Web サービスのゆるやかな結合モデルに適しています。この粒度の粗い通信モデルは、Web の非同期な性質に適しています。InfoPath は、XML ドキュメント用のハイレベルなオーサリング ツールとして、リモート プロシージャ コール (RPC) の SOAP エンコードではなく、ドキュメント/リテラル形式の SOAP エンコードをサポートしています。InfoPath は、SOAP メッセージ内で指定された XML スキーマをネイティブで読み取って、ユーザーが XML ドキュメント (対応する Web サービスで生成されるか、または受信される) の表示と編集を簡単にできる UI をスキーマに基づいて作成できるので、Web サービスの理想的なクライアントです。InfoPath は、変更の追跡を含む ADO.NET データセットのサポートも提供します。</span><span class="sxs-lookup"><span data-stu-id="4033c-p138">InfoPath fits well with the loosely coupled model of Web services, in which data is sent between computers as complete XML documents. This coarse-grained communication model fits well with the asynchronous nature of the Web. As a high-level authoring tool for XML documents, InfoPath supports the document/literal SOAP encoding instead of Remote Procedure Call (RPC) SOAP encoding. InfoPath is an ideal client for Web services, because it can natively read the XML schema specified in a SOAP message and then create a UI based on the schema, which enables users to easily view and edit XML documents that are generated or received by the corresponding Web service. InfoPath also provides support for ADO.NET DataSets that includes change-tracking.</span></span>
  
## <a name="terminology"></a><span data-ttu-id="4033c-247">用語集</span><span class="sxs-lookup"><span data-stu-id="4033c-247">Terminology</span></span>

|||
|:-----|:-----|
|<span data-ttu-id="4033c-248">**フィールド グループ:**</span><span class="sxs-lookup"><span data-stu-id="4033c-248">**field group:**</span></span> <br/> |<span data-ttu-id="4033c-p139">セクション、繰り返しセクション、オプションのセクション、または繰り返しテーブル。セクションおよび繰り返しテーブルは、他のコントロールを含み、必要に応じて繰り返されるフォーム上のコントロールです。ユーザーは、フォームに記入する際に、複数のセクションや行を挿入できます。</span><span class="sxs-lookup"><span data-stu-id="4033c-p139">A section, repeating section, optional section, or repeating table. Sections and repeating tables are controls on a form that contain other controls and that repeat as needed. Users can insert multiple sections or rows when filling out the form.</span></span>  <br/> |
|<span data-ttu-id="4033c-252">**DOM ツリー:**</span><span class="sxs-lookup"><span data-stu-id="4033c-252">**DOM tree:**</span></span> <br/> |<span data-ttu-id="4033c-p140">フォームのデータ ソースの構造。特に、InfoPath フォームのためのデータの定義と格納を行うフィールドおよびグループの集まり。</span><span class="sxs-lookup"><span data-stu-id="4033c-p140">The structure of the data source of the form. In particular, the collection of fields and groups that define and store the data for an InfoPath form.</span></span>  <br/> |
   
## <a name="conclusion"></a><span data-ttu-id="4033c-255">終わりに</span><span class="sxs-lookup"><span data-stu-id="4033c-255">Conclusion</span></span>

<span data-ttu-id="4033c-p141">InfoPath では、Open XML 標準を使用して、ユーザーが、データ収集のための、柔軟性がある一方で構造化された XML 編集をできるようにします。階層構造の XML データを視覚的に表示させて編集するための、簡単なユーザー インターフェイスを提供するために、UI コントロールを含む入れ子構造のフィールド グループが DOM ツリーにマッピングされます。XSLT 変換によって、XML データの構造とは異なる形で、UI ビューのコンテンツを構成できます。</span><span class="sxs-lookup"><span data-stu-id="4033c-p141">InfoPath uses open XML standards to provide users with flexible yet structured XML editing for data gathering. To provide an easy user interface for visualizing and editing hierarchical XML data, nested field groups that contains UI controls are mapped to the DOM tree. XSLT transformations enable the content of the UI views to be organized differently than the structure of the XML data.</span></span>
  
<span data-ttu-id="4033c-p142">InfoPath は、静的なフォームよりも優れた柔軟性を提供し、ワープロのドキュメントよりも構造化された編集および検証を行うことができます。従来のドキュメント編集環境の高機能な部分と、フォーム パッケージの厳密なデータ取り込み機能とを組み合わせたハイブリッド ツールで、これを使用することで、一般的なユーザーが、カスタム定義された XML スキーマに属する有効な XML ドキュメントを作成できます。Web サービスの統合されたサポートにより、Web サービスのスキーマに準拠した XML ドキュメントを編集するためのビューを簡単に定義できます。</span><span class="sxs-lookup"><span data-stu-id="4033c-p142">InfoPath provides more flexibility than static forms, with more structured editing and validation than word processor documents. The result is a hybrid tool that combines the best of a traditional document editing experience with the rigorous data-capture capabilities of a forms package, which enables ordinary users to create valid XML documents that belong to a custom-defined XML schema. Integrated support for Web services enables easily defining views for editing XML documents that comply with a Web services schema.</span></span>
  

