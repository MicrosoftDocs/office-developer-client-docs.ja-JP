---
title: InfoPath フォームのデータにデジタル署名する
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
ms.assetid: 7b396d9f-9a47-3170-367f-5d1f0144f927
description: デジタル署名は、マクロまたはドキュメント上にあり、電子的で暗号化ベースの、セキュリティで保護された認証のスタンプです。有効なデジタル署名では、そのデータが署名者からのものであり、署名されてから変更されていないことを確認できます。ドキュメントまたはドキュメント内の特定のデータに署名すると、署名が計算されてドキュメントに追加されます。このようにして、署名は常に署名済みデータと共に移動します。
ms.openlocfilehash: 6c1f5a1c14c15bc88839dc44d9a5a595d8b52893
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/28/2019
ms.locfileid: "33425100"
---
# <a name="digitally-signing-data-in-infopath-forms"></a><span data-ttu-id="e6eb2-106">InfoPath フォームのデータにデジタル署名する</span><span class="sxs-lookup"><span data-stu-id="e6eb2-106">Digitally Signing Data in InfoPath Forms</span></span>

<span data-ttu-id="e6eb2-p102">デジタル署名は、マクロまたはドキュメント上にあり、電子的で暗号化ベースの、セキュリティで保護された認証のスタンプです。有効なデジタル署名では、そのデータが署名者からのものであり、署名されてから変更されていないことを確認できます。ドキュメントまたはドキュメント内の特定のデータに署名すると、署名が計算されてドキュメントに追加されます。このようにして、署名は常に署名済みデータと共に移動します。</span><span class="sxs-lookup"><span data-stu-id="e6eb2-p102">A digital signature is an electronic, encryption-based, secure stamp of authentication on a macro or document. A valid digital signature confirms that the data originated from the signer and has not been altered since it was signed. When documents or certain data in the documents are signed, the signature is computed and added to the document. This way, the signatures will always travel with the signed data.</span></span>
  
<span data-ttu-id="e6eb2-p103">データに署名するには、ユーザーは証明機関に証明書を要求し、その証明書を使用してデジタル署名を作成する必要があります。証明機関は証明書の有効期間と、データの暗号化と署名の作成に必要なキー (公開キーまたは秘密キー) を管理します。</span><span class="sxs-lookup"><span data-stu-id="e6eb2-p103">In order to sign data, users need to request a certificate from a certificate authority, and then use it to create digital signatures. The certificate authority will manage the life cycle of the certificates and keys (public or private) needed to encrypt data and create the signature.</span></span>
  
<span data-ttu-id="e6eb2-p104">それ以降にドキュメントを使用するユーザーは、既存の署名を検証する必要があり、検証の結果に応じて、ドキュメントを編集して署名することができます。正しい検証結果を得るには、検証者は、ドキュメントの元の署名に使用された証明書を発行した証明機関を信頼する必要があります。</span><span class="sxs-lookup"><span data-stu-id="e6eb2-p104">Subsequent users of the document will have to verify existing signatures, and according to the result of the verification, may add their own contribution and sign. For accurate verification results, the verifier must trust the certificate authority who issued the certificate that was used to originally sign the document.</span></span>
  
<span data-ttu-id="e6eb2-p105">XML デジタル署名は、XML ドキュメントおよびデータが関連するトランザクション用に設計されています。XML 署名の威力は、XML ドキュメントの特定のデータのみに署名できる機能にあります。</span><span class="sxs-lookup"><span data-stu-id="e6eb2-p105">XML digital signatures are designed for transactions that involve XML documents and data. The power of XML signatures stays in the ability to sign only specific data in an XML document.</span></span>
  
## <a name="types-of-digital-signatures-in-infopath-forms"></a><span data-ttu-id="e6eb2-117">InfoPath フォームのデジタル署名の種類</span><span class="sxs-lookup"><span data-stu-id="e6eb2-117">Types of Digital Signatures in InfoPath Forms</span></span>

<span data-ttu-id="e6eb2-p106">Microsoft InfoPath は、デジタル署名を実装して、InfoPath フォームのデータをセキュリティで保護します。InfoPath に用意されているデジタル署名は次の 2 種類です。</span><span class="sxs-lookup"><span data-stu-id="e6eb2-p106">Microsoft InfoPath implements digital signatures to help secure data in InfoPath forms. Two kinds of digital signatures are featured in InfoPath:</span></span>
  
- <span data-ttu-id="e6eb2-120">フォーム テンプレート (.xsn ファイル) のデータの整合性と信頼性を確実にするデジタル署名</span><span class="sxs-lookup"><span data-stu-id="e6eb2-120">Digital signatures that ensure the data integrity and authenticity of the form template (.xsn file)</span></span>
    
- <span data-ttu-id="e6eb2-121">XML フォームのデータに関連する整合性、信頼性、および否認防止のサポートを確実にするデジタル署名</span><span class="sxs-lookup"><span data-stu-id="e6eb2-121">Digital signatures that ensure the integrity, authenticity, and support for non-repudiation related to data in XML forms</span></span>
    
<span data-ttu-id="e6eb2-p107">署名の最初のカテゴリは、フォーム テンプレート (.xsn ファイル) が対象であり、2 番目のカテゴリは、InfoPath フォーム ファイル (.xml ファイル) で実際にユーザーが入力したデータが対象です。ここでは、フォーム デザイナーはユーザーがフォーム全体またはフォームの一部のみに対してデジタル署名を作成するようにできます。署名されたテンプレートと署名されたフォームには基本的な違いがあります。このドキュメントでは、署名されたテンプレートについて (完全に信頼できるものとして実行されるフォームを作成するための別の方法として) いくらか説明しますが、この種類の署名の詳細については説明しません。フォーム テンプレートの署名方法の詳細については、「[署名済み InfoPath フォーム テンプレートを展開する](deploying-signed-infopath-form-templates.md)」を参照してください。このトピックでは、署名された InfoPath XML フォームの使用について主に説明します。XML フォームのデータに署名するために InfoPath で作成されるデジタル署名は、W3C の XML デジタル署名の仕様に準拠しています。</span><span class="sxs-lookup"><span data-stu-id="e6eb2-p107">Whereas the first category of signatures is targeting the form template (.xsn file), the second category targets the actual user-entered data in InfoPath form files (.xml files), where the form designer can enable users to create digital signatures for the whole form or for sections of the form. There are fundamental differences between a signed template and a signed form. Although this document will have some references to signed templates (as an alternative way to create a form that will run as fully trusted), it does not provide details about this kind of signing. For more information about how to sign form templates, see [Deploying Signed InfoPath Form Templates](deploying-signed-infopath-form-templates.md) The focus in this topic is using signed InfoPath XML forms. Digital signatures created by InfoPath to sign data in XML forms comply with W3C XML Digital Signatures specifications.</span></span> 
  
## <a name="digital-signatures-features"></a><span data-ttu-id="e6eb2-127">デジタル署名の機能</span><span class="sxs-lookup"><span data-stu-id="e6eb2-127">Digital Signatures Features</span></span>

<span data-ttu-id="e6eb2-p108">InfoPath では、拡張デジタル署名機能が用意されていて、テンプレート開発者はフォーム全体またはフォームの特定のデータに対してデジタル署名を有効にする、柔軟性のあるフォームをデザインできます。フォーム全体にデジタル署名すると、常にフォームに対する連署がエンティティとして作成され、InfoPath フォームの一部に署名すると、データの同じセットに追加された署名の関係の種類 (副署名、連署、または 1 つの署名のみを許可) を選択する柔軟性が得られます。</span><span class="sxs-lookup"><span data-stu-id="e6eb2-p108">InfoPath offers an extended digital signatures feature, with template developers being able to design flexible forms that enable digital signatures either for the whole form or for specific data in the form. Whereas digitally signing the whole form will always create counter-signatures for the form as an entity, signing parts of InfoPath forms enables more flexibility in choosing the kind of relationship between signatures added to the same set of data: there can be co-signatures, counter-signatures, or only one signature allowed.</span></span>
  
<span data-ttu-id="e6eb2-p109">InfoPath では、署名により、ユーザーが現在のビューで表示したデータを確認するための否認防止情報が既定で追加されると共に、署名が作成されたときに設定された時間およびその他の環境設定が追加されます。否認防止情報はカスタマイズできますが、否認防止のダイアログ ボックスには、否認防止の既定のノードのデータのみが表示されます。</span><span class="sxs-lookup"><span data-stu-id="e6eb2-p109">With the signature, InfoPath will also add by default some non-repudiation information to identify the data users have seen in the current view, as well as the time and other environment settings as they were set when the signature was created. The non-repudiation information can be customized, but only the data in default non-repudiation nodes will be displayed in the non-repudiation dialog.</span></span>
  
<span data-ttu-id="e6eb2-p110">署名を追加するには、ユーザーは署名するデータのセットを選択する必要があります。署名できるデータのセットはフォーム テンプレート デザイナーによって定義され、フォームの入力時にデータに署名するために使用されます。ユーザーは、署名ごとに、デジタル署名ウィザードに従って、署名可能なデータのセットの選択、証明書の選択、コメントの追加、およびフォームへの署名の承認とコミットを行う必要があります。</span><span class="sxs-lookup"><span data-stu-id="e6eb2-p110">In order to add a signature, users have to select the set of data that will be signed. The set of data that can be signed is defined by the form template designer and used to sign the data when filling out the form. For each signature, users will have to follow a digital signature wizard for selecting the set of signable data, selecting a certificate, adding comments, and approving and committing the signature to the form.</span></span>
  
<span data-ttu-id="e6eb2-p111">ユーザーが、署名済みデータを含むコントロールの上にマウス ポインターを移動すると、そのデータが署名済みで変更できないことが視覚的に示されます。フォーム テンプレート デザイナーは、署名済みデータが含まれている状態で署名がビューに表示されるようにすることで、ユーザーが否認防止情報に簡単にアクセスできるようにすることができます。</span><span class="sxs-lookup"><span data-stu-id="e6eb2-p111">When a user rests the mouse over a control that contains signed data, InfoPath displays a visual indication that the data is signed and cannot be changed. Form template designers can choose to have the signatures displayed in the view with the signed data so that users can take advantage of easy access to the non-repudiation information.</span></span>
  
## <a name="programmatic-support-for-digital-signatures"></a><span data-ttu-id="e6eb2-137">デジタル署名のプログラム的なサポート</span><span class="sxs-lookup"><span data-stu-id="e6eb2-137">Programmatic Support for Digital Signatures</span></span>

<span data-ttu-id="e6eb2-p112">InfoPath オブジェクト モデルにはデジタル署名のサポートが含まれています。これにより、開発者は、[SignedDataBlockCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SignedDataBlockCollection.aspx) クラスを通じて、フォームに定義されている署名可能なデータのセットにプログラム的にアクセスし、 [SignatureCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SignatureCollection.aspx) クラスを通じて、署名済みデータの各セットに割り当てられている署名にプログラム的にアクセスし、 [Certificate](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Certificate.aspx) クラスを通じて、署名を作成するために使用されている証明書にプログラム的にアクセスできます。さらに、 [Sign](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormEvents.Sign.aspx) イベント ハンドラーは完全に信頼できるフォームでカスタマイズ可能であり、InfoPath フォームのデジタル署名の高度な処理のサポートが提供されます。</span><span class="sxs-lookup"><span data-stu-id="e6eb2-p112">The InfoPath object model includes support for digital signatures, which enables developers programmatic access to the sets of signable data are defined in the form through the [SignedDataBlockCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SignedDataBlockCollection.aspx) class, to the signatures assigned to each set of signed data through the [SignatureCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SignatureCollection.aspx) class, and to the certificate that is used to create a signature through the [Certificate](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Certificate.aspx) class. Additionally, the [Sign](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormEvents.Sign.aspx) event handler is customizable in fully trusted forms, offering support for advanced processing of digital signatures in InfoPath forms.</span></span> 
  
## <a name="interoperability"></a><span data-ttu-id="e6eb2-140">相互運用性</span><span class="sxs-lookup"><span data-stu-id="e6eb2-140">Interoperability</span></span>

<span data-ttu-id="e6eb2-141">InfoPath のデジタル署名のインフラストラクチャは、MSXML5 のデジタル署名のサポートを使用して設計されているため、InfoPath デジタル署名は、MSXML5 デジタル署名と完全な相互運用性があります。</span><span class="sxs-lookup"><span data-stu-id="e6eb2-141">The infrastructure for digital signatures in InfoPath was designed by using the digital signatures support in MSXML5 so that InfoPath digital signatures have full interoperability with MSXML5 digital signatures.</span></span>
  
<span data-ttu-id="e6eb2-p113">署名された InfoPath フォームおよび InfoPath で作成されたデジタル署名は、Microsoft .NET Framework (バージョン 1.1 から始まる) を使用して作成されたデジタル署名とも完全な相互運用性があります。InfoPath で作成されたデジタル署名は, .NET Framework 署名の検証クラスを使用するアプリケーションによって検証できます。.NET Framework デジタル署名のクラスを使用して設計されたアプリケーションによって InfoPath フォームでホストされたデータ用に作成された署名は、InfoPath のデジタル署名メカニズムで正しく検証されます。</span><span class="sxs-lookup"><span data-stu-id="e6eb2-p113">Signed InfoPath forms and digital signatures created by InfoPath will also provide full interoperability with digital signatures created by using the Microsoft .NET Framework (starting with version 1.1). Signatures created by InfoPath can be verified by applications that use .NET Framework signature verification classes. Signatures created for data hosted in InfoPath forms by applications designed using .NET Framework digital signatures classes are successfully verified by InfoPath's digital signatures mechanism.</span></span>
  
## <a name="see-also"></a><span data-ttu-id="e6eb2-145">関連項目</span><span class="sxs-lookup"><span data-stu-id="e6eb2-145">See also</span></span>



[<span data-ttu-id="e6eb2-146">デジタル署名を操作する</span><span class="sxs-lookup"><span data-stu-id="e6eb2-146">Work with Digital Signatures</span></span>](how-to-work-with-digital-signatures.md)

