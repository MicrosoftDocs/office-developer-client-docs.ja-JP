---
title: エラーを処理する
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
keywords:
- エラー [infopath 2007],処理,FormErrorCollection [InfoPath 2007],InfoPath 2007,エラー処理,FormError [InfoPath 2007],エラー処理 [InfoPath 2007]
localization_priority: Normal
ms.assetid: 132cb698-d9a5-4767-b3d1-5dd1343a1ff4
description: カスタム アプリケーションを作成するときに、開発者はエラー処理を行わなければならないことがよくあります。エラー処理では、アプリケーションで発生したエラーをチェックしたり、カスタム エラーを作成して発生させたりするプログラミング コードを記述します。Microsoft.Office.InfoPath 名前空間によって提供される InfoPath オブジェクト モデルでは、FormError クラスを FormErrorCollection クラスと共に使用するエラー処理がサポートされています。
ms.openlocfilehash: 30cf649188b7e4cbc35469d2a50540bb13ecb38d
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/23/2019
ms.locfileid: "32303606"
---
# <a name="handle-errors"></a><span data-ttu-id="e0d78-105">エラーを処理する</span><span class="sxs-lookup"><span data-stu-id="e0d78-105">Handle Errors</span></span>

<span data-ttu-id="e0d78-p102">カスタム アプリケーションを作成するときに、開発者はエラー処理を行わなければならないことがよくあります。エラー処理では、アプリケーションで発生したエラーをチェックしたり、カスタム エラーを作成して発生させたりするプログラミング コードを記述します。[Microsoft.Office.InfoPath](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.aspx) 名前空間によって提供される InfoPath オブジェクト モデルでは、 [FormError](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormError.aspx) クラスを [FormErrorCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormErrorCollection.aspx) クラスと共に使用するエラー処理がサポートされています。</span><span class="sxs-lookup"><span data-stu-id="e0d78-p102">When creating custom applications, developers must often perform error handling that involves writing programming code to check for errors raised by the application or to create and raise custom errors. The InfoPath object model provided by the [Microsoft.Office.InfoPath](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.aspx) namespace supports error handling through the use of the [FormError](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormError.aspx) class in association with the [FormErrorCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormErrorCollection.aspx) class.</span></span> 
  
<span data-ttu-id="e0d78-108">InfoPath では、次のような場合にエラーが発生する可能性があります。</span><span class="sxs-lookup"><span data-stu-id="e0d78-108">In InfoPath, errors can occur for the following reasons:</span></span>
  
- <span data-ttu-id="e0d78-109">フォームに入力されたデータが XML スキーマの検証に失敗したとき。</span><span class="sxs-lookup"><span data-stu-id="e0d78-109">When data entered into a form fails XML schema validation.</span></span>
    
- <span data-ttu-id="e0d78-110">カスタム検証の制約に違反があったとき。</span><span class="sxs-lookup"><span data-stu-id="e0d78-110">When a custom validation constraint fails.</span></span>
    
- <span data-ttu-id="e0d78-111">[XmlValidatingEventArgs](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlValidatingEventArgs.ReportError.aspx) イベント オブジェクトの [ReportError](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlValidatingEventArgs.aspx) メソッドによってエラーが生成されたとき。</span><span class="sxs-lookup"><span data-stu-id="e0d78-111">When an error is generated by the [ReportError](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlValidatingEventArgs.ReportError.aspx) method of the [XmlValidatingEventArgs](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlValidatingEventArgs.aspx) event object.</span></span> 
    
- <span data-ttu-id="e0d78-112">[FormErrorCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormErrorCollection.Add.aspx) クラスの [Add](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormErrorCollection.aspx) メソッドを使用してユーザー定義エラーが作成されたとき。</span><span class="sxs-lookup"><span data-stu-id="e0d78-112">When a user-defined error is created using the [Add](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormErrorCollection.Add.aspx) method of the [FormErrorCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormErrorCollection.aspx) class.</span></span> 
    
## <a name="overview-of-the-formerrorcollection-class"></a><span data-ttu-id="e0d78-113">FormErrorCollection クラスの概要</span><span class="sxs-lookup"><span data-stu-id="e0d78-113">Overview of the FormErrorCollection Class</span></span>

<span data-ttu-id="e0d78-114">[FormErrorCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormErrorCollection.aspx) クラスには、次のメソッドとプロパティがあります。フォームの開発者は、これらを使用することにより、コレクションに含まれている [FormError](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormError.aspx) オブジェクトを管理できます。</span><span class="sxs-lookup"><span data-stu-id="e0d78-114">The [FormErrorCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormErrorCollection.aspx) class provides the following methods and properties, which form developers can use to manage the [FormError](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormError.aspx) objects that the collection contains.</span></span> 
  
|<span data-ttu-id="e0d78-115">**[名前]**</span><span class="sxs-lookup"><span data-stu-id="e0d78-115">**Name**</span></span>|<span data-ttu-id="e0d78-116">**[説明]**</span><span class="sxs-lookup"><span data-stu-id="e0d78-116">**Description**</span></span>|
|:-----|:-----|
|<span data-ttu-id="e0d78-117">[Add](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormErrorCollection.Add.aspx) メソッド (+3 オーバーロード)</span><span class="sxs-lookup"><span data-stu-id="e0d78-117">[Add](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormErrorCollection.Add.aspx) method (+3 overloads)</span></span>  <br/> |<span data-ttu-id="e0d78-118">**FormError** オブジェクトを作成し、それをコレクションに追加します。</span><span class="sxs-lookup"><span data-stu-id="e0d78-118">Creates a **FormError** object and adds it to the collection.</span></span>  <br/> |
|<span data-ttu-id="e0d78-119">[Delete](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormErrorCollection.Delete.aspx) メソッド (+1 オーバーロード)</span><span class="sxs-lookup"><span data-stu-id="e0d78-119">[Delete](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormErrorCollection.Delete.aspx) method (+1 overload)</span></span>  <br/> |<span data-ttu-id="e0d78-120">指定したユーザー定義エラーをコレクションから削除します。</span><span class="sxs-lookup"><span data-stu-id="e0d78-120">Deletes the specified user-defined error from the collection.</span></span>  <br/> |
|<span data-ttu-id="e0d78-121">[DeleteAll](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormErrorCollection.DeleteAll.aspx) メソッド</span><span class="sxs-lookup"><span data-stu-id="e0d78-121">[DeleteAll](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormErrorCollection.DeleteAll.aspx) method</span></span>  <br/> |<span data-ttu-id="e0d78-122">コレクションに含まれているすべての **FormError** オブジェクトを削除します。</span><span class="sxs-lookup"><span data-stu-id="e0d78-122">Deletes all **FormError** objects contained in the collection.</span></span>  <br/> |
|<span data-ttu-id="e0d78-123">[GetErrors](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormErrorCollection.GetErrors.aspx) (+1 オーバーロード)</span><span class="sxs-lookup"><span data-stu-id="e0d78-123">[GetErrors](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormErrorCollection.GetErrors.aspx) (+1 overload)</span></span>  <br/> |<span data-ttu-id="e0d78-124">指定した名前または型のすべての **FormError** オブジェクトをコレクションから返します。</span><span class="sxs-lookup"><span data-stu-id="e0d78-124">Returns all **FormError** objects of the specified name or type from the collection.</span></span>  <br/> |
|<span data-ttu-id="e0d78-125">[Count](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormErrorCollection.Count.aspx) プロパティ</span><span class="sxs-lookup"><span data-stu-id="e0d78-125">[Count](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormErrorCollection.Count.aspx) property</span></span>  <br/> |<span data-ttu-id="e0d78-126">コレクションに含まれている **FormError** オブジェクトの数を取得します。</span><span class="sxs-lookup"><span data-stu-id="e0d78-126">Gets a count of the number of **FormError** objects contained in the collection.</span></span>  <br/> |
|<span data-ttu-id="e0d78-127">[Item](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormErrorCollection.Item.aspx) プロパティ</span><span class="sxs-lookup"><span data-stu-id="e0d78-127">[Item](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormErrorCollection.Item.aspx) property</span></span>  <br/> |<span data-ttu-id="e0d78-128">指定したインデックス番号に基づく **FormError** オブジェクトへの参照を取得します。</span><span class="sxs-lookup"><span data-stu-id="e0d78-128">Gets a reference to an **FormError** object based on the specified index number.</span></span>  <br/> |
   
## <a name="overview-of-the-formerror-class"></a><span data-ttu-id="e0d78-129">FormError クラスの概要</span><span class="sxs-lookup"><span data-stu-id="e0d78-129">Overview of the FormError Class</span></span>

<span data-ttu-id="e0d78-130">[FormError](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormError.aspx) クラスには、次のプロパティがあります。フォームの開発者は、これらを使用することにより、発生したエラーに関する情報にアクセスできます。</span><span class="sxs-lookup"><span data-stu-id="e0d78-130">The [FormError](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormError.aspx) class provides the following properties, which form developers can use to access information about the error that was raised.</span></span> 
  
|<span data-ttu-id="e0d78-131">**[名前]**</span><span class="sxs-lookup"><span data-stu-id="e0d78-131">**Name**</span></span>|<span data-ttu-id="e0d78-132">**[説明]**</span><span class="sxs-lookup"><span data-stu-id="e0d78-132">**Description**</span></span>|
|:-----|:-----|
|<span data-ttu-id="e0d78-133">[DetailedMessage](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormError.DetailedMessage.aspx) プロパティ</span><span class="sxs-lookup"><span data-stu-id="e0d78-133">[DetailedMessage](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormError.DetailedMessage.aspx) property</span></span>  <br/> |<span data-ttu-id="e0d78-134">**FormError** オブジェクトの詳細なエラー メッセージを取得または設定します。</span><span class="sxs-lookup"><span data-stu-id="e0d78-134">Gets or sets the detailed error message of the **FormError** object.</span></span>  <br/> |
|<span data-ttu-id="e0d78-135">[ErrorCode](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormError.ErrorCode.aspx) プロパティ</span><span class="sxs-lookup"><span data-stu-id="e0d78-135">[ErrorCode](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormError.ErrorCode.aspx) property</span></span>  <br/> |<span data-ttu-id="e0d78-136">**FormError** オブジェクトのエラー コードを取得または設定します。</span><span class="sxs-lookup"><span data-stu-id="e0d78-136">Gets or sets the error code of the **FormError** object.</span></span>  <br/> |
|<span data-ttu-id="e0d78-137">[Site](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormError.Site.aspx) プロパティ</span><span class="sxs-lookup"><span data-stu-id="e0d78-137">[Site](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormError.Site.aspx) property</span></span>  <br/> |<span data-ttu-id="e0d78-138">**FormError** オブジェクトに関連付けられたノードにある **XPathNavigator** オブジェクトを取得します。</span><span class="sxs-lookup"><span data-stu-id="e0d78-138">Gets an **XPathNavigator** object that is positioned at the node associated with the **FormError** object.</span></span>  <br/> |
|<span data-ttu-id="e0d78-139">[Message](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormError.Message.aspx) プロパティ</span><span class="sxs-lookup"><span data-stu-id="e0d78-139">[Message](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormError.Message.aspx) property</span></span>  <br/> |<span data-ttu-id="e0d78-140">**FormError** オブジェクトの短いエラー メッセージを取得または設定します。</span><span class="sxs-lookup"><span data-stu-id="e0d78-140">Gets or sets the short error message of the **FormError** object.</span></span>  <br/> |
|<span data-ttu-id="e0d78-141">[FormErrorType](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormError.FormErrorType.aspx) プロパティ</span><span class="sxs-lookup"><span data-stu-id="e0d78-141">[FormErrorType](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormError.FormErrorType.aspx) property</span></span>  <br/> |<span data-ttu-id="e0d78-142">**FormError** オブジェクトの型を取得します。</span><span class="sxs-lookup"><span data-stu-id="e0d78-142">Gets the type of the **FormError** object.</span></span>  <br/> |
   
## <a name="using-the-formerrorcollection-and-formerror-classes"></a><span data-ttu-id="e0d78-143">FormErrorCollection クラスおよび FormError クラスを使用する</span><span class="sxs-lookup"><span data-stu-id="e0d78-143">Using the FormErrorCollection and FormError Classes</span></span>

<span data-ttu-id="e0d78-p103">フォームに関連付けられた **FormErrorCollection** オブジェクトにアクセスするには、 [XmlForm](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.Errors.aspx) オブジェクトの [Errors](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.aspx) プロパティを使用します。 **FormErrorCollection** オブジェクトはフォームの基になる XML ドキュメントに関連付けられているため、エラーが発生した場合は、現在の XML ドキュメント内でそのエラーや追加のエラーにアクセスし、エラーを管理することができます。次の例では、ループを使用して、フォームの基になる XML ドキュメント内にあるエラーをチェックする方法を示します。エラーがある場合は、関数で各エラーをループ処理し、 **FormError** オブジェクトの **Message** プロパティを使用して、ユーザーにメッセージ ボックスを表示します。</span><span class="sxs-lookup"><span data-stu-id="e0d78-p103">The **FormErrorCollection** object associated with a form is accessed through the [Errors](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.Errors.aspx) property of the [XmlForm](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.aspx) object. The **FormErrorCollection** object is associated with a form's underlying XML document so that when an error occurs, it and any additional errors can be accessed and managed within the current XML document. The following example demonstrates how a loop can be used to check the errors that may exist in a form's underlying XML document. If there are errors, the function loops through each of them, and, using the **Message** property of the **FormError** object, displays a message box to the user.</span></span> 
  
```cs
public void CheckErrors(XPathNavigator xmlNode)
{
   foreach(FormError err in this.Errors)
   {
      if(xmlNode.InnerXml == err.Site.InnerXml)
         MessageBox.Show("The following error has occured: "
             + err.Message);
   }
}
```

```vb
Public Sub CheckErrors(ByVal xmlNode As XPathNavigator)
   Dim err As FormError
   For Each err In Me.Errors
      If xmlNode.InnerXml = err.Site.InnerXml Then
         MessageBox.Show("The following error has occured: " _
             &amp; err.Message)
   End If
End Sub
```

<span data-ttu-id="e0d78-p104">上の関数は、フォームのデータ検証イベント ハンドラーの 1 つから呼び出すことができます。たとえば、フォーム内のフィールドの [Changed](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlEvent.Changed.aspx) イベントのイベント ハンドラーで使用した場合、関数の呼び出しにより、次のように [XmlEventArgs](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlEventArgs.Site.aspx) イベント オブジェクトの [Site](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlEventArgs.aspx) プロパティを使用して XML ノードが引数として渡されます。</span><span class="sxs-lookup"><span data-stu-id="e0d78-p104">The preceding function could be called from one of the form's data validation event handlers. For example, when used in the event handler for the [Changed](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlEvent.Changed.aspx) event of a field in the form, the call to the function would pass the XML node argument using the [Site](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlEventArgs.Site.aspx) property of the [XmlEventArgs](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlEventArgs.aspx) event object as follows.</span></span> 
  
```cs
CheckErrors(e.Site);
```

```vb
CheckErrors(e.Site)
```

<span data-ttu-id="e0d78-p105">InfoPath によって生成されるエラーの処理に加えて、フォームの開発者は、[XmlValidatingEventArgs](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlValidatingEventArgs.ReportError.aspx) イベント オブジェクトの [ReportError(XPathNavigator, Boolean, String)](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlValidatingEventArgs.aspx) メソッド、または [FormErrorCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormErrorCollection.Add.aspx) クラスの [Add](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormErrorCollection.aspx) メソッドを使用して、カスタム エラーを生成することもできます。 [ReportError(XPathNavigator, Boolean, String)](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlValidatingEventArgs.ReportError.aspx) メソッドまたは [Add](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormErrorCollection.Add.aspx) メソッドの使用方法については、このトピックの先頭にあるそれぞれのメソッドのリンクをクリックしてください。</span><span class="sxs-lookup"><span data-stu-id="e0d78-p105">In addition to handling errors generated by InfoPath, form developers can also generate custom errors by using the [ReportError(XPathNavigator, Boolean, String)](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlValidatingEventArgs.ReportError.aspx) method of the [XmlValidatingEventArgs](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlValidatingEventArgs.aspx) event object, or by using the [Add](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormErrorCollection.Add.aspx) method of the [FormErrorCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormErrorCollection.aspx) class. For information about using the [ReportError(XPathNavigator, Boolean, String)](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlValidatingEventArgs.ReportError.aspx) or [Add](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormErrorCollection.Add.aspx) methods, click the links for those methods at the beginning of this topic.</span></span> 
  
## <a name="handling-managed-code-exceptions"></a><span data-ttu-id="e0d78-152">マネージ コードの例外を処理する</span><span class="sxs-lookup"><span data-stu-id="e0d78-152">Handling Managed-Code Exceptions</span></span>

<span data-ttu-id="e0d78-153">try-catch 例外処理を使用すると、次のコードに示すようにマネージ コード フォーム テンプレート内で発生した例外を処理することができます。</span><span class="sxs-lookup"><span data-stu-id="e0d78-153">You can use try-catch exception handling to handle exceptions raised in managed-code form template as shown in the following code example.</span></span>
  
```cs
FileQueryConnection queryXMLFile = 
   (FileQueryConnection)this.DataConnections["form1"];
// Perform the query.
try
{
   queryXMLFile.Execute();
}
catch (Exception ex)
{
   MessageBox.Show("Failed to query." + System.Environment.NewLine 
      + ex.Message);
}
```

```vb
Dim queryXMLFile As FileQueryConnection = _
   DirectCast(Me.DataConnections("form1"), FileQueryConnection)
' Perform the query.
Try
   queryXMLFile.Execute();
Catch ex As Exception
   MessageBox.Show("Failed to query." &amp; System.Environment.NewLine 
      &amp; ex.Message)
End Try
```

<span data-ttu-id="e0d78-p106">フォーム コード内で try-catch 例外処理を使用していないと、デバッグ中およびプレビュー中に、未処理の例外に関する情報が InfoPath によって InfoPath のエラー ダイアログ ボックスに表示されます。また、既定では、マネージ コード フォーム テンプレートを展開した場合の実行時には、未処理の例外は Info Path エラー ダイアログ ボックスに表示されません。実行時に未処理の例外に関する情報を表示するには、次の手順を使用します。</span><span class="sxs-lookup"><span data-stu-id="e0d78-p106">If you do not use try-catch exception handling in your form code, InfoPath will display information about unhandled exceptions in the InfoPath error dialog box while debugging and previewing. Additionally, by default, unhandled exceptions are not displayed in the InfoPath error dialog box at run time when you deploy your managed-code form template. To display information about unhandled exceptions at run time, use the following procedure.</span></span>
  
### <a name="enable-notifications-for-unhandled-managed-code-exceptions-at-run-time"></a><span data-ttu-id="e0d78-157">未処理のマネージ コード例外の実行時の通知を有効にする</span><span class="sxs-lookup"><span data-stu-id="e0d78-157">Enable notifications for unhandled managed-code exceptions at run time</span></span>

1. <span data-ttu-id="e0d78-158">InfoPath デザイン モードを開いて、[ **ファイル**] タブをクリックします。</span><span class="sxs-lookup"><span data-stu-id="e0d78-158">Open the InfoPath designer, and then click the **File** tab.</span></span> 
    
2. <span data-ttu-id="e0d78-159">[ **オプション**] をクリックして、[ **基本設定**] カテゴリの [ **InfoPath オプション**] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="e0d78-159">Click **Options**, and then click **InfoPath Options** under the **General** category.</span></span> 
    
3. <span data-ttu-id="e0d78-160">[ **詳細設定**] タブで、[ **Visual Basic または Visual C# コードのエラーを表示する**] チェック ボックスをオンにします。</span><span class="sxs-lookup"><span data-stu-id="e0d78-160">On the **Advanced** tab, select the **Show a notification for Visual Basic and C# code errors** check box.</span></span> 
    

