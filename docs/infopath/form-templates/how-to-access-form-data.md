---
title: フォーム データにアクセスする
manager: soliver
ms.date: 12/07/2015
ms.audience: Developer
keywords:
- form data [infopath 2007],forms [InfoPath 2007], accessing properties,form templates [InfoPath 2007], accessing properties,opening forms [InfoPath 2007],printing forms [InfoPath 2007],forms [InfoPath 2007], printing,closing forms [InfoPath 2007],InfoPath 2007, accessing form data,forms [InfoPath 2007], accessing data source,forms [InfoPath 2007], closing,forms [InfoPath 2007], opening,printing [InfoPath 2007], forms,forms [InfoPath 2007], creating
localization_priority: Normal
ms.assetid: fd7374d3-a268-4e30-9872-7579cd681bd0
description: InfoPath フォームの機能を拡張しようと思うと、多くの場合、フォームの基になる XML ドキュメントに関する情報へのアクセス、XML ドキュメントに記述されているデータへのアクセス、XML ドキュメントに対する何らかの操作の実行などの処理をプログラムで行う必要が出てきます。InfoPath オブジェクト モデルでは、XmlForm クラスと XmlFormCollection クラスを関連させて使用することにより、フォームの基になる XML ドキュメントにアクセスしたり、その XML ドキュメントを操作したりすることができます。
ms.openlocfilehash: c8251afcd75391f102215811694515c06b9f3e7e
ms.sourcegitcommit: ef717c65d8dd41ababffb01eafc443c79950aed4
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 10/04/2018
ms.locfileid: "25386832"
---
# <a name="access-form-data"></a><span data-ttu-id="086db-105">フォーム データにアクセスする</span><span class="sxs-lookup"><span data-stu-id="086db-105">Access Form Data</span></span>

<span data-ttu-id="086db-p102">InfoPath フォームの機能を拡張しようと思うと、多くの場合、フォームの基になる XML ドキュメントに関する情報へのアクセス、XML ドキュメントに記述されているデータへのアクセス、XML ドキュメントに対する何らかの操作の実行などの処理をプログラムで行う必要が出てきます。InfoPath オブジェクト モデルでは、[XmlForm](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.aspx) クラスと [XmlFormCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlFormCollection.aspx) クラスを関連させて使用することにより、フォームの基になる XML ドキュメントにアクセスしたり、その XML ドキュメントを操作したりすることができます。</span><span class="sxs-lookup"><span data-stu-id="086db-p102">When you want to extend the functionality of an InfoPath form, it is often necessary to programmatically access information about the form's underlying XML document, access the data that the XML document contains, or perform some action on the XML document. The InfoPath object model supports accessing and manipulating a form's underlying XML document through the use of the [XmlForm](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.aspx) class in association with the [XmlFormCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlFormCollection.aspx) class.</span></span> 
  
<span data-ttu-id="086db-108">[XmlForm](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.aspx) クラスには、さまざまなプロパティとメソッドが用意されており、フォームの基になる XML ドキュメントを扱えるだけではなく、InfoPath のユーザー インターフェイスで行える多数の操作を実行することもできるため、このクラスは InfoPath オブジェクト モデルの中では最も便利な型の 1 つと言えます。</span><span class="sxs-lookup"><span data-stu-id="086db-108">The [XmlForm](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.aspx) class is one of the most useful types in the InfoPath object model because it provides a variety of properties and methods that not only interact with a form's underlying XML document, but also perform many of the actions that are available in the InfoPath user interface.</span></span> 
  
## <a name="overview-of-the-xmlformcollection-class"></a><span data-ttu-id="086db-109">XmlFormCollection クラスの概要</span><span class="sxs-lookup"><span data-stu-id="086db-109">Overview of the XmlFormCollection Class</span></span>

<span data-ttu-id="086db-110">[XmlFormCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlFormCollection.aspx) クラスには、次のメソッドとプロパティがあります。フォームの開発者は、これらを使用することにより、コレクションに含まれている [XmlForm](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.aspx) オブジェクトを管理できます。</span><span class="sxs-lookup"><span data-stu-id="086db-110">The [XmlFormCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlFormCollection.aspx) class provides the following methods and properties that form developers can use to manage the [XmlForm](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.aspx) objects that the collection contains.</span></span> 
  
|<span data-ttu-id="086db-111">**名前**</span><span class="sxs-lookup"><span data-stu-id="086db-111">**Name**</span></span>|<span data-ttu-id="086db-112">**説明**</span><span class="sxs-lookup"><span data-stu-id="086db-112">**Description**</span></span>|
|:-----|:-----|
|<span data-ttu-id="086db-113">[New(String)](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlFormCollection.New.aspx) メソッド</span><span class="sxs-lookup"><span data-stu-id="086db-113">[New(String)](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlFormCollection.New.aspx) method</span></span>  <br/> |<span data-ttu-id="086db-114">指定したフォームに基づいて新しいフォームを作成します。</span><span class="sxs-lookup"><span data-stu-id="086db-114">Creates a new form based on the specified form.</span></span>  <br/> |
|<span data-ttu-id="086db-115">[New(String, XmlFormOpenMode)](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlFormCollection.New.aspx) メソッド (オーバーロード 1)</span><span class="sxs-lookup"><span data-stu-id="086db-115">[New(String, XmlFormOpenMode)](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlFormCollection.New.aspx) method (overload 1)</span></span>  <br/> |<span data-ttu-id="086db-116">指定した開くモードの動作を使用して、指定したフォームに基づいて新しいフォームを作成します。</span><span class="sxs-lookup"><span data-stu-id="086db-116">Creates a new form based on the specified form using the specified open mode behavior.</span></span>  <br/> |
|<span data-ttu-id="086db-117">[NewFromFormTemplate(String)](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlFormCollection.NewFromFormTemplate.aspx) メソッド</span><span class="sxs-lookup"><span data-stu-id="086db-117">[NewFromFormTemplate(String)](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlFormCollection.NewFromFormTemplate.aspx) method</span></span>  <br/> |<span data-ttu-id="086db-118">指定したフォーム テンプレートに基づいて新しいフォームを作成します。</span><span class="sxs-lookup"><span data-stu-id="086db-118">Creates a new form based on the specified form template.</span></span>  <br/> |
|<span data-ttu-id="086db-119">[NewFromFormTemplate(String, String)](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlFormCollection.NewFromFormTemplate.aspx) メソッド (オーバーロード 1)</span><span class="sxs-lookup"><span data-stu-id="086db-119">[NewFromFormTemplate(String, String)](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlFormCollection.NewFromFormTemplate.aspx) method (overload 1)</span></span>  <br/> |<span data-ttu-id="086db-120">指定したフォーム テンプレートと XML データに基づいて新しいフォームを作成します。</span><span class="sxs-lookup"><span data-stu-id="086db-120">Creates a new form based on the specified form template and XML data.</span></span>  <br/> |
|<span data-ttu-id="086db-121">[NewFromFormTemplate(String, String, XmlFormOpenMode)](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlFormCollection.NewFromFormTemplate.aspx) メソッド (オーバーロード 2)</span><span class="sxs-lookup"><span data-stu-id="086db-121">[NewFromFormTemplate(String, String, XmlFormOpenMode)](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlFormCollection.NewFromFormTemplate.aspx) method (overload 2)</span></span>  <br/> |<span data-ttu-id="086db-122">指定したフォーム テンプレートと [XPathNavigator](https://msdn.microsoft.com/library/system.xml.xpath.xpathnavigator%28v=vs.110%29.aspx) オブジェクトで指定されるデータに基づいて新しいフォームを作成します。</span><span class="sxs-lookup"><span data-stu-id="086db-122">Creates a new form based on the specified form template with data specified by an [XPathNavigator](https://msdn.microsoft.com/library/system.xml.xpath.xpathnavigator%28v=vs.110%29.aspx) object.</span></span>  <br/> |
|<span data-ttu-id="086db-123">[NewFromFormTemplate(String, XPathNavigator)](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlFormCollection.NewFromFormTemplate.aspx) メソッド (オーバーロード 3)</span><span class="sxs-lookup"><span data-stu-id="086db-123">[NewFromFormTemplate(String, XPathNavigator)](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlFormCollection.NewFromFormTemplate.aspx) method (overload 3)</span></span>  <br/> |<span data-ttu-id="086db-124">指定した開くモードの動作を使用して、指定したフォーム テンプレートと **XPathNavigator** オブジェクトで指定されるデータに基づいて新しいフォームを作成します。</span><span class="sxs-lookup"><span data-stu-id="086db-124">Creates a new form based on the specified form template with data specified by an **XPathNavigator** object using the specified open mode behavior.</span></span>  <br/> |
|<span data-ttu-id="086db-125">[Open(String)](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlFormCollection.Open.aspx) メソッド</span><span class="sxs-lookup"><span data-stu-id="086db-125">[Open(String)](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlFormCollection.Open.aspx) method</span></span>  <br/> |<span data-ttu-id="086db-126">指定したフォームを開きます。</span><span class="sxs-lookup"><span data-stu-id="086db-126">Opens the specified form.</span></span>  <br/> |
|<span data-ttu-id="086db-127">[Open(String, XmlFormOpenMode)](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlFormCollection.Open.aspx) メソッド (オーバーロード 1)</span><span class="sxs-lookup"><span data-stu-id="086db-127">[Open(String, XmlFormOpenMode)](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlFormCollection.Open.aspx) method (overload 1)</span></span>  <br/> |<span data-ttu-id="086db-128">指定した開くモードの動作を使用して、指定したフォームを開きます。</span><span class="sxs-lookup"><span data-stu-id="086db-128">Opens the specified form using the specified open mode behavior.</span></span>  <br/> |
|<span data-ttu-id="086db-129">[Count](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlFormCollection.Count.aspx) プロパティ</span><span class="sxs-lookup"><span data-stu-id="086db-129">[Count](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlFormCollection.Count.aspx) property</span></span>  <br/> |<span data-ttu-id="086db-130">コレクションに含まれている **XmlForm** オブジェクトの数を取得します。</span><span class="sxs-lookup"><span data-stu-id="086db-130">Gets a count of the number of **XmlForm** objects contained in the collection.</span></span>  <br/> |
|<span data-ttu-id="086db-131">[Item](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlFormCollection.Item.aspx) プロパティ</span><span class="sxs-lookup"><span data-stu-id="086db-131">[Item](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlFormCollection.Item.aspx) property</span></span>  <br/> |<span data-ttu-id="086db-132">インデックス値で指定されたコレクション内の **XmlForm** オブジェクトへの参照を取得します。</span><span class="sxs-lookup"><span data-stu-id="086db-132">Gets a reference to the specified **XmlForm** object from the collection by index value.</span></span>  <br/> |
   
## <a name="overview-of-the-xmlform-class"></a><span data-ttu-id="086db-133">XmlForm クラスの概要</span><span class="sxs-lookup"><span data-stu-id="086db-133">Overview of the XmlForm Class</span></span>

<span data-ttu-id="086db-134">[XmlForm](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.aspx) クラスには、次のメソッドとプロパティがあります。フォームの開発者は、これらを使用することにより、フォームの基になる XML ドキュメントとの相互作用により、その XML ドキュメントに対して操作を実行できます。</span><span class="sxs-lookup"><span data-stu-id="086db-134">The [XmlForm](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.aspx) class provides the following methods and properties, which form developers can use to interact with and perform actions on a form's underlying XML document.</span></span> 
  
|<span data-ttu-id="086db-135">**名前**</span><span class="sxs-lookup"><span data-stu-id="086db-135">**Name**</span></span>|<span data-ttu-id="086db-136">**説明**</span><span class="sxs-lookup"><span data-stu-id="086db-136">**Description**</span></span>|
|:-----|:-----|
|<span data-ttu-id="086db-137">[Close](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.Close.aspx) メソッド</span><span class="sxs-lookup"><span data-stu-id="086db-137">[Close](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.Close.aspx) method</span></span>  <br/> |<span data-ttu-id="086db-138">フォームを閉じます。</span><span class="sxs-lookup"><span data-stu-id="086db-138">Closes the form.</span></span>  <br/> |
|<span data-ttu-id="086db-139">[GetWorkflowTasks](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.GetWorkflowTasks.aspx) メソッド</span><span class="sxs-lookup"><span data-stu-id="086db-139">[GetWorkflowTasks](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.GetWorkflowTasks.aspx) method</span></span>  <br/> |<span data-ttu-id="086db-140">現在のフォームの **Microsoft.Office.Core.WorkflowTasks** コレクションへの参照を取得します。</span><span class="sxs-lookup"><span data-stu-id="086db-140">Gets a reference to a **Microsoft.Office.Core.WorkflowTasks** collection for the current form.</span></span>  <br/> |
|<span data-ttu-id="086db-141">[GetWorkflowTemplates](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.GetWorkflowTemplates.aspx) メソッド</span><span class="sxs-lookup"><span data-stu-id="086db-141">[GetWorkflowTemplates](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.GetWorkflowTemplates.aspx) method</span></span>  <br/> |<span data-ttu-id="086db-142">現在のフォームの **Microsoft.Office.Core.WorkflowTemplates** コレクションへの参照を取得します。</span><span class="sxs-lookup"><span data-stu-id="086db-142">Gets a reference to a **Microsoft.Office.Core.WorkflowTemplates** collection for the current form.</span></span>  <br/> |
|<span data-ttu-id="086db-143">[MergeForm(String)](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.MergeForm.aspx) メソッド</span><span class="sxs-lookup"><span data-stu-id="086db-143">[MergeForm(String)](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.MergeForm.aspx) method</span></span>  <br/> |<span data-ttu-id="086db-144">現在のフォームを、パスまたは URL によって指定されたフォームとマージします。</span><span class="sxs-lookup"><span data-stu-id="086db-144">Merges the current form with the form specified by path or URL.</span></span>  <br/> |
|<span data-ttu-id="086db-145">[MergeForm(XPathNavigator)](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.MergeForm.aspx) メソッド (オーバーロード 1)</span><span class="sxs-lookup"><span data-stu-id="086db-145">[MergeForm(XPathNavigator)](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.MergeForm.aspx) method (overload 1)</span></span>  <br/> |<span data-ttu-id="086db-146">現在のフォームを、メソッドに渡された **XPathNavigator** によって返されるノードに指定されたターゲット フォームにマージします。</span><span class="sxs-lookup"><span data-stu-id="086db-146">Merges the current form with the target form specified in the node returned by the **XPathNavigator** passed to the method.</span></span>  <br/> |
|<span data-ttu-id="086db-147">[NotifyHost](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.NotifyHost.aspx) メソッド</span><span class="sxs-lookup"><span data-stu-id="086db-147">[NotifyHost](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.NotifyHost.aspx) method</span></span>  <br/> |<span data-ttu-id="086db-148">ホストしているアプリケーションまたは ASPX ページにカスタム値を提供します。</span><span class="sxs-lookup"><span data-stu-id="086db-148">Provides a custom value to the hosting application or ASPX page.</span></span>  <br/> |
|<span data-ttu-id="086db-149">[Print()](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.Print.aspx) メソッド</span><span class="sxs-lookup"><span data-stu-id="086db-149">[Print()](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.Print.aspx) method</span></span>  <br/> |<span data-ttu-id="086db-150">フォームのアクティブ ビューに表示されているフォームの内容を印刷します。</span><span class="sxs-lookup"><span data-stu-id="086db-150">Prints the form content as it is rendered in the form's active view.</span></span>  <br/> |
|<span data-ttu-id="086db-151">[Print(Boolean)](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.Print.aspx) メソッド (オーバーロード 1)</span><span class="sxs-lookup"><span data-stu-id="086db-151">[Print(Boolean)](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.Print.aspx) method (overload 1)</span></span>  <br/> |<span data-ttu-id="086db-152">[ **印刷**] ダイアログ ボックスを表示することによって、フォームのアクティブ ビューに表示されているフォームの内容を印刷します。</span><span class="sxs-lookup"><span data-stu-id="086db-152">Prints the form content as it is rendered in the form's active view by displaying the **Print** dialog box.</span></span>  <br/> |
|<span data-ttu-id="086db-153">[Save](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.Save.aspx) メソッド</span><span class="sxs-lookup"><span data-stu-id="086db-153">[Save](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.Save.aspx) method</span></span>  <br/> |<span data-ttu-id="086db-154">現在関連付けられている Uniform Resource Locator (URL) にフォームを保存します。</span><span class="sxs-lookup"><span data-stu-id="086db-154">Saves the form to the Uniform Resource Locator (URL) that it is currently associated with.</span></span>  <br/> |
|<span data-ttu-id="086db-155">[SaveAs](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.SaveAs.aspx) メソッド</span><span class="sxs-lookup"><span data-stu-id="086db-155">[SaveAs](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.SaveAs.aspx) method</span></span>  <br/> |<span data-ttu-id="086db-156">指定した Uniform Resource Locator (URL) にフォームを保存します。</span><span class="sxs-lookup"><span data-stu-id="086db-156">Saves the form to the specified Uniform Resource Locator (URL).</span></span>  <br/> |
|<span data-ttu-id="086db-157">[SetSaveAsDialogFilename](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.SetSaveAsDialogFilename.aspx) メソッド</span><span class="sxs-lookup"><span data-stu-id="086db-157">[SetSaveAsDialogFilename](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.SetSaveAsDialogFilename.aspx) method</span></span>  <br/> |<span data-ttu-id="086db-158">[ **名前を付けて保存**] ダイアログ ボックスを使用してフォームを保存するときの既定のファイル名を設定します。</span><span class="sxs-lookup"><span data-stu-id="086db-158">Sets the default filename for the **SaveAs** dialog box.</span></span>  <br/> |
|<span data-ttu-id="086db-159">[SetSaveAsDialogLocation](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.SetSaveAsDialogLocation.aspx) メソッド</span><span class="sxs-lookup"><span data-stu-id="086db-159">[SetSaveAsDialogLocation](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.SetSaveAsDialogLocation.aspx) method</span></span>  <br/> |<span data-ttu-id="086db-160">[ **名前を付けて保存**] ダイアログ ボックスを使用してフォームを保存するときの既定のパスを設定します。</span><span class="sxs-lookup"><span data-stu-id="086db-160">Sets the default path for saving the form using the **SaveAs** dialog box.</span></span>  <br/> |
|<span data-ttu-id="086db-161">[Submit](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.Submit.aspx) メソッド</span><span class="sxs-lookup"><span data-stu-id="086db-161">[Submit](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.Submit.aspx) method</span></span>  <br/> |<span data-ttu-id="086db-162">フォーム テンプレートに定義された送信処理を使用してフォームを送信します。</span><span class="sxs-lookup"><span data-stu-id="086db-162">Submits the form using the submit operation defined in the form template.</span></span>  <br/> |
|<span data-ttu-id="086db-163">[CurrentView](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.CurrentView.aspx) プロパティ</span><span class="sxs-lookup"><span data-stu-id="086db-163">[CurrentView](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.CurrentView.aspx) property</span></span>  <br/> |<span data-ttu-id="086db-164">フォームの現在のビューを表す [View](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.View.aspx) オブジェクトを取得します。</span><span class="sxs-lookup"><span data-stu-id="086db-164">Gets a [View](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.View.aspx) object that represents the current view of the form.</span></span>  <br/> |
|<span data-ttu-id="086db-165">[DataConnections](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.DataConnections.aspx) プロパティ</span><span class="sxs-lookup"><span data-stu-id="086db-165">[DataConnections](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.DataConnections.aspx) property</span></span>  <br/> |<span data-ttu-id="086db-166">フォームに関連付けられた [DataConnectionCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataConnectionCollection.aspx) オブジェクトを取得します。</span><span class="sxs-lookup"><span data-stu-id="086db-166">Gets a [DataConnectionCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataConnectionCollection.aspx) object associated with the form.</span></span>  <br/> |
|<span data-ttu-id="086db-167">[DataSources](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.DataSources.aspx) プロパティ</span><span class="sxs-lookup"><span data-stu-id="086db-167">[DataSources](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.DataSources.aspx) property</span></span>  <br/> |<span data-ttu-id="086db-168">フォームに関連付けられた [DataSourceCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSourceCollection.aspx) オブジェクトを取得します。</span><span class="sxs-lookup"><span data-stu-id="086db-168">Gets the [DataSourceCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSourceCollection.aspx) object associated with the form.</span></span>  <br/> |
|<span data-ttu-id="086db-169">[Dirty](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.Dirty.aspx) プロパティ</span><span class="sxs-lookup"><span data-stu-id="086db-169">[Dirty](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.Dirty.aspx) property</span></span>  <br/> |<span data-ttu-id="086db-170">フォームのデータが最後に保存されてから変更されたかどうかを示す値を取得します。</span><span class="sxs-lookup"><span data-stu-id="086db-170">Gets a value that indicates whether the data in a form has been modified since it was last saved.</span></span>  <br/> |
|<span data-ttu-id="086db-171">[Errors](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.Errors.aspx) プロパティ</span><span class="sxs-lookup"><span data-stu-id="086db-171">[Errors](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.Errors.aspx) property</span></span>  <br/> |<span data-ttu-id="086db-172">フォームに関連付けられた [FormErrorCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormErrorCollection.aspx) への参照を取得します。</span><span class="sxs-lookup"><span data-stu-id="086db-172">Gets a reference to the [FormErrorCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormErrorCollection.aspx) that is associated with a form.</span></span>  <br/> |
|<span data-ttu-id="086db-173">[Extension](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.Extension.aspx) プロパティ</span><span class="sxs-lookup"><span data-stu-id="086db-173">[Extension](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.Extension.aspx) property</span></span>  <br/> |<span data-ttu-id="086db-174">
  [System.Reflection](https://msdn.microsoft.com/library/system.object%28v=vs.110%29.aspx) を使用して、フォームのプライマリ フォーム コード ファイルに含まれる関数とグローバル変数にアクセスするための [System.Object](https://msdn.microsoft.com/library/system.reflection(v=vs.110).aspx) を取得します。</span><span class="sxs-lookup"><span data-stu-id="086db-174">Gets an [System.Object](https://msdn.microsoft.com/library/system.object%28v=vs.110%29.aspx) for accessing the functions and global variables contained in a form's primary form code file using [System.Reflection](https://msdn.microsoft.com/library/system.reflection(v=vs.110).aspx).</span></span>  <br/> |
|<span data-ttu-id="086db-175">[FormState](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.FormState.aspx) プロパティ</span><span class="sxs-lookup"><span data-stu-id="086db-175">[FormState](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.FormState.aspx) property</span></span>  <br/> |<span data-ttu-id="086db-176">サーバー上の複数のセッションにわたって状態情報を維持するためにブラウザー対応のフォームで使用できる、[System.Collections.IDictionary](https://msdn.microsoft.com/library/system.collections.idictionary%28v=vs.110%29.aspx) 型のプロパティ バッグへの参照を取得します。</span><span class="sxs-lookup"><span data-stu-id="086db-176">Gets a reference to a property bag of type [System.Collections.IDictionary](https://msdn.microsoft.com/library/system.collections.idictionary%28v=vs.110%29.aspx) that browser-enabled forms can use to maintain state information across sessions on the server.</span></span>  <br/> |
|<span data-ttu-id="086db-177">[Host](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.Host.aspx) プロパティ</span><span class="sxs-lookup"><span data-stu-id="086db-177">[Host](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.Host.aspx) property</span></span>  <br/> |<span data-ttu-id="086db-178">ホストされた InfoPath のインスタンスで実行しているコードでホスト アプリケーションのオブジェクト モデルにアクセスするために使用できる、[System.Object](https://msdn.microsoft.com/library/system.object%28v=vs.110%29.aspx) を取得します。</span><span class="sxs-lookup"><span data-stu-id="086db-178">Gets a [System.Object](https://msdn.microsoft.com/library/system.object%28v=vs.110%29.aspx) that code running in a hosted instance of InfoPath can use to access the object model of the host application.</span></span>  <br/> |
|<span data-ttu-id="086db-179">[Hosted](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.Hosted.aspx) プロパティ</span><span class="sxs-lookup"><span data-stu-id="086db-179">[Hosted](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.Hosted.aspx) property</span></span>  <br/> |<span data-ttu-id="086db-180">InfoPath が別のアプリケーションでコントロールとしてホストされているかどうかを取得します。</span><span class="sxs-lookup"><span data-stu-id="086db-180">Gets whether InfoPath is hosted as a control in another application.</span></span>  <br/> |
|<span data-ttu-id="086db-181">[HostName](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.HostName.aspx) プロパティ</span><span class="sxs-lookup"><span data-stu-id="086db-181">[HostName](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.HostName.aspx) property</span></span>  <br/> |<span data-ttu-id="086db-182">InfoPath をコントロールとしてホストしているアプリケーションの名前を取得します。</span><span class="sxs-lookup"><span data-stu-id="086db-182">Gets the name of the application hosting InfoPath as a control.</span></span>  <br/> |
|<span data-ttu-id="086db-183">[MainDataSource](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.MainDataSource.aspx) プロパティ</span><span class="sxs-lookup"><span data-stu-id="086db-183">[MainDataSource](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.MainDataSource.aspx) property</span></span>  <br/> |<span data-ttu-id="086db-184">フォームのメイン データ ソースを表す [DataSource](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSource.aspx) オブジェクトを取得します。</span><span class="sxs-lookup"><span data-stu-id="086db-184">Gets a [DataSource](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSource.aspx) object that represents the main data source of the form.</span></span>  <br/> |
|<span data-ttu-id="086db-185">[NamespaceManager](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.NamespaceManager.aspx) プロパティ</span><span class="sxs-lookup"><span data-stu-id="086db-185">[NamespaceManager](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.NamespaceManager.aspx) property</span></span>  <br/> |<span data-ttu-id="086db-186">フォームで使用されている名前空間を解決、追加、または削除するために使用できる [XmlNamespaceManager](https://msdn.microsoft.com/library/System.Xml.XmlNamespaceManager.aspx) オブジェクトへの参照を取得します。</span><span class="sxs-lookup"><span data-stu-id="086db-186">Gets a reference to a [XmlNamespaceManager](https://msdn.microsoft.com/library/System.Xml.XmlNamespaceManager.aspx) object that can be used to resolve, add, or remove namespaces used in the form.</span></span>  <br/> |
|<span data-ttu-id="086db-187">[New](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.New.aspx) プロパティ</span><span class="sxs-lookup"><span data-stu-id="086db-187">[New](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.New.aspx) property</span></span>  <br/> |<span data-ttu-id="086db-188">フォームが新規かどうかを指定する値を取得します。</span><span class="sxs-lookup"><span data-stu-id="086db-188">Gets a value that specifies whether a form is new.</span></span>  <br/> |
|<span data-ttu-id="086db-189">[Permission](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.Permission.aspx) プロパティ</span><span class="sxs-lookup"><span data-stu-id="086db-189">[Permission](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.Permission.aspx) property</span></span>  <br/> |<span data-ttu-id="086db-190">フォームに関連付けられている [Permission](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Permission.aspx) オブジェクトへの参照を取得します。</span><span class="sxs-lookup"><span data-stu-id="086db-190">Gets a reference to a [Permission](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Permission.aspx) object associated with the form.</span></span>  <br/> |
|<span data-ttu-id="086db-191">[QueryDataConnection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.QueryDataConnection.aspx) プロパティ</span><span class="sxs-lookup"><span data-stu-id="086db-191">[QueryDataConnection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.QueryDataConnection.aspx) property</span></span>  <br/> |<span data-ttu-id="086db-192">フォームに関連付けられているデータ接続を表す [DataConnection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataConnection.aspx) オブジェクトへの参照を取得します。</span><span class="sxs-lookup"><span data-stu-id="086db-192">Gets a reference to the [DataConnection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataConnection.aspx) object that represents the data connection that is associated with the form.</span></span>  <br/> |
|<span data-ttu-id="086db-193">[ReadOnly](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.ReadOnly.aspx) プロパティ</span><span class="sxs-lookup"><span data-stu-id="086db-193">[ReadOnly](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.ReadOnly.aspx) property</span></span>  <br/> |<span data-ttu-id="086db-194">フォーム テンプレートが読み取り専用またはロックされているかどうかを示す値を取得します。</span><span class="sxs-lookup"><span data-stu-id="086db-194">Gets a value that indicates whether a form template is read-only or locked.</span></span>  <br/> |
|<span data-ttu-id="086db-195">[Recovered](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.Recovered.aspx) プロパティ</span><span class="sxs-lookup"><span data-stu-id="086db-195">[Recovered](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.Recovered.aspx) property</span></span>  <br/> |<span data-ttu-id="086db-196">フォームが最後に保存されたのが自動保存操作によるものかどうかを示す値を取得します。</span><span class="sxs-lookup"><span data-stu-id="086db-196">Gets a value that indicates whether a form was last saved by an AutoRecover save operation.</span></span>  <br/> |
|<span data-ttu-id="086db-197">[Signed](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.Signed.aspx) プロパティ</span><span class="sxs-lookup"><span data-stu-id="086db-197">[Signed](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.Signed.aspx) property</span></span>  <br/> |<span data-ttu-id="086db-198">フォームがデジタル署名を使用してデジタル署名されているかどうかを示す値を取得します。</span><span class="sxs-lookup"><span data-stu-id="086db-198">Gets a value that indicates whether a form has been digitally signed using digital signatures.</span></span>  <br/> |
|<span data-ttu-id="086db-199">[SignedDataBlocks](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.SignedDataBlocks.aspx) プロパティ</span><span class="sxs-lookup"><span data-stu-id="086db-199">[SignedDataBlocks](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.SignedDataBlocks.aspx) property</span></span>  <br/> |<span data-ttu-id="086db-200">フォームに関連付けられている [SignedDataBlockCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SignedDataBlockCollection.aspx) コレクションへの参照を取得します。</span><span class="sxs-lookup"><span data-stu-id="086db-200">Gets a reference to the [SignedDataBlockCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SignedDataBlockCollection.aspx) collection that is associated with a form.</span></span>  <br/> |
|<span data-ttu-id="086db-201">[TaskPanes](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.TaskPanes.aspx) プロパティ</span><span class="sxs-lookup"><span data-stu-id="086db-201">[TaskPanes](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.TaskPanes.aspx) property</span></span>  <br/> |<span data-ttu-id="086db-202">フォーム テンプレートに関連付けられた [TaskPaneCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.TaskPaneCollection.aspx) への参照を取得します。</span><span class="sxs-lookup"><span data-stu-id="086db-202">Gets a reference to the [TaskPaneCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.TaskPaneCollection.aspx) that is associated with a form template.</span></span>  <br/> |
|<span data-ttu-id="086db-203">[Template](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.Template.aspx) プロパティ</span><span class="sxs-lookup"><span data-stu-id="086db-203">[Template](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.Template.aspx) property</span></span>  <br/> |<span data-ttu-id="086db-204">フォームに関連付けられたフォーム テンプレートのマニフェスト (.xsf) を表す [FormTemplate](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormTemplate.aspx) オブジェクトへの参照を取得します。</span><span class="sxs-lookup"><span data-stu-id="086db-204">Gets a reference to the [FormTemplate](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormTemplate.aspx) object that represents the manifest (.xsf) of the form template associated with the form.</span></span>  <br/> |
|<span data-ttu-id="086db-205">[Uri](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.Uri.aspx) プロパティ</span><span class="sxs-lookup"><span data-stu-id="086db-205">[Uri](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.Uri.aspx) property</span></span>  <br/> |<span data-ttu-id="086db-206">フォームの Uniform Resource Identifier (URI) を取得します。</span><span class="sxs-lookup"><span data-stu-id="086db-206">Gets the Uniform Resource Identifier (URI) of a form.</span></span>  <br/> |
|<span data-ttu-id="086db-207">[UserRole](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.UserRole.aspx) プロパティ</span><span class="sxs-lookup"><span data-stu-id="086db-207">[UserRole](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.UserRole.aspx) property</span></span>  <br/> |<span data-ttu-id="086db-208">フォームのロール名の現在のユーザーを取得または設定します。</span><span class="sxs-lookup"><span data-stu-id="086db-208">Gets or sets the current user of the form's role name.</span></span>  <br/> |
|<span data-ttu-id="086db-209">[ViewInfos](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.ViewInfos.aspx) プロパティ</span><span class="sxs-lookup"><span data-stu-id="086db-209">[ViewInfos](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.ViewInfos.aspx) property</span></span>  <br/> |<span data-ttu-id="086db-210">フォーム テンプレートに関連付けられた [ViewInfoCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.ViewInfoCollection.aspx) オブジェクトへの参照を取得します。</span><span class="sxs-lookup"><span data-stu-id="086db-210">Gets a reference to the [ViewInfoCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.ViewInfoCollection.aspx) object associated with the form template.</span></span>  <br/> |
|<span data-ttu-id="086db-211">[XmlLang](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.XmlLang.aspx) プロパティ</span><span class="sxs-lookup"><span data-stu-id="086db-211">[XmlLang](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.XmlLang.aspx) property</span></span>  <br/> |<span data-ttu-id="086db-212">フォームの基になる XML ドキュメント内の **xml:lang** 属性の値を取得します。</span><span class="sxs-lookup"><span data-stu-id="086db-212">Gets the value of the **xml:lang** attribute in the underlying XML document of the form.</span></span>  <br/> |
   
## <a name="using-the-xmlformcollection-class"></a><span data-ttu-id="086db-213">XmlFormCollection クラスを使用する</span><span class="sxs-lookup"><span data-stu-id="086db-213">Using the XmlFormCollection Class</span></span>

<span data-ttu-id="086db-p103">**XmlFormCollection** クラスは、 [Application](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Application.XmlForms.aspx) クラスの [XmlForms](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Application.aspx) プロパティを通じてアクセスされます。 [Microsoft.Office.InfoPath](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.aspx) 名前空間のメンバーによって提供されるオブジェクト モデルを使用して作成されたマネージ コード フォーム テンプレートでは、フォーム コードで **this** (C# の場合) キーワードまたは **Me** (Visual Basic の場合) キーワードを使用して、 **Application** クラスとそのメンバーにアクセスできます。</span><span class="sxs-lookup"><span data-stu-id="086db-p103">The **XmlFormCollection** class is accessed through the [XmlForms](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Application.XmlForms.aspx) property of the [Application](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Application.aspx) class. In a managed code form template created using the object model provided by the members of the [Microsoft.Office.InfoPath](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.aspx) namespace, you can use the **this** (C#) or **Me** (Visual Basic) keyword in your form code to access the **Application** class and its members.</span></span> 
  
<span data-ttu-id="086db-p104">次の例では、 **Application** クラスの **XmlForms** プロパティを使用して、InfoPath の実行中のインスタンスの **XDocumentsCollection** オブジェクトを参照する myForms という名前のオブジェクト変数を作成します。この変数を使用して、現在開いているフォームの数を表示します。</span><span class="sxs-lookup"><span data-stu-id="086db-p104">The following example uses the **XmlForms** property of the **Application** class to create an object variable named myForms that references the **XDocumentsCollection** object of the currently running instance of InfoPath. This variable is then used to display the count of forms that are open.</span></span> 
  
```cs
// Create variable for accessing the XmlFormCollection.
XmlFormCollection myForms = this.Application.XmlForms;
// Display the number of forms that are currently open.
MessageBox.Show("Forms open: " + myForms.Count);
```

```vb
// Create variable for accessing the XmlFormCollection.
Dim myForms As XmlFormCollection = Me.Application.XmlForms
' Display the number of forms that are currently open.
MessageBox.Show("Forms open: " + myForms.Count)
```

<span data-ttu-id="086db-218">myForms 変数は、新しいフォームを作成したり (いずれかの **New** メソッドまたは **NewFromTemplate** メソッドを使用)、既存のフォームを開いたり (いずれかの **Open** メソッドを使用) する場合にも使用できます。</span><span class="sxs-lookup"><span data-stu-id="086db-218">The myForms variable can then also be used to create new forms (using one of the **New** or **NewFromTemplate** methods) or open existing forms (using one of the **Open** methods).</span></span> 
  
## <a name="using-the-xmlform-class"></a><span data-ttu-id="086db-219">XmlForm クラスを使用する</span><span class="sxs-lookup"><span data-stu-id="086db-219">Using the XmlForm Class</span></span>

<span data-ttu-id="086db-220">[Microsoft.Office.InfoPath](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.aspx) 名前空間のメンバーによって提供されるオブジェクト モデルを使用して作成されたマネージ コード フォーム テンプレートでは、フォーム コードで **this** (C# の場合) キーワードまたは **Me** (Visual Basic の場合) キーワードを使用して、( [XmlForm](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.aspx) クラスへの参照を確立するオブジェクト変数を必要とすることなく) [XmlForm](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.aspx) クラスのメンバーに直接アクセスできます。</span><span class="sxs-lookup"><span data-stu-id="086db-220">In a managed code form template created using the object model provided by the members of the [Microsoft.Office.InfoPath](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.aspx) namespace, you can use the **this** (C#) or **Me** (Visual Basic) keyword in your form code to access the members of the [XmlForm](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.aspx) class directly (without requiring an object variable that establishes a reference to the [XmlForm](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.aspx) class).</span></span> 
  
### <a name="accessing-a-forms-property-values"></a><span data-ttu-id="086db-221">フォームのプロパティ値にアクセスする</span><span class="sxs-lookup"><span data-stu-id="086db-221">Accessing a Form's Property Values</span></span>

<span data-ttu-id="086db-222">次の例では、 **this** キーワードまたは **Me** キーワードを使用して、 **XmlForm** クラスの **New**、 **ReadOnly**、 **Signed**、および **Uri** の各プロパティにアクセスし、現在のフォームについて返された値をメッセージ ボックスに表示します。</span><span class="sxs-lookup"><span data-stu-id="086db-222">The following example uses the **this** or **Me** keyword to access the **New**, **ReadOnly**, **Signed**, and **Uri** properties of the **XmlForm** class and display the values returned for the current form in a message box.</span></span> 
  
```cs
MessageBox.Show(
   "Is new: " + this.New + System.Environment.NewLine +
   "Is read-only: " + this.ReadOnly + System.Environment.NewLine +
   "Is signed: " + this.Signed + System.Environment.NewLine +
   "Form URI: " + this.Uri);
```

```vb
MessageBox.Show( _
   "Is new: " &amp; Me.New &amp; System.Environment.NewLine &amp; _
   "Is read-only: " &amp; Me.ReadOnly &amp; System.Environment.NewLine + _
   "Is signed: " &amp; Me.Signed &amp; System.Environment.NewLine &amp; _
   "Form URI: " &amp; this.Uri)
```

### <a name="accessing-a-forms-data-source"></a><span data-ttu-id="086db-223">フォームのデータ ソースにアクセスする</span><span class="sxs-lookup"><span data-stu-id="086db-223">Accessing a Form's Data Source</span></span>

<span data-ttu-id="086db-p105">フォーム データに関する **XmlForm** クラスの主要なプロパティは、 **MainDataSource** プロパティです。このプロパティは、現在のフォームの基になる XML データを表す [DataSource](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSource.aspx) オブジェクトへの参照を返します (現在のフォームの基になる XML データは、フォームのメイン データ ソースまたは プライマリ データ ソースとも呼ばれます)。 **DataSource** クラスには [CreateNavigator](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSource.CreateNavigator.aspx) メソッドがあります。このメソッドは、フォームの基になる XML ドキュメントのルートに配置される [XPathNavigator](https://msdn.microsoft.com/library/system.xml.xpath.xpathnavigator%28v=vs.110%29.aspx) オブジェクトを作成します。その後で、 **XPathNavigator** クラスのプロパティとメソッドを使用して、フォームの基になる XML データ内を移動し、データを編集できます。</span><span class="sxs-lookup"><span data-stu-id="086db-p105">A key property of the **XmlForm** class with respect to form data is the **MainDataSource** property. This property returns a reference to a [DataSource](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSource.aspx) object that represents the underlying XML data of the current form, which is also referred to as the form's main or primary data source. The **DataSource** class provides the [CreateNavigator](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSource.CreateNavigator.aspx) method, which creates a [XPathNavigator](https://msdn.microsoft.com/library/system.xml.xpath.xpathnavigator%28v=vs.110%29.aspx) object positioned at the root of the form's underlying XML document. The properties and methods of the **XPathNavigator** class can then be used to navigate and edit the form's underlying XML data.</span></span> 
  
<span data-ttu-id="086db-p106">次の例では、 **XmlForm** クラスの **MainDataSource** プロパティを使用して、フォームのメイン データ ソースのルートに配置される **XPathNavigator** オブジェクトを作成します。次に、 **XPathNavigator** クラスの **OuterXml** プロパティを使用して、フォームの基になる XML ドキュメントのすべての内容を取得し、表示します。</span><span class="sxs-lookup"><span data-stu-id="086db-p106">The following example uses the **MainDataSource** property of the **XmlForm** class to create an **XPathNavigator** object positioned at the root of the form's main data source. The **OuterXml** property of the **XPathNavigator** class is then used to return and display all of the contents of a form's underlying XML document.</span></span> 
  
```cs
// Get outer XML of the underlying XML document.
string myDoc = this.MainDataSource.CreateNavigator.OuterXml.ToString();
// Display XML.
MessageBox.Show(myDoc);
```

```vb
' Get outer XML of the underlying XML document.
Dim myDoc As String myDoc = _
   Me.MainDataSource.CreateNavigator.OuterXml.ToString()
' Display XML.
MessageBox.Show(myDoc)
```

> [!NOTE]
> <span data-ttu-id="086db-230">InfoPath では、 **MainDataSource** プロパティを、 **this** キーワードまたは **Me** キーワードを使用して **XmlForm** オブジェクトにアクセスするときの既定のプロパティとして扱うので、 **XPathNavigator** オブジェクトを作成するためのコード行ではこのプロパティを省略できます。</span><span class="sxs-lookup"><span data-stu-id="086db-230">Because InfoPath treats the **MainDataSource** property as a default property of the **XmlForm** object accessed when using the **this** or **Me** keywords, you can omit it from the line of code used to create the **XPathNavigator** object.</span></span> 
  
<span data-ttu-id="086db-231">InfoPath フォーム テンプレートのビジネス ロジックでの **XPathNavigator** クラスの詳細については、「[XPathNavigator クラスおよび XPathNodeIterator クラスを操作する方法](how-to-work-with-the-xpathnavigator-and-xpathnodeiterator-classes.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="086db-231">To learn more about the **XPathNavigator** class in an InfoPath form template's business logic, see [Work with the XPathNavigator and XPathNodeIterator Classes](how-to-work-with-the-xpathnavigator-and-xpathnodeiterator-classes.md).</span></span>
  
### <a name="accessing-data-about-a-forms-form-template-file"></a><span data-ttu-id="086db-232">フォームのフォーム テンプレート ファイルのデータにアクセスする</span><span class="sxs-lookup"><span data-stu-id="086db-232">Accessing Data About a Form's Form Template File</span></span>

<span data-ttu-id="086db-p107">フォームに関連付けられているフォーム テンプレートに関する情報は、フォーム定義ファイル (.xsf) およびそこに格納されているソース XML データを含め、 **XmlForm** クラスを使用してアクセスすることもできます。この情報は、 [Template](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.Template.aspx) プロパティを使用してアクセスします。このプロパティは、現在のフォームに関連付けられているフォーム テンプレートを表す [FormTemplate](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormTemplate.aspx) オブジェクトへの参照を返します。</span><span class="sxs-lookup"><span data-stu-id="086db-p107">Information about the form template associated with a form, including the form definition file (.xsf ) and the source XML data that it contains, can also be accessed using the **XmlForm** class. This information is accessed using the [Template](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.Template.aspx) property, which returns a reference to a [FormTemplate](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormTemplate.aspx) object that represents the form template associated with the current form.</span></span> 
  
<span data-ttu-id="086db-p108">次の例では、1 つ目のメッセージ ボックスに、 **Template** クラスを使用して取得できるデータの一部を表示します。表示されるデータには、Uniform Resource Identifier (URI) での場所 ( [Uri](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormTemplate.Uri.aspx) プロパティを使用)、キャッシュ識別子 ( [CacheId](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormTemplate.CacheId.aspx) プロパティを使用)、そのバージョン番号 ( [Version](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormTemplate.Version.aspx) プロパティを使用) などがあります。2 つ目のメッセージ ボックスでは、 [Template](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormTemplate.Manifest.aspx) クラスの **Manifest** プロパティを使用して、フォーム定義ファイル (.xsf) のソース XML を表示するために使用される **XPathNavigator** オブジェクトを作成します。</span><span class="sxs-lookup"><span data-stu-id="086db-p108">In the following example, the first message box displays some of the data that is available through the **Template** class, such as its Uniform Resource Identifier (URI) location (using the [Uri](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormTemplate.Uri.aspx) property), the cache identifier (using the [CacheId](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormTemplate.CacheId.aspx) property) and its version number (using the [Version](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormTemplate.Version.aspx) property). The next message box uses the [Manifest](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormTemplate.Manifest.aspx) property of the **Template** class to create an **XPathNavigator** object that is used to display the source XML of the form definition file (.xsf).</span></span> 
  
```cs
// Display form template properties.
MessageBox.Show(
   "Cache ID: " + this.Template.CacheId + System.Environment.NewLine +
   "URI: " + this.ReadOnly + System.Environment.NewLine +
   "Version: " + this.Signed, "Form Template Properties");
// Display form definition file XML.
MessageBox.Show(this.Template.Manifest.OuterXml, 
   "Form Definition File XML");
```

```vb
' Display form template properties.
MessageBox.Show( _
   "Cache ID: " &amp; Me.Template.CacheId &amp; System.Environment.NewLine &amp;
   "URI: " &amp; Me.ReadOnly &amp; System.Environment.NewLine &amp;
   "Version: " &amp; Me.Signed, "Form Template Properties")
' Display form definition file XML.
MessageBox.Show(Me.Template.Manifest.OuterXml, _
   "Form Definition File XML")
```


