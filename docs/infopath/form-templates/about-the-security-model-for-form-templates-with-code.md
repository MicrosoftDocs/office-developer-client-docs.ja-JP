---
title: コードを含むフォーム テンプレートのセキュリティ モデルについて
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
keywords:
- infopath 2007, security,code access security [InfoPath 2007],security [InfoPath 2007], security model for managed code,security [InfoPath 2007], levels,CAS [InfoPath 2007],InfoPath 2003-compatible form templates, security,permissions [InfoPath 2007]
localization_priority: Normal
ms.assetid: 5e1c1c72-f98d-4871-9c57-82c315277aa1
description: InfoPath マネージ コード フォーム テンプレートは、アンマネージ フォーム テンプレートで実行されるスクリプトと同じセキュリティ レベルをサポートしますが, .NET Framework の共通言語ランタイム (CLR) で実行されるマネージ コードに適用される追加のコード アクセス セキュリティ機能もサポートします。
ms.openlocfilehash: 97f0239a5bd6699b539ddaebf4d1d2ed7d1394db
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/23/2019
ms.locfileid: "32303767"
---
# <a name="about-the-security-model-for-form-templates-with-code"></a><span data-ttu-id="599a7-104">コードを含むフォーム テンプレートのセキュリティ モデルについて</span><span class="sxs-lookup"><span data-stu-id="599a7-104">About the Security Model for Form Templates with Code</span></span>

<span data-ttu-id="599a7-105">InfoPath マネージ コード フォーム テンプレートは、アンマネージ フォーム テンプレートで実行されるスクリプトと同じセキュリティ レベルをサポートしますが, .NET Framework の共通言語ランタイム (CLR) で実行されるマネージ コードに適用される追加のコード アクセス セキュリティ機能もサポートします。</span><span class="sxs-lookup"><span data-stu-id="599a7-105">InfoPath managed code form templates support the same security levels as script running in unmanaged form templates, and they also support additional code access security features that apply to managed code running under the common language runtime (CLR) of the .NET Framework.</span></span>
  
## <a name="infopath-managed-object-model-security-levels"></a><span data-ttu-id="599a7-106">InfoPath マネージ オブジェクト モデルのセキュリティ レベル</span><span class="sxs-lookup"><span data-stu-id="599a7-106">InfoPath Managed Object Model Security Levels</span></span>

<span data-ttu-id="599a7-107">次の表は、セキュリティ オブジェクト モデルのメンバーのセキュリティ レベルと、マネージ コード フォーム テンプレートでそのオブジェクト モデルのメンバーが使用されるときに、各レベルで要求されるアクセス許可のセットの関係を示しています。</span><span class="sxs-lookup"><span data-stu-id="599a7-107">The following table describes the relationship between the security levels for script object model members and the corresponding permission set that is demanded for each level when the object model member is used in a managed code form template.</span></span>
  
|<span data-ttu-id="599a7-108">**オブジェクト モデルのセキュリティ レベル**</span><span class="sxs-lookup"><span data-stu-id="599a7-108">**Object Model Security Level**</span></span>|<span data-ttu-id="599a7-109">**説明**</span><span class="sxs-lookup"><span data-stu-id="599a7-109">**Description**</span></span>|<span data-ttu-id="599a7-110">**要求されるアクセス許可のセット**</span><span class="sxs-lookup"><span data-stu-id="599a7-110">**Permission Set Demanded**</span></span>|
|:-----|:-----|:-----|
|<span data-ttu-id="599a7-111">.0</span><span class="sxs-lookup"><span data-stu-id="599a7-111">0</span></span>  <br/> |<span data-ttu-id="599a7-112">制限なくアクセスできます。</span><span class="sxs-lookup"><span data-stu-id="599a7-112">Can be accessed without restrictions.</span></span>  <br/> |<span data-ttu-id="599a7-113">なし</span><span class="sxs-lookup"><span data-stu-id="599a7-113">None</span></span>  <br/> |
|<span data-ttu-id="599a7-114">pbm-2</span><span class="sxs-lookup"><span data-stu-id="599a7-114">2</span></span>  <br/> |<span data-ttu-id="599a7-115">現在開いているフォームと同じドメイン内で実行されているフォーム、またはドメインを越えたアクセス許可を付与されているフォームだけがアクセスできます。</span><span class="sxs-lookup"><span data-stu-id="599a7-115">Can be accessed only by forms running in the same domain as the currently open form, or by forms that have been granted cross-domain permissions.</span></span>  <br/> |<span data-ttu-id="599a7-116">なし</span><span class="sxs-lookup"><span data-stu-id="599a7-116">None</span></span>  <br/> |
|<span data-ttu-id="599a7-117">1/3</span><span class="sxs-lookup"><span data-stu-id="599a7-117">3</span></span>  <br/> |<span data-ttu-id="599a7-118">完全に信頼できるフォームだけがアクセスできます。</span><span class="sxs-lookup"><span data-stu-id="599a7-118">Can be accessed only by fully trusted forms.</span></span>  <br/> |<span data-ttu-id="599a7-119">FullTrust</span><span class="sxs-lookup"><span data-stu-id="599a7-119">FullTrust</span></span>  <br/> |
   
> [!NOTE]
> <span data-ttu-id="599a7-120">[!メモ] セキュリティ レベル "1" は現在の InfoPath COM サーバーでは使用されず、将来の使用に備えて予約されています。</span><span class="sxs-lookup"><span data-stu-id="599a7-120">The security level "1" is not used by the current InfoPath COM server and is reserved for future use.</span></span> 
  
> [!IMPORTANT]
> <span data-ttu-id="599a7-121">[!重要] オブジェクト モデルのレベル 0 および 2 では、マネージ コードを含むためにアクセス許可のセットは要求されませんが、次のセクションに示すドメイン アクセスのセキュリティ レベル [ドメイン] の定義に従って動作します。</span><span class="sxs-lookup"><span data-stu-id="599a7-121">Even though object model levels 0 and 2 do not demand any permission set, because they contain managed code, they behave as defined for the Domain domain access security level that is described in the following section.</span></span> 
  
<span data-ttu-id="599a7-122">Microsoft.Office.InfoPath アセンブリおよび Microsoft.Office.Interop.InfoPath.SemiTrust アセンブリで公開される各オブジェクト モデルのメンバーのセキュリティ レベルについては、[Microsoft.Office.InfoPath](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.aspx) 名前空間および [Microsoft.Office.Interop.InfoPath.SemiTrust](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.aspx) 名前空間のそのメンバーについて説明しているトピックの「解説」に記載されています。</span><span class="sxs-lookup"><span data-stu-id="599a7-122">The security level of each object model member exposed by the Microsoft.Office.InfoPath and Microsoft.Office.Interop.InfoPath.SemiTrust assemblies is specified in the Remarks section of the topic that documents that member in the [Microsoft.Office.InfoPath](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.aspx) and [Microsoft.Office.Interop.InfoPath.SemiTrust](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.aspx) namespaces.</span></span> 
  
## <a name="infopath-domain-access-security-levels"></a><span data-ttu-id="599a7-123">InfoPath ドメイン アクセスのセキュリティ レベル</span><span class="sxs-lookup"><span data-stu-id="599a7-123">InfoPath Domain Access Security Levels</span></span>

<span data-ttu-id="599a7-p101">InfoPath では、InfoPath アプリケーションで公開される COM サーバーによって強制されるオブジェクト モデルのセキュリティ レベルと関連して、フォーム テンプレートの場所、フォームの展開方法、およびデザイン モードでの設定に応じて適用される 3 つのセキュリティ レベルが定義されます。これらの 3 つのセキュリティ レベルを次の表に示します。</span><span class="sxs-lookup"><span data-stu-id="599a7-p101">In conjunction with the object model security levels that are enforced by the COM server exposed by the InfoPath application, InfoPath defines three security levels that are applied depending on where the form template is located, how the form is deployed, and settings configured in design mode. These three security levels are defined in the following table.</span></span>
  
|<span data-ttu-id="599a7-126">**ドメイン アクセスのセキュリティ レベル**</span><span class="sxs-lookup"><span data-stu-id="599a7-126">**Domain Access Security Level**</span></span>|<span data-ttu-id="599a7-127">**説明**</span><span class="sxs-lookup"><span data-stu-id="599a7-127">**Description**</span></span>|
|:-----|:-----|
|<span data-ttu-id="599a7-128">Restricted</span><span class="sxs-lookup"><span data-stu-id="599a7-128">Restricted</span></span>  <br/> |<span data-ttu-id="599a7-129">フォーム テンプレート外部での通信は許可されません。</span><span class="sxs-lookup"><span data-stu-id="599a7-129">Does not permit any communication outside of the form template.</span></span> <span data-ttu-id="599a7-130">このセキュリティ レベルでは、有害なフォームがコンピューターから悪意のある攻撃者へデータを転送することが防止されます。</span><span class="sxs-lookup"><span data-stu-id="599a7-130">This security level is intended to prevent harmful forms from transmitting any data from your computer to a malicious attacker.</span></span> <span data-ttu-id="599a7-131">このセキュリティ モードで実行しているときには、カスタム作業ウィンドウ、データ接続 (電子メールの送信を除く)、ActiveX コントロール、マネージ コード フォーム コード、ロール、およびワークフローの各機能は使用できません。</span><span class="sxs-lookup"><span data-stu-id="599a7-131">When running in this security mode, the following features will not work: Custom Task Pane, Data Connections (except email submit), ActiveX controls, managed code form code, Roles, and Workflow.</span></span> <span data-ttu-id="599a7-132">マネージ コード フォーム テンプレートは、"制限あり" のドメインでは実行できません。</span><span class="sxs-lookup"><span data-stu-id="599a7-132">Managed code form templates cannot run in the Restricted domain.</span></span> <span data-ttu-id="599a7-133">マネージ コード フォーム テンプレートに関して、[ **フォームのオプション**] ダイアログ ボックスの [ **セキュリティと信頼**] カテゴリで [ **自動的にセキュリティ レベルを設定する**] がオンになっている場合、コードを実行するには、常に少なくとも [ドメイン] セキュリティ アクセス レベルが必要です。</span><span class="sxs-lookup"><span data-stu-id="599a7-133">When a managed code form template is set to the **Automatically determine security level** setting in the **Security and Trust** category of the **Form Options** dialog box, the form template will always require at least the Domain security access level to run code.</span></span>  <br/><br/><span data-ttu-id="599a7-134">**重要**: マネージ コード フォーム テンプレート用に作成されたマネージ コード アセンブリは、"制限あり" のドメインからフォームが開かれた場合 (たとえば、電子メールの添付ファイルとして送信された InfoPath フォームから開かれた場合) は読み込まれず、実行されません。</span><span class="sxs-lookup"><span data-stu-id="599a7-134">**IMPORTANT**: The managed code assembly created for a managed code form template will not load and run when a form is opened from a Restricted domain, for example, from an InfoPath form sent as an email attachment.</span></span> <span data-ttu-id="599a7-135">電子メールの添付ファイルとして展開するフォーム テンプレートには、上記の機能を含めないようにする必要があります。フォーム テンプレートにフォーム コードが含まれる場合、フォーム コードは JScript または VBScript で実装し、セキュリティ レベル 0 のオブジェクト モデルのメンバーのみを使用する必要があります。</span><span class="sxs-lookup"><span data-stu-id="599a7-135">Any form template you wish to deploy as an email attachment must omit the features listed above, and if the form template contains form code, form code must be implemented in JScript or VBScript, and must only utilize object model members with a security level of 0 (zero).</span></span>           |
|<span data-ttu-id="599a7-136">ドメイン</span><span class="sxs-lookup"><span data-stu-id="599a7-136">Domain</span></span>  <br/> |<span data-ttu-id="599a7-p104">Microsoft Internet Explorer で定義されているセキュリティ ゾーンでのフォームの場所に応じて、フォームが制限されます。たとえば、フォームがローカル イントラネット ゾーンにある場合、そのドメイン内の他のデータと通信することは許可されますが、他のドメインからデータを取得することは許可されません。Microsoft Internet Explorer のセキュリティ ゾーンにより、スクリプトが安全に使用できない可能性があるとマークされている ActiveX コントロールの実行を許可するかどうかも決定されます。</span><span class="sxs-lookup"><span data-stu-id="599a7-p104">Restricts a form based on its location in one of the security zones defined by Microsoft Internet Explorer. For example, if the form is located in the Local Intranet zone, it is allowed to communicate with other data inside its own domain but it is not permitted to retrieve data from other domains. The location in a Microsoft Internet Explorer security zone also determines whether ActiveX controls that are marked as unsafe for scripting will be allowed to run.</span></span>  <br/> |
|<span data-ttu-id="599a7-140">完全信頼</span><span class="sxs-lookup"><span data-stu-id="599a7-140">Full Trust</span></span>  <br/> |<span data-ttu-id="599a7-p105">フォームが使用されるコンピューターで、完全な信頼によりフォームを実行することが許可されます。このセキュリティ レベルを使用できるのは、コンピューターの信頼されたルート発行元に一致する署名によりデジタル署名されたフォームを操作する場合か、フォームをインストールし、フォーム定義ファイル (.xsf) で **xDocumentClass** 要素の **requireFullTrust** 属性を "yes" に設定するインストール プログラムを作成する場合のみです。この設定を使用すると、フォームはオブジェクト モデルのセキュリティ レベル 3 を必要とするオブジェクト モデル (ファイル システムにアクセスするプロパティとメソッドなど) の呼び出しにアクセスすることができ、より制限の高いセキュリティ レベルで実行するときに表示される、特定のセキュリティ プロンプトを無効にすることができます  </span><span class="sxs-lookup"><span data-stu-id="599a7-p105">Allows you to run a form with full trust on the computer where the form will be used. This security level can only be used when working with a form that is digitally signed with a signature that matches a trusted root publisher on your computer, or by creating an installation program that installs the form and sets the **requireFullTrust** attribute of the **xDocumentClass** element to "yes" in the form definition file (.xsf). By using this setting, your form can access object model calls that require object model security level 3, such as properties and methods that access the file system, and you can disable certain security prompts that appear when running at a more restrictive security level.  </span></span><br/> |
   
<span data-ttu-id="599a7-144">既定では、フォーム テンプレートで使用されている機能と、フォーム テンプレートの展開場所および展開方法に応じて、InfoPath フォームは [制限あり] セキュリティ レベルまたは [ドメイン] セキュリティ レベルを自動的に選択するように構成されます。</span><span class="sxs-lookup"><span data-stu-id="599a7-144">By default, an InfoPath form is configured to select automatically either the Restricted or Domain security level depending on the features that are being used in the form template, and where and how the form template is deployed.</span></span> <span data-ttu-id="599a7-145">たとえば、電子メールの添付ファイルとして展開されたフォーム テンプレートは、[制限あり] セキュリティ レベルに自動的に構成されます。</span><span class="sxs-lookup"><span data-stu-id="599a7-145">For example, a form template deployed as an email attachment is automatically configured to the Restricted security level.</span></span> <span data-ttu-id="599a7-146">ユーザーおよびデータの保護レベルを高めるために、このセキュリティ設定は常に可能な限り高い制限となり、[制限あり] で開始されます。</span><span class="sxs-lookup"><span data-stu-id="599a7-146">The security setting is always as restrictive as possible, starting at Restricted, to ensure a greater level of protection for you and your data.</span></span> <span data-ttu-id="599a7-147">マネージ コードを含むフォーム テンプレートがセキュリティ レベルを自動的に選択するように設定される場合、コードを実行するには、フォーム テンプレートでは常に少なくとも [ドメイン] セキュリティ アクセス レベルが必要になります。</span><span class="sxs-lookup"><span data-stu-id="599a7-147">When a form template that contains managed code is set to automatically select the security level, the form template will always require at least the Domain security access level before code can run.</span></span> <span data-ttu-id="599a7-148">次の手順を使用すると、デザイン時にこの設定を上書きし、フォームでより適切なセキュリティ レベルを選択することができます。</span><span class="sxs-lookup"><span data-stu-id="599a7-148">You can manually override this setting at design time to select a level of security that is more appropriate for the form by using the following procedure.</span></span> 
  
### <a name="specify-a-forms-security-level"></a><span data-ttu-id="599a7-149">フォームのセキュリティ レベルを指定する</span><span class="sxs-lookup"><span data-stu-id="599a7-149">Specify a form's security level</span></span>

1. <span data-ttu-id="599a7-150">InfoPath フォーム デザイナーでフォームを開き、[ **ファイル**] タブをクリックして、[ **情報**] タブの [ **フォームのオプション**] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="599a7-150">Open the form in the InfoPath form designer, click the **File** tab, click **Info**, and then click **Form Options**.</span></span>
    
2. <span data-ttu-id="599a7-151">[ **フォームのオプション**] ダイアログ ボックスの [ **セキュリティと信頼**] カテゴリをクリックします。</span><span class="sxs-lookup"><span data-stu-id="599a7-151">In the **Form Options** dialog box, click the **Security and Trust** category.</span></span> 
    
3. <span data-ttu-id="599a7-152">[ **自動的にセキュリティ レベルを設定する (推奨)**] チェック ボックスをオフにします。</span><span class="sxs-lookup"><span data-stu-id="599a7-152">Clear the **Automatically determine security level (recommended)** check box.</span></span> 
    
4. <span data-ttu-id="599a7-153">目的のセキュリティ レベルを選択します。</span><span class="sxs-lookup"><span data-stu-id="599a7-153">Select the desired security level.</span></span>
    
> [!NOTE] 
> - <span data-ttu-id="599a7-154">マネージ コード フォーム テンプレートで [ **制限あり**] セキュリティ レベルを選択すると、フォーム コードで使用されるオブジェクト モデルのメンバーにかかわらず、フォームの分離コードは読み込まれず、実行されません。</span><span class="sxs-lookup"><span data-stu-id="599a7-154">If you the select the **Restricted** security level for a managed code form template, the code behind the form will not load and run regardless of which object model members are used in the form code.</span></span> <span data-ttu-id="599a7-155">このセキュリティ レベルは、主に電子メールを使用して展開される InfoPath フォームを対象としています。</span><span class="sxs-lookup"><span data-stu-id="599a7-155">This security level is primarily designed for InfoPath forms that are deployed using email.</span></span>     
> - <span data-ttu-id="599a7-156">セキュリティ レベルとして **[完全信頼]** を選択した場合は、フォームをデジタル署名するか、またはインストールして登録する必要があります。</span><span class="sxs-lookup"><span data-stu-id="599a7-156">If you select the **Full Trust** security level, you need to digitally sign or install and register the form.</span></span> <span data-ttu-id="599a7-157">詳細については、「[コードを含む InfoPath フォーム テンプレートを展開する](how-to-deploy-infopath-form-templates-with-code.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="599a7-157">For more information, see [Deploy InfoPath Form Templates with Code](how-to-deploy-infopath-form-templates-with-code.md).</span></span>
    
<span data-ttu-id="599a7-p109">次の表は、InfoPath セキュリティ モデルの概要を示しています。最初の列には、フォームで指定されるレベルまたは必要なレベルを示します。2 つ目および 3 つ目の列には、場所の URN 識別子または URL 識別子がフォームに含まれるかどうかを示します。その他の列には、実行が許可される項目を示します。展開のシナリオと、マネージ コード フォーム テンプレートのアクセス許可の詳細については、このトピックの後で説明する「共通言語ランタイム コードのアクセス セキュリティ機能」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="599a7-p109">The following table summarizes the InfoPath security model. The first column lists the level specified for or required by the form. The second and third columns specify whether the form has a URN or URL identifier for its location. The remaining columns specify what is allowed to run. For more information on deployment scenarios and permission sets for managed code form templates, see the "Common Language Runtime Code Access Security Features" section later in this topic.</span></span>
  
|<span data-ttu-id="599a7-163">**フォームで必要なレベル**</span><span class="sxs-lookup"><span data-stu-id="599a7-163">**Level Required by form**</span></span>|<span data-ttu-id="599a7-164">**URN 識別子を含む**</span><span class="sxs-lookup"><span data-stu-id="599a7-164">**Has URN Identifier**</span></span>|<span data-ttu-id="599a7-165">**URL 識別子を含む**</span><span class="sxs-lookup"><span data-stu-id="599a7-165">**Has URL Identifier**</span></span>|<span data-ttu-id="599a7-166">**スクリプトの実行は安全ではないとマークされている ActiveX**</span><span class="sxs-lookup"><span data-stu-id="599a7-166">**ActiveX marked unsafe for scripting**</span></span>|<span data-ttu-id="599a7-167">**クロス ドメイン アクセス**</span><span class="sxs-lookup"><span data-stu-id="599a7-167">**Cross-Domain Access**</span></span>|<span data-ttu-id="599a7-168">**マネージ コード**</span><span class="sxs-lookup"><span data-stu-id="599a7-168">**Managed code**</span></span>|<span data-ttu-id="599a7-169">**オブジェクト モデルのセキュリティ**</span><span class="sxs-lookup"><span data-stu-id="599a7-169">**Object Model Security**</span></span>|
|:-----|:-----|:-----|:-----|:-----|:-----|:-----|
|<span data-ttu-id="599a7-170">制限あり</span><span class="sxs-lookup"><span data-stu-id="599a7-170">Restricted</span></span>  <br/> ||<span data-ttu-id="599a7-171">X</span><span class="sxs-lookup"><span data-stu-id="599a7-171">X</span></span>  <br/> |<span data-ttu-id="599a7-172">ActiveX はまったく実行されない</span><span class="sxs-lookup"><span data-stu-id="599a7-172">No ActiveX at all</span></span>  <br/> |<span data-ttu-id="599a7-173">失敗</span><span class="sxs-lookup"><span data-stu-id="599a7-173">Fail</span></span>  <br/> |<span data-ttu-id="599a7-174">フォームは読み込まれるが、マネージ コードは実行されない</span><span class="sxs-lookup"><span data-stu-id="599a7-174">Form loads, but managed code won't run</span></span>  <br/> |<span data-ttu-id="599a7-175">.0</span><span class="sxs-lookup"><span data-stu-id="599a7-175">0</span></span>  <br/> |
|<span data-ttu-id="599a7-176">ドメイン (Internet Explorer の [ **制限付きサイト**] ゾーン)</span><span class="sxs-lookup"><span data-stu-id="599a7-176">Domain (Internet Explorer **Restricted sites** zone)</span></span>  <br/> |<span data-ttu-id="599a7-177">まったく実行されない</span><span class="sxs-lookup"><span data-stu-id="599a7-177">Won't run at all</span></span>  <br/> |<span data-ttu-id="599a7-178">まったく実行されない</span><span class="sxs-lookup"><span data-stu-id="599a7-178">Won't run at all</span></span>  <br/> |<span data-ttu-id="599a7-179">まったく実行されない</span><span class="sxs-lookup"><span data-stu-id="599a7-179">Won't run at all</span></span>  <br/> |<span data-ttu-id="599a7-180">まったく実行されない</span><span class="sxs-lookup"><span data-stu-id="599a7-180">Won't run at all</span></span>  <br/> |<span data-ttu-id="599a7-181">まったく実行されない</span><span class="sxs-lookup"><span data-stu-id="599a7-181">Won't run at all</span></span>  <br/> |<span data-ttu-id="599a7-182">まったく実行されない</span><span class="sxs-lookup"><span data-stu-id="599a7-182">Won't run at all</span></span>  <br/> |
|<span data-ttu-id="599a7-183">ドメイン (Internet Explorer の [ **インターネット**] ゾーン)</span><span class="sxs-lookup"><span data-stu-id="599a7-183">Domain (Internet Explorer **Internet** zone)</span></span>  <br/> |<span data-ttu-id="599a7-184">X</span><span class="sxs-lookup"><span data-stu-id="599a7-184">X</span></span>  <br/> ||<span data-ttu-id="599a7-185">失敗</span><span class="sxs-lookup"><span data-stu-id="599a7-185">Fail</span></span>  <br/> |<span data-ttu-id="599a7-186">失敗</span><span class="sxs-lookup"><span data-stu-id="599a7-186">Fail</span></span>  <br/> |<span data-ttu-id="599a7-187">まったく実行されない</span><span class="sxs-lookup"><span data-stu-id="599a7-187">Won't run at all</span></span>  <br/> |<span data-ttu-id="599a7-188">.0</span><span class="sxs-lookup"><span data-stu-id="599a7-188">0</span></span>  <br/> |
|<span data-ttu-id="599a7-189">ドメイン (Internet Explorer の [ **ローカル イントラネット**] ゾーン)</span><span class="sxs-lookup"><span data-stu-id="599a7-189">Domain (Internet Explorer **Local intranet** zone)</span></span>  <br/> |<span data-ttu-id="599a7-190">X</span><span class="sxs-lookup"><span data-stu-id="599a7-190">X</span></span>  <br/> ||<span data-ttu-id="599a7-191">失敗</span><span class="sxs-lookup"><span data-stu-id="599a7-191">Fail</span></span>  <br/> |<span data-ttu-id="599a7-192">プロンプト</span><span class="sxs-lookup"><span data-stu-id="599a7-192">Prompt</span></span>  <br/> |<span data-ttu-id="599a7-193">マネージ コードは [ **ローカル イントラネット**] のアクセス許可により実行される</span><span class="sxs-lookup"><span data-stu-id="599a7-193">Managed code runs with **Local intranet** permissions.</span></span>  <br/> |<span data-ttu-id="599a7-194">pbm-2</span><span class="sxs-lookup"><span data-stu-id="599a7-194">2</span></span>  <br/> |
|<span data-ttu-id="599a7-195">ドメイン (Internet Explorer の [ **信頼済みサイト**] ゾーン)</span><span class="sxs-lookup"><span data-stu-id="599a7-195">Domain (Internet Explorer **Trusted sites** zone)</span></span>  <br/> |<span data-ttu-id="599a7-196">X</span><span class="sxs-lookup"><span data-stu-id="599a7-196">X</span></span>  <br/> ||<span data-ttu-id="599a7-197">ダイアログを表示する</span><span class="sxs-lookup"><span data-stu-id="599a7-197">Prompt</span></span>  <br/> |<span data-ttu-id="599a7-198">OK</span><span class="sxs-lookup"><span data-stu-id="599a7-198">OK</span></span>  <br/> |<span data-ttu-id="599a7-p110">マネージ コードは [ **インターネット**] のアクセス許可により実行される。クロス ドメイン アクセスは許可される。フォームは [ **信頼済みサイト**] ゾーンだが、[ **インターネット**] ゾーンのアクセス許可が適用されることに注意すること。  </span><span class="sxs-lookup"><span data-stu-id="599a7-p110">Managed code runs with **Internet** permissions. Cross-domain access is allowed. Note that even though the form is in the **Trusted sites** zone, **Internet** zone permissions are applied.  </span></span><br/> |<span data-ttu-id="599a7-202">pbm-2</span><span class="sxs-lookup"><span data-stu-id="599a7-202">2</span></span>  <br/> |
|<span data-ttu-id="599a7-203">ドメイン (Internet Explorer の [ **ローカル コンピューター**] ゾーン)</span><span class="sxs-lookup"><span data-stu-id="599a7-203">Domain (Internet Explorer **Local computer** zone)</span></span>  <br/> |<span data-ttu-id="599a7-204">X</span><span class="sxs-lookup"><span data-stu-id="599a7-204">X</span></span>  <br/> |<span data-ttu-id="599a7-205">X</span><span class="sxs-lookup"><span data-stu-id="599a7-205">X</span></span>  <br/> |<span data-ttu-id="599a7-206">ダイアログを表示する</span><span class="sxs-lookup"><span data-stu-id="599a7-206">Prompt</span></span>  <br/> |<span data-ttu-id="599a7-207">失敗</span><span class="sxs-lookup"><span data-stu-id="599a7-207">Fail</span></span>  <br/> |<span data-ttu-id="599a7-208">マネージ コードは [ **ローカル イントラネット**] のアクセス許可により実行される</span><span class="sxs-lookup"><span data-stu-id="599a7-208">Managed code runs with **Local intranet** permissions.</span></span>  <br/> |<span data-ttu-id="599a7-209">pbm-2</span><span class="sxs-lookup"><span data-stu-id="599a7-209">2</span></span>  <br/> |
|<span data-ttu-id="599a7-210">完全信頼</span><span class="sxs-lookup"><span data-stu-id="599a7-210">Full Trust</span></span>  <br/> |<span data-ttu-id="599a7-211">X</span><span class="sxs-lookup"><span data-stu-id="599a7-211">X</span></span>  <br/> |<span data-ttu-id="599a7-212">X</span><span class="sxs-lookup"><span data-stu-id="599a7-212">X</span></span>  <br/> |<span data-ttu-id="599a7-213">OK</span><span class="sxs-lookup"><span data-stu-id="599a7-213">OK</span></span>  <br/> |<span data-ttu-id="599a7-214">OK</span><span class="sxs-lookup"><span data-stu-id="599a7-214">OK</span></span>  <br/> |<span data-ttu-id="599a7-215">完全信頼</span><span class="sxs-lookup"><span data-stu-id="599a7-215">Full Trust</span></span>  <br/> |<span data-ttu-id="599a7-216">1/3</span><span class="sxs-lookup"><span data-stu-id="599a7-216">3</span></span>  <br/> |
   
> [!IMPORTANT]
> <span data-ttu-id="599a7-p111">上記の説明で "スクリプトの実行は安全ではないとマークされている ActiveX" 列および "クロス ドメイン アクセス" 列では、Microsoft Internet Explorer の既定のセキュリティ設定が使用されることを前提としています。ユーザーがセキュリティ設定を変更した場合、InfoPath の動作はそれに応じて変更されます。たとえば、[ **ローカル イントラネット**] ゾーンで [ **ドメイン間でのデータ ソースのアクセス**] を [ **有効にする**] に設定した場合、上の表のようにクロス ドメイン アクセスを許可するかどうかを確認するダイアログ ボックスは表示されません。</span><span class="sxs-lookup"><span data-stu-id="599a7-p111">The descriptions above in the "ActiveX marked unsafe for scripting" and "Cross-Domain Access" columns assume the default security settings for Microsoft Internet Explorer. If a user changes their security settings, InfoPath will behave accordingly. For example, if in the **Local intranet** zone, **Access data sources across domains** is set to **Enable**, then users will not be prompted to allow cross-domain access as described in the table.</span></span> 
  
## <a name="common-language-runtime-code-access-security-features"></a><span data-ttu-id="599a7-220">共通言語ランタイム コードのアクセス セキュリティ機能</span><span class="sxs-lookup"><span data-stu-id="599a7-220">Common Language Runtime Code Access Security Features</span></span>

<span data-ttu-id="599a7-221">InfoPath マネージ コード フォーム テンプレートをコンパイルすると、フォーム コードのロジックの実装を含むプライベート マネージ コード アセンブリが作成されます。</span><span class="sxs-lookup"><span data-stu-id="599a7-221">When an InfoPath managed code form template is compiled, a private managed code assembly is created that contains the implementation of the form code logic.</span></span>
  
<span data-ttu-id="599a7-p112">.NET Framework では、既定でマネージ コード アセンブリはローカル マシンでの実行時に完全信頼アクセス許可が設定され、イントラネットでの実行時には完全信頼アクセス許可は与えられません。セキュリティ ポリシーをより詳細に管理し、InfoPath マネージ コード フォーム テンプレートをイントラネットから完全に信頼されたフォームとして実行するオプションを提供するために、InfoPath には次のセキュリティ アーキテクチャが実装されています。</span><span class="sxs-lookup"><span data-stu-id="599a7-p112">In the .NET Framework, by default, a managed code assembly has Full Trust permissions when running on the local machine, and is not granted Full Trust permissions when running on the Intranet. To provide more fine-grained control over security policy, and to provide the option to run InfoPath managed code form templates as fully trusted forms from the Intranet, InfoPath implements the following security architecture.</span></span>
  
- <span data-ttu-id="599a7-224">InfoPath アプリケーションは, .NET Framework 共通言語ランタイム (CLR) をホストします。</span><span class="sxs-lookup"><span data-stu-id="599a7-224">The InfoPath application hosts the .NET Framework common language runtime (CLR).</span></span>
    
- <span data-ttu-id="599a7-225">InfoPath でホストされる CLR 内で、各マネージ コード フォーム テンプレートは異なるアプリケーション ドメインで実行されます。これは、マネージ コードを実行するための分離、アンロード、およびセキュリティの境界を備えた環境です。</span><span class="sxs-lookup"><span data-stu-id="599a7-225">Within the CLR hosted by InfoPath, each managed code form template runs in a separate application domain, which is an environment that provides isolation, unloading, and security boundaries for executing managed code.</span></span>
    
- <span data-ttu-id="599a7-226">InfoPath では、フォーム テンプレートに関連付けられた信頼のレベルと場所の URL に応じて、アプリケーション ドメインに既定のセキュリティ ポリシーが設定されます。</span><span class="sxs-lookup"><span data-stu-id="599a7-226">InfoPath sets a default security policy on the application domain depending on the level of trust associated with the form template and the URL of its location.</span></span>
    
- <span data-ttu-id="599a7-p113">既定では、ローカル コンピューター ([マイ コンピューター ゾーン] コード グループ) で実行されるマネージ コード フォーム テンプレートには、完全信頼 (ローカル イントラネット ゾーンのアクセス許可) よりも低いレベルのアクセス許可が与えられます。完全信頼アクセス許可を得るには、フォームを登録するか、信頼済みの証明書を使用してデジタル署名する必要があります。</span><span class="sxs-lookup"><span data-stu-id="599a7-p113">By default, a managed code form template running on the local computer (the My Computer Zone code group) gets a lower level of permissions than Full Trust (Local Intranet Zone permissions). To have Full Trust permissions, the form must be registered or digitally signed with a trusted certificate.</span></span>
    
<span data-ttu-id="599a7-p114">マネージ コード フォーム テンプレートのアプリケーション ドメインに設定された既定のセキュリティ ポリシーにより、InfoPath ドメイン アクセスのセキュリティ レベルと、追加の .NET セキュリティ制限が確実に実施されます。InfoPath セキュリティ システムでは、さらに柔軟性を高めるために、"InfoPath フォーム テンプレート" という名前の .NET コード アクセス セキュリティ コード グループが認識されます。このコード グループがユーザーのコンピューターに存在する場合、そのセキュリティ構成と、グループ内の子コード グループのセキュリティ構成が、アプリケーションのドメインに適用されます。</span><span class="sxs-lookup"><span data-stu-id="599a7-p114">The default security policy set for the application domain of a managed code form template ensures that the InfoPath domain access security levels as well as any additional .NET security restrictions are enforced. To provide additional flexibility, the InfoPath security system recognizes a .NET code access security code group named "InfoPath Form Templates". If this code group is present on a user's computer, its security configuration, and those of any child code groups within it will be applied to the application domain.</span></span>
  
> [!IMPORTANT] 
> - <span data-ttu-id="599a7-p115">InfoPath フォーム テンプレートのコード グループは、マネージ コードのフォーム コード アセンブリにのみ適用されます。その結果、InfoPath マネージ コードのフォーム コードに完全信頼アクセス許可のセットを付与しても、フォーム テンプレートをインストールおよび登録 (またはデジタル署名) していない場合 (この操作を行うと、フォーム テンプレート全体が完全に信頼されます)、フォーム コードからセキュリティ レベル 3 のオブジェクト モデルのメンバーの呼び出しは失敗します。</span><span class="sxs-lookup"><span data-stu-id="599a7-p115">The InfoPath Form Templates code group applies only to the managed code form code assembly itself. As a result, if you grant the Full Trust permission set to InfoPath managed code form code, but you have not installed and registered (or digitally signed) the form template itself (which makes the entire form template fully trusted), calls in the form code to security level 3 object model members will still fail.</span></span>   
> - <span data-ttu-id="599a7-234">ハッシュ、厳密な名前、または発行元の証拠を使用して、制限されたアクセス許可のセットによって構成されたアセンブリを参照するか明示的に読み込み (Assembly.Load)、フォーム テンプレート プロジェクトでのメンバーシップの状態を判断する場合、アセンブリはフォーム テンプレートによって読み込まれ、実行されます。</span><span class="sxs-lookup"><span data-stu-id="599a7-234">If you reference or explicitly load (Assembly.Load) an assembly that is configured with a restricted permission set using Hash, Strong Name, or Publisher evidence to determine its membership condition in a form template project, the assembly will nonetheless be loaded and executed by the form template.</span></span>
    
<span data-ttu-id="599a7-235">InfoPath フォーム テンプレートのコード グループを作成し、構成する方法については、「[コードを含むフォーム テンプレートのセキュリティ設定を構成する](how-to-configure-security-settings-for-form-templates-with-code.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="599a7-235">For information on how to create and configure the InfoPath Form Templates code group, see [Configure Security Settings for Form Templates with Code](how-to-configure-security-settings-for-form-templates-with-code.md).</span></span>
  
<span data-ttu-id="599a7-236">次の表は、マネージ コード フォーム テンプレートに適用されるアクセス許可のセットと展開シナリオをまとめたものです。</span><span class="sxs-lookup"><span data-stu-id="599a7-236">The following table summarizes the deployment scenarios and permission sets that apply to managed code form templates.</span></span>
  
|<span data-ttu-id="599a7-237">**展開シナリオ**</span><span class="sxs-lookup"><span data-stu-id="599a7-237">**Deployment Scenario**</span></span>|<span data-ttu-id="599a7-238">**アクセス許可のセット**</span><span class="sxs-lookup"><span data-stu-id="599a7-238">**Permission Set**</span></span>|<span data-ttu-id="599a7-239">**メモ**</span><span class="sxs-lookup"><span data-stu-id="599a7-239">**Notes**</span></span>|
|:-----|:-----|:-----|
|<span data-ttu-id="599a7-240">フォーム テンプレートがローカル コンピューターで発行され、開発者は Visual Studio を使用してフォーム コードを記述し、デバッグする。</span><span class="sxs-lookup"><span data-stu-id="599a7-240">The form template is published on the local computer, and the developer is using Visual Studio to write and debug form code.</span></span>  <br/> |<span data-ttu-id="599a7-241">ローカル イントラネットのアクセス許可のセット</span><span class="sxs-lookup"><span data-stu-id="599a7-241">Local Intranet permission set.</span></span>  <br/> <span data-ttu-id="599a7-242">グローバル アセンブリ キャッシュ (GAC) にインストールされ、 **AllowPartiallyTrustedCallersAttribute** 属性でマークされたアセンブリには、完全許可アクセス許可のセットが付与されます。</span><span class="sxs-lookup"><span data-stu-id="599a7-242">Assemblies installed in the Global Assembly Cache (GAC) and marked with the **AllowPartiallyTrustedCallersAttribute** attribute are granted the Full Trust permission set.</span></span>  <br/> |<span data-ttu-id="599a7-243">既定では、ローカル コンピューターから実行されているフォーム テンプレートには完全信頼アクセス許可のセットは付与されません。</span><span class="sxs-lookup"><span data-stu-id="599a7-243">By default, form templates running from the local computer are not granted the Full Trust permission set.</span></span> <span data-ttu-id="599a7-244">完全信頼アクセス許可を必要とするオブジェクト モデルのメンバーの機能を使用し、呼び出すフォーム テンプレートを開発するときは、「[完全信頼が必要なフォーム テンプレートをプレビューおよびデバッグする](how-to-preview-and-debug-form-templates-that-require-full-trust.md)」に記載された手順を使用することができます。</span><span class="sxs-lookup"><span data-stu-id="599a7-244">While developing form templates that use features and calls to object model members that require Full Trust permissions, you can use the procedure described in [Preview and Debug Form Templates that Require Full Trust](how-to-preview-and-debug-form-templates-that-require-full-trust.md).</span></span>  <br/> |
|<span data-ttu-id="599a7-245">フォーム テンプレートがローカル コンピューターに発行され、ローカル コンピューターで完全信頼アクセス許可のセットを要求するカスタム アセンブリを参照する。</span><span class="sxs-lookup"><span data-stu-id="599a7-245">The form template is published on the local computer and references a custom assembly that requests the Full Trust permission set on the local computer.</span></span>  <br/> |<span data-ttu-id="599a7-246">ローカル イントラネットのアクセス許可のセット</span><span class="sxs-lookup"><span data-stu-id="599a7-246">Local Intranet permission set.</span></span>  <br/> <span data-ttu-id="599a7-p117">グローバル アセンブリ キャッシュ (GAC) にインストールされ、 **AllowPartiallyTrustedCallersAttribute** 属性でマークされたアセンブリには、完全許可アクセス許可のセットが付与されます。カスタム アセンブリには、ローカル イントラネットのアクセス許可のセットが付与されます。  </span><span class="sxs-lookup"><span data-stu-id="599a7-p117">Assemblies installed in the Global Assembly Cache (GAC) and marked with the **AllowPartiallyTrustedCallersAttribute** attribute are granted the Full Trust permission set. The custom assembly is granted the Local Intranet permission set.  </span></span><br/> |<span data-ttu-id="599a7-p118">開発者は、フォーム テンプレートのコードで使用する外部アセンブリを参照するには、InfoPath フォーム テンプレートのコード グループを使用して、フォーム テンプレートのコードで参照される外部アセンブリに完全信頼 (または適切なアクセス許可セット) を付与する必要があります。InfoPath では、グローバル アセンブリ キャッシュ (GAC) にインストールされるものを除き、外部アセンブリに関する仮定項目はありません。開発者は、マイ コンピューター ゾーンのコード グループで付与されるアクセス許可によって既にアセンブリが信頼されている場合でも、InfoPath フォーム テンプレートのコード グループを使用して、必要なアクセス許可を明示的にアセンブリに付与する必要があります。</span><span class="sxs-lookup"><span data-stu-id="599a7-p118">To reference external assemblies for use in the form template's code, the developer must use the InfoPath Form Templates code group to grant Full Trust (or the appropriate permission set) to the external assembly referenced in the form template's code. InfoPath does not make any assumptions about external assemblies other than those installed in the Global Assembly Cache (GAC). The developer must explicitly grant the assembly the necessary permissions using the InfoPath Form Templates code group even if the assembly is already trusted though permissions granted in the My_Computer_Zone code group.</span></span>  <br/> |
|<span data-ttu-id="599a7-252">フォーム テンプレートは、ファイル共有、SharePoint フォーム ライブラリ、Web サーバーなど、ローカル イントラネットの共有された場所に発行される。</span><span class="sxs-lookup"><span data-stu-id="599a7-252">The form template is published on a shared location in the local intranet, such as a file share, SharePoint Form library, or a Web server.</span></span>  <br/> |<span data-ttu-id="599a7-253">ローカル イントラネットのアクセス許可のセット</span><span class="sxs-lookup"><span data-stu-id="599a7-253">Local Intranet permission set.</span></span>  <br/> <span data-ttu-id="599a7-254">グローバル アセンブリ キャッシュ (GAC) にインストールされ、 **AllowPartiallyTrustedCallersAttribute** 属性でマークされたアセンブリには、完全許可アクセス許可のセットが付与されます。</span><span class="sxs-lookup"><span data-stu-id="599a7-254">Assemblies installed in the Global Assembly Cache (GAC) and marked with the **AllowPartiallyTrustedCallersAttribute** attribute are granted the Full Trust permission set.</span></span>  <br/> ||
|<span data-ttu-id="599a7-255">フォーム テンプレートは、ファイル共有、SharePoint フォーム ライブラリ、Web サーバーなど、Internet Explorer で信頼済みサイトと指定された、ローカル イントラネット内の共有された場所に発行される。</span><span class="sxs-lookup"><span data-stu-id="599a7-255">The form template is published on a shared location in the local intranet, such as a file share, SharePoint Form library, or a Web server that is designated as a Trusted site in Internet Explorer.</span></span>  <br/> |<span data-ttu-id="599a7-256">インターネット アクセス許可のセット</span><span class="sxs-lookup"><span data-stu-id="599a7-256">Internet permission set.</span></span>  <br/> <span data-ttu-id="599a7-257">Microsoft および ECMA によって署名されたアセンブリには、完全信頼アクセス許可のセットが付与されます。</span><span class="sxs-lookup"><span data-stu-id="599a7-257">Assemblies signed by Microsoft and ECMA are granted the Full Trust permission set.</span></span>  <br/> |<span data-ttu-id="599a7-p119">CLR コードのアクセス セキュリティにより、Internet Explorer で信頼済みサイトと指定されたサイトには、インターネット アクセス許可のセットのみが付与されます。InfoPath ではこのポリシーがそのまま使用されます。これは、フォーム コードにスクリプトを使用する InfoPath フォーム テンプレートとは異なります。InfoPath フォーム テンプレートでは、信頼済みサイト ゾーンに発行されるときに、より高いレベルのアクセス許可が与えられます。</span><span class="sxs-lookup"><span data-stu-id="599a7-p119">CLR code access security grants only the Internet permission set to sites that are designated as Trusted sites in Internet Explorer. InfoPath respects this policy. Note that this is unlike an InfoPath form template that uses script for form code, which receives a higher level of permissions when published in a Trusted sites zone.</span></span>  <br/> |
|<span data-ttu-id="599a7-261">フォーム テンプレートはインターネット上の場所からダウンロードまたはコピーされる。</span><span class="sxs-lookup"><span data-stu-id="599a7-261">The form template is downloaded or copied from an Internet location.</span></span>  <br/> |<span data-ttu-id="599a7-p120">既定では、何も付与されません。フォーム テンプレートのマネージ コード アセンブリは読み込まれず、実行されません。</span><span class="sxs-lookup"><span data-stu-id="599a7-p120">By default, none. The managed code assembly for the form template is not loaded and does not run.</span></span>  <br/> ||
   
## <a name="see-also"></a><span data-ttu-id="599a7-264">関連項目</span><span class="sxs-lookup"><span data-stu-id="599a7-264">See also</span></span>

- [<span data-ttu-id="599a7-265">コードを含むフォーム テンプレートのセキュリティ設定を構成する</span><span class="sxs-lookup"><span data-stu-id="599a7-265">Configure Security Settings for Form Templates with Code</span></span>](how-to-configure-security-settings-for-form-templates-with-code.md)
- [<span data-ttu-id="599a7-266">完全信頼が必要なフォーム テンプレートをプレビューおよびデバッグする</span><span class="sxs-lookup"><span data-stu-id="599a7-266">Preview and Debug Form Templates that Require Full Trust</span></span>](how-to-preview-and-debug-form-templates-that-require-full-trust.md)

