---
title: InfoPath フォームと Microsoft Access データベースの統合
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
ms.assetid: 5ec9a9c0-b348-4a31-b377-e95db2f92455
description: Microsoft InfoPath では、Microsoft Access 2010 のデータベースをフォームのプライマリ データ ソースとして、あるいはフォームまたはコントロールのセカンダリ データ ソースとして使用できます。ここでは、Access 2010 データベースをデータ ソースとして使用する方法について説明します。
ms.openlocfilehash: 30aea15a5e9a8d19f64b3f089b71e859cff93e0e
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 06/11/2018
ms.locfileid: "19799166"
---
# <a name="integrate-an-infopath-form-with-a-microsoft-access-database"></a><span data-ttu-id="17861-104">InfoPath フォームと Microsoft Access データベースの統合</span><span class="sxs-lookup"><span data-stu-id="17861-104">Integrate an InfoPath Form with a Microsoft Access Database</span></span>

<span data-ttu-id="17861-p102">Microsoft InfoPath では、Microsoft Access 2010 のデータベースをフォームのプライマリ データ ソースとして、あるいはフォームまたはコントロールのセカンダリ データ ソースとして使用できます。ここでは、Access 2010 データベースをデータ ソースとして使用する方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="17861-p102">Microsoft InfoPath supports using a Microsoft Access 2010 database as the primary data source for a form, or as a secondary data source for a form or control. This article explains how to use an Access 2010 database as a data source.</span></span>
  
## <a name="using-a-microsoft-access-database-as-a-data-source"></a><span data-ttu-id="17861-107">データ ソースとして Microsoft Access データベースを使用する</span><span class="sxs-lookup"><span data-stu-id="17861-107">Using a Microsoft Access Database as a Data Source</span></span>

### <a name="setting-up-a-microsoft-access-database-as-a-forms-primary-data-source"></a><span data-ttu-id="17861-108">Microsoft Access データベースをフォームのプライマリ データ ソースとして設定する</span><span class="sxs-lookup"><span data-stu-id="17861-108">Setting Up a Microsoft Access Database as a Form's Primary Data Source</span></span>

<span data-ttu-id="17861-p103">InfoPath では **データ接続ウィザード**を使用してデータ接続を確立します。このウィザードを開くには、Microsoft Office Backstage の [ **新規作成**] タブにある [ **フォーム テンプレート (高度)**] セクションで [ **データベース**] を選択し、[ **Design This Form**] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="17861-p103">Database connections are established in InfoPath by using the **Data Connection Wizard**. This wizard is opened by selecting **Database** in the **Advanced Form Templates** section on the **New** tab of the Microsoft Office Backstage, and then clicking pressing **Design This Form**.</span></span>
  
<span data-ttu-id="17861-111">[ **データベースの選択**] をクリックすると、既存のデータ ソースを選択するか、特定のデータベース ファイルに直接接続できます。</span><span class="sxs-lookup"><span data-stu-id="17861-111">By clicking **Select Database**, you can choose an existing data source or connect directly to a specific database file.</span></span>
  
<span data-ttu-id="17861-p104">データベースを選択した後は、ウィザードに従って、フォームのデータ ソースとして使用するテーブルをそのデータベースから選択する必要があります。テーブルを追加していくと、テーブル相互のリレーションシップが確立され、[ **データ ソース構造**] ボックスの一覧に、各テーブルとそれらの階層関係が表示されます。[ **テーブルの列を表示する**] チェック ボックスをオンにすると、各テーブルのフィールドの名前が [データ ソース構造] ボックスの一覧に表示されます。各フィールド名の横にあるチェック ボックスを使用して、該当するフィールドをウィザードで作成する SQL ステートメントに含めるかどうかを指定できます。</span><span class="sxs-lookup"><span data-stu-id="17861-p104">After you select a database, the wizard prompts you to select a table from the database to use as the data source for the form. As you add tables, their relationships to each other are established, and the wizard displays the tables and their hierarchical relationships in the **Data source structure** list. If you select the **Show table columns** check box, the wizard displays the field names of each table in the Data source structure list; you use the check boxes next to each field name to specify whether a field is included in the SQL statement that the wizard constructs.</span></span> 
  
> [!NOTE]
> <span data-ttu-id="17861-115">[!メモ] 各テーブルの主キー フィールドは必ず選択されます。選択を解除することはできません。</span><span class="sxs-lookup"><span data-stu-id="17861-115">Primary key fields from each table are always selected and cannot be removed.</span></span> 
  
<span data-ttu-id="17861-p105">**データ接続ウィザード**を使用してテーブル、リレーションシップ、およびフィールドを指定したら、[ **SQL の編集**] をクリックして、フォームのデータ ソースの作成に使用される SQL ステートメントを表示できます。[ **SQL の編集**] ダイアログ ボックスの [ **SQL ステートメントのテスト**] をクリックすると、指定した情報からデータ ソースを作成できるかどうかを確認できます。また、[ **SQL の編集**] ダイアログ ボックスでは、表示されている SQL ステートメントを編集して、より複雑なクエリを作成することもできます。</span><span class="sxs-lookup"><span data-stu-id="17861-p105">When the tables, relationships, and fields have been specified using the **Data Connection Wizard**, you can click **Edit SQL** to view the SQL statement that will be used to establish the data source for the form. In the **Edit SQL** dialog box, you can click **Test SQL Statement** to verify that InfoPath will be able to create the data source from the information provided. You can also use the **Edit SQL** dialog box to modify the SQL statement to create more complex queries.</span></span> 
  
> [!NOTE]
> <span data-ttu-id="17861-p106">[!メモ] InfoPath で使用される SQL ステートメントは、データ シェイプ クエリです。データ シェイプ クエリでは、クエリ内の複数の論理エンティティ間に階層関係を指定できます。SQL JOIN ステートメントを使用できますが、このステートメントを使用するとフォームの送信が無効になるため、お勧めできません。データ シェイプ クエリの詳細については、Microsoft Developer Network (MSDN) のドキュメントを参照してください。</span><span class="sxs-lookup"><span data-stu-id="17861-p106">The SQL statements used by InfoPath are data shaping queries. Data shaping queries allow the building of hierarchical relationships between two or more logical entities in a query. It is possible to use SQL JOIN statements, but this is not recommended, because doing so will disable form submission. For more information on data shaping queries, see the documentation on the Microsoft Developer Network (MSDN).</span></span> 
  
<span data-ttu-id="17861-p107">**データ接続ウィザード**の最後のページには、データ ソースの名前とファイルの場所、プライマリ親テーブルの名前、使用されるテーブルの数、送信状態など、データ ソースに関する概要が表示されます。送信状態によって、生成される SQL ステートメントでデータをデータ ソースに正しく送信できるかどうかがわかります。</span><span class="sxs-lookup"><span data-stu-id="17861-p107">The last page of the **Data Connection Wizard** displays summary information about the data source, including the name and file location of the data source, the name of the primary parent table, the number of tables used, and the submit status. The submit status tells you whether the generated SQL statement will allow for successful submission of data to the data source.</span></span> 
  
### <a name="setting-up-a-microsoft-access-database-as-a-secondary-data-source"></a><span data-ttu-id="17861-125">Microsoft Access データベースをセカンダリ データ ソースとして設定する</span><span class="sxs-lookup"><span data-stu-id="17861-125">Setting up a Microsoft Access Database as a Secondary Data Source</span></span>

<span data-ttu-id="17861-p108">セカンダリ データ ソースは、リスト ボックスやドロップダウン リスト ボックスのエントリを提供する目的で使用できます。また、セカンダリ データ ソースのデータをフォームに追加するコードを記述することもできます。フォームでセカンダリ データ ソースを使用するには、フォームのデザイン時に [ **データ**] タブの [ **データ接続**] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="17861-p108">Secondary data sources can be used to provide the entries for a list box or drop-down list box, or you can write code to add data from a secondary data source to your form. To work with secondary data sources in your form, click **Data Connections** on the **Data** tab when designing a form.</span></span> 
  
<span data-ttu-id="17861-p109">**データ接続ウィザード**を起動すると、フォームに使用するデータを受信するか、またはフォームのデータを送信するかを選択するように求められます。[ **データの受信**] を選択して [ **次へ**] をクリックします。データベースからセカンダリ データ ソースを作成するには、[ **データベース (Microsoft SQL Server または Microsoft Office Access のみ)**] を選択します。ウィザードの次のページで、[ **データベースの選択**] をクリックし、既存のデータ ソースを選択するか、特定のデータベース ファイルに直接接続します。</span><span class="sxs-lookup"><span data-stu-id="17861-p109">When you start the **Data Connection Wizard**, you are prompted to select whether to receive data to use in the form, or to submit data in the form. Choose **Receive data**, and then click **Next**. To create a secondary data source from a database, select **Database (Microsoft SQL Server or Microsoft Office Access only)**. On the next page of the wizard, click **Select Database** to choose an existing data source or connect directly to a specific database file.</span></span> 
  
<span data-ttu-id="17861-p110">データベースを選択した後は、ウィザードに従って、フォームのデータ ソースとして使用するテーブルまたはクエリをそのデータベースから選択する必要があります。最初にテーブルまたはクエリを 1 つ選択する必要がありますが、必要に応じて後から追加のテーブルを選択できます。テーブルまたはクエリを選択したら、使用するフィールドを [ **データ ソース構造**] ボックスの一覧で選択できます。既定では、テーブルのフィールドがすべて選択されていますが、フォームに不要なフィールドは選択を解除できます。また、テーブルから返されるレコードの並べ替え方法や、複数のレコードを扱えるかどうかも設定できます。設定する場合は、[ **テーブルの変更**] をクリックし、[ **並べ替え順序**] ダイアログ ボックスで並べ替えの条件を最大 3 つ選択します。設定が終了したら、[ **完了**] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="17861-p110">After you select a database, the wizard prompts you to select a table or query from the database to use as the data source for the form. You must select one table or query to begin with, but you can select additional tables later if you want to include them. After you've selected a table or query, the wizard allows you to select the fields you want to use in the **Data source structure** list. By default, all the fields of the table are selected, but you can remove fields if they aren't necessary for your form. You can also control how the records returned from the table are sorted, and whether multiple records are allowed. To do so, click **Modify Table**, and then select up to three sorting criteria in the **Sort Order** dialog box. When you're satisfied, click **Finish**.</span></span>
  
> [!NOTE]
> <span data-ttu-id="17861-139">[!メモ] 各テーブルの主キー フィールドは必ず選択されます。選択を解除することはできません。</span><span class="sxs-lookup"><span data-stu-id="17861-139">Primary key fields from each table are always selected and cannot be removed.</span></span> 
  
<span data-ttu-id="17861-p111">InfoPath では、複数のテーブルまたはクエリから同時にデータを取得することもできます。複数のテーブルまたはクエリからデータを取得するときは、 **データ接続ウィザード**で最初に選択したテーブルやクエリと関係のあるすべてのテーブルまたはクエリの間でリレーションシップを確立できる必要があります。たとえば、ノースウィンド データベースの得意先テーブルからデータを取得した場合は、受注テーブルを追加して、その顧客のすべての受注に関するデータを取得したり、受注明細テーブルを追加して、個々の注文の詳細を取得したりできます。</span><span class="sxs-lookup"><span data-stu-id="17861-p111">InfoPath also enables you to retrieve data from multiple tables or queries at the same time. When you retrieve data from multiple tables or queries, you must be able to establish a relationship between all of the tables or queries involved with the original table or query you selected in the **Data Connection Wizard**. For example, if you were retrieving data from the Customers table of the Northwind database, you could add the Orders table to retrieve data about all the orders for that customer, and you could add the Order Details table to retrieve the details of each order.</span></span>
  
<span data-ttu-id="17861-p112">データ ソースにテーブルを追加するには、子テーブルの追加先のテーブルを [ **データ ソース構造**] ボックスの一覧で選択し、[ **テーブルの追加**] をクリックします。追加するテーブルまたはクエリを選択し、[ **次へ**] をクリックします。使用するリレーションシップ (複数可) を選択するように求められます。2 つのテーブルに同じ名前のフィールドがある場合は、それらのフィールドがリレーションシップとして自動的に追加されます。同じ名前のフィールドがない場合や、カスタムのリレーションシップを使用する場合は、[ **リレーションシップの追加**] をクリックして、親テーブルのどのフィールドを子テーブルのフィールドに対応付けるかを指定します。[ **リレーションシップの編集**] ダイアログボックスの [ **リレーションシップの削除**] をクリックして、既存のリレーションシップを削除することもできます。</span><span class="sxs-lookup"><span data-stu-id="17861-p112">To add an additional table to the data source, select the table you want to add a child table to in the **Data source structure** list, and then click **Add Table**. Select the table or query you want to add, and then click **Next**. InfoPath prompts you to select the relationship or relationships you want to use. If fields in the two tables have the same name, InfoPath automatically adds those fields as a relationship, but if not, or if you want to use a custom relationship, you can click **Add Relationship** to specify which fields in the parent table correspond to fields in the child table. You can also remove existing relationships by clicking **Remove Relationship** in the **Edit Relationship** dialog box.</span></span> 
  
<span data-ttu-id="17861-p113">リレーションシップの設定が終了したら、[ **完了**] をクリックします。メイン テーブルの場合と同様に、子テーブルからどのフィールドを返すかを指定できます。ただし、[ **テーブルの変更**] ボタンを使用して、レコードを返す順序を編集することはできません。</span><span class="sxs-lookup"><span data-stu-id="17861-p113">When you're satisfied with the relationships, click **Finish**. As with the main table, you can specify which fields are returned from the child table. You cannot, however, use the **Modify Table** button to edit the order in which the records are returned.</span></span> 
  
<span data-ttu-id="17861-p114">テーブル、リレーションシップ、およびフィールドを指定したら、[ **SQL の編集**] をクリックして、フォームのデータ ソースの作成に使用される SQL ステートメントを表示できます。[ **SQL の編集**] ダイアログ ボックスの [ **SQL ステートメントのテスト**] をクリックすると、指定した情報からデータ ソースを作成できるかどうかを確認できます。また、[ **SQL の編集**] ダイアログ ボックスでは、表示されている SQL ステートメントを編集して、より複雑なクエリを作成することもできます。</span><span class="sxs-lookup"><span data-stu-id="17861-p114">When the tables, relationships, and fields have been specified, you can click **Edit SQL** to view the SQL query statement that will be used to establish the data source for the form. In the **Edit SQL** dialog box, you can click **Test SQL Statement** to verify that InfoPath will be able to create the data source from the information provided. You can also use the **Edit SQL** dialog box to modify the SQL statement to create more complex queries.</span></span> 
  
> [!NOTE]
> <span data-ttu-id="17861-p115">[!メモ] InfoPath で使用される SQL ステートメントは、データ シェイプ クエリです。データ シェイプ クエリでは、クエリ内の複数の論理エンティティ間に階層関係を指定できます。SQL JOIN ステートメントを使用できますが、このステートメントを使用するとフォームの送信が無効になるため、お勧めできません。データ シェイプ クエリの詳細については、Microsoft Developer Network (MSDN) のドキュメントを参照してください。</span><span class="sxs-lookup"><span data-stu-id="17861-p115">The SQL statements used by InfoPath are data shaping queries. Data shaping queries allow the building of hierarchical relationships between two or more logical entities in a query. It is possible to use SQL JOIN statements, but this is not recommended, because doing so will disable form submission. For more information on data shaping queries, see the documentation on the Microsoft Developer Network (MSDN).</span></span> 
  
## <a name="enabling-form-submission"></a><span data-ttu-id="17861-158">フォームの送信を有効にする</span><span class="sxs-lookup"><span data-stu-id="17861-158">Enabling Form Submission</span></span>

<span data-ttu-id="17861-p116">InfoPath では、Access データベースからデータを受信するだけでなく、新しいデータや変更されたデータをデータベースに送り返すことができます。[ **ホーム**] タブまたは Microsoft Office Backstage の [ **送信**] コマンドを使用して、変更内容をデータベースに送信すると、ActiveX データ オブジェクト (ADO) を使用してデータベースのレコードが更新されます。フォームの送信は、次のすべての条件が満たされる場合に有効になります。</span><span class="sxs-lookup"><span data-stu-id="17861-p116">In addition to receiving data from an Access database, InfoPath can submit new or changed data back to the database. When you use the **Submit** command on the **Home** tab or the Microsoft Office Backstage to submit changes to the database, InfoPath uses ActiveX Data Objects (ADO) to update the records in the database. Form submission is enabled when all of the following conditions are met:</span></span> 
  
- <span data-ttu-id="17861-162">フォームのクエリで使用されるすべての列の基本列が存在する必要があります。</span><span class="sxs-lookup"><span data-stu-id="17861-162">There must be a base column for every column that is used in the form's query.</span></span>
    
- <span data-ttu-id="17861-163">テーブルの 1 つの列がクエリ全体で複数回使用されないようにします。</span><span class="sxs-lookup"><span data-stu-id="17861-163">A table column may not appear multiple times in the entire query.</span></span>
    
- <span data-ttu-id="17861-164">フォームのクエリで使用される SELECT 句内のすべてのテーブルで、主キー、一意制約 (UNIQUE)、または一意なインデックスを利用できる必要があります。</span><span class="sxs-lookup"><span data-stu-id="17861-164">A primary key, unique constraint, or unique index must be available for every table in a SELECT clause that is used in the form's query.</span></span>
    
- <span data-ttu-id="17861-165">1 つのテーブルをフォームのクエリに複数回含めることはできません。</span><span class="sxs-lookup"><span data-stu-id="17861-165">A table cannot be included multiple times in the form's query.</span></span>
    
- <span data-ttu-id="17861-166">親テーブルと子テーブルのリレーションシップには、親テーブルの主キー列をすべて含める必要があります。</span><span class="sxs-lookup"><span data-stu-id="17861-166">Relationships between parent and child tables must include all primary key columns from the parent table.</span></span>
    
- <span data-ttu-id="17861-167">フォームのクエリに使用される SELECT 句内のすべての列について、ベース テーブルが 1 つであることが必要です。</span><span class="sxs-lookup"><span data-stu-id="17861-167">There can only be one base table for all columns in a SELECT clause that is used in the form's query.</span></span>
    
<span data-ttu-id="17861-p117">フォームの変更内容を InfoPath でデータベースに送信できない状況がいくつかあります。たとえば、テーブルではなくクエリからデータを取得するフォームを作成した場合や、InfoPath で使用される SQL ステートメントをカスタマイズして JOIN ステートメントを挿入した場合は、InfoPath から変更内容を送信できません。親テーブルとの間に多対一のリレーションシップを持つテーブルをフォームに追加した場合も、変更内容の送信はできません。InfoPath からデータベースに変更内容を送信できない場合は、 **データ接続ウィザード**の最後のページの [ **送信状況**] フィールドに、その理由が表示されます。</span><span class="sxs-lookup"><span data-stu-id="17861-p117">There are some circumstances under which InfoPath cannot submit form changes to a database. For example, if you create a form that draws data from a query instead of a table, or if you customize the SQL statement that is used by InfoPath to include a JOIN statement, InfoPath will be unable to submit changes. Another circumstance that would prevent InfoPath from submitting changes is if you were to add tables to the form that have a many-to-one relationship with their parent table. In situations where InfoPath will be unable to submit changes to the database, the **Submit status** field on the last page of the **Data Connection Wizard** will display the reason for the limitation.</span></span> 
  

