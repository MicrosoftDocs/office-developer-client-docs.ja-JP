---
title: InfoPath 2003 オブジェクト モデルを使用してフォーム ウィンドウを操作する
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
keywords:
- infopath 2003 互換のフォーム テンプレート,フォーム ウィンドウ,フォーム ウィンドウ [InfoPath 2007], InfoPath 2003 互換のフォーム テンプレート
localization_priority: Normal
ms.assetid: fbcf3a04-ee0f-40a6-8edd-583ae203e2e1
description: InfoPath フォームをプログラムから操作するときは、フォームのウィンドウにアクセスするコードを記述し、ウィンドウに含まれるアイテムの一部をカスタマイズすることができます。InfoPath 2003 互換のオブジェクト モデルでは、WindowsCollection インターフェイスと WindowObject インターフェイスを関連させて使用することにより、フォームのウィンドウにアクセスできます。
ms.openlocfilehash: f8939fc562cf16c1bce0f6f88bba659e895254f3
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/28/2019
ms.locfileid: "33427578"
---
# <a name="work-with-form-windows-using-the-infopath-2003-object-model"></a><span data-ttu-id="267e5-105">InfoPath 2003 オブジェクト モデルを使用してフォーム ウィンドウを操作する</span><span class="sxs-lookup"><span data-stu-id="267e5-105">Work with Form Windows Using the InfoPath 2003 Object Model</span></span>

<span data-ttu-id="267e5-p102">InfoPath フォームをプログラムから操作するときは、フォームのウィンドウにアクセスするコードを記述し、ウィンドウに含まれるアイテムの一部をカスタマイズすることができます。InfoPath 2003 互換のオブジェクト モデルでは、[WindowsCollection](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.WindowObject.aspx) インターフェイスと [WindowObject](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.WindowsCollection.aspx) インターフェイスを関連させて使用することにより、フォームのウィンドウにアクセスできます。</span><span class="sxs-lookup"><span data-stu-id="267e5-p102">When working programmatically with an InfoPath form, you can write code to access the form's windows, and then customize some of the items that they contain. The InfoPath 2003-compatible object model supports access to a form's windows through the use of the [WindowObject](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.WindowObject.aspx) interface in association with the [WindowsCollection](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.WindowsCollection.aspx) interface.</span></span> 
  
<span data-ttu-id="267e5-108">InfoPath には、次の 2 種類のウィンドウがあります。</span><span class="sxs-lookup"><span data-stu-id="267e5-108">There are two types of windows in InfoPath:</span></span>
  
- <span data-ttu-id="267e5-109">ユーザーがフォームにデータを入力するときに使用する編集ウィンドウ。</span><span class="sxs-lookup"><span data-stu-id="267e5-109">The editing window, which is used when a user fills out a form.</span></span>
    
- <span data-ttu-id="267e5-110">ユーザーがフォーム テンプレートをデザインするときに使用するデザイン ウィンドウ。</span><span class="sxs-lookup"><span data-stu-id="267e5-110">The designing window, which is used when a user designs a form template.</span></span>
    
<span data-ttu-id="267e5-111">フォーム テンプレートのコードを書くときに便利な機能を備えているのは編集ウィンドウです。参照する **WindowObject** インスタンスを使用して、さまざまなプロパティとメソッドにアクセスし、フォーム編集の操作性をカスタマイズすることができます。</span><span class="sxs-lookup"><span data-stu-id="267e5-111">When writing code in a form template, it is the editing window that provides the most useful functionality, because you can use a **WindowObject** instance that references it to access a variety of properties and methods that can be used to customize the form editing experience.</span></span> 
  
## <a name="overview-of-the-windowscollection-interface"></a><span data-ttu-id="267e5-112">WindowsCollection インターフェイスの概要</span><span class="sxs-lookup"><span data-stu-id="267e5-112">Overview of the WindowsCollection Interface</span></span>

<span data-ttu-id="267e5-113">**WindowsCollection** インターフェイスには、次のプロパティがあります。フォーム テンプレートの開発者は、これらのプロパティを使用して、フォーム テンプレートに含まれている **WindowObject** インスタンスを管理できます。</span><span class="sxs-lookup"><span data-stu-id="267e5-113">The **WindowsCollection** interface provides the following properties, which form template developers can use to manage the **WindowObject** instances that it contains.</span></span> 
  
|<span data-ttu-id="267e5-114">**名前**</span><span class="sxs-lookup"><span data-stu-id="267e5-114">**Name**</span></span>|<span data-ttu-id="267e5-115">**説明**</span><span class="sxs-lookup"><span data-stu-id="267e5-115">**Description**</span></span>|
|:-----|:-----|
|<span data-ttu-id="267e5-116">[Count](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Windows.Count.aspx) プロパティ</span><span class="sxs-lookup"><span data-stu-id="267e5-116">[Count](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Windows.Count.aspx) property</span></span>  <br/> |<span data-ttu-id="267e5-117">コレクションに含まれている **Window** オブジェクトの数を返します。</span><span class="sxs-lookup"><span data-stu-id="267e5-117">Returns a count of the number of **Window** objects contained in the collection.</span></span>  <br/> |
|<span data-ttu-id="267e5-118">[Item](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Windows.Item.aspx) プロパティ</span><span class="sxs-lookup"><span data-stu-id="267e5-118">[Item](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Windows.Item.aspx) property</span></span>  <br/> |<span data-ttu-id="267e5-119">指定された **Window** オブジェクトの参照を返します。</span><span class="sxs-lookup"><span data-stu-id="267e5-119">Returns a reference to the specified **Window** object.</span></span>  <br/> <span data-ttu-id="267e5-120">**注**: Visual C# では、**Item** プロパティを呼び出す代わりに、インデクサーを使用してコレクションにアクセスします。</span><span class="sxs-lookup"><span data-stu-id="267e5-120">**NOTE**: Visual C# accesses collections using an indexer instead of calling the **Item** property.</span></span> <span data-ttu-id="267e5-121">例: `thisApplication.Windows[0].Caption`。</span><span class="sxs-lookup"><span data-stu-id="267e5-121">For example,  `thisApplication.Windows[0].Caption`.</span></span>           |
   
## <a name="overview-of-the-window-object"></a><span data-ttu-id="267e5-122">Window オブジェクトの概要</span><span class="sxs-lookup"><span data-stu-id="267e5-122">Overview of the Window Object</span></span>

<span data-ttu-id="267e5-123">**WindowObject** インターフェイスには、次のメソッドとプロパティがあります。フォームの開発者は、これらを使用して、InfoPath のウィンドウを操作できます。</span><span class="sxs-lookup"><span data-stu-id="267e5-123">The **WindowObject** interface provides the following methods and properties, which form developers can use to interact with an InfoPath window.</span></span> <span data-ttu-id="267e5-124">これらのメソッドとプロパティのサポートは、操作対象のウィンドウの種類 ([XdWindowType](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.XdWindowType.aspx)) によって異なります。</span><span class="sxs-lookup"><span data-stu-id="267e5-124">Support for these methods and properties differ depending on the type of window ( [XdWindowType](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.XdWindowType.aspx) ) you are working with.</span></span> <span data-ttu-id="267e5-125">メソッドとプロパティの中には、ウィンドウの種類がエディター (**XdWindowType.xdEditorWindow**) でないと機能しないものがあります。</span><span class="sxs-lookup"><span data-stu-id="267e5-125">Some methods and properties work only with the editor window type (**XdWindowType.xdEditorWindow**).</span></span> <span data-ttu-id="267e5-126">その他のメソッドとプロパティは、ウィンドウの種類がエディターでも、デザイナー (**XdWindowType.xdDesignerWindow**) でも機能します。</span><span class="sxs-lookup"><span data-stu-id="267e5-126">The remaining methods and properties work with both the editor window type and the designer window type (**XdWindowType.xdDesignerWindow**).</span></span> <span data-ttu-id="267e5-127">さらに、InfoPath オブジェクト モデルのすべてのメンバーと同様に、フォーム テンプレートから呼び出す際のメソッドとプロパティのサポートは、セキュリティ レベルおよびフォームのデプロイ方法によって異なります。</span><span class="sxs-lookup"><span data-stu-id="267e5-127">Additionally, like all InfoPath object model members, when called from a form template, support for methods and properties can vary depending on the security level and how the form is deployed.</span></span>
  
|<span data-ttu-id="267e5-128">**名前**</span><span class="sxs-lookup"><span data-stu-id="267e5-128">**Name**</span></span>|<span data-ttu-id="267e5-129">**説明**</span><span class="sxs-lookup"><span data-stu-id="267e5-129">**Description**</span></span>|<span data-ttu-id="267e5-130">**ウィンドウの種類のサポート**</span><span class="sxs-lookup"><span data-stu-id="267e5-130">**Window Type Support**</span></span>|
|:-----|:-----|:-----|
|<span data-ttu-id="267e5-131">[Activate](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Window2.Activate.aspx) メソッド</span><span class="sxs-lookup"><span data-stu-id="267e5-131">[Activate](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Window2.Activate.aspx) method</span></span>  <br/> |<span data-ttu-id="267e5-132">現在アクティブなウィンドウを指定します。</span><span class="sxs-lookup"><span data-stu-id="267e5-132">Designates the window as the currently active window.</span></span>  <br/> |<span data-ttu-id="267e5-133">**xdDesignWindow** および **xdEditorWindow**</span><span class="sxs-lookup"><span data-stu-id="267e5-133">Both the **xdDesignWindow** and **xdEditorWindow** types</span></span>  <br/> |
|<span data-ttu-id="267e5-134">[Active](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Window2.Active.aspx) プロパティ</span><span class="sxs-lookup"><span data-stu-id="267e5-134">[Active](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Window2.Active.aspx) property</span></span>  <br/> |<span data-ttu-id="267e5-135">ウィンドウが現在アクティブなウィンドウかどうかを示す **Boolean** 値を返します。</span><span class="sxs-lookup"><span data-stu-id="267e5-135">Returns a **Boolean** value indicating whether the window is the currently active window.</span></span>  <br/> |<span data-ttu-id="267e5-136">**xdDesignWindow** および **xdEditorWindow**</span><span class="sxs-lookup"><span data-stu-id="267e5-136">Both the **xdDesignWindow** and **xdEditorWindow** types</span></span>  <br/> |
|<span data-ttu-id="267e5-137">[Caption](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Window2.Caption.aspx) プロパティ</span><span class="sxs-lookup"><span data-stu-id="267e5-137">[Caption](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Window2.Caption.aspx) property</span></span>  <br/> |<span data-ttu-id="267e5-138">**Window** オブジェクトによって表されるウィンドウのキャプション テキストを返す、または設定する読み取り/書き込みプロパティ。</span><span class="sxs-lookup"><span data-stu-id="267e5-138">A read/write property that returns or sets the caption text for the window represented by the **Window** object.</span></span>  <br/> |<span data-ttu-id="267e5-139">**xdEditorWindow** のみ</span><span class="sxs-lookup"><span data-stu-id="267e5-139">Only the **xdEditorWindow** type</span></span>  <br/> |
|<span data-ttu-id="267e5-140">[Close](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Window2.Close.aspx) メソッド</span><span class="sxs-lookup"><span data-stu-id="267e5-140">[Close](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Window2.Close.aspx) method</span></span>  <br/> |<span data-ttu-id="267e5-141">ウィンドウを閉じます。</span><span class="sxs-lookup"><span data-stu-id="267e5-141">Closes a window.</span></span>  <br/> |<span data-ttu-id="267e5-142">**xdEditorWindow** のみ</span><span class="sxs-lookup"><span data-stu-id="267e5-142">Only the **xdEditorWindow** type</span></span>  <br/> |
|<span data-ttu-id="267e5-143">[CommandBars](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Window2.CommandBars.aspx) プロパティ</span><span class="sxs-lookup"><span data-stu-id="267e5-143">[CommandBars](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Window2.CommandBars.aspx) property</span></span>  <br/> |<span data-ttu-id="267e5-144">Microsoft Office **CommandBars** オブジェクトへの参照を返します。</span><span class="sxs-lookup"><span data-stu-id="267e5-144">Returns a reference to the Microsoft Office **CommandBars** object.</span></span>  <br/> |<span data-ttu-id="267e5-145">**xdDesignWindow** および **xdEditorWindow**</span><span class="sxs-lookup"><span data-stu-id="267e5-145">Both the **xdDesignWindow** and **xdEditorWindow** types</span></span>  <br/> |
|<span data-ttu-id="267e5-146">[Height](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Window2.Height.aspx) プロパティ</span><span class="sxs-lookup"><span data-stu-id="267e5-146">[Height](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Window2.Height.aspx) property</span></span>  <br/> |<span data-ttu-id="267e5-147">**Window** オブジェクトによって表されるウィンドウのポイント単位での高さを指定する Long 型整数の読み取り/書き込みプロパティ。</span><span class="sxs-lookup"><span data-stu-id="267e5-147">A read/write property of type long integer that specifies the height of the window represented by the **Window** object, measured in points.</span></span>  <br/> |<span data-ttu-id="267e5-148">**xdDesignWindow** および **xdEditorWindow**</span><span class="sxs-lookup"><span data-stu-id="267e5-148">Both the **xdDesignWindow** and **xdEditorWindow** types</span></span>  <br/> |
|<span data-ttu-id="267e5-149">[Left](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Window2.Left.aspx) プロパティ</span><span class="sxs-lookup"><span data-stu-id="267e5-149">[Left](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Window2.Left.aspx) property</span></span>  <br/> |<span data-ttu-id="267e5-150">**Window** オブジェクトによって表されるウィンドウのポイント単位での水平方向の位置を指定する Long 型整数の読み取り/書き込みプロパティ。</span><span class="sxs-lookup"><span data-stu-id="267e5-150">A read/write property of type long integer that specifies the horizontal position of the window represented by the **Window** object, measured in points.</span></span>  <br/> |<span data-ttu-id="267e5-151">**xdDesignWindow** および **xdEditorWindow**</span><span class="sxs-lookup"><span data-stu-id="267e5-151">Both the **xdDesignWindow** and **xdEditorWindow** types</span></span>  <br/> |
|<span data-ttu-id="267e5-152">[MailEnvelope](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Window2.MailEnvelope.aspx) プロパティ</span><span class="sxs-lookup"><span data-stu-id="267e5-152">[MailEnvelope](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Window2.MailEnvelope.aspx) property</span></span>  <br/> |<span data-ttu-id="267e5-153">[MailEnvelopeObject](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.MailEnvelopeObject.aspx) オブジェクトへの参照を返します。</span><span class="sxs-lookup"><span data-stu-id="267e5-153">Returns a reference to the [MailEnvelopeObject](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.MailEnvelopeObject.aspx) object.</span></span>  <br/> |<span data-ttu-id="267e5-154">**xdEditorWindow** のみ</span><span class="sxs-lookup"><span data-stu-id="267e5-154">Only the **xdEditorWindow** type</span></span>  <br/> |
|<span data-ttu-id="267e5-155">[TaskPanes](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Window2.TaskPanes.aspx) プロパティ</span><span class="sxs-lookup"><span data-stu-id="267e5-155">[TaskPanes](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Window2.TaskPanes.aspx) property</span></span>  <br/> |<span data-ttu-id="267e5-156">[TaskPanesCollection](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.TaskPanesCollection.aspx) コレクションへの参照を返します。</span><span class="sxs-lookup"><span data-stu-id="267e5-156">Returns a reference to the [TaskPanesCollection](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.TaskPanesCollection.aspx) collection.</span></span>  <br/> |<span data-ttu-id="267e5-157">**xdDesignWindow** および **xdEditorWindow**</span><span class="sxs-lookup"><span data-stu-id="267e5-157">Both the **xdDesignWindow** and **xdEditorWindow** types</span></span>  <br/> |
|<span data-ttu-id="267e5-158">[Top](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Window2.Top.aspx) プロパティ</span><span class="sxs-lookup"><span data-stu-id="267e5-158">[Top](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Window2.Top.aspx) property</span></span>  <br/> |<span data-ttu-id="267e5-159">**Window** オブジェクトによって表されるウィンドウのポイント単位での垂直方向の位置を指定する Long 型整数の読み取り/書き込みプロパティ。</span><span class="sxs-lookup"><span data-stu-id="267e5-159">A read/write property of type long integer that specifies the vertical position of the window represented by the **Window** object, measured in points.</span></span>  <br/> |<span data-ttu-id="267e5-160">**xdDesignWindow** および **xdEditorWindow**</span><span class="sxs-lookup"><span data-stu-id="267e5-160">Both the **xdDesignWindow** and **xdEditorWindow** types</span></span>  <br/> |
|<span data-ttu-id="267e5-161">[WindowType](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Window2.WindowType.aspx) プロパティ</span><span class="sxs-lookup"><span data-stu-id="267e5-161">[WindowType](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Window2.WindowType.aspx) property</span></span>  <br/> |<span data-ttu-id="267e5-162">[XdWindowType](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.XdWindowType.aspx) 列挙に基づいて、ウィンドウの種類を表す数値を返します。</span><span class="sxs-lookup"><span data-stu-id="267e5-162">Returns a number indicating the type of the window, based on the [XdWindowType](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.XdWindowType.aspx) enumeration.</span></span>  <br/> |<span data-ttu-id="267e5-163">**xdDesignWindow** および **xdEditorWindow**</span><span class="sxs-lookup"><span data-stu-id="267e5-163">Both the **xdDesignWindow** and **xdEditorWindow** types</span></span>  <br/> |
|<span data-ttu-id="267e5-164">[Width](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Window2.Width.aspx) プロパティ</span><span class="sxs-lookup"><span data-stu-id="267e5-164">[Width](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Window2.Width.aspx) property</span></span>  <br/> |<span data-ttu-id="267e5-165">**Window** オブジェクトによって表されるウィンドウのポイント単位での幅を指定する Long 型整数の読み取り/書き込みプロパティ。</span><span class="sxs-lookup"><span data-stu-id="267e5-165">A read/write property of type long integer that specifies the width of the window represented by the **Window** object, measured in points.</span></span>  <br/> |<span data-ttu-id="267e5-166">**xdDesignWindow** および **xdEditorWindow**</span><span class="sxs-lookup"><span data-stu-id="267e5-166">Both the **xdDesignWindow** and **xdEditorWindow** types</span></span>  <br/> |
|<span data-ttu-id="267e5-167">[WindowState](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Window2.WindowState.aspx) プロパティ</span><span class="sxs-lookup"><span data-stu-id="267e5-167">[WindowState](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Window2.WindowState.aspx) property</span></span>  <br/> |<span data-ttu-id="267e5-168">[Window](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.XdWindowState.aspx) オブジェクトによって表されるウィンドウの状態を返す、または設定する **XdWindowState** 型の読み取り/書き込みプロパティ。</span><span class="sxs-lookup"><span data-stu-id="267e5-168">A read/write property of type [XdWindowState](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.XdWindowState.aspx) that returns or sets the state of the window represented by the **Window** object.</span></span>  <br/> |<span data-ttu-id="267e5-169">**xdDesignWindow** および **xdEditorWindow**</span><span class="sxs-lookup"><span data-stu-id="267e5-169">Both the **xdDesignWindow** and **xdEditorWindow** types</span></span>  <br/> |
|<span data-ttu-id="267e5-170">[XDocument](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Window2.XDocument.aspx) プロパティ</span><span class="sxs-lookup"><span data-stu-id="267e5-170">[XDocument](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Window2.XDocument.aspx) property</span></span>  <br/> |<span data-ttu-id="267e5-171">ウィンドウに関連付けられている [_XDocument](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust._XDocument.aspx) オブジェクトへの参照を返します。</span><span class="sxs-lookup"><span data-stu-id="267e5-171">Returns a reference to the [_XDocument](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust._XDocument.aspx) object associated with the window.</span></span>  <br/> |<span data-ttu-id="267e5-172">**xdEditorWindow** のみ</span><span class="sxs-lookup"><span data-stu-id="267e5-172">Only the **xdEditorWindow** type</span></span>  <br/> |
   
## <a name="using-the-windowscollection-and-window-interfaces"></a><span data-ttu-id="267e5-173">WindowsCollection インターフェイスおよび Window インターフェイスを使用する</span><span class="sxs-lookup"><span data-stu-id="267e5-173">Using the WindowsCollection and Window Interfaces</span></span>

<span data-ttu-id="267e5-p105">**WindowsCollection** インターフェイスには、 [Application](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust._Application2.Windows.aspx) インターフェイスの [Windows](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Application.aspx) プロパティを通じてアクセスできます。 **WindowsCollection** インターフェイスを使用してフォームのウィンドウにアクセスするときは、インデクサーを使用するか (Visual C# の場合)、 **Item** プロパティに Long 型整数を渡して (Visual Basic の場合)、 **WindowObject** インターフェイス インスタンスへの参照を返します。たとえば、次のコードは、 **WindowsCollection** に含まれる最初の **WindowObject** への参照を設定します。</span><span class="sxs-lookup"><span data-stu-id="267e5-p105">The **WindowsCollection** interface can be accessed through the [Windows](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust._Application2.Windows.aspx) property of the [Application](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Application.aspx) interface. When using the **WindowsCollection** interface to access a form's windows, you use an indexer (for Visual C#) or pass a long integer to the **Item** property (for Visual Basic) to return a reference to a **WindowObject** interface instance. For example, the following code sets a reference to the first **WindowObject** contained in the **WindowsCollection**.</span></span>
  
```cs
WindowObject objWindow = thisApplication.Windows[0];
```

```vb
Dim objWindow As WindowObject = thisApplication.Windows(0)
```

<span data-ttu-id="267e5-177">ただし、次のコードに示すとおり、 [Application](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust._Application2.ActiveWindow.aspx) インターフェイスの **ActiveWindow** プロパティを使用すると、 \*\* WindowsCollection \*\* を介することなく、現在開いているウィンドウに直接アクセスできます。</span><span class="sxs-lookup"><span data-stu-id="267e5-177">However, you can access the currently open window directly by using the [ActiveWindow](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust._Application2.ActiveWindow.aspx) property of the **Application** interface, without going through the \*\* WindowsCollection \*\*, as the following code demonstrates.</span></span>
  
```cs
WindowObject objWindow = thisApplication.ActiveWindow;
```

```vb
Dim objWindow As WindowObject = thisApplication.ActiveWindow
```

> [!NOTE]
> <span data-ttu-id="267e5-178">InfoPath マネージ コード プロジェクトをデバッグするときは、デバッグ ウィンドウがアクティブなので、 **ActiveWindow** プロパティは常に **null** を返します。</span><span class="sxs-lookup"><span data-stu-id="267e5-178">When debugging an InfoPath managed-code project, the **ActiveWindow** property will always return **null** because the debugging window is active.</span></span> 
  
<span data-ttu-id="267e5-p106">**WindowObject** は、 [View](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.View.Window.aspx) インターフェイスの [Window](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.View.aspx) プロパティを使用してアクセスすることもできます。このインターフェイスは、フォームの基になる XML ドキュメントに関連付けられています。 **XDocument** インターフェイスの **View** プロパティは、 **View** オブジェクトにアクセスするために使用します。たとえば、次のコードは、フォームの基になる XML ドキュメントのビューに関連付けられている **WindowObject** への参照を設定します。</span><span class="sxs-lookup"><span data-stu-id="267e5-p106">A **WindowObject** can also be accessed by using the [Window](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.View.Window.aspx) property of the [View](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.View.aspx) interface, which is associated with the form's underlying XML document. The **View** property of the **XDocument** interface is used to access the **View** object. For example, the following code sets a reference to the **WindowObject** that is associated with the view of a form's underlying XML document.</span></span> 
  
```cs
WindowObject objWindow = thisXDocument.View.Window;
```

```vb
Dim objWindow As WindowObject = thisXDocument.View.Window
```

> [!NOTE]
> <span data-ttu-id="267e5-p107">**Window** オブジェクトの一部のプロパティとメソッドは、編集ウィンドウでのみ使用できます。デザイン ウィンドウで使用すると、エラーが発生します。各ウィンドウの種類でサポートされるプロパティとメソッドの一覧については、前に示した表を参照してください。コードで **WindowType** プロパティを使用すると、現在操作しているウィンドウの種類を確認できます。</span><span class="sxs-lookup"><span data-stu-id="267e5-p107">Some of the properties and methods of the **Window** object are only for the editing window type; if used with the designing window type, they will return an error. The properties and methods that are supported for each window type are listed in the table shown earlier in this topic. You can use the **WindowType** property in your code to determine which type of window you are working with.</span></span> 
  

