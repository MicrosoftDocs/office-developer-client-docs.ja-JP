---
title: 外部データ ソースにアクセスする
manager: soliver
ms.date: 12/07/2015
ms.audience: Developer
keywords:
- data connection classes [infopath 2007],secondary data sources [InfoPath 2007],data [InfoPath 2007], secondary,DataSource class [InfoPath 2007],accessing external data sources [InfoPath 2007],DataSourceCollection class [InfoPath 2007],DataConnectionCollection class [InfoPath 2007],DataConnection class [InfoPath 2007],InfoPath 2007, accessing external data,data [InfoPath 2007], external sources
localization_priority: Normal
ms.assetid: db7c2521-a1ad-4802-b398-79575d3d310a
description: InfoPath フォーム テンプレートで作業しているときに、フォームのセカンダリ データ ソースにアクセスしてそこに含まれるデータを操作するコードを書くことができます。
ms.openlocfilehash: f6957c561231eef0e3e4df6deb09ae89f85afcc5
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/28/2019
ms.locfileid: "33408314"
---
# <a name="access-external-data-sources"></a><span data-ttu-id="96b60-104">外部データ ソースにアクセスする</span><span class="sxs-lookup"><span data-stu-id="96b60-104">Access External Data Sources</span></span>

<span data-ttu-id="96b60-105">InfoPath フォーム テンプレートで作業しているときに、フォームのセカンダリ データ ソースにアクセスしてそこに含まれるデータを操作するコードを書くことができます。</span><span class="sxs-lookup"><span data-stu-id="96b60-105">When working with an InfoPath form template, you can write code to access the form's secondary data sources and manipulate the data that they contain.</span></span> 
  
<span data-ttu-id="96b60-p101">各セカンダリ データ ソースは、[DataSource](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSource.aspx) クラスを使用してインスタンス化されたオブジェクトによって表現され、データベースや Web サービス クエリなどの外部データ ソースから取得された保管データに相当します。これらのデータ ソースがセカンダリと呼ばれる理由は、ユーザーが InfoPath フォームを保存する際、メインのデータ ソース (プライマリ データ ソース) のデータのみが保存され、これらのデータ ソースのデータは保存されないためです。データ ソースへの接続は、"データ接続" クラスを使用してインスタンス化されたオブジェクトによって表されます。このようなクラスには、XML Web サービスへのデータ接続を表す [WebServiceConnection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.WebServiceConnection.aspx) などがあります。</span><span class="sxs-lookup"><span data-stu-id="96b60-p101">Each secondary data source is represented by an object instantiated using the [DataSource](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSource.aspx) class, and corresponds to stored data, obtained from some external source of data, such as a database or a Web Service query. These data sources are referred to as secondary because when the user saves an InfoPath form, the user is saving the data only in the main (or primary) data source, not the data in the secondary data sources. The connection to a data source is represented by an object instantiated using one of the "data connection" classes, such as the [WebServiceConnection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.WebServiceConnection.aspx) class, which represents a data connection to an XML Web Service.</span></span> 
  
<span data-ttu-id="96b60-109">インスタンス化された [DataSource](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSource.aspx) オブジェクトは、データベースまたは Web サービス クエリからデータ接続によって返される XML データの格納場所を表し、"データ接続" クラスはデータ接続自体 ([ **データ**] タブの [ **データ接続**] コマンドを使用して定義および指定するデータ接続) を表します。</span><span class="sxs-lookup"><span data-stu-id="96b60-109">The instantiated [DataSource](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSource.aspx) object represents the storage of XML data returned by a data connection (from a database or Web Service query), and the "data connection" class represents the data connection itself (as defined and named using the **Data Connections** command on the **Data** tab).</span></span> 
  
<span data-ttu-id="96b60-110">InfoPath オブジェクト モデルは、[DataSourceCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSource.aspx) クラスに関連した [DataSource](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSourceCollection.aspx) クラスの使用によるフォームのセカンダリ データ ソースへのアクセスをサポートしています。</span><span class="sxs-lookup"><span data-stu-id="96b60-110">The InfoPath object model supports access to a form's secondary data sources through the use of the [DataSource](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSource.aspx) class in association with the [DataSourceCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSourceCollection.aspx) class.</span></span> 
  
<span data-ttu-id="96b60-111">InfoPath オブジェクト モデルは、フォームによって使用されるデータ接続に関する情報を格納したデータ接続クラスのセットも提供します。</span><span class="sxs-lookup"><span data-stu-id="96b60-111">The InfoPath object model also provides a set of data connection classes, containing information about the data connections used by the form.</span></span>
  
> [!NOTE]
> <span data-ttu-id="96b60-112">Microsoft InfoPath 2003 では、データ接続のことをデータ アダプターと呼びます。</span><span class="sxs-lookup"><span data-stu-id="96b60-112">In Microsoft InfoPath 2003, a data connection is referred to as a data adapter.</span></span> 
  
<span data-ttu-id="96b60-p102">データ接続には 2 つの種類があります。クエリ接続は、データを取得するために使用されます。取得されたデータは、セカンダリ データ ソースに格納されます。送信用接続は、データベースや Web サービスなどにデータを送信するために使用されます。送信されるデータは、メインまたはセカンダリのデータ ソースからコピーされます。</span><span class="sxs-lookup"><span data-stu-id="96b60-p102">Data connections are of two kinds: Query connections are used to obtain the data that is then stored in a secondary data source. Submit connections are used to submit data, to a database or Web service, for example. The submitted data is copied from the main or secondary data sources.</span></span> 
  
## <a name="overview-of-the-datasourcecollection-class"></a><span data-ttu-id="96b60-116">DataSourceCollection クラスの概要</span><span class="sxs-lookup"><span data-stu-id="96b60-116">Overview of the DataSourceCollection Class</span></span>

<span data-ttu-id="96b60-117">[DataSourceCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSourceCollection.aspx) クラスには、次のプロパティとメソッドがあります。フォームの開発者は、これらを使用することにより、フォームに含まれている [DataSourceCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSourceCollection.aspx) オブジェクトのインスタンスを管理できます。</span><span class="sxs-lookup"><span data-stu-id="96b60-117">The [DataSourceCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSourceCollection.aspx) class provides the following properties and methods, which form developers can use to manage the [DataSourceCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSourceCollection.aspx) object instances that the form contains.</span></span> 
  
|<span data-ttu-id="96b60-118">**名前**</span><span class="sxs-lookup"><span data-stu-id="96b60-118">**Name**</span></span>|<span data-ttu-id="96b60-119">**説明**</span><span class="sxs-lookup"><span data-stu-id="96b60-119">**Description**</span></span>|
|:-----|:-----|
|<span data-ttu-id="96b60-120">[Count](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSourceCollection.Count.aspx) プロパティ</span><span class="sxs-lookup"><span data-stu-id="96b60-120">[Count](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSourceCollection.Count.aspx) property</span></span>  <br/> |<span data-ttu-id="96b60-121">コレクションに含まれている **DataSource** オブジェクト インスタンスの数を返します。</span><span class="sxs-lookup"><span data-stu-id="96b60-121">Returns a count of the number of **DataSource** object instances contained in the collection.</span></span>  <br/> |
|<span data-ttu-id="96b60-122">[GetEnumerator](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSourceCollection.GetEnumerator.aspx) メソッド</span><span class="sxs-lookup"><span data-stu-id="96b60-122">[GetEnumerator](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSourceCollection.GetEnumerator.aspx) method</span></span>  <br/> |<span data-ttu-id="96b60-123">コレクションの反復処理に使用できる **IEnumerator** を返します。</span><span class="sxs-lookup"><span data-stu-id="96b60-123">Returns an **IEnumerator** that can be used to iterate through the collection.</span></span>  <br/> |
|<span data-ttu-id="96b60-124">[Item[Int32]](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSourceCollection.Item.aspx) プロパティ</span><span class="sxs-lookup"><span data-stu-id="96b60-124">[Item[Int32]](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSourceCollection.Item.aspx) property</span></span>  <br/> |<span data-ttu-id="96b60-125">指定した **DataSource** オブジェクトへの参照をインデックス値で返します。</span><span class="sxs-lookup"><span data-stu-id="96b60-125">Returns a reference to the specified **DataSource** object by index value.</span></span>  <br/> |
|<span data-ttu-id="96b60-126">[Item[String]](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSourceCollection.Item.aspx) プロパティ</span><span class="sxs-lookup"><span data-stu-id="96b60-126">[Item[String]](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSourceCollection.Item.aspx) property</span></span>  <br/> |<span data-ttu-id="96b60-127">指定した **DataSource** オブジェクトへの参照を名前で返します。</span><span class="sxs-lookup"><span data-stu-id="96b60-127">Returns a reference to the specified **DataSource** object by name.</span></span>  <br/> |
   
## <a name="overview-of-the-datasource-class"></a><span data-ttu-id="96b60-128">DataSource クラスの概要</span><span class="sxs-lookup"><span data-stu-id="96b60-128">Overview of the DataSource Class</span></span>

<span data-ttu-id="96b60-129">[DataSourceCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSourceCollection.aspx) クラスには、次のメソッドとプロパティがあります。フォームの開発者は、これらを使用することにより、InfoPath セカンダリ データ ソースを操作することができます。</span><span class="sxs-lookup"><span data-stu-id="96b60-129">The [DataSourceCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSourceCollection.aspx) class provides the following method and properties, which form developers can use to interact with an InfoPath secondary data source.</span></span> 
  
|<span data-ttu-id="96b60-130">**名前**</span><span class="sxs-lookup"><span data-stu-id="96b60-130">**Name**</span></span>|<span data-ttu-id="96b60-131">**説明**</span><span class="sxs-lookup"><span data-stu-id="96b60-131">**Description**</span></span>|
|:-----|:-----|
|<span data-ttu-id="96b60-132">[CreateNavigator](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSource.CreateNavigator.aspx) メソッド</span><span class="sxs-lookup"><span data-stu-id="96b60-132">[CreateNavigator](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSource.CreateNavigator.aspx) method</span></span>  <br/> |<span data-ttu-id="96b60-133">データ ソースへのアクセスおよび編集のための [XPathNavigator](https://msdn.microsoft.com/library/system.xml.xpath.xpathnavigator%28v=vs.110%29.aspx) オブジェクトを返します。</span><span class="sxs-lookup"><span data-stu-id="96b60-133">Returns an [XPathNavigator](https://msdn.microsoft.com/library/system.xml.xpath.xpathnavigator%28v=vs.110%29.aspx) object for accessing and editing the data source</span></span>  <br/> |
|<span data-ttu-id="96b60-134">[QueryConnection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSource.QueryConnection.aspx) プロパティ</span><span class="sxs-lookup"><span data-stu-id="96b60-134">[QueryConnection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSource.QueryConnection.aspx) property</span></span>  <br/> |<span data-ttu-id="96b60-135">関連付けられたデータ接続オブジェクトへの参照を取得します。</span><span class="sxs-lookup"><span data-stu-id="96b60-135">Gets a reference to the associated data connection object.</span></span>  <br/> <span data-ttu-id="96b60-136">データ接続に対してクエリを実行し、返されたデータを、 **DataSource** オブジェクトに関連付けられた XML ノードに XML として挿入するには、関連付けられたデータ接続オブジェクトの [Execute](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataConnection.Execute.aspx) メソッドを使用します。</span><span class="sxs-lookup"><span data-stu-id="96b60-136">To execute the query on the data connection and insert the returned data as XML into the XML node associated with the **DataSource** object, use the [Execute](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataConnection.Execute.aspx) method of the associated data connection object.</span></span>  <br/> |
|<span data-ttu-id="96b60-137">[Name](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSource.Name.aspx) プロパティ</span><span class="sxs-lookup"><span data-stu-id="96b60-137">[Name](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSource.Name.aspx) property</span></span>  <br/> |<span data-ttu-id="96b60-138">**DataSource** オブジェクトの名前を取得します。</span><span class="sxs-lookup"><span data-stu-id="96b60-138">Gets the name of the **DataSource** object.</span></span>  <br/> |
|<span data-ttu-id="96b60-139">[ReadOnly](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSource.ReadOnly.aspx) プロパティ</span><span class="sxs-lookup"><span data-stu-id="96b60-139">[ReadOnly](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSource.ReadOnly.aspx) property</span></span>  <br/> |<span data-ttu-id="96b60-140">データ ソースが読み取り専用状態かどうかを示す値を取得します。</span><span class="sxs-lookup"><span data-stu-id="96b60-140">Gets a value that indicates whether the data source is in a read-only state</span></span>  <br/> |
|<span data-ttu-id="96b60-141">[GetNamedNodeProperty](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSource.GetNamedNodeProperty.aspx) メソッド</span><span class="sxs-lookup"><span data-stu-id="96b60-141">[GetNamedNodeProperty](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSource.GetNamedNodeProperty.aspx) method</span></span>  <br/> |<span data-ttu-id="96b60-142">指定した XML ノードの名前付きプロパティの値を取得します。このノードは、メイン データ ソースの **nonattribute** ノードである必要があります。  </span><span class="sxs-lookup"><span data-stu-id="96b60-142">Gets the value of a named property for the specified XML node, which must be a **nonattribute** node in the main data source.</span></span>  <br/> |
|<span data-ttu-id="96b60-143">[SetNamedNodeProperty](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSource.SetNamedNodeProperty.aspx) メソッド</span><span class="sxs-lookup"><span data-stu-id="96b60-143">[SetNamedNodeProperty](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSource.SetNamedNodeProperty.aspx) method</span></span>  <br/> |<span data-ttu-id="96b60-144">指定した XML ノードの名前付きプロパティの値を設定します。このノードは、メイン データ ソースの **nonattribute** ノードである必要があります。  </span><span class="sxs-lookup"><span data-stu-id="96b60-144">Sets the value of a named property for the specified XML node, which must be a **nonattribute** node in the main data source.</span></span>  <br/> |
   
## <a name="overview-of-the-data-connection-classes"></a><span data-ttu-id="96b60-145">データ接続クラスの概要</span><span class="sxs-lookup"><span data-stu-id="96b60-145">Overview of the Data Connection Classes</span></span>

<span data-ttu-id="96b60-p103">データ接続にアクセスするためのクラスは、さまざまなプロパティとメソッドを提供し、これらは外部データ ソースへの接続を通じてデータを取得および送信します。 **DataSource** オブジェクトに関連付けられるデータ接続は、外部データ接続の種類に依存します。InfoPath は、データ接続にアクセスするために以下のクラスを実装します。</span><span class="sxs-lookup"><span data-stu-id="96b60-p103">The classes for accessing data connections provide different properties and methods that retrieve and submit data through connections to external data sources; the data connection that is associated with a **DataSource** object is dependent on the type of external data connection. InfoPath implements the following classes for accessing data connections.</span></span> 
  
|<span data-ttu-id="96b60-148">**名前**</span><span class="sxs-lookup"><span data-stu-id="96b60-148">**Name**</span></span>|<span data-ttu-id="96b60-149">**説明**</span><span class="sxs-lookup"><span data-stu-id="96b60-149">**Description**</span></span>|
|:-----|:-----|
|<span data-ttu-id="96b60-150">[AdoQueryConnection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.AdoQueryConnection.aspx) クラス</span><span class="sxs-lookup"><span data-stu-id="96b60-150">[AdoQueryConnection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.AdoQueryConnection.aspx) class</span></span>  <br/> |<span data-ttu-id="96b60-151">ADO/OLEDB データ ソースのクエリを実行します。Microsoft Access および Microsoft SQL Server に限定されます。</span><span class="sxs-lookup"><span data-stu-id="96b60-151">Queries an ADO/OLEDB data source; limited to Microsoft Access and Microsoft SQL Server.</span></span>  <br/> |
|<span data-ttu-id="96b60-152">[AdoSubmitConnection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.AdoSubmitConnection.aspx) クラス</span><span class="sxs-lookup"><span data-stu-id="96b60-152">[AdoSubmitConnection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.AdoSubmitConnection.aspx) class</span></span>  <br/> |<span data-ttu-id="96b60-153">ADO/OLEDB データ ソースにデータを送信します。Microsoft Access および Microsoft SQL Server に限定されます。</span><span class="sxs-lookup"><span data-stu-id="96b60-153">Submits to an ADO/OLEDB data source; limited to Microsoft Access and Microsoft SQL Server.</span></span>  <br/> |
|<span data-ttu-id="96b60-154">[SharePointListRWQueryConnection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SharePointListRWQueryConnection.aspx) クラス</span><span class="sxs-lookup"><span data-stu-id="96b60-154">[SharePointListRWQueryConnection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SharePointListRWQueryConnection.aspx) class</span></span>  <br/> |<span data-ttu-id="96b60-155">SharePoint リストまたはドキュメント ライブラリのクエリを実行します。</span><span class="sxs-lookup"><span data-stu-id="96b60-155">Queries a SharePoint list or document library.</span></span>  <br/> |
|[<span data-ttu-id="96b60-156">SharePointListRWSubmitConnection</span><span class="sxs-lookup"><span data-stu-id="96b60-156">SharePointListRWSubmitConnection</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SharePointListRWSubmitConnection.aspx) <br/> |<span data-ttu-id="96b60-157">SharePoint リストまたはドキュメント ライブラリにデータを送信します。</span><span class="sxs-lookup"><span data-stu-id="96b60-157">Submits to a SharePoint list or document library.</span></span>  <br/> |
|<span data-ttu-id="96b60-158">[WebServiceConnection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.WebServiceConnection.aspx) クラス</span><span class="sxs-lookup"><span data-stu-id="96b60-158">[WebServiceConnection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.WebServiceConnection.aspx) class</span></span>  <br/> |<span data-ttu-id="96b60-159">XML Web サービスに接続します。</span><span class="sxs-lookup"><span data-stu-id="96b60-159">Connects to an XML Web service.</span></span>  <br/> |
|<span data-ttu-id="96b60-160">[FileQueryConnection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FileQueryConnection.aspx) クラス</span><span class="sxs-lookup"><span data-stu-id="96b60-160">[FileQueryConnection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FileQueryConnection.aspx) class</span></span>  <br/> |<span data-ttu-id="96b60-161">XML ファイルのクエリを実行します。</span><span class="sxs-lookup"><span data-stu-id="96b60-161">Queries an XML file.</span></span>  <br/> |
|<span data-ttu-id="96b60-162">[FileSubmitConnection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FileSubmitConnection.aspx) クラス</span><span class="sxs-lookup"><span data-stu-id="96b60-162">[FileSubmitConnection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FileSubmitConnection.aspx) class</span></span>  <br/> |<span data-ttu-id="96b60-163">XML ファイルにデータを送信します。</span><span class="sxs-lookup"><span data-stu-id="96b60-163">Submits to an XML file.</span></span>  <br/> |
|<span data-ttu-id="96b60-164">[EmailSubmitConnection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.EmailSubmitConnection.aspx) クラス</span><span class="sxs-lookup"><span data-stu-id="96b60-164">[EmailSubmitConnection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.EmailSubmitConnection.aspx) class</span></span>  <br/> |<span data-ttu-id="96b60-165">フォームを電子メールの添付ファイルとして送信します。</span><span class="sxs-lookup"><span data-stu-id="96b60-165">Submits a form as an attachment in email.</span></span>  <br/> |
|<span data-ttu-id="96b60-166">[BdcQueryConnection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.BdcQueryConnection.aspx) クラス</span><span class="sxs-lookup"><span data-stu-id="96b60-166">[BdcQueryConnection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.BdcQueryConnection.aspx) class</span></span>  <br/> |<span data-ttu-id="96b60-167">SharePoint Foundation 2010 または SharePoint Server 2010 を実行しているサーバーで、外部リストのクエリを実行します。</span><span class="sxs-lookup"><span data-stu-id="96b60-167">Queries an external list on a server running SharePoint Foundation 2010 or SharePoint Server 2010.</span></span>  <br/> |
|<span data-ttu-id="96b60-168">[BdcSubmitConnection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.BdcSubmitConnection.aspx) クラス</span><span class="sxs-lookup"><span data-stu-id="96b60-168">[BdcSubmitConnection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.BdcSubmitConnection.aspx) class</span></span>  <br/> |<span data-ttu-id="96b60-169">SharePoint Foundation 2010 または SharePoint Server 2010 を実行しているサーバー上の外部リストにデータを送信します。</span><span class="sxs-lookup"><span data-stu-id="96b60-169">Submits to an external list on a server running SharePoint Foundation 2010 or SharePoint Server 2010.</span></span>  <br/> |
   
## <a name="using-the-datasourcecollection-and-the-datasource-classes"></a><span data-ttu-id="96b60-170">DataSourceCollection クラスと DataSource クラスを使用する</span><span class="sxs-lookup"><span data-stu-id="96b60-170">Using the DataSourceCollection and the DataSource Classes</span></span>

<span data-ttu-id="96b60-p104">フォーム テンプレートに関連付けられたデータ ソースのコレクションを表す **DataSourceCollection** オブジェクトにアクセスするには、 [XmlForm](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.DataSources.aspx) クラスの [DataSources](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.aspx) プロパティを使用します。たとえば、Northwind データベースの Employees テーブルからデータを取得する Employees という名前のセカンダリ データ ソースを作成した場合、 **DataSourceCollection** オブジェクトを使用して、取得されたデータを表す **DataSource** オブジェクトへの参照を設定することができます。</span><span class="sxs-lookup"><span data-stu-id="96b60-p104">The **DataSourceCollection** object that represents the collection of data sources associated with a form template is accessed through the [DataSources](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.DataSources.aspx) property of the [XmlForm](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.aspx) class. For example, if you create a secondary data source named Employees that retrieves data from the Employees table in the Northwind database, you can use the **DataSourceCollection** object to set a reference to a **DataSource** object that represents the retrieved data.</span></span> 
  
<span data-ttu-id="96b60-p105">以下のコード例では、 **DataSourceCollection** クラスのアクセサー プロパティにセカンダリ データ ソースの名前が渡されて、取得された Employees テーブルのデータを表す **DataSource** オブジェクトへの参照が返されます。その後、 **DataSource** クラスの **CreateNavigator** メソッドを使用して **XPathNavigator** クラスの **InnerXml** プロパティにアクセスすることにより、セカンダリ データ ソースから取得されたデータを格納している XML ノードがメッセージ ボックスに表示されます。</span><span class="sxs-lookup"><span data-stu-id="96b60-p105">In the following code sample, the name of the secondary data source is passed to the accessor property of the **DataSourceCollection** class, which returns a reference to the **DataSource** object that represents the retrieved Employees table data. The XML node that stores the retrieved data from the secondary data source is displayed in a message box using the **CreateNavigator** method of the **DataSource** class to access the **InnerXml** property of the **XPathNavigator** class.</span></span> 
  
```cs
// Instantiate a variable to access the specified data source
// from the DataSourceCollection of the form.
DataSource myDataSource = 
   this.DataSources["Employees"];
// Display the XML data from the secondary data source.
MessageBox.Show("Data source data: " +
   myDataSource.CreateNavigator().InnerXml.ToString());
```

```vb
' Instantiate a variable to access the specified data source
' from the DataSourceCollection of the form.
Dim myDataSource As DataSource = _
   Me.DataSources("Employees")
' Display the XML data from the secondary data source.
MessageBox.Show("Data source data: " &amp; _
   myDataSource.CreateNavigator().InnerXml.ToString())
```

<span data-ttu-id="96b60-175">セカンダリ データ ソースに格納されているデータを操作するには、 **DataSource** クラスの **CreateNavigator** メソッドを使用して、そのセカンダリ データが格納されているノードにある **XPathNavigator** オブジェクトへの参照を取得します。</span><span class="sxs-lookup"><span data-stu-id="96b60-175">To manipulate the data that is contained in a secondary data source, use the **CreateNavigator** method of the **DataSource** class to return a reference to an **XPathNavigator** object positioned at the node where the secondary data is stored.</span></span> <span data-ttu-id="96b60-176">**XPathNavigator** クラスのプロパティまたはメソッドを使用して、データを操作できます。</span><span class="sxs-lookup"><span data-stu-id="96b60-176">You can use the properties or methods of the **XPathNavigator** class to manipulate the data.</span></span> <span data-ttu-id="96b60-177">詳細については、「[XPathNavigator クラスおよび XPathNodeIterator クラスを操作する方法](how-to-work-with-the-xpathnavigator-and-xpathnodeiterator-classes.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="96b60-177">For more information, see [Work with the XPathNavigator and XPathNodeIterator Classes](how-to-work-with-the-xpathnavigator-and-xpathnodeiterator-classes.md).</span></span>
  
## <a name="using-the-dataconnectioncollection-and-the-dataconnection-classes"></a><span data-ttu-id="96b60-178">DataConnectionCollection クラスと DataConnection クラスを使用する</span><span class="sxs-lookup"><span data-stu-id="96b60-178">Using the DataConnectionCollection and the DataConnection Classes</span></span>

<span data-ttu-id="96b60-p107">フォーム テンプレートに関連付けられたデータ接続のコレクションを表す [DataConnectionCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataConnectionCollection.aspx) オブジェクトにアクセスするには、 [XmlForm](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.DataConnections.aspx) クラスの **DataConnections** プロパティを使用します。たとえば、Northwind データベースの Employees テーブルからデータを取得する Employees という名前のセカンダリ データ ソースを作成した場合、フォーム テンプレートに関連付けられた **DataConnectionCollection** オブジェクトを使用して、データベースへの接続を表す **DataConnection** への参照を設定することができます。</span><span class="sxs-lookup"><span data-stu-id="96b60-p107">The [DataConnectionCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataConnectionCollection.aspx) object that represents the collection of data connections associated with a form template is accessed through the [DataConnections](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.DataConnections.aspx) property of the **XmlForm** class. For example, if you create a secondary data source named Employees that retrieves data from the Employees table in the Northwind database, you can use the **DataConnectionCollection** object associated with the form template to set a reference to the **DataConnection** that represents the connection to the database.</span></span> 
  
<span data-ttu-id="96b60-p108">以下のコード例では、 **DataConnectionCollection** クラスのアクセサー プロパティにセカンダリ データ ソースの名前が渡されて、今度は、Northwind データベースへの接続を表す **ADOQueryConnection** オブジェクトへの参照が返されます。これを正常に動作させるには、返されるオブジェクトを **ADOQueryConnection** 型に明示的にキャストする必要があります。メッセージ ボックス内での ADO 接続文字列の表示には [ADOAdapterObject](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.AdoQueryConnection.Connection.aspx) インターフェイスの **Connection** プロパティが使用されます。</span><span class="sxs-lookup"><span data-stu-id="96b60-p108">In the following code sample, the name of the secondary data source is passed to the accessor property of the **DataConnectionCollection** class, which, in this case, returns a reference to the **ADOQueryConnection** object that represents the connection to the Northwind database. For this to work properly, you must explicitly cast the object being returned to the **ADOQueryConnection** type. The [Connection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.AdoQueryConnection.Connection.aspx) property of the **ADOAdapterObject** interface is used to display the ADO connection string in a message box.</span></span> 
  
```cs
// Instantiate a variable to access the specified data connection
// from the DataConnectionCollection of the form. 
// You must cast to the specific data connection type
// (ADOQueryConnection) before you can access the data connection.
ADOQueryConnection myADOConnection = 
   (ADOQueryConnection)this.DataConnections["Employees"];
// Display the connection information for the data connection.
MessageBox.Show("Connection string: " + myADOConnection.Connection);
```

```vb
' Instantiate a variable to access the specified data connection
' from the DataConnectionCollection of the form. 
' You must cast to the specific data connection type
' (ADOQueryConnection) before you can access the data connection.
Dim myADOConnection As ADOQueryConnection = _
   DirectCast(Me.DataConnections("Employees"), ADOQueryConnection)
' Display the connection information for the data connection.
MessageBox.Show("Connection string: " &amp; myADOConnection.Connection)
```

## <a name="see-also"></a><span data-ttu-id="96b60-184">関連項目</span><span class="sxs-lookup"><span data-stu-id="96b60-184">See also</span></span>



[<span data-ttu-id="96b60-185">InfoPath Forms Services で動作する InfoPath フォーム テンプレートを作成する</span><span class="sxs-lookup"><span data-stu-id="96b60-185">Creating InfoPath Form Templates That Work With InfoPath Forms Services</span></span>](creating-infopath-form-templates-that-work-with-infopath-forms-services.md)

