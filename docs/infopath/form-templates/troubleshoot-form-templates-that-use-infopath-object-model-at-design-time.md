---
title: デザイン時に InfoPath オブジェクト モデルを使用するフォーム テンプレートのトラブルシューティングを行う
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
keywords:
- infopath 2003-compatible form templates, troubleshooting at design time,troubleshooting form templates [InfoPath 2007], design time
localization_priority: Normal
ms.assetid: 4179b235-e21d-4c37-ae2b-ad01388296ec
description: ここでは、Microsoft.Office.Interop.InfoPath.SemiTrust 名前空間によって提供される InfoPath 2003 互換オブジェクト モデルを使用する、マネージ コード フォーム テンプレートのデザイン時およびデバッグ時に発生する可能性のある一般的なトラブルシューティングのシナリオについて説明します。
ms.openlocfilehash: af71c8058744561a4c8ee0870fb37054e9979751
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 06/11/2018
ms.locfileid: "19799216"
---
# <a name="troubleshoot-form-templates-that-use-the-infopath-object-model-at-design-time"></a><span data-ttu-id="86e7a-104">デザイン時に InfoPath オブジェクト モデルを使用するフォーム テンプレートのトラブルシューティングを行う</span><span class="sxs-lookup"><span data-stu-id="86e7a-104">Troubleshoot form templates that use the InfoPath object model at design time</span></span>

<span data-ttu-id="86e7a-105">ここでは、 **Microsoft.Office.Interop.InfoPath.SemiTrust** 名前空間によって提供される InfoPath 2003 互換オブジェクト モデルを使用する、マネージ コード フォーム テンプレートのデザイン時およびデバッグ時に発生する可能性のある一般的なトラブルシューティングのシナリオについて説明します。</span><span class="sxs-lookup"><span data-stu-id="86e7a-105">The following sections describe common troubleshooting scenarios you may encounter while designing and debugging managed code form templates that use the InfoPath 2003-compatible object model provided by the **Microsoft.Office.Interop.InfoPath.SemiTrust** namespace.</span></span> 
  
## <a name="cannot-preview-or-debug-form-templates-that-use-calls-to-object-model-security-level-3-methods-and-properties"></a><span data-ttu-id="86e7a-106">オブジェクト モデル セキュリティ レベル 3 のメソッドとプロパティへの呼び出しを使用するフォーム テンプレートをプレビューまたはデバッグできない</span><span class="sxs-lookup"><span data-stu-id="86e7a-106">Cannot Preview or Debug Form Templates That Use Calls to Object Model Security Level 3 Methods and Properties</span></span>

<span data-ttu-id="86e7a-107">完全信頼を必要とするオブジェクト モデルのメンバーを呼び出すコードが含まれるマネージ コード プロジェクトをデバッグまたはプレビューしようとすると、"ハンドルされていないセキュリティの例外がフォームのコードで発生しました" というエラー メッセージが InfoPath によって表示され、フォームが開きません。</span><span class="sxs-lookup"><span data-stu-id="86e7a-107">If you attempt to debug or preview a managed-code project that contains code that invokes object model members that require full trust, InfoPath will display the error message "An unhandled security exception has occurred in the form's code" and the form will not open.</span></span> <span data-ttu-id="86e7a-108">フォーム テンプレートのビジネス ロジックをデバッグまたはプレビューできるようにするには、セキュリティ レベルを [ **完全信頼**] に設定し、フォームにデジタル署名する必要があります。</span><span class="sxs-lookup"><span data-stu-id="86e7a-108">To allow business logic in the form template to be debugged or previewed, you must set the security level to **Full Trust** and digitally sign the form template.</span></span> <span data-ttu-id="86e7a-109">これを行う方法の詳細については、[プレビューしその必要とする完全信頼フォーム テンプレートのデバッグ](how-to-preview-and-debug-form-templates-that-require-full-trust.md)を参照してください。</span><span class="sxs-lookup"><span data-stu-id="86e7a-109">For details on how to do this, see [Preview and Debug Form Templates that Require Full Trust](how-to-preview-and-debug-form-templates-that-require-full-trust.md).</span></span>
  
## <a name="cannot-update-xpath-expressions-in-event-handlers-if-the-matchpath-parameter-value-was-deleted-manually"></a><span data-ttu-id="86e7a-110">MatchPath パラメーターの値を手動で削除した場合に、イベント ハンドラーの XPath 式を更新できない</span><span class="sxs-lookup"><span data-stu-id="86e7a-110">Cannot Update XPath Expressions in Event Handlers If the MatchPath Parameter Value Was Deleted Manually</span></span>

<span data-ttu-id="86e7a-111">フィールドまたはグループにイベント ハンドラーを追加し、後から InfoPath の [ **フィールド**] 作業ウィンドウで、そのフィールドやグループに影響を与えるような方法で (たとえば、名前を変更したり移動したりする) データ ソースのスキーマを変更した場合、フォームのコードの XPath 式を更新するかどうかを確認するメッセージが表示されます。</span><span class="sxs-lookup"><span data-stu-id="86e7a-111">If you add an event handler to a field or group and later change the schema of the data source in the InfoPath **Fields** task pane in a way that affects that field or group (for example, by renaming or moving it), a message will be displayed asking if you want to update the XPath expressions in your form's code.</span></span> <span data-ttu-id="86e7a-112">このメッセージで言及されている XPath 式は、[MatchPath](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.InfoPathEventHandlerAttribute.MatchPath.aspx) 属性の [InfoPathEventHandlerAttribute](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.InfoPathEventHandlerAttribute.aspx) パラメーターで指定されている値のことで、これらの値はイベント ハンドラーをフォームのデータ ソースのフィールドやグループに関連付けるために使用されます。</span><span class="sxs-lookup"><span data-stu-id="86e7a-112">The XPath expressions referred to in this message are the values specified in the [MatchPath](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.InfoPathEventHandlerAttribute.MatchPath.aspx) parameter of the [InfoPathEventHandlerAttribute](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.InfoPathEventHandlerAttribute.aspx) attribute, which are used to associate the event handler with a field or group in your form's data source.</span></span> <span data-ttu-id="86e7a-113">コードの他の XPath 式は更新されません。</span><span class="sxs-lookup"><span data-stu-id="86e7a-113">No other XPath expressions in your code will be updated.</span></span> <span data-ttu-id="86e7a-114">XPath 式を更新するためのアルゴリズムは、フォーム コードで適用される **MatchPath** 属性の **InfoPathEventHandler** パラメーターに格納されている値によって異なります。</span><span class="sxs-lookup"><span data-stu-id="86e7a-114">The algorithm for updating the XPath expressions depends on a value being present in the **MatchPath** parameter of the **InfoPathEventHandler** attributes that are applied in your form code.</span></span> <span data-ttu-id="86e7a-115">XPath 式を更新するかどうかを確認するメッセージに応答する前に、これらの値を手動で削除した場合、InfoPath は XPath 式を自動的に更新できなくなります。</span><span class="sxs-lookup"><span data-stu-id="86e7a-115">If you manually deleted these values before responding to the prompt to update XPath expressions, InfoPath will not be able to update the XPath expressions automatically.</span></span> <span data-ttu-id="86e7a-116">詳細については、[追加のイベント ハンドラーを使用して InfoPath 2003 オブジェクト モデル](how-to-add-an-event-handler-using-the-infopath-2003-object-model.md)を参照してください。</span><span class="sxs-lookup"><span data-stu-id="86e7a-116">For more information, see [Add an Event Handler Using the InfoPath 2003 Object Model](how-to-add-an-event-handler-using-the-infopath-2003-object-model.md).</span></span>
  
## <a name="cannot-call-members-of-the-infopath-2003-compatible-object-model-on-a-separate-thread"></a><span data-ttu-id="86e7a-117">InfoPath 2003 互換オブジェクト モデルのメンバーを別のスレッドで呼び出すことができない</span><span class="sxs-lookup"><span data-stu-id="86e7a-117">Cannot Call Members of the InfoPath 2003 Compatible Object Model on a Separate Thread</span></span>

<span data-ttu-id="86e7a-p103">InfoPath 2003 互換オブジェクト モデルでは、別のスレッドでの呼び出しがサポートされていません。たとえば、InfoPath オブジェクト モデルのメンバーを呼び出す LaunchOMFunction という関数を呼び出す次のコードは実行されません。</span><span class="sxs-lookup"><span data-stu-id="86e7a-p103">The InfoPath 2003-compatible object model does not support calls on a separate thread. For example, the following code, which calls a function named LaunchOMFunction that calls members of the InfoPath object model, will not run.</span></span> 
  
```cs
Thread th = new Thread(new ThreadStart(LaunchOMFunction));
th.Start();
```

<span data-ttu-id="86e7a-p104">必要に応じて、この制限を回避する方法があります。詳細については、「[InfoPath 2003 オブジェクト モデルを使用する InfoPath プロジェクトにおけるスレッドのサポート](threading-support-in-infopath-projects-using-the-infopath-2003-object-model.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="86e7a-p104">When necessary, there is a way to work around this limitation. For information, see [Threading Support in InfoPath Projects Using the InfoPath 2003 Object Model](threading-support-in-infopath-projects-using-the-infopath-2003-object-model.md).</span></span>
  
## <a name="omitting-optional-parameters-causes-a-build-error-in-visual-basic-and-visual-c"></a><span data-ttu-id="86e7a-122">オプションのパラメーターを省略すると、Visual Basic および Visual C# でビルド エラーが発生する</span><span class="sxs-lookup"><span data-stu-id="86e7a-122">Omitting Optional Parameters Causes a Build Error in Visual Basic and Visual C#</span></span>

<span data-ttu-id="86e7a-p105">InfoPath オブジェクト モデルのメンバーにオプションのパラメーターがある場合に、そのパラメーターの値を指定しないときは、代わりにそのパラメーターの **Type.Missing** フィールドを渡す必要があります。実際の値を省略したときに **Type.Missing** フィールドを渡さないと、ビルド エラーが発生します。これは Visual Basic と Visual C# のどちらで書かれたコードにも当てはまります。詳細と例については、「 [InfoPath 2003 互換オブジェクト モデル](infopath-2003-compatible-object-models.md)」の「InfoPath オブジェクト モデルのメンバーにオプションのパラメーターを渡す」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="86e7a-p105">If an InfoPath object model member contains an optional parameter, and you do not specify a value for that parameter, you must pass the **Type.Missing** field for that parameter instead. Failure to pass the **Type.Missing** field when an actual value is omitted will result in a build error. This is true for code written in both Visual Basic and Visual C#. For more information and examples see the "Passing Optional Parameters to InfoPath Object Model Members" section in the [InfoPath 2003 Compatible Object Models](infopath-2003-compatible-object-models.md) topic.</span></span> 
  
## <a name="see-also"></a><span data-ttu-id="86e7a-127">関連項目</span><span class="sxs-lookup"><span data-stu-id="86e7a-127">See also</span></span>

- [<span data-ttu-id="86e7a-128">コードを含むフォーム テンプレートのためのセキュリティ モデルについて</span><span class="sxs-lookup"><span data-stu-id="86e7a-128">About the Security Model for Form Templates with Code</span></span>](about-the-security-model-for-form-templates-with-code.md)
- [<span data-ttu-id="86e7a-129">コードを含む InfoPath フォーム テンプレートを展開する</span><span class="sxs-lookup"><span data-stu-id="86e7a-129">Deploy InfoPath Form Templates with Code</span></span>](how-to-deploy-infopath-form-templates-with-code.md)
- [<span data-ttu-id="86e7a-130">InfoPath 2003 オブジェクト モデルを使用してエラーを処理する</span><span class="sxs-lookup"><span data-stu-id="86e7a-130">Handle Errors Using the InfoPath 2003 Object Model</span></span>](how-to-handle-errors-using-the-infopath-2003-object-model.md)
- [<span data-ttu-id="86e7a-131">完全信頼が必要なフォーム テンプレートをプレビューおよびデバッグする</span><span class="sxs-lookup"><span data-stu-id="86e7a-131">Preview and Debug Form Templates that Require Full Trust</span></span>](how-to-preview-and-debug-form-templates-that-require-full-trust.md)
- [<span data-ttu-id="86e7a-132">InfoPath 2003 オブジェクト モデルを使用して InfoPath プロジェクトをデバッグする</span><span class="sxs-lookup"><span data-stu-id="86e7a-132">Debug InfoPath Projects Using the InfoPath 2003 Object Model</span></span>](how-to-debug-infopath-projects-using-the-infopath-2003-object-model.md)

