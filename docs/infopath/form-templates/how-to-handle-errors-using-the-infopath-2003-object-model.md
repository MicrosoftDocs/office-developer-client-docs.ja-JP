---
title: InfoPath 2003 オブジェクト モデルを使用してエラーを処理する
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
keywords:
- infopath 2003-compatible form templates, handling errors,InfoPath 2003-compatible form templates, error handling,form templates [InfoPath 2007], error handling,error handling [InfoPath 2007], InfoPath 2003-compatible form templates
localization_priority: Normal
ms.assetid: eeb05205-d6f4-4931-b9a9-55a663bb1a25
description: カスタム アプリケーションを作成する際、開発者はしばしばエラー ハンドリングを行わなければなりません。これには、アプリケーションで発生したエラーをチェックするプログラム コードや、カスタム エラーを作成して発生させるプログラム コードの記述などの作業が伴います。InfoPath 2003 互換オブジェクト モデルでは、ErrorObject オブジェクトと ErrorsCollection コレクションを組み合わせて使用することによるエラー ハンドリングがサポートされています。
ms.openlocfilehash: 93991e33d8867f89454bec08b41ba83e98ab0a17
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/28/2019
ms.locfileid: "33439479"
---
# <a name="handle-errors-using-the-infopath-2003-object-model"></a><span data-ttu-id="f9191-105">InfoPath 2003 オブジェクト モデルを使用してエラーを処理する</span><span class="sxs-lookup"><span data-stu-id="f9191-105">Handle Errors Using the InfoPath 2003 Object Model</span></span>

<span data-ttu-id="f9191-p102">カスタム アプリケーションを作成する際、開発者はしばしばエラー ハンドリングを行わなければなりません。これには、アプリケーションで発生したエラーをチェックするプログラム コードや、カスタム エラーを作成して発生させるプログラム コードの記述などの作業が伴います。InfoPath 2003 互換オブジェクト モデルでは、[ErrorObject](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.ErrorObject.aspx) オブジェクトと [ErrorsCollection](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.ErrorsCollection.aspx) コレクションを組み合わせて使用することによるエラー ハンドリングがサポートされています。</span><span class="sxs-lookup"><span data-stu-id="f9191-p102">When creating custom applications, developers must often perform error handling that involves writing programming code to check for errors raised by the application or to create and raise custom errors. The InfoPath 2003-compatible object model supports error handling through the use of the [ErrorObject](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.ErrorObject.aspx) object in association with the [ErrorsCollection](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.ErrorsCollection.aspx) collection.</span></span> 
  
<span data-ttu-id="f9191-108">InfoPath では、フォームに入力されたデータが XML スキーマ検証に失敗したとき、カスタム検証制約に違反があったとき、[DataDOMEventObject](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.DataDOMEvent.ReportError.aspx) オブジェクトの [ReportError](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.DataDOMEventObject.aspx) メソッドによりエラーが生成されたとき、および [ErrorsCollection](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Errors.Add.aspx) コレクションの [Add](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.ErrorsCollection.aspx) メソッドを使用してエラーが作成されたときにエラーが発生します。</span><span class="sxs-lookup"><span data-stu-id="f9191-108">In InfoPath, errors can occur when data entered into a form fails XML schema validation, when a custom validation constraint fails, when an error is generated by the [ReportError](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.DataDOMEvent.ReportError.aspx) method of the [DataDOMEventObject](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.DataDOMEventObject.aspx) object, or when an error is created using the [Add](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Errors.Add.aspx) method of the [ErrorsCollection](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.ErrorsCollection.aspx) collection.</span></span> 
  
## <a name="overview-of-the-errorscollection-collection"></a><span data-ttu-id="f9191-109">ErrorsCollection コレクションの概要</span><span class="sxs-lookup"><span data-stu-id="f9191-109">Overview of the ErrorsCollection Collection</span></span>

<span data-ttu-id="f9191-110">**ErrorsCollection** コレクションには、次のメソッドとプロパティがあります。フォームの開発者は、これらを使用することにより、コレクションに含まれている **ErrorObject** オブジェクトを管理できます。</span><span class="sxs-lookup"><span data-stu-id="f9191-110">The **ErrorsCollection** collection provides the following methods and properties, which form developers can use to manage the **ErrorObject** objects that the collection contains.</span></span> 
  
|<span data-ttu-id="f9191-111">**名前**</span><span class="sxs-lookup"><span data-stu-id="f9191-111">**Name**</span></span>|<span data-ttu-id="f9191-112">**説明**</span><span class="sxs-lookup"><span data-stu-id="f9191-112">**Description**</span></span>|
|:-----|:-----|
|<span data-ttu-id="f9191-113">[Add](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Errors.Add.aspx) メソッド</span><span class="sxs-lookup"><span data-stu-id="f9191-113">[Add](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Errors.Add.aspx) method</span></span>  <br/> |<span data-ttu-id="f9191-114">**ErrorObject** オブジェクトを作成し、それをコレクションに追加します。</span><span class="sxs-lookup"><span data-stu-id="f9191-114">Creates an **ErrorObject** object and adds it to the collection.</span></span>  <br/> |
|<span data-ttu-id="f9191-115">[Delete](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Errors.Delete.aspx) メソッド</span><span class="sxs-lookup"><span data-stu-id="f9191-115">[Delete](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Errors.Delete.aspx) method</span></span>  <br/> |<span data-ttu-id="f9191-116">指定した XML ノードと条件名に関連付けられている、 **ReportError** メソッドを使用して追加したカスタム エラー以外のすべての **ErrorObject** オブジェクトを削除します。</span><span class="sxs-lookup"><span data-stu-id="f9191-116">Deletes all **ErrorObject** objects associated with the specified XML node and condition name, except for custom errors added using the **ReportError** method.</span></span>  <br/> |
|<span data-ttu-id="f9191-117">[DeleteAll](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Errors.DeleteAll.aspx) メソッド</span><span class="sxs-lookup"><span data-stu-id="f9191-117">[DeleteAll](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Errors.DeleteAll.aspx) method</span></span>  <br/> |<span data-ttu-id="f9191-118">コレクションに含まれているすべての **ErrorObject** オブジェクトを削除します。</span><span class="sxs-lookup"><span data-stu-id="f9191-118">Deletes all **ErrorObject** objects contained in the collection.</span></span>  <br/> |
|<span data-ttu-id="f9191-119">[Count](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Errors.Count.aspx) プロパティ</span><span class="sxs-lookup"><span data-stu-id="f9191-119">[Count](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Errors.Count.aspx) property</span></span>  <br/> |<span data-ttu-id="f9191-120">コレクションに含まれている **ErrorObject** オブジェクトの数を取得します。</span><span class="sxs-lookup"><span data-stu-id="f9191-120">Gets a count of the number of **ErrorObject** objects contained in the collection.</span></span>  <br/> |
|<span data-ttu-id="f9191-121">[Item](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Errors.Item.aspx) プロパティ</span><span class="sxs-lookup"><span data-stu-id="f9191-121">[Item](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Errors.Item.aspx) property</span></span>  <br/> |<span data-ttu-id="f9191-122">指定したインデックス番号に基づく **ErrorObject** オブジェクトへの参照を取得します。</span><span class="sxs-lookup"><span data-stu-id="f9191-122">Gets a reference to an **ErrorObject** object based on the specified index number.</span></span>  <br/> |
   
## <a name="overview-of-the-errorobject-object"></a><span data-ttu-id="f9191-123">ErrorObject オブジェクトの概要</span><span class="sxs-lookup"><span data-stu-id="f9191-123">Overview of the ErrorObject Object</span></span>

<span data-ttu-id="f9191-124">**ErrorObject** オブジェクトには、次のプロパティがあります。フォームの開発者は、これらを使用することにより、発生したエラーに関する情報にアクセスできます。</span><span class="sxs-lookup"><span data-stu-id="f9191-124">The **ErrorObject** object provides the following properties, which form developers can use to access information about the error that was raised.</span></span> 
  
|<span data-ttu-id="f9191-125">**名前**</span><span class="sxs-lookup"><span data-stu-id="f9191-125">**Name**</span></span>|<span data-ttu-id="f9191-126">**説明**</span><span class="sxs-lookup"><span data-stu-id="f9191-126">**Description**</span></span>|
|:-----|:-----|
|<span data-ttu-id="f9191-127">[ConditionName](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Error.ConditionName.aspx) プロパティ</span><span class="sxs-lookup"><span data-stu-id="f9191-127">[ConditionName](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Error.ConditionName.aspx) property</span></span>  <br/> |<span data-ttu-id="f9191-128">**ErrorObject** オブジェクトの型に応じて、エラー条件の名前を取得するか、または **null** を返します。</span><span class="sxs-lookup"><span data-stu-id="f9191-128">Gets the name of the error condition, or returns **null**, depending on the type of **ErrorObject** object.</span></span>  <br/> |
|<span data-ttu-id="f9191-129">[DetailedErrorMessage](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Error.DetailedErrorMessage.aspx) プロパティ</span><span class="sxs-lookup"><span data-stu-id="f9191-129">[DetailedErrorMessage](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Error.DetailedErrorMessage.aspx) property</span></span>  <br/> |<span data-ttu-id="f9191-130">**ErrorObject** オブジェクトの詳細なエラー メッセージを取得または設定します。</span><span class="sxs-lookup"><span data-stu-id="f9191-130">Gets or sets the detailed error message of the **ErrorObject** object.</span></span>  <br/> |
|<span data-ttu-id="f9191-131">[ErrorCode](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Error.ErrorCode.aspx) プロパティ</span><span class="sxs-lookup"><span data-stu-id="f9191-131">[ErrorCode](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Error.ErrorCode.aspx) property</span></span>  <br/> |<span data-ttu-id="f9191-132">**ErrorObject** オブジェクトのエラー コードを取得または設定します。</span><span class="sxs-lookup"><span data-stu-id="f9191-132">Gets or sets the error code of the **ErrorObject** object.</span></span>  <br/> |
|<span data-ttu-id="f9191-133">[Node](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Error.Node.aspx) プロパティ</span><span class="sxs-lookup"><span data-stu-id="f9191-133">[Node](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Error.Node.aspx) property</span></span>  <br/> |<span data-ttu-id="f9191-134">**ErrorObject** オブジェクトに関連付けられている XML ノードへの参照を取得します。</span><span class="sxs-lookup"><span data-stu-id="f9191-134">Gets a reference to the XML node associated with the **ErrorObject** object.</span></span>  <br/> |
|<span data-ttu-id="f9191-135">[ShortErrorMessage](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Error.ShortErrorMessage.aspx) プロパティ</span><span class="sxs-lookup"><span data-stu-id="f9191-135">[ShortErrorMessage](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Error.ShortErrorMessage.aspx) property</span></span>  <br/> |<span data-ttu-id="f9191-136">**ErrorObject** オブジェクトの短いエラー メッセージを取得または設定します。</span><span class="sxs-lookup"><span data-stu-id="f9191-136">Gets or sets the short error message of the **ErrorObject** object.</span></span>  <br/> |
|<span data-ttu-id="f9191-137">[ErrorType](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Error.ErrorType.aspx) プロパティ</span><span class="sxs-lookup"><span data-stu-id="f9191-137">[ErrorType](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Error.ErrorType.aspx) property</span></span>  <br/> |<span data-ttu-id="f9191-138">**ErrorObject** オブジェクトの型を取得します。</span><span class="sxs-lookup"><span data-stu-id="f9191-138">Gets the type of the **ErrorObject** object.</span></span>  <br/> |
   
## <a name="using-the-errorscollection-and-errorobject"></a><span data-ttu-id="f9191-139">ErrorsCollection および ErrorObject を使用する</span><span class="sxs-lookup"><span data-stu-id="f9191-139">Using the ErrorsCollection and ErrorObject</span></span>

<span data-ttu-id="f9191-p103">**ErrorsCollection** コレクションにアクセスするには、 [XDocument](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust._XDocument.Errors.aspx) オブジェクトの [Errors](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.XDocument.aspx) プロパティを使用します。 **ErrorsCollection** コレクションはフォームの基になる XML ドキュメントと関連付けられているため、エラー発生時にはエラーは XML ドキュメント内で発生します。次の例は、Visual C# の **foreach** ループを使用して、フォームの基になる XML ドキュメント内にあるエラーをチェックする方法を示します。エラーがある場合は、関数で各エラーをループ処理し、 **ErrorObject** オブジェクトの **ShortErrorMessage** プロパティを使用してメッセージをユーザーに表示します。</span><span class="sxs-lookup"><span data-stu-id="f9191-p103">The **ErrorsCollection** collection is accessed through the [Errors](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust._XDocument.Errors.aspx) property of the [XDocument](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.XDocument.aspx) object. The **ErrorsCollection** collection is associated with a form's underlying XML document so that when an error occurs, it occurs within the XML document. The following example demonstrates how a Visual C# **foreach** loop can be used to check the errors that may exist in a form's underlying XML document. If there are errors, the function loops through each of them, and, using the **ShortErrorMessage** property of the **ErrorObject** object, displays a message box to the user.</span></span> 
  
```cs
public void CheckErrors(IXMLDOMNode xmlNode)
{
   foreach(ErrorObject err in thisXDocument.Errors)
   {
      if(xmlNode==err.Node)
         thisXDocument.UI.Alert("The following error has occured: "
             + err.ShortErrorMessage + ".");
   }
}
```

<span data-ttu-id="f9191-p104">上の関数は、フォームのデータ検証イベントハンドラーの 1 つから呼び出すことができます。たとえば、フォーム内のフィールドの [OnAfterChange](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust._DataDOMEventSink_Event.OnAfterChange.aspx) イベント ハンドラー内で使用する場合なら、次に示すように [DataDOMEventObject](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.DataDOMEvent.Site.aspx) オブジェクトの [Site](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.DataDOMEventObject.aspx) プロパティを使用して、関数の呼び出し時に XML ノードを引数として渡します。</span><span class="sxs-lookup"><span data-stu-id="f9191-p104">The preceding function could be called from one of the form's data validation event handlers. For example, when used in the [OnAfterChange](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust._DataDOMEventSink_Event.OnAfterChange.aspx) event handler for a field in the form, the call to the function would pass the XML node argument using the [Site](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.DataDOMEvent.Site.aspx) property of the [DataDOMEventObject](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.DataDOMEventObject.aspx) object as follows.</span></span> 
  
```cs
CheckErrors(e.Site);
```

<span data-ttu-id="f9191-p105">フォームの開発者は、InfoPath により生成されたエラーの処理に加えて、 **DataDOMEventObject** オブジェクトの **ReportError** メソッドまたは **ErrorsCollection** コレクションの **Add** メソッドを使用してカスタム エラーを発生させることもできます。 **ReportError** メソッドおよび **Add** メソッドの使用方法の詳細については、このトピックの先頭にあるメソッド名をクリックしてください。</span><span class="sxs-lookup"><span data-stu-id="f9191-p105">In addition to handling errors generated by InfoPath, form developers can also generate custom errors by using the **ReportError** method of the **DataDOMEventObject** object, or by using the **Add** method of the **ErrorsCollection** collection. For information about using the **ReportError** or **Add** methods, click the methods at the beginning of this topic.</span></span> 
  
## <a name="handling-managed-code-exceptions"></a><span data-ttu-id="f9191-148">マネージ コードの例外を処理する</span><span class="sxs-lookup"><span data-stu-id="f9191-148">Handling Managed-Code Exceptions</span></span>

<span data-ttu-id="f9191-149">try-catch 例外処理を使用すると、次のコードに示すようにマネージ コード フォーム テンプレート内で発生した例外を処理することができます。</span><span class="sxs-lookup"><span data-stu-id="f9191-149">You can use try-catch exception handling to handle exceptions raised in managed-code form template as shown in the following code example.</span></span>
  
```cs
DataAdapters dataAdapters;
dataAdapters = thisXDocument.DataAdapters; 
XMLFileAdapterObject queryXMLFile = 
   (XMLFileAdapterObject)dataAdapters["form1"];
// Perform the query.
try
{
   queryXMLFile.Query();
}
catch (Exception ex)
{
   thisXDocument.UI.Alert("Failed to query.\n\n" + ex.Message);
}
// Perform the submit.
try
{
   queryXMLFile.Submit();
}
catch (Exception ex)
{
   thisXDocument.UI.Alert("Failed to submit.\n\n" + ex.Message);
}
```

<span data-ttu-id="f9191-150">フォーム コード内で try-catch 例外処理を使用していないと、デバッグ中およびプレビュー中に、未処理の例外に関する情報が InfoPath によって InfoPath のエラー ダイアログ ボックスに表示されます。</span><span class="sxs-lookup"><span data-stu-id="f9191-150">If you do not use try-catch exception handling in your form code, InfoPath will display information about unhandled exceptions in the InfoPath error dialog box while debugging and previewing.</span></span> 
  

