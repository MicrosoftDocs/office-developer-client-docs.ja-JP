---
title: 非同期のユーザー定義関数
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
ms.topic: overview
localization_priority: Normal
ms.assetid: 142eb27e-fb6f-4da3-bfb7-a88115bbb5d5
description: '�K�p�Ώ�: Excel 2013?| Office 2013?| Visual Studio'
ms.openlocfilehash: 5b64dfd4308da4efb5e94010fe1dc9d758a1199c
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 06/11/2018
ms.locfileid: "19798755"
---
# <a name="asynchronous-user-defined-functions"></a>非同期のユーザー定義関数

**適用されます**Excel 2013 |。Office 2013 |Visual Studio 
  
Microsoft Excel 2013 では、ユーザー定義関数を非同期的に呼び出すことができます。 関数を非同期的に呼び出すと、いくつかの計算を同時に実行を許可することでパフォーマンスが向上できます。 計算クラスターでユーザー定義関数を実行するときに関数の呼び出しを非同期的に計算を完了するためにいくつかのコンピューターを使用できます。
  
## <a name="when-to-use-asynchronous-user-defined-functions"></a>非同期のユーザー定義関数を使用する場合

いくつかのユーザー定義関数は、外部リソースを待つ必要があります。 、待機中に、Excel 計算スレッドはブロックされます。 2013 年 Excel でユーザー定義関数を非同期的に実行できます。 これにより、ユーザー定義関数は待機中に他の計算を実行する計算のスレッドが解放されます。
  
Excel 2007 では、プログラマによって実行できます複数のユーザー定義関数を同時に複数スレッドの再計算に使用されるスレッドの数を増やします。 このメソッドでは、スレッドの数は、アプリケーションを対象にした設定であり、レベルの 1 つの関数またはアドインを制御することはできませんが主な理由に欠点があります。
  
�֐����O�����\�[�X��҂K�v������ꍇ�A�v���O���}�[�͔񓯊��̃��[�U�[��`�֐��̌Ăяo����g�p����K�v������܂��B���Ƃ��΁A�C���^�[�l�b�g��� SOAP �v���𑗐M����֐��́A�l�b�g���[�N�ŗv�����z�M����A�����[�g �T�[�o�[�ŗv�����������A�l�b�g���[�N�Ō��ʂ��Ԃ����̂�҂K�v������܂��B���̏ꍇ�A�d�v�ȃR���s���[�e�B���O�͔��������AExcel �ő��̌v�Z��p�����čs�����Ƃ��ł��܂��B
  
�֐����v�Z�N���X�^�[�ɗv���𑗐M���Ă���ꍇ�A�v���O���}�[�͔񓯊��̃��[�U�[��`�֐���g�p���邱�Ƃ�ł��܂��B���̏ꍇ�A�l�b�g���[�N�̒x����҂����łȂ��A�N���X�^�[�͌X�̌Ăяo����ʁX�̃T�[�o�[�Ŏ��s�ł��܂��B�X�̌Ăяo������������܂ő҂��Ȃ����Ƃɂ��A�Ăяo����d�����邱�Ƃ��ł��邽�߃p�t�H�[�}���X�����P���܂��B�ꍇ�ɂ���ẮA�啝�ɉ��P���܂��B
  
> [!NOTE]
> [!����] ���[�U�[��`�֐��́A�񓯊��ƃN���X�^�[ �Z�[�t�̗����Ƃ��ēo�^���邱�Ƃ͂ł��܂���B 
  
## <a name="writing-an-asynchronous-user-defined-function"></a>非同期のユーザー定義関数の記述

非同期のユーザー定義関数はハンドルを追跡し、Excel に関数の呼び出しが完了したことを通知する際にそのハンドルを使用する必要があります。非同期のユーザー定義関数は 2 つの部分に分割されます。最初の部分は標準の UDF エントリ ポイントです。これにより、2 番目の別の非同期操作が開始されます。Excel へのコールバックは、UDF エントリ ポイントの間に行う必要があります。その後、関数の最初の開始部分では、その計算スレッドの制御を Excel に返し、Excel によって計算が継続されます。2 番目の非同期操作が完了すると、Excel にコールバックして結果を Excel に提供する必要があります。  
  
> [!NOTE]
> [!����] �񓯊������ŕK�v�� UDF �ɓn���ꂽ���ׂĂ̈����ɂ��ẮAUDF �G���g�� �|�C���g���Ԃ��ꂽ�Ƃ��� Excel �������̈����������邽�߁A�֐��̏ڍׂ��R�s�[����Ȃ���΂Ȃ�܂���B 
  
Excel �ł́A�񓯊��� UDF �Ăяo���̃��C�t �T�C�N����Ǘ����邽�߁AXLL �A�h�C�����g�����Ƃ̂ł���C�x���g�̃Z�b�g���񋟂���܂��B�����̃C�x���g�́AExcel �ł̌v�Z�������������A�v�Z���������ꂽ��������܂��B
  
### <a name="declaring-an-asynchronous-function"></a>非同期関数を宣言します。

�񓯊��̃��[�U�[��`�֐��̓o�^���ɁA�����񓯊��Ƃ��Đ錾����K�v������܂��B����́AXLOPER12 �\�� (�o�^�^�C�v�̕������ "X" �ƕ\�������) ��|�C���g����p�����[�^�[�� UDF �p�����[�^�[�̈ꗗ�̔C�ӂ̏ꏊ�ɒǉ����邱�Ƃɂ���Ď��s����܂��BExcel �ł́A���̃p�����[�^�[��g�p���Ĕ񓯊��̌Ăяo���n���h����n���܂��BXLL �A�h�C���́A�񓯊��̌Ăяo���n���h���ƁA�֐��̌��ʂ̏������ł����炻�̌��ʂ� Excel �ɓn���K�v������܂��B����ɁAUDF �̖߂�l�̌^�́A������^�̍ŏ��̕����Ƃ��� ">" �ɂ���Ďw�肳��� **void** �łȂ���΂Ȃ�܂���BUDF �̓��������� Excel �ɒl��Ԃ��Ȃ����߁A�߂�l�̌^�� void �ł��B����ɁAXLL �A�h�C�����R�[���o�b�N�ɂ���Ēl��񓯊��ŕԂ��܂��B 
  
�񓯊��̊֐���X���b�h �Z�[�t�Ƃ��Đ錾����ƁAUDF �̓����������}���`�X���b�h�̍Čv�Z�Ŏg�p����܂��B 
  
���̃R�[�h��́A"\>QX" ��o�^�^�C�v�̕�����Ƃ��Ďg�p���ēo�^���ꂽ�񓯊��̃��[�U�[��`�֐�������܂��B
  
```cpp
void MyAsyncUDF(LPXLOPER12 arg1, LPXLOPER12 pxAsyncHandle)
{
…
}
```

### <a name="returning-values"></a>値を返す

�񓯊��̌Ăяo���̌��ʂ̏������ł�����A�^ [xlAsyncReturn](xlasyncreturn.md) �̃R�[���o�b�N����s���邱�Ƃɂ���� XLL �A�h�C���͂��̌��ʂ� Excel �ɕԂ��܂��B
  
**xlAsyncReturn** �́A�Čv�Z���Ɍv�Z�ȊO�̃X���b�h�Ɏg�p�ł���B��̃R�[���o�b�N�ł��B���������āA�񓯊��� UDF �̔񓯊������ő��̃R�[���o�b�N�͎��s���Ȃ��ł��������B 
  
### <a name="handling-events"></a>イベントの処理

Excel 2010 �ȍ~�AXLL �͔񓯊��֐��̃��C�t �T�C�N����Ǘ����邽�߂ɐ݌v���ꂽ�C�x���g���M�ł��܂��B�ڂ����́A�u[�C�x���g�̏���](handling-events.md)�v��������������B
  
## <a name="see-also"></a>�֘A����

- [Excel XLL �̊J��](developing-excel-xlls.md)

