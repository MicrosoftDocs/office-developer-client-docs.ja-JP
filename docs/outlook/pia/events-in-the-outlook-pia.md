---
title: Outlook PIA でのイベント
TOCTitle: Events in the Outlook PIA
ms:assetid: 1f9eafb3-6645-4e27-81fa-5d73bf94ae40
ms:mtpsurl: https://msdn.microsoft.com/library/office/bb644571(v=office.15)
ms:contentKeyID: 55119782
ms.date: 07/24/2014
mtps_version: v=office.15
localization_priority: Normal
ms.openlocfilehash: 29217a633c02390587a370847291ef62d5621ce8
ms.sourcegitcommit: d6695c94415fa47952ee7961a69660abc0904434
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 01/17/2019
ms.locfileid: "28699213"
---
# <a name="events-in-the-outlook-pia"></a><span data-ttu-id="ac9da-102">Outlook PIA でのイベント</span><span class="sxs-lookup"><span data-stu-id="ac9da-102">Events in the Outlook PIA</span></span>

<span data-ttu-id="ac9da-p101">Outlook プライマリ相互運用機能アセンブリ (PIA) をブラウズすると、Outlook オブジェクト モデルで見慣れたオブジェクト名やイベント名に基づく名前のインターフェイスおよびイベント デリゲートが多数あることがわかります。COM タイプ ライブラリのイベントとは異なり、Outlook PIA のイベントは同じオブジェクトのメソッドやプロパティと同じインターフェイスでは定義されません。Outlook PIA のイベントをサポートするには、イベント関連のインターフェイス、デリゲート、およびシンク ヘルパー クラスをインポートするか作成します。このトピックでは、これらのイベント関連のインターフェイス、デリゲート、およびシンク ヘルパー クラスについて説明します。</span><span class="sxs-lookup"><span data-stu-id="ac9da-p101">Browsing the Outlook Primary Interop Assembly (PIA), you might notice that many interfaces and event delegates are named after familiar names of objects and events in the Outlook object model. Unlike events in the COM type library, events in the Outlook PIA are not defined in the same interface as methods and properties of the same object. Event-related interfaces, delegates, and sink helper classes are either imported or created to support events in the Outlook PIA. This topic describes these event-related interfaces, delegates, and sink helper classes.</span></span>

## <a name="where-do-the-event-interfaces-delegates-and-sink-helper-classes-come-from"></a><span data-ttu-id="ac9da-107">イベントのインターフェイス、デリゲート、シンク ヘルパー クラスの取得</span><span class="sxs-lookup"><span data-stu-id="ac9da-107">Where do the event interfaces, delegates, and Sink Helper classes come from</span></span>

<span data-ttu-id="ac9da-p102">Outlook は、Outlook PIA を作成するために .NET Framework のタイプ ライブラリ インポーター (TLBIMP) を使用して COM タイプ ライブラリのタイプの定義を共通言語ランタイム (CLR) アセンブリの同等の定義に変換します。TLBIMP は、オブジェクトごとに次の 2 種類のインターフェイスをインポートします。</span><span class="sxs-lookup"><span data-stu-id="ac9da-p102">To create the Outlook PIA, Outlook uses the Type Library Importer (TLBIMP) in the .NET Framework to convert type definitions in the COM type library into equivalent definitions in a common language runtime (CLR) assembly. TLBIMP imports the following two types of interfaces for each object:</span></span>

  - <span data-ttu-id="ac9da-110">プライマリ インターフェイス (例: [\_Application](https://msdn.microsoft.com/library/bb611255\(v=office.15\)) インターフェイス)</span><span class="sxs-lookup"><span data-stu-id="ac9da-110">The primary interface (for example, the [\_Application](https://msdn.microsoft.com/library/bb611255\(v=office.15\)) interface)</span></span>

  - <span data-ttu-id="ac9da-111">イベント インターフェイス (例: [ApplicationEvents\_11](https://msdn.microsoft.com/library/bb609229\(v=office.15\)) インターフェイス)</span><span class="sxs-lookup"><span data-stu-id="ac9da-111">The event interface (for example, the [ApplicationEvents\_11](https://msdn.microsoft.com/library/bb609229\(v=office.15\)) interface)</span></span>

<span data-ttu-id="ac9da-p103">TLBIMP は、インポートしたインターフェイスを処理し, .NET インターフェイス (たとえば、[Application](https://msdn.microsoft.com/library/bb646615\(v=office.15\)) インターフェイス) などの、いくつかのインターフェイス、デリゲート、およびクラスを作成します。オブジェクトにイベントがある場合は、次のものが作成されます。</span><span class="sxs-lookup"><span data-stu-id="ac9da-p103">TLBIMP processes the imported interfaces and creates a number of interfaces, delegates, and classes, including the .NET interface (for example, the [Application](https://msdn.microsoft.com/library/bb646615\(v=office.15\)) interface). If the object has events, the following are created:</span></span>

  - <span data-ttu-id="ac9da-114">.NET イベント インターフェイス (例: [ApplicationEvents\_11\_Event](https://msdn.microsoft.com/library/bb622725\(v=office.15\)) インターフェイス)</span><span class="sxs-lookup"><span data-stu-id="ac9da-114">The .NET event interface (for example, the [ApplicationEvents\_11\_Event](https://msdn.microsoft.com/library/bb622725\(v=office.15\)) interface)</span></span>

  - <span data-ttu-id="ac9da-115">各イベントのデリゲート (たとえば、 [ApplicationEvents\_11\_ItemSendEventHandler](https://msdn.microsoft.com/library/bb610818\(v=office.15\)) デリゲート)</span><span class="sxs-lookup"><span data-stu-id="ac9da-115">Delegate for each event (for example, the [ApplicationEvents\_11\_ItemSendEventHandler](https://msdn.microsoft.com/library/bb610818\(v=office.15\)) delegate)</span></span>

  - <span data-ttu-id="ac9da-116">シンク ヘルパー クラス (たとえば、 [ApplicationEvents\_11\_SinkHelper](https://msdn.microsoft.com/library/bb609842\(v=office.15\)) クラス)</span><span class="sxs-lookup"><span data-stu-id="ac9da-116">Sink helper class (for example, [ApplicationEvents\_11\_SinkHelper](https://msdn.microsoft.com/library/bb609842\(v=office.15\)) class)</span></span>

### <a name="multiple-versions-of-events"></a><span data-ttu-id="ac9da-117">複数のバージョンのイベント</span><span class="sxs-lookup"><span data-stu-id="ac9da-117">Multiple versions of events</span></span>

<span data-ttu-id="ac9da-p104">Outlook の複数のバージョンにわたって存在してきたオブジェクトの中には、バージョンによってイベントの実装が異なるものや、新しいバージョンがリリースされたときに追加的なイベントが増やされたものがあります。Outlook では、複数のバージョンの間で変化するイベントに対応するために、その名前にバージョン番号を付加してイベント関連のインターフェイス、デリゲート、およびクラスを識別しています。以下に例を示します。</span><span class="sxs-lookup"><span data-stu-id="ac9da-p104">Some objects that have existed for multiple versions of Outlook have different implementations of events over the versions, and have had additional events added as new versions are released. To support events that vary over multiple versions, Outlook distinguishes these event-related interfaces, delegates, and classes by adding a version number to their names. For example:</span></span>

  - <span data-ttu-id="ac9da-121">**Application** オブジェクトに関してインポートされるイベント インターフェイス</span><span class="sxs-lookup"><span data-stu-id="ac9da-121">The imported event interfaces of the **Application** object includes:</span></span>
    
      - <span data-ttu-id="ac9da-122">Outlook 98 および Outlook 2000 用の最初のバージョン: [ApplicationEvents](https://msdn.microsoft.com/library/bb644093\(v=office.15\)) インターフェイス</span><span class="sxs-lookup"><span data-stu-id="ac9da-122">The earliest version for Outlook 98 and Outlook 2000: the [ApplicationEvents](https://msdn.microsoft.com/library/bb644093\(v=office.15\)) interface</span></span>
    
      - <span data-ttu-id="ac9da-123">Outlook 2002 用のバージョン: [ApplicationEvents\_10](https://msdn.microsoft.com/library/bb647702\(v=office.15\)) インターフェイス</span><span class="sxs-lookup"><span data-stu-id="ac9da-123">The version for Outlook 2002: the [ApplicationEvents\_10](https://msdn.microsoft.com/library/bb647702\(v=office.15\)) interface</span></span>
    
      - <span data-ttu-id="ac9da-124">Outlook 2003 以降のリリース用のバージョン: [ApplicationEvents\_11](https://msdn.microsoft.com/library/bb609229\(v=office.15\)) インターフェイス</span><span class="sxs-lookup"><span data-stu-id="ac9da-124">The version for Outlook 2003 and later releases: the [ApplicationEvents\_11](https://msdn.microsoft.com/library/bb609229\(v=office.15\)) interface</span></span>

  - <span data-ttu-id="ac9da-125">**Application** オブジェクトで TLBIMP によって作成される .NET イベント インターフェイスに含まれるもの:</span><span class="sxs-lookup"><span data-stu-id="ac9da-125">The .NET event interfaces created by TLBIMP for the **Application** object includes:</span></span>
    
      - <span data-ttu-id="ac9da-126">Outlook 98 および Outlook 2000 用の最初のバージョン: [ApplicationEvents\_Event](https://msdn.microsoft.com/library/bb609380\(v=office.15\)) インターフェイス</span><span class="sxs-lookup"><span data-stu-id="ac9da-126">The earliest version for Outlook 98 and Outlook 2000: the [ApplicationEvents\_Event](https://msdn.microsoft.com/library/bb609380\(v=office.15\)) interface</span></span>
    
      - <span data-ttu-id="ac9da-127">Outlook 2002 用のバージョン: [ApplicationEvents\_10\_Event](https://msdn.microsoft.com/library/bb610098\(v=office.15\)) インターフェイス</span><span class="sxs-lookup"><span data-stu-id="ac9da-127">The version for Outlook 2002: the [ApplicationEvents\_10\_Event](https://msdn.microsoft.com/library/bb610098\(v=office.15\)) interface</span></span>
    
      - <span data-ttu-id="ac9da-128">Outlook 2003 以降のリリース用のバージョン: [ApplicationEvents\_11\_Event](https://msdn.microsoft.com/library/bb622725\(v=office.15\)) インターフェイス</span><span class="sxs-lookup"><span data-stu-id="ac9da-128">The version for Outlook 2003 and later releases: the [ApplicationEvents\_11\_Event](https://msdn.microsoft.com/library/bb622725\(v=office.15\)) interface</span></span>

  - <span data-ttu-id="ac9da-129">**Application** オブジェクトの各バージョンでイベントごとに TLBIMP が作成するデリゲート (例: ItemSend イベントの各バージョンのデリゲート)</span><span class="sxs-lookup"><span data-stu-id="ac9da-129">The delegates that TLBIMP creates for each event in each version of the **Application** object, for example, a delegate for each version of the ItemSend event:</span></span>
    
      - <span data-ttu-id="ac9da-130">Outlook 98 および Outlook 2000 用の最初のバージョン: [ApplicationEvents\_ItemSendEventHandler](https://msdn.microsoft.com/library/bb622515\(v=office.15\)) デリゲート</span><span class="sxs-lookup"><span data-stu-id="ac9da-130">The earliest version for Outlook 98 and Outlook 2000: the [ApplicationEvents\_ItemSendEventHandler](https://msdn.microsoft.com/library/bb622515\(v=office.15\)) delegate</span></span>
    
      - <span data-ttu-id="ac9da-131">Outlook 2002 用のバージョン: [ApplicationEvents\_10\_ItemSendEventHandler](https://msdn.microsoft.com/library/bb646436\(v=office.15\)) デリゲート</span><span class="sxs-lookup"><span data-stu-id="ac9da-131">The version for Outlook 2002: the [ApplicationEvents\_10\_ItemSendEventHandler](https://msdn.microsoft.com/library/bb646436\(v=office.15\)) delegate</span></span>
    
      - <span data-ttu-id="ac9da-132">Outlook 2003 以降のリリース用のバージョン: [ApplicationEvents\_11\_ItemSendEventHandler](https://msdn.microsoft.com/library/bb610818\(v=office.15\)) デリゲート</span><span class="sxs-lookup"><span data-stu-id="ac9da-132">The version for Outlook 2003 and later releases: the [ApplicationEvents\_11\_ItemSendEventHandler](https://msdn.microsoft.com/library/bb610818\(v=office.15\)) delegate</span></span>

<span data-ttu-id="ac9da-p105">新しいバージョンで追加されたイベントは、それ以前のバージョンではイベント インターフェイスに含まれず、対応するデリゲートもありません。たとえば、[AttachmentSelectionChange](https://msdn.microsoft.com/library/ff184926\(v=office.15\)) イベントは Outlook 2010 で [Explorer](https://msdn.microsoft.com/library/bb623678\(v=office.15\)) オブジェクトに追加されたので、 Explorer オブジェクトの以前のイベント インターフェイスには含まれていません。</span><span class="sxs-lookup"><span data-stu-id="ac9da-p105">Logically, events that are added to a later version do not appear in event interfaces of earlier versions and do not have corresponding delegates in earlier versions. For example, the [AttachmentSelectionChange](https://msdn.microsoft.com/library/ff184926\(v=office.15\)) event was added to the [Explorer](https://msdn.microsoft.com/library/bb623678\(v=office.15\)) object in Outlook 2010, therefore, it is not part of these earlier event interfaces for the Explorer object:</span></span>

  - <span data-ttu-id="ac9da-135">ExplorerEvents インターフェイス</span><span class="sxs-lookup"><span data-stu-id="ac9da-135">ExplorerEvents interface</span></span>

  - <span data-ttu-id="ac9da-136">ExplorerEvents\_ イベント インターフェイス</span><span class="sxs-lookup"><span data-stu-id="ac9da-136">ExplorerEvents\_Event interface</span></span>

<span data-ttu-id="ac9da-137">その一方、このイベントは最新の .NET イベント インターフェイスである ExplorerEvents\_10\_Event にあり、また、それに対応する Outlook 2010 用のデリゲートは [ExplorerEvents\_10\_AttachmentSelectionChangeEventHandler](https://msdn.microsoft.com/library/ff185177\(v=office.15\)) にあります。</span><span class="sxs-lookup"><span data-stu-id="ac9da-137">On the other hand, you can find the event in the most recent .NET event interface, ExplorerEvents\_10\_Event, and its delegate for the Outlook 2010 version, [ExplorerEvents\_10\_AttachmentSelectionChangeEventHandler](https://msdn.microsoft.com/library/ff185177\(v=office.15\)).</span></span>

## <a name="what-the-event-interfaces-delegates-and-sink-helper-classes-are-for"></a><span data-ttu-id="ac9da-138">イベント インターフェイス、デリゲート、シンク ヘルパー クラスの目的</span><span class="sxs-lookup"><span data-stu-id="ac9da-138">What the event interfaces, delegates, and Sink Helper classes are for</span></span>

<span data-ttu-id="ac9da-139">このセクションでは、**Application** オブジェクトを例として使用し、上記の各インターフェイスおよびクラスの内容を説明します。</span><span class="sxs-lookup"><span data-stu-id="ac9da-139">Using the **Application** object as an example, this section describes what each interface and class listed above contains:</span></span>

  - <span data-ttu-id="ac9da-140">プライマリ インターフェイスである \_Application は、Application のすべてのメソッドおよびプロパティを定義します。</span><span class="sxs-lookup"><span data-stu-id="ac9da-140">The primary interface, \_Application, defines all the methods and properties of Application.</span></span> <span data-ttu-id="ac9da-141">通常、後で説明する場合を除き、このインターフェイスをコードで使用することはありません。</span><span class="sxs-lookup"><span data-stu-id="ac9da-141">Except for a condition discussed below, typically you do not use this interface in code.</span></span>

  - <span data-ttu-id="ac9da-142">TLBIMP がインポートするイベント インターフェイス (例: ApplicationEvents\_11 や ApplicationEvents\_10 など) では、Outlook の対応するバージョンの Application のイベントに対するメソッド マッピングが定義されます。</span><span class="sxs-lookup"><span data-stu-id="ac9da-142">The events interfaces imported by TLBIMP, such as ApplicationEvents\_11 and ApplicationEvents\_10, define methods mapping to events of Application in the corresponding version of Outlook.</span></span> <span data-ttu-id="ac9da-143">このインターフェイスはコードでは使用しません。</span><span class="sxs-lookup"><span data-stu-id="ac9da-143">You do not use this interface in code.</span></span>

  - <span data-ttu-id="ac9da-144">TLBIMP によって作成されるイベント インターフェイス (例: ApplicationEvents\_11\_Event や ApplicationEvents\_10\_Event など) では、Outlook の対応するバージョンの Application のすべてのイベントが定義されます。</span><span class="sxs-lookup"><span data-stu-id="ac9da-144">The events interfaces created by TLBIMP, such as ApplicationEvents\_11\_Event and ApplicationEvents\_10\_Event, define all the events of Application in the corresponding version of Outlook.</span></span> <span data-ttu-id="ac9da-145">特定のバージョンのイベントのイベント ハンドラーを設計するときは、イベント ハンドラーをメソッドとして実装し、そのメソッドを, .NET イベント インターフェイスの対応するバージョンで定義されているイベントに接続します。</span><span class="sxs-lookup"><span data-stu-id="ac9da-145">When designing an event handler for an event in a specific version, you implement the event handler as a method and connect the method to the event defined in the corresponding version of the .NET events interface.</span></span> <span data-ttu-id="ac9da-146">通常、後で説明する場合を除き、このイベント インターフェイスをコードで参照することはありません。</span><span class="sxs-lookup"><span data-stu-id="ac9da-146">Except for a condition discussed below, typically you do not reference the events interface in code.</span></span>

  - <span data-ttu-id="ac9da-147">.NET インターフェイスである Application は、\_Application インターフェイスおよび ApplicationEvents\_11\_Event インターフェイスを継承します。</span><span class="sxs-lookup"><span data-stu-id="ac9da-147">The .NET interface, Application, inherits the \_Application interface and the ApplicationEvents\_11\_Event interface.</span></span> <span data-ttu-id="ac9da-148">通常、これはマネージ コードでオブジェクト、メソッド、プロパティ、および **Application** オブジェクトの最新のイベント メンバーにアクセスするとき使用するインターフェイスです。</span><span class="sxs-lookup"><span data-stu-id="ac9da-148">Typically, this is the one interface you use in managed code to access the object, method, property, and the latest event members of the **Application** object.</span></span> <span data-ttu-id="ac9da-149">ただし、次の 2 つのケースでは, .NET インターフェイスではなく、別のインターフェイスを使用してイベントに接続します。</span><span class="sxs-lookup"><span data-stu-id="ac9da-149">There are however two exceptions where you would not use the .NET interface but a different interface to connect to an event:</span></span>
    
      - <span data-ttu-id="ac9da-150">アクセスするイベントの名前が、そのオブジェクトのメソッドと同じときは、適切なイベント インターフェイスにキャストしてイベントに接続します。</span><span class="sxs-lookup"><span data-stu-id="ac9da-150">When you access an event that shares the same name as a method of that object, cast to the appropriate event interface to connect to the event.</span></span> <span data-ttu-id="ac9da-151">たとえば、[Quit](https://msdn.microsoft.com/library/bb622595\(v=office.15\)) イベントに接続するには ApplicationEvents\_11\_Event インターフェイスにキャストします。</span><span class="sxs-lookup"><span data-stu-id="ac9da-151">For example, to connect to the [Quit](https://msdn.microsoft.com/library/bb622595\(v=office.15\)) event, you cast to the ApplicationEvents\_11\_Event interface.</span></span>
    
      - <span data-ttu-id="ac9da-152">以降の新しいバージョンの Outlook で拡張されたイベントの以前のバージョンに接続するときは、以前のインターフェイスのイベントのバージョンに接続します。</span><span class="sxs-lookup"><span data-stu-id="ac9da-152">When you connect to an earlier version of an event that has been subsequently extended in a later version of Outlook, connect to the version of the event in the earlier interface.</span></span> <span data-ttu-id="ac9da-153">たとえば、最新バージョンではなくて Outlook 2002 で実装された **Application** オブジェクト用の Quit イベントのバージョンに接続する場合、ApplicationEvents\_11\_Event インターフェイスで定義された Quit イベントではなく、ApplicationEvents\_10\_Event インターフェイスで定義された [Quit](https://msdn.microsoft.com/library/bb609660\(v=office.15\)) イベントに接続します。</span><span class="sxs-lookup"><span data-stu-id="ac9da-153">For example, if you want to connect to the version of the Quit event of the **Application** object implemented for Outlook 2002 instead of the latest version, connect to the [Quit](https://msdn.microsoft.com/library/bb609660\(v=office.15\)) event defined in the ApplicationEvents\_10\_Event interface, instead of the Quit event defined in the ApplicationEvents\_11\_Event interface.</span></span>

  - <span data-ttu-id="ac9da-154">デリゲートは、特定のバージョンの Outlook で特定のイベントのカスタム イベント ハンドラーを作成するためのフレームワークを提供します。</span><span class="sxs-lookup"><span data-stu-id="ac9da-154">Delegates provide a framework for you to create custom event handlers for specific events in a specific version of Outlook.</span></span> <span data-ttu-id="ac9da-155">たとえば、Outlook アイテムで、送信直前に行う件名の有無の確認を追加する場合は、デリゲートと同じ署名を持つコールバック メソッド ApplicationEvents\_11\_ItemSendEventHandler で確認を実装します。</span><span class="sxs-lookup"><span data-stu-id="ac9da-155">For example, if you want to add a check for the existence of a subject line in an Outlook item just before you send it, you implement the check in a callback method that has the same signature as the delegate, ApplicationEvents\_11\_ItemSendEventHandler.</span></span> <span data-ttu-id="ac9da-156">次に、コールバック メソッドを、ApplicationEvents\_11\_Event インターフェイスで定義された ItemSend イベント用のイベント ハンドラーとして接続します。</span><span class="sxs-lookup"><span data-stu-id="ac9da-156">Then you hook up the callback method as an event handler for the ItemSend event that is defined in the ApplicationEvents\_11\_Event interface.</span></span> <span data-ttu-id="ac9da-157">オブジェクトのイベント ハンドラーとしてのコールバック メソッドの接続に関する詳細については、「[カスタム イベント ハンドラーに接続する](connecting-to-custom-event-handlers.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="ac9da-157">For more information about connecting the callback method as an event handler for an object, see [Connecting to custom event handlers](connecting-to-custom-event-handlers.md).</span></span>

  - <span data-ttu-id="ac9da-158">TLBIMP によって作成されるシンク ヘルパー クラス (例: ApplicationEvents\_11\_SinkHelper や [ApplicationEvents\_10\_SinkHelper](https://msdn.microsoft.com/library/bb644070\(v=office.15\)) など) は、Outlook の対応するバージョンの Application イベント用のイベント ヘルパー オブジェクトです。</span><span class="sxs-lookup"><span data-stu-id="ac9da-158">The sink helper classes created by TLBIMP, for example, ApplicationEvents\_11\_SinkHelper and [ApplicationEvents\_10\_SinkHelper](https://msdn.microsoft.com/library/bb644070\(v=office.15\)), are event helper objects for Application events in the corresponding version of Outlook.</span></span> <span data-ttu-id="ac9da-159">これらのクラスはコードで使わないでください。</span><span class="sxs-lookup"><span data-stu-id="ac9da-159">Do not use these classes in code.</span></span>

## <a name="see-also"></a><span data-ttu-id="ac9da-160">関連項目</span><span class="sxs-lookup"><span data-stu-id="ac9da-160">See also</span></span>

- [<span data-ttu-id="ac9da-161">Outlook PIA とオブジェクト モデルの関係</span><span class="sxs-lookup"><span data-stu-id="ac9da-161">Relating the Outlook PIA with the object model</span></span>](relating-the-outlook-pia-with-the-object-model.md)
- [<span data-ttu-id="ac9da-162">Outlook PIA でのオブジェクト</span><span class="sxs-lookup"><span data-stu-id="ac9da-162">Objects in the Outlook PIA</span></span>](objects-in-the-outlook-pia.md)
- [<span data-ttu-id="ac9da-163">Outlook PIA でのメソッドとプロパティ</span><span class="sxs-lookup"><span data-stu-id="ac9da-163">Methods and properties in the Outlook PIA</span></span>](methods-and-properties-in-the-outlook-pia.md)
- [<span data-ttu-id="ac9da-164">Outlook PIA を使用してマネージ Outlook アドインを開発する</span><span class="sxs-lookup"><span data-stu-id="ac9da-164">Developing managed Outlook add-ins using the Outlook PIA</span></span>](developing-managed-outlook-add-ins-using-the-outlook-pia.md)

