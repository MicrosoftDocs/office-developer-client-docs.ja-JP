---
title: トランスポート プロバイダーの初期化
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 977c18ce-ece5-4ad1-ac97-5a680846ab83
description: '�ŏI�X�V��: 2011�N7��23��'
ms.openlocfilehash: 3b369e20101bbaba5e246b2ef9f6ab3ed1771ef6
ms.sourcegitcommit: 0cf39e5382b8c6f236c8a63c6036849ed3527ded
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/23/2018
ms.locfileid: "22563556"
---
# <a name="initializing-the-transport-provider"></a>トランスポート プロバイダーの初期化

  
  
**適用されます**: Outlook 2013 |Outlook 2016 
  
トランスポートがスプーラーのインターフェイスでは、MAPI スプーラーでは、トランスポート プロバイダーへの呼び出しを定義します。 トランスポート プロバイダーは、ダイナミック リンク ライブラリ (DLL) で、これらのルーチンを実装します。 MAPI スプーラーによって使用される DLL への最初の直接のエントリ ポイントでは、トランスポート プロバイダーの初期化関数[XPProviderInit](xpproviderinit.md)をする必要があります。
  
MAPI は、 **GetProcAddress**ルーチンを使用して、サービス プロバイダーの初期化ルーチンのアドレスを取得して、そのルーチンを呼び出すと。 初期化ルーチンの名前は、トランスポート プロバイダーの**XPProviderInit**です。 MAPI サービス プロバイダーの他の種類によって異なりますが 1 つの DLL は、サービス プロバイダーの種類が特定の種類の 1 つのサービス プロバイダーの任意の組み合わせを含めることができますように。 ただし、特定の種類の 1 つのサービス プロバイダーは、その型の複数のサービスを実装できます。 など、1 つのトランスポート プロバイダーは、複数のメッセージ サービスへのメッセージ トランスポート機能を実装できます。 
  
Mapispi.h ヘッダー ファイルには、トランスポート プロバイダーの初期化関数の関数プロトタイプの種類の定義と、定義済みのプロシージャの名前があります。 **GetProcAddress**によって使用して、簡単なを使用する同じ名前と、C および C++ ファイルの初期化ルーチンを指定することによって、DLL 内の宣言をエクスポートします。DEF ファイルを自動的に取得する型の初期化ルーチンのパラメーターのチェックします。 サンプル転送プロバイダーのソース コードの例についてを参照してください。 詳細については、[トランスポート プロバイダーのサンプル](transport-provider-sample.md)を参照してください。
  
MAPI がすぐに**サービス プロバイダー オブジェクトのメソッド**を呼び出すし、初期化を呼び出す場合と同様に行われます場合はサービス プロバイダーの初期化の呼び出しが成功すると、MAPI 処理するには小さすぎますサービス プロバイダー インターフェイスのバージョン番号を返しますMAPI_E_VERSION で失敗しました。 こう MAPI、およびサービス プロバイダー、共同で処理可能なサービス プロバイダー インターフェイスのバージョン番号の範囲を定義し、戻り値を MAPI_E_VERSION で失敗する場合は何も一致し、サービス プロバイダーの読み込み中にします。 
  
トランスポート プロバイダーへのログオンには、サービス プロバイダーのリソースへのアクセスを取得中に、MAPI スプーラーの最後のステップです。 MAPI スプーラーは、の[IXPProvider::TransportLogon](ixpprovider-transportlogon.md)メソッドを呼び出して、 [IXPProvider: IUnknown](ixpprovideriunknown.md) **XPProviderInit**から返されたオブジェクト。 これは、場所、資格情報を使用する場合はオンになってと、ダイアログ ボックスを許可することができます。
  
プロセスは、MAPI セッション、トランスポート プロバイダーは、同時に 2 つ目のトランスポート セッションを開き、トランスポート プロバイダーの DLL は、2 番目のプロバイダー オブジェクトを作成しないでください。 2 番目のトランスポート セッションにログオンするには、最初のプロバイダー オブジェクトを使用してください。 トランスポート プロバイダーは、1 つのプロバイダー オブジェクトに複数のトランスポート セッションをサポートするためにプログラムする必要があります。 別の MAPI セッションが同じプロセスで使用されている場合にのみ、2 番目のプロバイダー オブジェクトを作成してください。
  

