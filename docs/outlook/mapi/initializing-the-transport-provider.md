---
title: トランスポート プロバイダーを初期化しています。
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 977c18ce-ece5-4ad1-ac97-5a680846ab83
description: '�ŏI�X�V��: 2011�N7��23��'
ms.openlocfilehash: 423b03d674028a2f81b4c042d6e65e9acfb57274
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 06/11/2018
ms.locfileid: "19801075"
---
# <a name="initializing-the-transport-provider"></a><span data-ttu-id="f5d5c-103">トランスポート プロバイダーを初期化しています。</span><span class="sxs-lookup"><span data-stu-id="f5d5c-103">Initializing the Transport Provider</span></span>

  
  
<span data-ttu-id="f5d5c-104">**適用されます**: Outlook</span><span class="sxs-lookup"><span data-stu-id="f5d5c-104">**Applies to**: Outlook</span></span> 
  
<span data-ttu-id="f5d5c-105">トランスポートがスプーラーのインターフェイスでは、MAPI スプーラーでは、トランスポート プロバイダーへの呼び出しを定義します。</span><span class="sxs-lookup"><span data-stu-id="f5d5c-105">The transport-spooler interface defines calls the MAPI spooler makes to a transport provider.</span></span> <span data-ttu-id="f5d5c-106">トランスポート プロバイダーは、ダイナミック リンク ライブラリ (DLL) で、これらのルーチンを実装します。</span><span class="sxs-lookup"><span data-stu-id="f5d5c-106">Transport providers implement these routines in a dynamic-link library (DLL).</span></span> <span data-ttu-id="f5d5c-107">MAPI スプーラーによって使用される DLL への最初の直接のエントリ ポイントでは、トランスポート プロバイダーの初期化関数[XPProviderInit](xpproviderinit.md)をする必要があります。</span><span class="sxs-lookup"><span data-stu-id="f5d5c-107">The first direct entry point into the DLL used by the MAPI spooler must be the transport provider initialization function [XPProviderInit](xpproviderinit.md).</span></span>
  
<span data-ttu-id="f5d5c-108">MAPI は、 **GetProcAddress**ルーチンを使用して、サービス プロバイダーの初期化ルーチンのアドレスを取得して、そのルーチンを呼び出すと。</span><span class="sxs-lookup"><span data-stu-id="f5d5c-108">MAPI uses the routine **GetProcAddress** to get the address of the service provider's initialization routine and then calls that routine.</span></span> <span data-ttu-id="f5d5c-109">初期化ルーチンの名前は、トランスポート プロバイダーの**XPProviderInit**です。</span><span class="sxs-lookup"><span data-stu-id="f5d5c-109">The name of the initialization routine is **XPProviderInit** for transport providers.</span></span> <span data-ttu-id="f5d5c-110">MAPI サービス プロバイダーの他の種類によって異なりますが 1 つの DLL は、サービス プロバイダーの種類が特定の種類の 1 つのサービス プロバイダーの任意の組み合わせを含めることができますように。</span><span class="sxs-lookup"><span data-stu-id="f5d5c-110">It is different for other types of MAPI service providers so that one DLL can contain any combination of service provider types, but only one service provider of a particular type.</span></span> <span data-ttu-id="f5d5c-111">ただし、特定の種類の 1 つのサービス プロバイダーは、その型の複数のサービスを実装できます。</span><span class="sxs-lookup"><span data-stu-id="f5d5c-111">However, one service provider of a given type can implement multiple services of its type.</span></span> <span data-ttu-id="f5d5c-112">など、1 つのトランスポート プロバイダーは、複数のメッセージ サービスへのメッセージ トランスポート機能を実装できます。</span><span class="sxs-lookup"><span data-stu-id="f5d5c-112">For example, one transport provider can implement message transport functionality to multiple message services.</span></span> 
  
<span data-ttu-id="f5d5c-113">Mapispi.h ヘッダー ファイルには、トランスポート プロバイダーの初期化関数の関数プロトタイプの種類の定義と、定義済みのプロシージャの名前があります。</span><span class="sxs-lookup"><span data-stu-id="f5d5c-113">The mapispi.h header file has a type definition for the function prototype of the transport provider initialization function, and a predefined procedure name for it.</span></span> <span data-ttu-id="f5d5c-114">**GetProcAddress**によって使用して、簡単なを使用する同じ名前と、C および C++ ファイルの初期化ルーチンを指定することによって、DLL 内の宣言をエクスポートします。DEF ファイルを自動的に取得する型の初期化ルーチンのパラメーターのチェックします。</span><span class="sxs-lookup"><span data-stu-id="f5d5c-114">By naming the initialization routines in your C and C++ files with the same names used by **GetProcAddress** and by using a straightforward export declaration in your DLL.DEF file, you automatically get type checking of the parameters on your initialization routine.</span></span> <span data-ttu-id="f5d5c-115">サンプル転送プロバイダーのソース コードの例についてを参照してください。</span><span class="sxs-lookup"><span data-stu-id="f5d5c-115">See the sample transport provider source code for examples.</span></span> <span data-ttu-id="f5d5c-116">詳細については、[トランスポート プロバイダーのサンプル](transport-provider-sample.md)を参照してください。</span><span class="sxs-lookup"><span data-stu-id="f5d5c-116">For more information, see [Transport Provider Sample](transport-provider-sample.md).</span></span>
  
<span data-ttu-id="f5d5c-117">MAPI がすぐに**サービス プロバイダー オブジェクトのメソッド**を呼び出すし、初期化を呼び出す場合と同様に行われます場合はサービス プロバイダーの初期化の呼び出しが成功すると、MAPI 処理するには小さすぎますサービス プロバイダー インターフェイスのバージョン番号を返しますMAPI_E_VERSION で失敗しました。</span><span class="sxs-lookup"><span data-stu-id="f5d5c-117">If a service provider's initialization call succeeds but returns a service provider interface version number too small for MAPI to handle, MAPI immediately calls the **Release** method of the service provider object and proceeds as if the initialization call had failed with MAPI_E_VERSION.</span></span> <span data-ttu-id="f5d5c-118">こう MAPI、およびサービス プロバイダー、共同で処理可能なサービス プロバイダー インターフェイスのバージョン番号の範囲を定義し、戻り値を MAPI_E_VERSION で失敗する場合は何も一致し、サービス プロバイダーの読み込み中にします。</span><span class="sxs-lookup"><span data-stu-id="f5d5c-118">This way MAPI and the service provider jointly define the range of service provider interface version numbers they can handle, and if nothing matches then service provider loading fails with a MAPI_E_VERSION return value.</span></span> 
  
<span data-ttu-id="f5d5c-119">トランスポート プロバイダーへのログオンには、サービス プロバイダーのリソースへのアクセスを取得中に、MAPI スプーラーの最後のステップです。</span><span class="sxs-lookup"><span data-stu-id="f5d5c-119">The last step for the MAPI spooler in getting access to service provider resources is to log on to the transport provider.</span></span> <span data-ttu-id="f5d5c-120">MAPI スプーラーは、の[IXPProvider::TransportLogon](ixpprovider-transportlogon.md)メソッドを呼び出して、 [IXPProvider: IUnknown](ixpprovideriunknown.md) **XPProviderInit**から返されたオブジェクト。</span><span class="sxs-lookup"><span data-stu-id="f5d5c-120">The MAPI spooler calls the [IXPProvider::TransportLogon](ixpprovider-transportlogon.md) method of the [IXPProvider : IUnknown](ixpprovideriunknown.md) object returned from **XPProviderInit**.</span></span> <span data-ttu-id="f5d5c-121">これは、場所、資格情報を使用する場合はオンになってと、ダイアログ ボックスを許可することができます。</span><span class="sxs-lookup"><span data-stu-id="f5d5c-121">This is the call where credentials, if used, are checked and dialog boxes can be allowed.</span></span>
  
<span data-ttu-id="f5d5c-122">プロセスは、MAPI セッション、トランスポート プロバイダーは、同時に 2 つ目のトランスポート セッションを開き、トランスポート プロバイダーの DLL は、2 番目のプロバイダー オブジェクトを作成しないでください。</span><span class="sxs-lookup"><span data-stu-id="f5d5c-122">If a process opens a second transport session on the same transport provider and MAPI session, the transport provider DLL should not create a second provider object.</span></span> <span data-ttu-id="f5d5c-123">2 番目のトランスポート セッションにログオンするには、最初のプロバイダー オブジェクトを使用してください。</span><span class="sxs-lookup"><span data-stu-id="f5d5c-123">The first provider object should be used to log on to the second transport session.</span></span> <span data-ttu-id="f5d5c-124">トランスポート プロバイダーは、1 つのプロバイダー オブジェクトに複数のトランスポート セッションをサポートするためにプログラムする必要があります。</span><span class="sxs-lookup"><span data-stu-id="f5d5c-124">A transport provider should be programmed to support multiple transport sessions in a single provider object.</span></span> <span data-ttu-id="f5d5c-125">別の MAPI セッションが同じプロセスで使用されている場合にのみ、2 番目のプロバイダー オブジェクトを作成してください。</span><span class="sxs-lookup"><span data-stu-id="f5d5c-125">A second provider object should only be created if different MAPI sessions are used in the same process.</span></span>
  

