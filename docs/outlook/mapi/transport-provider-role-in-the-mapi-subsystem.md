---
title: MAPI サブシステムでのトランスポート プロバイダーの役割
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 7659369a-0952-4f5a-a86b-91958c4c1a3f
description: '最終更新日: 2011 年 7 月 23 日'
ms.openlocfilehash: 7cadb57706e3feec7ed98dd5e4e8d75967036fef
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/23/2019
ms.locfileid: "32356622"
---
# <a name="transport-provider-role-in-the-mapi-subsystem"></a>MAPI サブシステムでのトランスポート プロバイダーの役割
  
**適用対象**: Outlook 2013 | Outlook 2016 
  
トランスポートプロバイダーのダイナミックリンクライブラリ (dll) は、MAPI スプーラーと、メッセージの送受信を行うメッセージングシステムの一部との間のインターフェイスを提供します。 MAPI スプーラーとトランスポートプロバイダーが連携して、メッセージの送信またはメッセージの受信の責任を担います。 MAPI スプーラーは、トランスポートプロバイダー DLL が最初に使用されたときに読み込まれ、不要になった時点で解放されます。 複数のトランスポートプロバイダーを同じシステムにインストールすることはできますが、MAPI は必要な1つのスプーラーを提供します。
  
クライアントアプリケーションは、通常、トランスポートプロバイダーと直接通信しません。 代わりに、クライアントはストアプロバイダーを経由してメッセージを送信し、MAPI スプーラーは適切なトランスポートプロバイダーに送信メッセージを送信し、受信メッセージを適切なメッセージストアに配信します。 フォアグラウンドアプリケーションがアイドル状態のときに MAPI スプーラーは動作を行い、トランスポートプロバイダーに呼び出しを行います。 トランスポートプロバイダーが最初にログオンしたときに、必要に応じてダイアログボックスを表示すると、トランスポートプロバイダーは、送信キューと受信キューをフラッシュするためにクライアントによって呼び出されない限り、バックグラウンドで動作します。 
  
トランスポートプロバイダーには、MAPI メッセージングシステムで次のような責任があります。
  
- mapi スプーラーで受け入れることができるアドレスの種類を登録します。これにより、mapi スプーラーは、メッセージの宛先アドレスに応じて、適切なトランスポートプロバイダーにメッセージを送信できます。 1つのトランスポートプロバイダーは複数のアドレスの種類を登録できます。 また、トランスポートプロバイダーは、MAPI スプーラーで特定の受信者のアドレスを登録することもできます。 これらのアドレスのいずれかに宛てたメッセージは、MAPI スプーラーにアドレスを登録したトランスポートプロバイダーに送信されます。 詳細については、「 [Transport Provider and MAPI Spooler 操作モデル](transport-provider-and-mapi-spooler-operational-model.md)」を参照してください。
    
- 受信メッセージを MAPI スプーラーに配信します。 メッセージングシステムの性質に応じて、トランスポートプロバイダーは新しいメッセージが到着したときに mapi スプーラーに直接通知するか、または mapi スプーラーがトランスポートプロバイダーを定期的にポーリングして新しいメッセージをチェックするように要求することができます。
    
- MAPI メッセージのプロパティを、メッセージングシステムにネイティブなメッセージプロパティとの間で変換します。 たとえば、トランスポートプロバイダーは、送信メッセージの送信者と受信者のアドレスを、メッセージングシステムで使用可能なフォームに変換する必要がある場合があります。 一部のメッセージングシステムでは、すべての MAPI メッセージプロパティをサポートしていません。 メッセージングシステムにメッセージを配信するときの MAPI メッセージプロパティの保持の詳細については、「 [TNEF 対応のトランスポートプロバイダーを開発](developing-a-tnef-enabled-transport-provider.md)する」を参照してください。
    
- トランスポートプロバイダーに固有のメッセージおよび受信者オプションを登録します。
    
- メッセージングシステムに必要な資格情報の確認を行います。
    
- MAPI スプーラーによって渡された message オブジェクトを使用して、送信メッセージにアクセスします。
    
- 基になるメッセージングシステムの必要に応じて、メッセージ形式を変換します。
    
- [MAPI スプーラーに通知する] トランスポートプロバイダーが、その受信者の**PR_RESPONSIBILITY** ([PidTagResponsibility](pidtagresponsibility-canonical-property.md)) プロパティを設定することにより、処理の責務を負っている送信メッセージの受信者を通知します。
    
- 受信メッセージを処理する必要がある場合は、MAPI スプーラーに通知します。
    
- メッセージオブジェクトを使用して、受信メッセージデータを MAPI スプーラーに渡します。
    
- 受信メッセージのすべての必要な MAPI メッセージプロパティに値を割り当てます。
    
- 必要に応じて、配信後に基になるメッセージングシステムからメッセージを削除します。
    
- MAPI スプーラーおよびクライアントアプリケーションの状態情報を提供します。
    
次の図は、MAPI アーキテクチャの他のコンポーネントに対するトランスポートプロバイダーの役割を示しています。
  
**メッセージング システムのトランスポート プロバイダー ロール**
  
![メッセージングシステムでのトランスポートプロバイダーの役割](media/xp01.gif "メッセージングシステムでのトランスポートプロバイダーの役割")
  

