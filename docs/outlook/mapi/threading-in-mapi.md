---
title: MAPI のスレッド処理
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 259297d2-acd7-4bc5-9a77-0df92cbfa33e
description: '最終更新日時: 2015 年 3 月 9 日'
ms.openlocfilehash: d9ee45ea7a3592a2b0fc0675bbdb6e640f9bd046
ms.sourcegitcommit: 0cf39e5382b8c6f236c8a63c6036849ed3527ded
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/23/2018
ms.locfileid: "22580391"
---
# <a name="threading-in-mapi"></a>MAPI のスレッド処理

  
  
**適用されます**: Outlook 2013 |Outlook 2016 
  
スレッドは、オペレーティング システムが CPU 時間を割り当てる基本的なエンティティです。 スレッド独自のレジスタ、スタック、優先順位、およびストレージがアクセス トークンなどのアドレス領域と処理リソースを共有します。 スレッドは、別のスレッドが書き込まれた内容を読み取り、1 つのスレッドでも、メモリを共有します。
  
MAPI クライアントでは、次の一般的なスレッド モデルを使用します。
  
|**スレッド モデル**|**説明**|
|:-----|:-----|
|シングル スレッド モデル  <br/> |すべてのオブジェクトは、単一のスレッドで使用されます。  <br/> |
|アパートメント スレッド モデル  <br/> |オブジェクトは、作成されたスレッド上でのみ使用できます。  <br/> |
|フリー スレッドまたはスレッドの関係者、モデル  <br/> |オブジェクトは、任意のスレッドで使用できます。  <br/> |
   
MAPI では、いつでも任意のスレッドで使用できるスレッド セーフなオブジェクトをサポートするフリー スレッド モデルを使用します。 OLE では、アパートメント スレッド モデルを使用します。 アパートメント スレッド モデルには、オブジェクト以外のオブジェクトを作成したスレッドがそのオブジェクトを使用する必要がある場合に明示的に転送する必要がありますがサポートされています。
  
OLE を使用してオブジェクトを別の 1 つのスレッドに転送する機構は、マーシャ リングと呼ばれます。 マーシャ リングには、スタブ オブジェクトとプロキシ オブジェクトが含まれます。 これらの特別なオブジェクトは、マーシャ リングする、これらのパラメーターを他のスレッドに転送および到着時にそれらのパッケージを展開するオブジェクトのインターフェイスのパラメーターをパッケージ化します。 2 つのマルチ スレッド モデル間の衝突は、フリー スレッドの MAPI オブジェクトが OLE「軽量な」リモート プロシージャ コール、または LRPC を使用して別のプロセスに送信されるときに発生します。 LRPC は、アパートメントのスレッド アパートメント スレッド、呼び出し元のオブジェクトとの間での動作を持つスタブとプロキシのインターフェイスを置くことによってするフリー スレッドのオブジェクトのセマンティクスを変更します。 MAPI でのこのような競合の原因となる状況の認識を支援し、サービス ・ プロバイダーの問題の発生を防ぐ。
  
MAPI オブジェクトにアクセスできます。
  
- インタ フェースを使用してそのメソッドへの直接呼び出しをサービス プロバイダーまたは MAPI によって返されたポインターにリンクされているクライアントのプロセスでは、 [MAPILogonEx](mapilogonex.md)からセッション オブジェクトが返されるようです。
    
- 間接的なメソッドをコール、フォルダー オブジェクトなど、任意のサービス プロバイダーによって返されるインターフェイス ポインターを使用して、 [IMAPIFolder::CopyFolder](imapifolder-copyfolder.md)の別のフォルダーからコピーされます。
    
- 渡されたまたは MAPI サービス プロバイダーに、**アドバイス**の呼び出し、または時間のかかる操作の進行状況を表示することができるメソッド、 [IMAPIAdviseSink::OnNotify](imapiadvisesink-onnotify.md)メソッドなどのコールバック関数です。 
    

