---
title: 'title: "�Y�t�t�@�C����\������e�L�X�g������ݒ��T�|�[�g���܂��B" ms.author: v-tirob author: v-tirob manager: soliver ms.date: 11/16/2014 ms.audience: Developer ms.topic: overview ms.prod: office-online-server localization_priority: Normal api_type:'
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 68abe85b-5dc0-40d0-8917-30ea002aa816
description: 'COM ms.assetid: 68abe85b-5dc0-40d0-8917-30ea002aa816 description: "�ŏI�X�V��: 2011�N7��23��"'
ms.openlocfilehash: 14c1162bd4e225fd3ab2ea5ab11536b3bdf08edd
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 06/11/2018
ms.locfileid: "19804032"
---
# <a name="supporting-formatted-text-rendering-attachments"></a><span data-ttu-id="aabf6-103">�Y�t�t�@�C����\������e�L�X�g������ݒ��T�|�[�g���܂��B</span><span class="sxs-lookup"><span data-stu-id="aabf6-103">Supporting Formatted Text: Rendering Attachments</span></span>

  
  
<span data-ttu-id="aabf6-104">**適用されます**: Outlook</span><span class="sxs-lookup"><span data-stu-id="aabf6-104">**Applies to**: Outlook</span></span> 
  
<span data-ttu-id="aabf6-105">場所でメッセージの添付ファイルはレンダリングを考慮するクライアント アプリケーションは、メッセージの形式の中にこれらの添付ファイルの**PR_RENDERING_POSITION** ([PidTagRenderingPosition](pidtagrenderingposition-canonical-property.md)) のプロパティを設定します。</span><span class="sxs-lookup"><span data-stu-id="aabf6-105">A client application that cares about where in a message its attachments are rendered sets the **PR_RENDERING_POSITION** ([PidTagRenderingPosition](pidtagrenderingposition-canonical-property.md)) property for these attachments during message composition.</span></span> <span data-ttu-id="aabf6-106">レンダリング配置しないクライアントは、設定を解除このプロパティを残します。</span><span class="sxs-lookup"><span data-stu-id="aabf6-106">A client that does not care about rendering placement leaves this property unset.</span></span>
  
<span data-ttu-id="aabf6-p102">�N���C�A���g�ł́A�Y�t�t�@�C���̂��郁�b�Z�[�W���J���A�Y�t�t�@�C������b�Z�[�W�̃e�L�X�g�̏ꏊ�ɕ\�����邩����肷��Y�t�t�@�C���� **PR_RENDERING_POSITION**�v���p�e�B��擾���悤�Ƃ��܂��B�N���C�A���g�́A���̂����ꂩ��g�p���� **PR_RENDERING_POSITION**��擾�ł��܂��B</span><span class="sxs-lookup"><span data-stu-id="aabf6-p102">When a client opens a message with attachments, it attempts to retrieve each attachment's **PR_RENDERING_POSITION** property to determine where in the message text the attachment should be rendered. A client can use one of the following methods to retrieve **PR_RENDERING_POSITION**:</span></span>
  
- <span data-ttu-id="aabf6-109">[PR_RENDERING_POSITION](imapiprop-getprops.md)�v���p�e�B��擾����Y�t�t�@�C����J�� [ **IMAPIProp::GetProps**�ɂ��܂��B</span><span class="sxs-lookup"><span data-stu-id="aabf6-109">[IMAPIProp::GetProps](imapiprop-getprops.md) on the open attachment to retrieve the **PR_RENDERING_POSITION** property.</span></span> 
    
- <span data-ttu-id="aabf6-p103">[IMessage::GetAttachmentTable](imessage-getattachmenttable.md)�̂ɁA�J���Ă��郁�b�Z�[�W�̓Y�t�t�@�C���̃e�[�u����擾���܂��B **PR_RENDERING_POSITION**�́A�Y�t�t�@�C���̂��ׂẴe�[�u���ŕK�v�ȗ�ł��B����́A�p�t�H�[�}���X����コ���邽�߂ɐ����������@�ł��B</span><span class="sxs-lookup"><span data-stu-id="aabf6-p103">[IMessage::GetAttachmentTable](imessage-getattachmenttable.md) on the open message to retrieve its attachment table. **PR_RENDERING_POSITION** is a required column in all attachment tables. This is the preferred method because it results in better performance.</span></span> 
    
<span data-ttu-id="aabf6-113">RTF に対応してメッセージ ・ ストアには、 **PR_RENDERING_POSITION**の正確、またはおおよその値を返すかどうかを選択できます。</span><span class="sxs-lookup"><span data-stu-id="aabf6-113">RTF-aware message stores can choose whether to return an accurate or approximate value for **PR_RENDERING_POSITION**.</span></span> <span data-ttu-id="aabf6-114">メッセージ ・ ストアは、メッセージの**PR_BODY**プロパティのメッセージが表示されたら、添付ファイルの**PR_RENDERING_POSITION**値を再計算ため、RTF に対応していないメッセージがいくつか格納だけが保証のレンダリング位置の正確性をクライアントが最初に要求すると**PR_BODY**。</span><span class="sxs-lookup"><span data-stu-id="aabf6-114">Because message stores recalculate an attachment's **PR_RENDERING_POSITION** value when asked for the message's **PR_BODY** property, some RTF-aware message stores only guarantee the accuracy of rendering positions when a client asks first for **PR_BODY**.</span></span> <span data-ttu-id="aabf6-115">RTF に対応してメッセージ ・ ストアは、パフォーマンスを強化するためにおおよその表示位置の値をクライアントに提供できるのです。</span><span class="sxs-lookup"><span data-stu-id="aabf6-115">RTF-aware message stores are allowed to provide clients with approximate rendering position values to enhance performance.</span></span> <span data-ttu-id="aabf6-116">レンダリングの正確な位置ではなく、概算値を提供する時間を節約し、ほとんどの場合だけで十分です。</span><span class="sxs-lookup"><span data-stu-id="aabf6-116">Providing an approximate rather than an accurate rendering position saves time and is sufficient for most situations.</span></span> 
  
<span data-ttu-id="aabf6-p105">�N���C�A���g�̃��[�U�[�̐ӔC�ɂ����āA�Y�t�t�@�C���̍쐬���w�肵���l����̋ߎ��l���K�v������́ARTF �Ή����b�Z�[�W�i�[���܂��B���ׂẴN���C�A���g�� **PR_RENDERING_POSITION**��ݒ肷��K�v������܂����A���b�Z�[�W �X�g�A �v���o�C�_�[�́A�x�ɂ̉\����������鏀���ɂȂ�܂��B�N���C�A���g�� **PR_RENDERING_POSITION**���ݒ肳��Ă��Ȃ��Ƃ��Ƀ��b�Z�[�W �X�g�A�悤�ݒ�ł��܂��\`��ʒu�����b�Z�[�W�̃e�L�X�g��łȂ����Ƃ����-1 �ɂ��܂��B�N���C�A���g�ɂ���āA���b�Z�[�W��̔C�ӂ̏ꏊ�ɂ���-1 �̕\���ʒu�̓Y�t�t�@�C����\���ł��܂��B�����̃N���C�A���g�ł́A���̃��b�Z�[�W�̏㕔�ɂ���Y�t�t�@�C���̎�ނ�z�u���܂��B</span><span class="sxs-lookup"><span data-stu-id="aabf6-p105">RTF-aware message stores should base their approximation on the value specified by the client responsible for creating the attachment. Although all clients should set **PR_RENDERING_POSITION**, message store providers should be prepared to deal with the possibility of its absence. When the client does not set **PR_RENDERING_POSITION**, a message store can set it to -1 to indicate that the rendering position is not within the message text. Attachments with a rendering position of -1 can be displayed at any place within the message depending on the client. Many clients position these types of attachments at the top of the message.</span></span>
  
<span data-ttu-id="aabf6-122">**PR_RENDERING_POSITION**プロパティの正確さの度合いは、メッセージ ストアがメッセージの**PR_BODY** ([PidTagBody](pidtagbody-canonical-property.md)) と ([PidTagRtfCompressed](pidtagrtfcompressed-canonical-property.md)) である**PR_RTF_COMPRESSED**プロパティの両方を保存するかどうかによって異なりますかのみ**PR_RTF_COMPRESSED**。</span><span class="sxs-lookup"><span data-stu-id="aabf6-122">The degree of accuracy for a **PR_RENDERING_POSITION** property depends on whether or not a message store saves both a message's **PR_BODY** ([PidTagBody](pidtagbody-canonical-property.md)) and **PR_RTF_COMPRESSED** ([PidTagRtfCompressed](pidtagrtfcompressed-canonical-property.md)) properties or only **PR_RTF_COMPRESSED**.</span></span> <span data-ttu-id="aabf6-123">**PR_BODY**を生成するクライアントと、メッセージ ・ ストアは、書式設定されたテキストと共に保存、正確な表示位置になります。</span><span class="sxs-lookup"><span data-stu-id="aabf6-123">If the client generates **PR_BODY** and the message store saves it along with the formatted text, the rendering positions will be accurate.</span></span> <span data-ttu-id="aabf6-124">ただし、 **PR_RTF_COMPRESSED**のみを保存するため、メッセージ ・ ストアは**PR_BODY**の独自のバージョンを生成する必要がある場合、レンダリング位置しないことをある程度正確なことができます。</span><span class="sxs-lookup"><span data-stu-id="aabf6-124">However, if the message store must generate its own version of **PR_BODY** because it only saves **PR_RTF_COMPRESSED**, it is probable that the rendering positions will be somewhat inaccurate.</span></span> <span data-ttu-id="aabf6-125">これは、クライアントとメッセージ ストア プロバイダーが**PR_BODY**プロパティを生成する方法が異なるのためです。</span><span class="sxs-lookup"><span data-stu-id="aabf6-125">This is because of the differences in the way that clients and message store providers generate the **PR_BODY** property.</span></span> 
  
<span data-ttu-id="aabf6-p107">���m�� **PR_RENDERING_POSITION**�l��v�Z����� RTF �Ή��X�g�A�́A�����ݒ肳�ꂽ�e�L�X�g�ɖ��ߍ��܂�Ă���^�O��g�p���܂��B���[�e�B���e�B�֐� **RTFSync**�́A���̌v�Z����s���āA�Y�t�t�@�C���̕\���ʒu��X�V����ƌĂ΂�邱�Ƃ��ł��܂��B���p�\�ȏ�Ԃ̏��̗ʂɂ���ă��b�Z�[�W �X�g�A�� RTF_SYNC_BODY_CHANGED�ARTF_SYNC_RTF_CHANGED�A�܂��͗����̒l�̂����ꂩ��[��](rtfsync.md)�ɓn�����Ƃ��ł��܂��B</span><span class="sxs-lookup"><span data-stu-id="aabf6-p107">To calculate an accurate **PR_RENDERING_POSITION** value, an RTF-aware store uses a tag embedded in the formatted text. The utility function **RTFSync** can be called to perform this calculation and update an attachment's rendering position. Depending on the amount of state information available, the message store can pass either RTF_SYNC_BODY_CHANGED, RTF_SYNC_RTF_CHANGED, or both values to [RTFSync](rtfsync.md).</span></span>
  

