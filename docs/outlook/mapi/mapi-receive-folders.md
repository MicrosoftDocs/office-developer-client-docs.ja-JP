---
title: 'title: "MAPI �t�H���_�[���\������܂��B" ms.author: v-tirob author: v-tirob manager: soliver ms.date: 3/9/2015 ms.audience: Developer ms.topic: overview ms.prod: office-online-server localization_priority: Normal api_type:'
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 2e1287a3-0f15-4d9a-b7ee-738fce9cd51f
description: 'COM ms.assetid: 2e1287a3-0f15-4d9a-b7ee-738fce9cd51f description: "�ŏI�X�V��: 2015�N3��9��"'
ms.openlocfilehash: 619bd2d5e3b40e49da835d774035ba237af06699
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 06/11/2018
ms.locfileid: "19801424"
---
# <a name="mapi-receive-folders"></a><span data-ttu-id="1107c-103">MAPI �t�H���_�[���\������܂��B</span><span class="sxs-lookup"><span data-stu-id="1107c-103">MAPI Receive Folders</span></span>

  
  
<span data-ttu-id="1107c-104">**適用対象**: Outlook</span><span class="sxs-lookup"><span data-stu-id="1107c-104">**Applies to**: Outlook</span></span> 
  
<span data-ttu-id="1107c-105">受信フォルダーは、特定のメッセージ クラスの受信メッセージを保持します。</span><span class="sxs-lookup"><span data-stu-id="1107c-105">A receive folder holds inbound messages of a particular message class.</span></span> <span data-ttu-id="1107c-106">クライアントによって、メッセージ ストア プロバイダー、または MAPI の関連付けを確立することができますフォルダーが表示されます。</span><span class="sxs-lookup"><span data-stu-id="1107c-106">Receive folder associations can be established by clients, by the message store provider, or by MAPI.</span></span> <span data-ttu-id="1107c-107">MAPI には、2 つの既定のフォルダーが表示されます: メッセージ ・ ストアのルート フォルダーと、個人間メッセージ (IPM) サブツリーの [受信トレイ] フォルダー。</span><span class="sxs-lookup"><span data-stu-id="1107c-107">MAPI has two default receive folders: the root folder of the message store, and the Inbox folder of the interpersonal message (IPM) subtree.</span></span> <span data-ttu-id="1107c-108">メッセージ ・ ストアのルート フォルダーは、既定のフォルダーのすべてのプロセス間通信 (IPC) メッセージを受信します。</span><span class="sxs-lookup"><span data-stu-id="1107c-108">The root folder of the message store is the default receive folder for all interprocess communication (IPC) messages.</span></span>
  
 <span data-ttu-id="1107c-109">MAPI によってすべての新しいメッセージ ストアの受信トレイ フォルダーが作成され、次のメッセージ クラスのフォルダーが表示される既定値としての役割を果たします。</span><span class="sxs-lookup"><span data-stu-id="1107c-109">The Inbox folder is created by MAPI for every new message store and acts as the default receive folder for the following message classes:</span></span> 
  
- <span data-ttu-id="1107c-110">IPM ���b�Z�[�W �N���X�ł��B</span><span class="sxs-lookup"><span data-stu-id="1107c-110">The IPM message class.</span></span>
    
- <span data-ttu-id="1107c-111">���|�[�g�̃��b�Z�[�W �N���X�ł��B</span><span class="sxs-lookup"><span data-stu-id="1107c-111">The report message class.</span></span>
    
- <span data-ttu-id="1107c-112">��̏ꍇ�A�܂��͕s�����Ă���A�N���X�łł��B</span><span class="sxs-lookup"><span data-stu-id="1107c-112">An empty, or missing, class.</span></span>
    
<span data-ttu-id="1107c-113">IPC メッセージに対する応答として送信されたものであっても、すべてのレポート メッセージは、受信トレイ フォルダーに配置されます。</span><span class="sxs-lookup"><span data-stu-id="1107c-113">All report messages, even those sent in response to an IPC message, are placed in the Inbox folder.</span></span> <span data-ttu-id="1107c-114">独自のレポートを処理する IPC クライアント アプリケーションでは、レポートの特定のクラスの受信フォルダーを明示的に追加する必要があります。</span><span class="sxs-lookup"><span data-stu-id="1107c-114">IPC client applications that process their own reports must explicitly add a receive folder for the particular class of report.</span></span> <span data-ttu-id="1107c-115">IPC クラスにメッセージを受信するクライアントが要求している場合などです。Paper.Order、その Report.IPC.Paper.Order のクラスを使ったレポートの受信フォルダーを確立するために[IMsgStore::SetReceiveFolder](imsgstore-setreceivefolder.md)メソッドを呼び出す必要があります。</span><span class="sxs-lookup"><span data-stu-id="1107c-115">For example, if a client expects to receive messages with the class IPC.Paper.Order, it should call the [IMsgStore::SetReceiveFolder](imsgstore-setreceivefolder.md) method to establish a receive folder for reports with the class Report.IPC.Paper.Order.</span></span> 
  
<span data-ttu-id="1107c-116">メッセージ クラスの階層構造に基づく関連のフォルダーが表示されます。</span><span class="sxs-lookup"><span data-stu-id="1107c-116">Receive folder associations are based on the hierarchical organization of message classes.</span></span> <span data-ttu-id="1107c-117">クライアントは、明示的に受信フォルダーとメッセージ クラス間の関連付けを確立または MAPI の既定の受信フォルダーを使用できます。</span><span class="sxs-lookup"><span data-stu-id="1107c-117">Clients can explicitly establish an association between a receive folder and a message class or use the MAPI default receive folders.</span></span> <span data-ttu-id="1107c-118">通常、クライアントは、基本クラスのメッセージを受信する 1 つのフォルダーとそのすべてのサブクラスを指定します。</span><span class="sxs-lookup"><span data-stu-id="1107c-118">Typically, clients designate one folder to receive messages for a base class and all of its subclasses.</span></span> <span data-ttu-id="1107c-119">などの標準的なクライアントは、 **MyClass**クラスにメッセージをアソシエーションを確立すると。</span><span class="sxs-lookup"><span data-stu-id="1107c-119">For example, a typical client would establish an association for messages with the class **MyClass**.</span></span> <span data-ttu-id="1107c-120">クライアントは、 **MyClass.Home**または**MyClass.Home.Kitchen.Computer**のクラスでメッセージを受信する場合これらのメッセージは、基本クラス**MyClass**の受信フォルダーに移動します。</span><span class="sxs-lookup"><span data-stu-id="1107c-120">Then if the client received messages with classes **MyClass.Home** or **MyClass.Home.Kitchen.Computer**, these messages would go to the receive folder for the base class, **MyClass**.</span></span>
  
<span data-ttu-id="1107c-121">�X�g�A�g�p���@��N���C�A���g�𑀍삷��ɂ́A�t�H���_�[���\������鎟�� 3 �̃��b�Z�[�W������܂��B</span><span class="sxs-lookup"><span data-stu-id="1107c-121">There are three message store methods that clients use to work with receive folders:</span></span>
  
- [<span data-ttu-id="1107c-122">IMsgStore::GetReceiveFolderTable</span><span class="sxs-lookup"><span data-stu-id="1107c-122">IMsgStore::GetReceiveFolderTable</span></span>](imsgstore-getreceivefoldertable.md)
    
- [<span data-ttu-id="1107c-123">IMsgStore::GetReceiveFolder</span><span class="sxs-lookup"><span data-stu-id="1107c-123">IMsgStore::GetReceiveFolder</span></span>](imsgstore-getreceivefolder.md)
    
- [<span data-ttu-id="1107c-124">IMsgStore::SetReceiveFolder</span><span class="sxs-lookup"><span data-stu-id="1107c-124">IMsgStore::SetReceiveFolder</span></span>](imsgstore-setreceivefolder.md)
    
<span data-ttu-id="1107c-125">受信フォルダーのテーブルは、すべてのメッセージ ・ ストアに対して設定されている受信フォルダーに関する情報の一覧です。</span><span class="sxs-lookup"><span data-stu-id="1107c-125">The receive folder table is a listing of information about all of the receive folders established for a message store.</span></span> <span data-ttu-id="1107c-126">必要な列のセットには、メッセージ クラス、レコード、およびエントリの識別子が含まれています。</span><span class="sxs-lookup"><span data-stu-id="1107c-126">Its required column set includes the message class, record key, and entry identifier.</span></span>
  
<span data-ttu-id="1107c-127">受信フォルダーを特定のメッセージ クラスを取得するためには、クライアントは、メッセージ クラスの文字列を[IMsgStore::GetReceiveFolder](imsgstore-getreceivefolder.md)メソッドに渡します。</span><span class="sxs-lookup"><span data-stu-id="1107c-127">To retrieve a receive folder for a particular message class, clients pass the message class string to the [IMsgStore::GetReceiveFolder](imsgstore-getreceivefolder.md) method.</span></span> <span data-ttu-id="1107c-128">メッセージは、プロバイダーを返します。 対応するフォルダーのエントリ id を格納します。</span><span class="sxs-lookup"><span data-stu-id="1107c-128">The message store provider returns an entry identifier for the corresponding folder.</span></span> <span data-ttu-id="1107c-129">**GetReceiveFolder**を実装するには、メッセージ ストア プロバイダーは、関連付けられているメッセージ クラスが指定したメッセージ クラスの可能な最長のプレフィックスに一致するフォルダーを選択するアルゴリズムを使用してください。</span><span class="sxs-lookup"><span data-stu-id="1107c-129">To implement **GetReceiveFolder**, a message store provider should use an algorithm that selects the folder whose associated message class matches the longest possible prefix of the specified message class.</span></span> <span data-ttu-id="1107c-130">たとえば、メッセージ ・ ストアには、次の関連付けの間でフォルダーが表示され、メッセージ内のクラスのフォルダーのテーブルが表示されます。</span><span class="sxs-lookup"><span data-stu-id="1107c-130">For example, assume the message store has the following associations between receive folders and message classes in its receive folder table:</span></span>
  
- <span data-ttu-id="1107c-131">**IPM**���b�Z�[�W�́A��M�g���C] �t�H���_�[�Ɋi�[����܂��B</span><span class="sxs-lookup"><span data-stu-id="1107c-131">**IPM** messages are placed in the Inbox folder.</span></span> 
    
- <span data-ttu-id="1107c-132">**IPM.Note.Sample**���b�Z�[�W�́A[�T���v��] �t�H���_�[�Ɋi�[����܂��B</span><span class="sxs-lookup"><span data-stu-id="1107c-132">**IPM.Note.Sample** messages are placed in the Samples folder.</span></span> 
    
<span data-ttu-id="1107c-133">�K�؂Ȃ��܂��܂ȃN���X�Ń��b�Z�[�W��ǂ̂悤�Ƀ��[�e�B���O����A���̕\�ł́A�t�H���_�[���\������܂��B</span><span class="sxs-lookup"><span data-stu-id="1107c-133">The following table shows how messages with various classes would be routed to the appropriate receive folder.</span></span>
  
|<span data-ttu-id="1107c-134">**�N���X�̃��b�Z�[�W���M���܂��B**</span><span class="sxs-lookup"><span data-stu-id="1107c-134">**Inbound message class**</span></span>|<span data-ttu-id="1107c-135">**�t�H���_�[���\������܂��B**</span><span class="sxs-lookup"><span data-stu-id="1107c-135">**Receive folder**</span></span>|
|:-----|:-----|
|<span data-ttu-id="1107c-136">**IPM.Note.Sample.Simple**</span><span class="sxs-lookup"><span data-stu-id="1107c-136">**IPM.Note.Sample.Simple**</span></span> <br/> |<span data-ttu-id="1107c-137">�T���v���̃t�H���_�[</span><span class="sxs-lookup"><span data-stu-id="1107c-137">Samples folder</span></span>  <br/> |
|<span data-ttu-id="1107c-138">**IPM.Note**</span><span class="sxs-lookup"><span data-stu-id="1107c-138">**IPM.Note**</span></span> <br/> |<span data-ttu-id="1107c-139">��M�g���C] �t�H���_�[</span><span class="sxs-lookup"><span data-stu-id="1107c-139">Inbox folder</span></span>  <br/> |
|<span data-ttu-id="1107c-140">**IPM.タイムカード**</span><span class="sxs-lookup"><span data-stu-id="1107c-140">**IPM.Timecard**</span></span> <br/> |<span data-ttu-id="1107c-141">��M�g���C] �t�H���_�[</span><span class="sxs-lookup"><span data-stu-id="1107c-141">Inbox folder</span></span>  <br/> |
|<span data-ttu-id="1107c-142">**IPM.Note.Sample.Simple.Totally**</span><span class="sxs-lookup"><span data-stu-id="1107c-142">**IPM.Note.Sample.Simple.Totally**</span></span> <br/> |<span data-ttu-id="1107c-143">�T���v���̃t�H���_�[</span><span class="sxs-lookup"><span data-stu-id="1107c-143">Samples folder</span></span>  <br/> |
   
<span data-ttu-id="1107c-144">クライアントは、特定のメッセージ クラスとの間の明示的な関連付けを作成し、フォルダーを表示する**SetReceiveFolder**メソッドを呼び出します。</span><span class="sxs-lookup"><span data-stu-id="1107c-144">Clients call the **SetReceiveFolder** method to make an explicit association between a particular message class and receive folder.</span></span> <span data-ttu-id="1107c-145">空のメッセージ クラスにメッセージを配信すると、MAPI は、空のクラスのプレフィックスで定義されている受信フォルダーにメッセージを配置します。</span><span class="sxs-lookup"><span data-stu-id="1107c-145">When a message is delivered to an empty message class, MAPI places the message in the receive folder that is defined for a prefix of the empty class.</span></span> <span data-ttu-id="1107c-146">など、クライアントがメッセージに設定されている受信フォルダーを持っている場合クラス**IPM**とメッセージ クラス IPM を**とします。Note.Test**が配信される場合、このメッセージは、 **IPM**メッセージ クラスの受信フォルダーにします。</span><span class="sxs-lookup"><span data-stu-id="1107c-146">For example, if your client has a receive folder established for messages with class **IPM** and a message with class **IPM.Note.Test** is delivered, this message will be placed in the receive folder for the **IPM** message class.</span></span> 
  
<span data-ttu-id="1107c-p107">**SetReceiveFolder**��Ăяo���ł́A�N���C�A���g���ʏ�̓��b�Z�[�W�̃N���X�̕������n�����A�V�����G���g�����ʎq���t�H���_�[���M���܂��B�������A�N���C�A���g�́A�����̃p�����[�^�[�̈���܂��͗����� NULL �œn�����Ƃ��ł��܂��B���̕\�ł́A���b�Z�[�W�̃N���X�ƃG���g�����ʎq�p�����[�^�[�� NULL ��w�肷�邱�Ƃ��猋�ʂ̓���ɂ��Đ�����܂��B</span><span class="sxs-lookup"><span data-stu-id="1107c-p107">In calling **SetReceiveFolder**, clients typically pass a message class string and the entry identifier of the new receive folder. However, clients can pass in NULL for one or both of these parameters. The following table describes the behavior that results from specifying NULL for the message class and entry identifier parameters.</span></span> 
  
|<span data-ttu-id="1107c-150">**_SetReceiveFolder_�p�����[�^�[**</span><span class="sxs-lookup"><span data-stu-id="1107c-150">**_SetReceiveFolder_ parameter**</span></span>|<span data-ttu-id="1107c-151">**���ʂ̓���**</span><span class="sxs-lookup"><span data-stu-id="1107c-151">**Resulting behavior**</span></span>|
|:-----|:-----|
|<span data-ttu-id="1107c-152">�G���g���̎��ʎq�� NULL �ɐݒ肵�܂��B</span><span class="sxs-lookup"><span data-stu-id="1107c-152">Entry identifier set to NULL</span></span>  <br/> |<span data-ttu-id="1107c-153">メッセージ ・ ストアの指定の間の関連付けを削除するメッセージのクラスと、既存のフォルダーが表示されます。</span><span class="sxs-lookup"><span data-stu-id="1107c-153">The message store deletes the association between the specified message class and its existing receive folder.</span></span> <span data-ttu-id="1107c-154">新しい受信フォルダーが確立されていません。</span><span class="sxs-lookup"><span data-stu-id="1107c-154">A new receive folder is not established.</span></span>  <br/> <span data-ttu-id="1107c-155">���̃��b�Z�[�W �N���X **GetReceiveFolder**�ȍ~�ł́A���b�Z�[�W �N���X�̃v���t�B�b�N�X�̎�M] �t�H���_�[��Ԃ��܂��V�������b�Z�[�W�̕ۑ��A **GetReceiveFolder**�� IPM ��A��M�g���C��Ԃ��܂��B</span><span class="sxs-lookup"><span data-stu-id="1107c-155">Subsequent calls to **GetReceiveFolder** with this message class will return the receive folder for a prefix of the message class; for new message stores, **GetReceiveFolder** will return the Inbox in the IPM subtree.</span></span>  <br/> |
|<span data-ttu-id="1107c-156">���b�Z�[�W�̃N���X�� NULL �ɐݒ肵�܂��B</span><span class="sxs-lookup"><span data-stu-id="1107c-156">Message class set to NULL</span></span>  <br/> |<span data-ttu-id="1107c-157">メッセージ ・ ストアでは、指定されたフォルダーに空のメッセージ クラスとの関連付けを変更します。</span><span class="sxs-lookup"><span data-stu-id="1107c-157">The message store changes the association for the empty message class to the indicated folder.</span></span> <span data-ttu-id="1107c-158">クラスが認識されていませんそれ以外の場合、受信メッセージは、このフォルダーに送られます。</span><span class="sxs-lookup"><span data-stu-id="1107c-158">Incoming messages whose class is otherwise unrecognized will go to this folder.</span></span>  <br/> |
|<span data-ttu-id="1107c-159">�G���g�����ʎq����у��b�Z�[�W �N���X�� NULL �ɐݒ肵�܂��B</span><span class="sxs-lookup"><span data-stu-id="1107c-159">Entry identifier and message class set to NULL</span></span>  <br/> |<span data-ttu-id="1107c-160">メッセージ ・ ストアでは、空のメッセージ クラスとクラス] の [フォルダーの関連付けを削除します。</span><span class="sxs-lookup"><span data-stu-id="1107c-160">The message store deletes the class/folder association for the empty message class.</span></span> <span data-ttu-id="1107c-161">通常の受信メッセージのメッセージ ・ ストアは、クライアントに表示されないフォルダーのルート フォルダーに置かれる結果となるために NULL の場合、両方のパラメーターを設定する必要がありますできません。</span><span class="sxs-lookup"><span data-stu-id="1107c-161">You should not set both parameters to NULL, because it typically results in inbound messages being placed in the root folder of the message store, a folder that is invisible to the client.</span></span>  <br/> |
   
<span data-ttu-id="1107c-p111">���b�Z�[�W�̃N���X�͋�ɂ��Ȃ��ŁA��̃��b�Z�[�W��N���X���������邱�Ƃ��ł��܂��B���b�Z�[�W �X�g�A�̐ӔC�� **IPM**���̃N���X����V�����̑��M���b�Z�[�W�Ƀ��b�Z�[�W�̃N���X����蓖�Ă��M���b�Z�[�W�̔C�ӂ̋�̃N���X����N���X�Ƃ��� **IPM.Note**����蓖�Ă�g�����X�|�[�g �v���o�C�_�[�̒S�����邱�Ƃ�����߂��܂��B</span><span class="sxs-lookup"><span data-stu-id="1107c-p111">Although a message's class should never be empty, an empty message class can occur. It is the message store's responsibility to assign the message class to **IPM** for new outbound messages that have an empty class; it is the transport provider's responsibility to assign **IPM.Note** as the class for inbound messages that have any empty class.</span></span> 
  
## <a name="see-also"></a><span data-ttu-id="1107c-164">�֘A����</span><span class="sxs-lookup"><span data-stu-id="1107c-164">See also</span></span>



<span data-ttu-id="1107c-165">[MAPI �t�H���_�[](mapi-folders.md)</span><span class="sxs-lookup"><span data-stu-id="1107c-165">[MAPI Folders](mapi-folders.md)</span></span>

