---
title: フォルダー フィールド ストリームの構造
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
ms.assetid: edbc9e6c-008c-4c13-9a0c-cb47ac0f3686
description: '最終更新日時: 2015 年 3 月 9 日'
ms.openlocfilehash: 96051bd2b62fd7c0e908a1018aac0225e44986be
ms.sourcegitcommit: ef717c65d8dd41ababffb01eafc443c79950aed4
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 10/04/2018
ms.locfileid: "25385089"
---
# <a name="folder-fields-stream-structures"></a><span data-ttu-id="2cdff-103">フォルダー フィールド ストリームの構造</span><span class="sxs-lookup"><span data-stu-id="2cdff-103">Folder Fields Stream Structures</span></span>

<span data-ttu-id="2cdff-104">**適用対象**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="2cdff-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="2cdff-105">メッセージの[PidTagUserFields](pidtaguserfields-canonical-property.md)プロパティには、バイナリ ストリーム、フォルダーのユーザー定義フィールドの定義が含まれている、FolderUserFields が含まれています。</span><span class="sxs-lookup"><span data-stu-id="2cdff-105">A message's [PidTagUserFields](pidtaguserfields-canonical-property.md) property contains a binary stream, FolderUserFields, which contains the folder user-defined field definitions.</span></span> <span data-ttu-id="2cdff-106">このトピックでは、フォルダーのユーザー定義フィールドの定義についてはストリームの構造体について説明します。</span><span class="sxs-lookup"><span data-stu-id="2cdff-106">This topic describes the stream structures for folder user-defined field definitions.</span></span> 

<span data-ttu-id="2cdff-107">FolderUserFields ストリームの構造体は、FolderUserFieldsA 構造体または FolderUserFieldsW 構造体の後に FolderUserFieldsA 構造体のいずれかで構成されます。</span><span class="sxs-lookup"><span data-stu-id="2cdff-107">A FolderUserFields stream structure consists of either a FolderUserFieldsA structure or a FolderUserFieldsA structure followed by a FolderUserFieldsW structure.</span></span>
  
<span data-ttu-id="2cdff-108">このストリーム内のデータ要素は、次の指定された順序で互いのすぐ後に格納されています。</span><span class="sxs-lookup"><span data-stu-id="2cdff-108">Data elements in this stream are stored immediately following each other in the following specified order:</span></span>
  
- <span data-ttu-id="2cdff-109">**FolderUserFieldsAnsi**: FolderUserFieldsA 構造体をストリーム配信します。</span><span class="sxs-lookup"><span data-stu-id="2cdff-109">**FolderUserFieldsAnsi**: A FolderUserFieldsA stream structure.</span></span>
    
- <span data-ttu-id="2cdff-110">**FolderUserFieldsUnicode**(オプション): FolderUserFieldsW 構造体をストリーム配信します。</span><span class="sxs-lookup"><span data-stu-id="2cdff-110">**FolderUserFieldsUnicode** (optional): A FolderUserFieldsW stream structure.</span></span>
    
<span data-ttu-id="2cdff-111">FolderUserFieldsAnsi の長さ以上である FolderUserFields の長さの合計で FolderUserFieldsUnicode の存在が検出されました。</span><span class="sxs-lookup"><span data-stu-id="2cdff-111">The presence of FolderUserFieldsUnicode is detected by the total length of the FolderUserFields being greater than the length of FolderUserFieldsAnsi.</span></span>
  
> [!IMPORTANT]
> <span data-ttu-id="2cdff-112">FolderUserFieldsAnsi が使用される以前、unicode 対応でない、MAPI クライアントのバージョンとの互換性のため FolderUserFieldsUnicode が存在する場合、FolderUserFieldsAnsi の内容は無視されます。</span><span class="sxs-lookup"><span data-stu-id="2cdff-112">FolderUserFieldsAnsi is used for compatibility with older, non-Unicode, versions of MAPI clients, therefore if FolderUserFieldsUnicode is present, the contents of FolderUserFieldsAnsi is ignored.</span></span> <span data-ttu-id="2cdff-113">データを避けるために ANSI 変換、常に FolderUserFields ストリームを作成するときに失われるには、FolderUserFieldsW の一部が含まれます。</span><span class="sxs-lookup"><span data-stu-id="2cdff-113">To avoid possible data loss in ANSI conversion, when creating a FolderUserFields stream always include the FolderUserFieldsW part.</span></span> 
  
## <a name="folderuserfieldsa-stream-structure"></a><span data-ttu-id="2cdff-114">FolderUserFieldsA ストリームの構造</span><span class="sxs-lookup"><span data-stu-id="2cdff-114">FolderUserFieldsA Stream Structure</span></span>

<span data-ttu-id="2cdff-115">FolderUserFieldsA ストリームの構造体は、FolderUserFieldsW、FolderUserFields 構造体の一部が上書きされない限り、Outlook フォルダー内のすべてのユーザー定義フィールドの定義を含む FolderFieldDefinitionA ストリームの構造体の配列です。</span><span class="sxs-lookup"><span data-stu-id="2cdff-115">A FolderUserFieldsA stream structure is an array of FolderFieldDefinitionA stream structures that contain definitions for all user-defined fields in an Outlook folder, unless overridden by the FolderUserFieldsW part of the FolderUserFields structure.</span></span>
  
<span data-ttu-id="2cdff-116">リトル エンディアンのバイト順は、次の指定された順序で互いのすぐ後に、このストリーム内のデータ要素が格納されます。</span><span class="sxs-lookup"><span data-stu-id="2cdff-116">Data elements in this stream are stored in little-endian byte order, immediately following each other in the following specified order:</span></span>
  
- <span data-ttu-id="2cdff-117">**FieldDefinitionCount**: DWORD (4 バイト) で、このストリーム内のフィールドの定義の数です。</span><span class="sxs-lookup"><span data-stu-id="2cdff-117">**FieldDefinitionCount**: DWORD (4 bytes), the number of field definitions in this stream.</span></span> <span data-ttu-id="2cdff-118">これは、 **FieldDefinitions**配列の要素の数です。</span><span class="sxs-lookup"><span data-stu-id="2cdff-118">This is the count of elements in the **FieldDefinitions** array.</span></span>
    
- <span data-ttu-id="2cdff-119">**FieldDefinitions**: FolderFieldDefinitionA の配列が構造体をストリーム配信します。</span><span class="sxs-lookup"><span data-stu-id="2cdff-119">**FieldDefinitions**: An array of FolderFieldDefinitionA stream structures.</span></span> <span data-ttu-id="2cdff-120">この配列は、 **FieldDefinitionCount**のデータ要素と同じです。</span><span class="sxs-lookup"><span data-stu-id="2cdff-120">The count of this array is equal to the **FieldDefinitionCount** data element.</span></span>
    
<span data-ttu-id="2cdff-121">オーバーライドされない限りこの FolderUserFieldsA は、FolderUserFieldsW、FolderUserFields 構造体の一部で、 **FieldDefinitions**配列する必要があります「null で終わる」の最後の FolderFieldDefinitionA 要素の Common.FieldType フィールドの値のことで、ftNull。</span><span class="sxs-lookup"><span data-stu-id="2cdff-121">Unless this FolderUserFieldsA is overridden by the FolderUserFieldsW part of the FolderUserFields structure, the **FieldDefinitions** array must be "null-terminated" by having its last FolderFieldDefinitionA element's Common.FieldType field equal to ftNull.</span></span>
  
## <a name="folderuserfieldsw-stream-structure"></a><span data-ttu-id="2cdff-122">FolderUserFieldsW ストリームの構造</span><span class="sxs-lookup"><span data-stu-id="2cdff-122">FolderUserFieldsW Stream Structure</span></span>

<span data-ttu-id="2cdff-123">FolderUserFieldsW ストリームの構造体は、Outlook フォルダー内のすべてのユーザー定義フィールドの定義を含む FolderFieldDefinitionW ストリームの構造体の配列です。</span><span class="sxs-lookup"><span data-stu-id="2cdff-123">A FolderUserFieldsW stream structure is an array of FolderFieldDefinitionW stream structures that contain definitions for all user-defined fields in an Outlook folder.</span></span>
  
<span data-ttu-id="2cdff-124">リトル エンディアンのバイト順は、次の指定された順序で互いのすぐ後に、このストリーム内のデータ要素が格納されます。</span><span class="sxs-lookup"><span data-stu-id="2cdff-124">Data elements in this stream are stored in little-endian byte order, immediately following each other in the following specified order:</span></span>
  
- <span data-ttu-id="2cdff-125">**FieldDefinitionCount**: DWORD (4 バイト) で、このストリーム内のフィールドの定義の数です。</span><span class="sxs-lookup"><span data-stu-id="2cdff-125">**FieldDefinitionCount**: DWORD (4 bytes), the number of field definitions in this stream.</span></span> <span data-ttu-id="2cdff-126">これは、 **FieldDefinitions**配列の要素の数です。</span><span class="sxs-lookup"><span data-stu-id="2cdff-126">This is the count of elements in the **FieldDefinitions** array.</span></span>
    
- <span data-ttu-id="2cdff-127">**FieldDefinitions**: FolderFieldDefinitionW の配列が構造体をストリーム配信します。</span><span class="sxs-lookup"><span data-stu-id="2cdff-127">**FieldDefinitions**: An array of FolderFieldDefinitionW stream structures.</span></span> <span data-ttu-id="2cdff-128">この配列は、 **FieldDefinitionCount**のデータ要素と同じです。</span><span class="sxs-lookup"><span data-stu-id="2cdff-128">The count of this array is equal to the **FieldDefinitionCount** data element.</span></span>
    
<span data-ttu-id="2cdff-129">**FieldDefinitions**配列する必要があります「null で終わる」の最後の FolderFieldDefinitionW 要素の Common.FieldType フィールドを ftNull にすることによって。</span><span class="sxs-lookup"><span data-stu-id="2cdff-129">The **FieldDefinitions** array must be "null-terminated" by having its last FolderFieldDefinitionW element's Common.FieldType field equal to ftNull.</span></span>
  
## <a name="folderfielddefinitiona-stream-structure"></a><span data-ttu-id="2cdff-130">FolderFieldDefinitionA ストリームの構造</span><span class="sxs-lookup"><span data-stu-id="2cdff-130">FolderFieldDefinitionA Stream Structure</span></span>

<span data-ttu-id="2cdff-131">FolderFieldDefinitionA ストリームの構造体には、ansi 形式で格納されているフィールド名を持つユーザー定義のフィールドの定義が含まれています。</span><span class="sxs-lookup"><span data-stu-id="2cdff-131">A FolderFieldDefinitionA stream structure contains a definition of a user-defined field with the field name stored in ANSI.</span></span>
  
<span data-ttu-id="2cdff-132">リトル エンディアンのバイト順は、次の指定された順序で互いのすぐ後に、このストリーム内のデータ要素が格納されます。</span><span class="sxs-lookup"><span data-stu-id="2cdff-132">Data elements in this stream are stored in little-endian byte order, immediately following each other in the following specified order:</span></span>
  
- <span data-ttu-id="2cdff-133">**FieldType**: FldType (4 バイト) で、このフィールドの種類です。</span><span class="sxs-lookup"><span data-stu-id="2cdff-133">**FieldType**: FldType (4 bytes), the type of this field.</span></span>
    
- <span data-ttu-id="2cdff-134">**FieldNameLength**: ワード (2 バイト) で、**フィールド名**の配列内の要素の数。</span><span class="sxs-lookup"><span data-stu-id="2cdff-134">**FieldNameLength**: WORD (2 bytes), the number of elements in the **FieldName** array.</span></span>
    
- <span data-ttu-id="2cdff-135">**フィールド名**: char 型の配列。</span><span class="sxs-lookup"><span data-stu-id="2cdff-135">**FieldName**: An array of CHAR.</span></span> <span data-ttu-id="2cdff-136">つまり、CP_ACP の ANSI コード ページ形式のフィールド名です。</span><span class="sxs-lookup"><span data-stu-id="2cdff-136">This is the ANSI CP_ACP codepage representation of the field name.</span></span> <span data-ttu-id="2cdff-137">この配列の数は**FieldNameLength**になります。</span><span class="sxs-lookup"><span data-stu-id="2cdff-137">The count of this array is equal to **FieldNameLength**.</span></span> <span data-ttu-id="2cdff-138">フィールド名は、 [UserProperties.Add](https://msdn.microsoft.com/library/microsoft.office.interop.outlook.userproperties.add.aspx)メソッドで指定された Name パラメーターの制限を満たす必要があります。</span><span class="sxs-lookup"><span data-stu-id="2cdff-138">The field name must satisfy the restrictions on the Name parameter as specified in the [UserProperties.Add](https://msdn.microsoft.com/library/microsoft.office.interop.outlook.userproperties.add.aspx) Method.</span></span> 
    
   > [!NOTE]
   > <span data-ttu-id="2cdff-139">レガシー互換性の理由から、Outlook は**フィールド名**の値がないこれらの制限を満たすいくつか、しかしこのような場合が対応していないこのトピックを処理することにあります。</span><span class="sxs-lookup"><span data-stu-id="2cdff-139">For reasons of legacy compatibility, Outlook may be able to handle some **FieldName** values not satisfying these restrictions, however such cases are not covered by this topic.</span></span> 
  
- <span data-ttu-id="2cdff-140">**共通**: FolderFieldDefinitionCommon 構造体をストリーム配信します。</span><span class="sxs-lookup"><span data-stu-id="2cdff-140">**Common**: A FolderFieldDefinitionCommon stream structure.</span></span>
    
## <a name="folderfielddefinitionw-stream-structure"></a><span data-ttu-id="2cdff-141">FolderFieldDefinitionW ストリームの構造</span><span class="sxs-lookup"><span data-stu-id="2cdff-141">FolderFieldDefinitionW Stream Structure</span></span>

<span data-ttu-id="2cdff-142">FolderFieldDefinitionW ストリームの構造体には、Unicode で格納されているフィールド名を持つユーザー定義のフィールドの定義が含まれています。</span><span class="sxs-lookup"><span data-stu-id="2cdff-142">A FolderFieldDefinitionW stream structure contains a definition of a user-defined field with the field name stored in Unicode.</span></span>
  
<span data-ttu-id="2cdff-143">リトル エンディアンのバイト順は、次の指定された順序で互いのすぐ後に、このストリーム内のデータ要素が格納されます。</span><span class="sxs-lookup"><span data-stu-id="2cdff-143">Data elements in this stream are stored in little-endian byte order, immediately following each other in the following specified order:</span></span>
  
- <span data-ttu-id="2cdff-144">**FieldType**: FldType (4 バイト) で、このフィールドの種類です。</span><span class="sxs-lookup"><span data-stu-id="2cdff-144">**FieldType**: FldType (4 bytes), the type of this field.</span></span>
    
- <span data-ttu-id="2cdff-145">**FieldNameLength**: ワード (2 バイト) で、**フィールド名**の配列内の要素の数。</span><span class="sxs-lookup"><span data-stu-id="2cdff-145">**FieldNameLength**: WORD (2 bytes), the number of elements in the **FieldName** array.</span></span>
    
- <span data-ttu-id="2cdff-146">**フィールド名**: wchar 型の配列。</span><span class="sxs-lookup"><span data-stu-id="2cdff-146">**FieldName**: An array of WCHAR.</span></span> <span data-ttu-id="2cdff-147">これは、Unicode (utf-16) の形式のフィールド名です。</span><span class="sxs-lookup"><span data-stu-id="2cdff-147">This is the Unicode (UTF-16) representation of the field name.</span></span> <span data-ttu-id="2cdff-148">この配列の数は**FieldNameLength**になります。</span><span class="sxs-lookup"><span data-stu-id="2cdff-148">The count of this array is equal to **FieldNameLength**.</span></span> <span data-ttu-id="2cdff-149">フィールド名は、 [UserProperties.Add](https://msdn.microsoft.com/library/microsoft.office.interop.outlook.userproperties.add.aspx)メソッドで指定された Name パラメーターの制限を満たす必要があります。</span><span class="sxs-lookup"><span data-stu-id="2cdff-149">The field name must satisfy the restrictions on the Name parameter as specified in the [UserProperties.Add](https://msdn.microsoft.com/library/microsoft.office.interop.outlook.userproperties.add.aspx) Method.</span></span> 
    
   > [!NOTE]
   > <span data-ttu-id="2cdff-150">レガシー互換性の理由から、Outlook はしないこれらの制限を満たすいくつかの**フィールド**値を処理できる場合がありますが、このような場合は、このトピックでは説明しません。</span><span class="sxs-lookup"><span data-stu-id="2cdff-150">For reasons of legacy compatibility, Outlook may be able to handle some **FieldName** values not satisfying these restrictions, but such cases are not covered by this topic.</span></span> 
  
- <span data-ttu-id="2cdff-151">**共通**: FolderFieldDefinitionCommon 構造体をストリーム配信します。</span><span class="sxs-lookup"><span data-stu-id="2cdff-151">**Common**: A FolderFieldDefinitionCommon stream structure.</span></span>
    
## <a name="fldtype-enumeration"></a><span data-ttu-id="2cdff-152">FldType 列挙型</span><span class="sxs-lookup"><span data-stu-id="2cdff-152">FldType Enumeration</span></span>

<span data-ttu-id="2cdff-153">**FldType**列挙値は、次の表に表示されます。</span><span class="sxs-lookup"><span data-stu-id="2cdff-153">**FldType** enumeration values are listed in the following table.</span></span> 
  
|<span data-ttu-id="2cdff-154">名前</span><span class="sxs-lookup"><span data-stu-id="2cdff-154">Name</span></span>|<span data-ttu-id="2cdff-155">値</span><span class="sxs-lookup"><span data-stu-id="2cdff-155">Value</span></span>|<span data-ttu-id="2cdff-156">意味</span><span class="sxs-lookup"><span data-stu-id="2cdff-156">Meaning</span></span>|
|:-----|:-----|:-----|
|<span data-ttu-id="2cdff-157">ftNull</span><span class="sxs-lookup"><span data-stu-id="2cdff-157">ftNull</span></span>  <br/> |<span data-ttu-id="2cdff-158">0x0</span><span class="sxs-lookup"><span data-stu-id="2cdff-158">0x0</span></span>  <br/> |<span data-ttu-id="2cdff-159">フィールド定義の配列を null で終了するのには、この種類のフィールドが使用されます。</span><span class="sxs-lookup"><span data-stu-id="2cdff-159">This field type is used to null-terminate an array of field definitions.</span></span>  <br/> |
|<span data-ttu-id="2cdff-160">ftString</span><span class="sxs-lookup"><span data-stu-id="2cdff-160">ftString</span></span>  <br/> |<span data-ttu-id="2cdff-161">0x1</span><span class="sxs-lookup"><span data-stu-id="2cdff-161">0x1</span></span>  <br/> |<span data-ttu-id="2cdff-162">テキスト</span><span class="sxs-lookup"><span data-stu-id="2cdff-162">Text</span></span>  <br/> |
|<span data-ttu-id="2cdff-163">ftInteger</span><span class="sxs-lookup"><span data-stu-id="2cdff-163">ftInteger</span></span>  <br/> |<span data-ttu-id="2cdff-164">0x3</span><span class="sxs-lookup"><span data-stu-id="2cdff-164">0x3</span></span>  <br/> |<span data-ttu-id="2cdff-165">整数</span><span class="sxs-lookup"><span data-stu-id="2cdff-165">Integer</span></span>  <br/> |
|<span data-ttu-id="2cdff-166">ftTime</span><span class="sxs-lookup"><span data-stu-id="2cdff-166">ftTime</span></span>  <br/> |<span data-ttu-id="2cdff-167">0x5</span><span class="sxs-lookup"><span data-stu-id="2cdff-167">0x5</span></span>  <br/> |<span data-ttu-id="2cdff-168">日付/時刻型</span><span class="sxs-lookup"><span data-stu-id="2cdff-168">Date/Time</span></span>  <br/> |
|<span data-ttu-id="2cdff-169">ftBoolean</span><span class="sxs-lookup"><span data-stu-id="2cdff-169">ftBoolean</span></span>  <br/> |<span data-ttu-id="2cdff-170">0x6</span><span class="sxs-lookup"><span data-stu-id="2cdff-170">0x6</span></span>  <br/> |<span data-ttu-id="2cdff-171">はい/いいえ</span><span class="sxs-lookup"><span data-stu-id="2cdff-171">Yes/No</span></span>  <br/> |
|<span data-ttu-id="2cdff-172">ftDuration</span><span class="sxs-lookup"><span data-stu-id="2cdff-172">ftDuration</span></span>  <br/> |<span data-ttu-id="2cdff-173">0x7</span><span class="sxs-lookup"><span data-stu-id="2cdff-173">0x7</span></span>  <br/> |<span data-ttu-id="2cdff-174">Duration</span><span class="sxs-lookup"><span data-stu-id="2cdff-174">Duration</span></span>  <br/> |
|<span data-ttu-id="2cdff-175">ftMultiString</span><span class="sxs-lookup"><span data-stu-id="2cdff-175">ftMultiString</span></span>  <br/> |<span data-ttu-id="2cdff-176">0 xb</span><span class="sxs-lookup"><span data-stu-id="2cdff-176">0xB</span></span>  <br/> |<span data-ttu-id="2cdff-177">Keywords</span><span class="sxs-lookup"><span data-stu-id="2cdff-177">Keywords</span></span>  <br/> |
|<span data-ttu-id="2cdff-178">ftFloat</span><span class="sxs-lookup"><span data-stu-id="2cdff-178">ftFloat</span></span>  <br/> |<span data-ttu-id="2cdff-179">0xC</span><span class="sxs-lookup"><span data-stu-id="2cdff-179">0xC</span></span>  <br/> |<span data-ttu-id="2cdff-180">数値または割合</span><span class="sxs-lookup"><span data-stu-id="2cdff-180">Number or Percent</span></span>  <br/> |
|<span data-ttu-id="2cdff-181">ftCurrency</span><span class="sxs-lookup"><span data-stu-id="2cdff-181">ftCurrency</span></span>  <br/> |<span data-ttu-id="2cdff-182">0xE</span><span class="sxs-lookup"><span data-stu-id="2cdff-182">0xE</span></span>  <br/> |<span data-ttu-id="2cdff-183">通貨型 (Currency)</span><span class="sxs-lookup"><span data-stu-id="2cdff-183">Currency</span></span>  <br/> |
|<span data-ttu-id="2cdff-184">ftCalc</span><span class="sxs-lookup"><span data-stu-id="2cdff-184">ftCalc</span></span>  <br/> |<span data-ttu-id="2cdff-185">0x12</span><span class="sxs-lookup"><span data-stu-id="2cdff-185">0x12</span></span>  <br/> |<span data-ttu-id="2cdff-186">式</span><span class="sxs-lookup"><span data-stu-id="2cdff-186">Formula</span></span>  <br/> |
|<span data-ttu-id="2cdff-187">ftSwitch</span><span class="sxs-lookup"><span data-stu-id="2cdff-187">ftSwitch</span></span>  <br/> |<span data-ttu-id="2cdff-188">0x13</span><span class="sxs-lookup"><span data-stu-id="2cdff-188">0x13</span></span>  <br/> |<span data-ttu-id="2cdff-189">表示のみ最初空でないフィールドのうちの種類の組み合わせです。</span><span class="sxs-lookup"><span data-stu-id="2cdff-189">Combination of type showing only the first non-empty field - ignoring subsequent ones.</span></span>  <br/> |
|<span data-ttu-id="2cdff-190">ftConcat</span><span class="sxs-lookup"><span data-stu-id="2cdff-190">ftConcat</span></span>  <br/> |<span data-ttu-id="2cdff-191">0x17</span><span class="sxs-lookup"><span data-stu-id="2cdff-191">0x17</span></span>  <br/> |<span data-ttu-id="2cdff-192">結合するフィールドすべてを他の種類の組み合わせです。</span><span class="sxs-lookup"><span data-stu-id="2cdff-192">Combination of type joining fields and any text fragments to each other.</span></span>  <br/> |
   
## <a name="folderfielddefinitioncommon-stream-structure"></a><span data-ttu-id="2cdff-193">FolderFieldDefinitionCommon ストリームの構造</span><span class="sxs-lookup"><span data-stu-id="2cdff-193">FolderFieldDefinitionCommon Stream Structure</span></span>

<span data-ttu-id="2cdff-194">FolderFieldDefinitionCommon ストリームの構造体には、FolderFieldDefinitionA と、FolderFieldDefinitionW の両方に共通するユーザー定義のフィールド定義のデータが含まれています。</span><span class="sxs-lookup"><span data-stu-id="2cdff-194">A FolderFieldDefinitionCommon stream structure contains the data of a user-defined field definition that is common to both a FolderFieldDefinitionA and a FolderFieldDefinitionW.</span></span>
  
<span data-ttu-id="2cdff-195">リトル エンディアンのバイト順は、次の指定された順序で互いのすぐ後に、このストリーム内のデータ要素が格納されます。</span><span class="sxs-lookup"><span data-stu-id="2cdff-195">Data elements in this stream are stored in little-endian byte order, immediately following each other in the following specified order:</span></span>
  
- <span data-ttu-id="2cdff-196">**PropSetGuid**: GUID (16 バイト)、プロパティは、フォルダー フィールドの対応する MAPI プロパティ名の GUID を設定します。</span><span class="sxs-lookup"><span data-stu-id="2cdff-196">**PropSetGuid**: GUID (16 bytes), the property set GUID of the folder field's corresponding MAPI property name.</span></span> <span data-ttu-id="2cdff-197">このフィールドの値でなければなりません PS_PUBLIC_STRINGS でない限り、フィールドの種類**ftNone**場合にこのフィールドの値が GUID_ 値にする必要があります。</span><span class="sxs-lookup"><span data-stu-id="2cdff-197">This field's value must be equal to PS_PUBLIC_STRINGS, unless the field type is **ftNone** in which case this field's value must be equal to GUID_NULL.</span></span> 
    
   > [!NOTE]
   > <span data-ttu-id="2cdff-198">レガシー互換性の理由から、Outlook がされないこの制限を満たすいくつかの**PropSetGuid**値、しかしこのような場合が対応していないこのトピックを処理することがあります。</span><span class="sxs-lookup"><span data-stu-id="2cdff-198">For reasons of legacy compatibility, Outlook may be able to handle some **PropSetGuid** values not satisfying this restriction, however such cases are not covered by this topic.</span></span> 
  
- <span data-ttu-id="2cdff-199">**fcapm**: DWORD (4 バイト)、および意味の値が次の表に記載されている 1 つ以上のフラグの組み合わせです。</span><span class="sxs-lookup"><span data-stu-id="2cdff-199">**fcapm**: DWORD (4 bytes), a combination of zero or more flags the values of which and meanings are listed in the following table.</span></span> <span data-ttu-id="2cdff-200">フラグを同じ値では、フィールドの型、つまり、FldType の値に依存する意味を持っています。</span><span class="sxs-lookup"><span data-stu-id="2cdff-200">Flags with the same value have meanings dependent on the field's type, that is, FldType value.</span></span>
    
    |<span data-ttu-id="2cdff-201">フラグ名</span><span class="sxs-lookup"><span data-stu-id="2cdff-201">Flag name</span></span>|<span data-ttu-id="2cdff-202">値</span><span class="sxs-lookup"><span data-stu-id="2cdff-202">Value</span></span>|<span data-ttu-id="2cdff-203">意味</span><span class="sxs-lookup"><span data-stu-id="2cdff-203">Meaning</span></span>|
    |:-----|:-----|:-----|
    |<span data-ttu-id="2cdff-204">FCAPM_CAN_EDIT</span><span class="sxs-lookup"><span data-stu-id="2cdff-204">FCAPM_CAN_EDIT</span></span>  <br/> |<span data-ttu-id="2cdff-205">0x00000001</span><span class="sxs-lookup"><span data-stu-id="2cdff-205">0x00000001</span></span>  <br/> |<span data-ttu-id="2cdff-206">フィールドは編集可能です。</span><span class="sxs-lookup"><span data-stu-id="2cdff-206">The field is editable.</span></span>  <br/> |
    |<span data-ttu-id="2cdff-207">FCAPM_CAN_SORT</span><span class="sxs-lookup"><span data-stu-id="2cdff-207">FCAPM_CAN_SORT</span></span>  <br/> |<span data-ttu-id="2cdff-208">0x00000002</span><span class="sxs-lookup"><span data-stu-id="2cdff-208">0x00000002</span></span>  <br/> |<span data-ttu-id="2cdff-209">フィールドは、並べ替えができます。</span><span class="sxs-lookup"><span data-stu-id="2cdff-209">The field is sortable.</span></span>  <br/> |
    |<span data-ttu-id="2cdff-210">FCAPM_CAN_GROUP</span><span class="sxs-lookup"><span data-stu-id="2cdff-210">FCAPM_CAN_GROUP</span></span>  <br/> |<span data-ttu-id="2cdff-211">0x00000004</span><span class="sxs-lookup"><span data-stu-id="2cdff-211">0x00000004</span></span>  <br/> |<span data-ttu-id="2cdff-212">フィールドは、調べたりします。</span><span class="sxs-lookup"><span data-stu-id="2cdff-212">The field is groupable.</span></span>  <br/> |
    |<span data-ttu-id="2cdff-213">FCAPM_MULTILINE_TEXT</span><span class="sxs-lookup"><span data-stu-id="2cdff-213">FCAPM_MULTILINE_TEXT</span></span>  <br/> |<span data-ttu-id="2cdff-214">0x00000100</span><span class="sxs-lookup"><span data-stu-id="2cdff-214">0x00000100</span></span>  <br/> |<span data-ttu-id="2cdff-215">フィールドは、複数行のテキストを保持できます。</span><span class="sxs-lookup"><span data-stu-id="2cdff-215">The field can hold multiple lines of text.</span></span>  <br/> |
    |<span data-ttu-id="2cdff-216">FCAPM_PERCENT</span><span class="sxs-lookup"><span data-stu-id="2cdff-216">FCAPM_PERCENT</span></span>  <br/> |<span data-ttu-id="2cdff-217">0x01000000</span><span class="sxs-lookup"><span data-stu-id="2cdff-217">0x01000000</span></span>  <br/> |<span data-ttu-id="2cdff-218">この型 ftFloat は、割合フィールドです。</span><span class="sxs-lookup"><span data-stu-id="2cdff-218">This field of the type ftFloat is a percentage field.</span></span>  <br/> |
    |<span data-ttu-id="2cdff-219">FCAPM_DATEONLY</span><span class="sxs-lookup"><span data-stu-id="2cdff-219">FCAPM_DATEONLY</span></span>  <br/> |<span data-ttu-id="2cdff-220">0x01000000</span><span class="sxs-lookup"><span data-stu-id="2cdff-220">0x01000000</span></span>  <br/> |<span data-ttu-id="2cdff-221">型 ftTime のこのフィールドは、日付だけの時間フィールドです。</span><span class="sxs-lookup"><span data-stu-id="2cdff-221">This field of the type ftTime is a date-only time field.</span></span>  <br/> |
    |<span data-ttu-id="2cdff-222">FCAPM_UNITLESS</span><span class="sxs-lookup"><span data-stu-id="2cdff-222">FCAPM_UNITLESS</span></span>  <br/> |<span data-ttu-id="2cdff-223">0x01000000</span><span class="sxs-lookup"><span data-stu-id="2cdff-223">0x01000000</span></span>  <br/> |<span data-ttu-id="2cdff-224">型 ftInteger のこのフィールドの単位は許可されませんの表示形式です。としてこのような形式の"コンピューター - 640 の K.."は許可されていません。</span><span class="sxs-lookup"><span data-stu-id="2cdff-224">For this field of the type ftInteger, no unit is allowed in display format; for example such formats as "Computer - 640 K…" are not allowed.</span></span>  <br/> |
    |<span data-ttu-id="2cdff-225">FCAPM_CAN_EDIT_IN_ITEM</span><span class="sxs-lookup"><span data-stu-id="2cdff-225">FCAPM_CAN_EDIT_IN_ITEM</span></span>  <br/> |<span data-ttu-id="2cdff-226">0x80000000</span><span class="sxs-lookup"><span data-stu-id="2cdff-226">0x80000000</span></span>  <br/> |<span data-ttu-id="2cdff-227">アイテムでフィールドを編集することができます: これは、具体的にはユーザー設定フォームです。</span><span class="sxs-lookup"><span data-stu-id="2cdff-227">The field can be edited in the item: This is specifically for custom forms.</span></span>  <br/> |
   
- <span data-ttu-id="2cdff-228">**dwString**: DWORD (4 バイト)。</span><span class="sxs-lookup"><span data-stu-id="2cdff-228">**dwString**: DWORD (4 bytes).</span></span> <span data-ttu-id="2cdff-229">最初の次の注を参照してください。</span><span class="sxs-lookup"><span data-stu-id="2cdff-229">See the first following Note.</span></span>
    
- <span data-ttu-id="2cdff-230">**dwBitmap**: DWORD (4 バイト)。</span><span class="sxs-lookup"><span data-stu-id="2cdff-230">**dwBitmap**: DWORD (4 bytes).</span></span> <span data-ttu-id="2cdff-231">最初の次の注を参照してください。</span><span class="sxs-lookup"><span data-stu-id="2cdff-231">See the first following Note.</span></span>
    
- <span data-ttu-id="2cdff-232">**dwDisplay**: DWORD (4 バイト)。</span><span class="sxs-lookup"><span data-stu-id="2cdff-232">**dwDisplay**: DWORD (4 bytes).</span></span> <span data-ttu-id="2cdff-233">最初の次の注を参照してください。</span><span class="sxs-lookup"><span data-stu-id="2cdff-233">See the first following Note.</span></span>
    
- <span data-ttu-id="2cdff-234">**iFmt**: INT (4 バイト)。</span><span class="sxs-lookup"><span data-stu-id="2cdff-234">**iFmt**: INT (4 bytes).</span></span> <span data-ttu-id="2cdff-235">持つフィールド型に対して、"形式:」ダイアログ ボックスの [新しいフィールドの"、"フィールドの編集]、および [フィールド プロパティ] のコンボ ボックス、コンボ ボックスで選択した形式の 0 から始まるインデックス。</span><span class="sxs-lookup"><span data-stu-id="2cdff-235">For the field types that have the "Format:" combo box in the "New Field", "Edit Field", and "Field Properties" dialogs, the 0-based index of the format selected in that combo box.</span></span> <span data-ttu-id="2cdff-236">種類のフィールドをコンボ ボックスを使用せずに 0 でなければなりません。</span><span class="sxs-lookup"><span data-stu-id="2cdff-236">For the field types without that combo box, this must be 0.</span></span> <span data-ttu-id="2cdff-237">フィールドの種類とフィールドの値が一意に、 **dwString**、 **dwBitmap**の値を決定し、 **dwDisplay**フィールドでは、最初の次の注を参照してください。</span><span class="sxs-lookup"><span data-stu-id="2cdff-237">The field's value together with the field type uniquely determine the values of the **dwString**, **dwBitmap**, and **dwDisplay** fields, see the first following Note.</span></span>
    
- <span data-ttu-id="2cdff-238">**wszFormulaLength**: ワード (2 バイト)、 **wszFormulaLength**配列内の要素の数。</span><span class="sxs-lookup"><span data-stu-id="2cdff-238">**wszFormulaLength**: WORD (2 bytes), the number of elements in the **wszFormulaLength** array.</span></span>
    
- <span data-ttu-id="2cdff-239">**wszFormulaLength**: wchar 型の配列。</span><span class="sxs-lookup"><span data-stu-id="2cdff-239">**wszFormulaLength**: An array of WCHAR.</span></span> <span data-ttu-id="2cdff-240">これは、標準の形式でのフィールドの数式文字列の Unicode (utf-16) 形式です。</span><span class="sxs-lookup"><span data-stu-id="2cdff-240">This is the Unicode (UTF-16) representation of the field's formula string in its standard format.</span></span> <span data-ttu-id="2cdff-241">標準の説明と、フィールドの数式の UI 形式の 2 つ目の次の注を参照してください。</span><span class="sxs-lookup"><span data-stu-id="2cdff-241">See the second following Note for the description of the standard and UI formats of a field's formula.</span></span> <span data-ttu-id="2cdff-242">この配列の数は**wszFormulaLength**になります。</span><span class="sxs-lookup"><span data-stu-id="2cdff-242">The count of this array is equal to **wszFormulaLength**.</span></span> <span data-ttu-id="2cdff-243">数式の文字列は、フィールドの型が**ftCalc**、 **ftSwitch**または**ftConcat**でない限り、空の文字列にすることがあります。</span><span class="sxs-lookup"><span data-stu-id="2cdff-243">The formula string must be an empty string unless the field type is **ftCalc**, **ftSwitch** or **ftConcat**.</span></span>
    
> [!NOTE]
> <span data-ttu-id="2cdff-244">冗長は、 **FldType**の値と、 **iFmt**の値に基づいて**dwString**、 **dwBitmap**、および**dwDisplay**の値は一意に決まりますが適切な値はまだのために必要な正しいoutlook フィールドの定義の処理をします。</span><span class="sxs-lookup"><span data-stu-id="2cdff-244">Although the values of **dwString**, **dwBitmap**, and **dwDisplay** are uniquely determined based on the **FldType** value and the **iFmt** value, which are redundant, their correct values are still necessary for correct processing of the field definition by Outlook.</span></span> <span data-ttu-id="2cdff-245">この決定を実行するアルゴリズムの簡単な説明はありません。</span><span class="sxs-lookup"><span data-stu-id="2cdff-245">There is no simple description of the algorithm that performs this determination.</span></span> 
> 
> <span data-ttu-id="2cdff-246">したがって、どの**dwString**、 **dwBitmap**、および**dwDisplay**値に対応して、指定した**FldType**値と**iFmt**の値を検索] を選択する形式と、その種類のユーザー定義フィールドを作成してテストを実行します。**フォーマット**」コンボ ボックスで、適用できると仮定して、結果として得られる**FolderUserFields**ストリームを対象となるユーザー定義フィールドが作成されますを確認します。</span><span class="sxs-lookup"><span data-stu-id="2cdff-246">Therefore, to find out which **dwString**, **dwBitmap**, and **dwDisplay** values correspond to a given **FldType** value and **iFmt** value, perform a test by creating a user-defined field of that type, and with that format selected in the **Format** combo box, assuming its applicability, inspect the resulting **FolderUserFields** stream that Outlook creates for that user-defined field.</span></span> 
  
<span data-ttu-id="2cdff-247">**新しいフィールド**、**フィールドの編集**、およびユーザー定義フィールドの**フィールドのプロパティ**ダイアログ ボックスの [**数式**] テキスト ボックス内の UI 形式でのフィールドの数式を編集します。</span><span class="sxs-lookup"><span data-stu-id="2cdff-247">The field's formula in its UI format is edited in the **Formula** text box of the **New Field**, **Edit Field**, and **Field Properties** dialogs for the user-defined field.</span></span> <span data-ttu-id="2cdff-248">UI 形式の数式を標準の形式に変換するアルゴリズムは、次の説明に従ってフィールドの種類によって異なります。</span><span class="sxs-lookup"><span data-stu-id="2cdff-248">The algorithm to convert a formula from the UI format to the standard format depends on the field type as described in the following:</span></span> 
- <span data-ttu-id="2cdff-249">タイプ**ftCalc**および**ftSwitch**のフィールドは、組み込みのフィールドは、対応する MAPI プロパティは、標準的な形式という名前のプロパティの種類の MNID\_の文字列はフィールドの名前の一部を置き換えることによって取得されます`[<field_name>]`フラグメントを使用した`[_<field_dispid_decimal>]`。</span><span class="sxs-lookup"><span data-stu-id="2cdff-249">For fields of types **ftCalc** and **ftSwitch**, the standard format for built-in fields, which corresponding MAPI properties are not named properties of the kind MNID\_STRING, is obtained by replacing field name fragments, that is `[<field_name>]` with fragments `[_<field_dispid_decimal>]`.</span></span> 

  <span data-ttu-id="2cdff-250">たとえば、**数式**、 **ftCalc**、Office UI 言語が英語 (米国) の中では、型のフィールドの数式は、UI の形式は、 `[Business Phone] & [My custom field]`、`My custom field`名前のユーザー定義のフィールドでは、このような数式の標準の形式になります`[_14856] & [My custom field]`.</span><span class="sxs-lookup"><span data-stu-id="2cdff-250">For example, if the UI format of a formula for a field of the type **Formula**, that is **ftCalc**, with the Office UI language being US English, is `[Business Phone] & [My custom field]`, where `My custom field` is the name of a user-defined field, the standard format of such a formula would be `[_14856] & [My custom field]`.</span></span>

- <span data-ttu-id="2cdff-251">**FtConcat**の型のフィールドは、次を実行して標準の形式を取得します。</span><span class="sxs-lookup"><span data-stu-id="2cdff-251">For fields of the type **ftConcat**, the standard format is obtained by performing the following:</span></span>

  1. <span data-ttu-id="2cdff-252">先頭および末尾の空白文字が切り捨てられます。</span><span class="sxs-lookup"><span data-stu-id="2cdff-252">Truncate leading and trailing whitespace.</span></span> 
  2. <span data-ttu-id="2cdff-253">以下の 2 種類のフラグメントのシーケンスには、式を解析します。</span><span class="sxs-lookup"><span data-stu-id="2cdff-253">Parse the formula into a sequence of fragments of the following two kinds:</span></span> 
     - <span data-ttu-id="2cdff-254">フィールド名は角かっこで`[<field_name>]`です。</span><span class="sxs-lookup"><span data-stu-id="2cdff-254">A field name in square brackets, that is, `[<field_name>]`.</span></span> 
     - <span data-ttu-id="2cdff-255">角かっこが含まれていない部分です。</span><span class="sxs-lookup"><span data-stu-id="2cdff-255">A substring not containing any square brackets.</span></span>   
      <span data-ttu-id="2cdff-256">第二種のない 2 つのフラグメントは、シーケンス内の連続したことを保証します。</span><span class="sxs-lookup"><span data-stu-id="2cdff-256">Assure that no two fragments of the second kind are adjacent in the sequence.</span></span> <span data-ttu-id="2cdff-257">場合は、数式には、この方法を解析できない場合、無効と見なされます。</span><span class="sxs-lookup"><span data-stu-id="2cdff-257">If the formula cannot be parsed this way, it is considered invalid.</span></span> 
  3. <span data-ttu-id="2cdff-258">**FtCalc**と**ftSwitch**フィールドと 1 つのフラグメントの同一の置換を実行します。</span><span class="sxs-lookup"><span data-stu-id="2cdff-258">Perform the same replacement for fragments of the first kind as for the **ftCalc** and **ftSwitch** fields.</span></span> 
  4. <span data-ttu-id="2cdff-259">第二種の各フラグメントのすべての二重引用符をエスケープします (""") 文字、2 つの連続した二重引用符文字である場合、二重引用符で囲みます。</span><span class="sxs-lookup"><span data-stu-id="2cdff-259">For each fragment of the second kind, escape all double-quote (""") characters, if any, with two consecutive double-quote characters, and enclose it in double quotes.</span></span> 
  5. <span data-ttu-id="2cdff-260">アンパサンド文字列を挿入 (`&`) 隣接するフラグメントの各ペアの間です。</span><span class="sxs-lookup"><span data-stu-id="2cdff-260">Insert an ampersand string (`&`) between each pair of adjacent fragments.</span></span>
 
  <span data-ttu-id="2cdff-261">**FtConcat**の型のフィールドの数式の UI 形式の場合など、Office UI 言語を英語 (米国) を使用して`text1 [Business Phone] "text2" [My custom field]`、`My custom field`標準の書式設定、ユーザー定義フィールドの名前は、このような数式になるの`""text1" & [_14856] & """text2""" & [My custom field]"`。</span><span class="sxs-lookup"><span data-stu-id="2cdff-261">For example, using the Office UI language US English, if the UI format of a formula for a field of the type **ftConcat** is `text1 [Business Phone] "text2" [My custom field]`, where `My custom field` is the name of a user-defined field, the standard format for such a formula would be `""text1" & [_14856] & """text2""" & [My custom field]"`.</span></span> 
  
## <a name="see-also"></a><span data-ttu-id="2cdff-262">関連項目</span><span class="sxs-lookup"><span data-stu-id="2cdff-262">See also</span></span>

- [<span data-ttu-id="2cdff-263">FolderUserFields ストリームのサンプル</span><span class="sxs-lookup"><span data-stu-id="2cdff-263">FolderUserFields Stream Sample</span></span>](folderuserfields-stream-sample.md)
- [<span data-ttu-id="2cdff-264">新しいユーザー定義フィールドの定義を追加する</span><span class="sxs-lookup"><span data-stu-id="2cdff-264">Add a Definition for a New User-Defined Field</span></span>](how-to-add-a-definition-for-a-new-user-defined-field.md)

