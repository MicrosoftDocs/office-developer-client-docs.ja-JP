---
title: フォルダーフィールドストリームの構造
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
ms.assetid: edbc9e6c-008c-4c13-9a0c-cb47ac0f3686
description: '最終更新日時: 2015 年 3 月 9 日'
ms.openlocfilehash: 96051bd2b62fd7c0e908a1018aac0225e44986be
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/23/2019
ms.locfileid: "32336891"
---
# <a name="folder-fields-stream-structures"></a><span data-ttu-id="eb395-103">フォルダーフィールドストリームの構造</span><span class="sxs-lookup"><span data-stu-id="eb395-103">Folder Fields Stream Structures</span></span>

<span data-ttu-id="eb395-104">**適用対象**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="eb395-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="eb395-105">メッセージの[PidTagUserFields](pidtaguserfields-canonical-property.md)プロパティには、ユーザー定義フィールド定義のフォルダーが含まれているバイナリストリーム、folderuserfields が含まれています。</span><span class="sxs-lookup"><span data-stu-id="eb395-105">A message's [PidTagUserFields](pidtaguserfields-canonical-property.md) property contains a binary stream, FolderUserFields, which contains the folder user-defined field definitions.</span></span> <span data-ttu-id="eb395-106">このトピックでは、フォルダーのユーザー定義フィールド定義のストリーム構造について説明します。</span><span class="sxs-lookup"><span data-stu-id="eb395-106">This topic describes the stream structures for folder user-defined field definitions.</span></span> 

<span data-ttu-id="eb395-107">folderuserfields ストリーム構造は、folderuserfields dsa 構造または folderuserfields の dsa 構造のいずれかで構成され、その後に folderuserfields w 構造が続きます。</span><span class="sxs-lookup"><span data-stu-id="eb395-107">A FolderUserFields stream structure consists of either a FolderUserFieldsA structure or a FolderUserFieldsA structure followed by a FolderUserFieldsW structure.</span></span>
  
<span data-ttu-id="eb395-108">このストリームの Data 要素は、次の指定された順序で互いに直後に格納されます。</span><span class="sxs-lookup"><span data-stu-id="eb395-108">Data elements in this stream are stored immediately following each other in the following specified order:</span></span>
  
- <span data-ttu-id="eb395-109">**folderuserフィールド ansi**: folderuserな dsa ストリーム構造。</span><span class="sxs-lookup"><span data-stu-id="eb395-109">**FolderUserFieldsAnsi**: A FolderUserFieldsA stream structure.</span></span>
    
- <span data-ttu-id="eb395-110">**folderuserフィールド unicode**(オプション): folderuserフィールド w stream 構造。</span><span class="sxs-lookup"><span data-stu-id="eb395-110">**FolderUserFieldsUnicode** (optional): A FolderUserFieldsW stream structure.</span></span>
    
<span data-ttu-id="eb395-111">folderuserfields unicode が存在するかどうかは、folderuserfields ansi の長さを超える、folderuserfield の長さの合計によって検出されます。</span><span class="sxs-lookup"><span data-stu-id="eb395-111">The presence of FolderUserFieldsUnicode is detected by the total length of the FolderUserFields being greater than the length of FolderUserFieldsAnsi.</span></span>
  
> [!IMPORTANT]
> <span data-ttu-id="eb395-112">folderuserフィールド ansi は、古い、unicode 以外のバージョンの MAPI クライアントとの互換性を保つために使用されるため、folderuserフィールド Unicode が存在する場合、folderuserフィールド ansi の内容は無視されます。</span><span class="sxs-lookup"><span data-stu-id="eb395-112">FolderUserFieldsAnsi is used for compatibility with older, non-Unicode, versions of MAPI clients, therefore if FolderUserFieldsUnicode is present, the contents of FolderUserFieldsAnsi is ignored.</span></span> <span data-ttu-id="eb395-113">ANSI 変換でのデータ損失を回避するために、folderuserfields ストリームを作成する場合、常に folderuserfields w パーツが含まれています。</span><span class="sxs-lookup"><span data-stu-id="eb395-113">To avoid possible data loss in ANSI conversion, when creating a FolderUserFields stream always include the FolderUserFieldsW part.</span></span> 
  
## <a name="folderuserfieldsa-stream-structure"></a><span data-ttu-id="eb395-114">folderuseron dsa ストリーム構造</span><span class="sxs-lookup"><span data-stu-id="eb395-114">FolderUserFieldsA Stream Structure</span></span>

<span data-ttu-id="eb395-115">folderuseron dsa ストリーム構造は、folderuserfields 構造の folderuserfields w 部分でオーバーライドされない限り、Outlook フォルダー内のすべてのユーザー定義フィールドの定義を含む、folderuserfieldsa 配列です。</span><span class="sxs-lookup"><span data-stu-id="eb395-115">A FolderUserFieldsA stream structure is an array of FolderFieldDefinitionA stream structures that contain definitions for all user-defined fields in an Outlook folder, unless overridden by the FolderUserFieldsW part of the FolderUserFields structure.</span></span>
  
<span data-ttu-id="eb395-116">このストリームの Data 要素は、次の指定された順序で互いに直後に、リトルエンディアンバイト順に格納されます。</span><span class="sxs-lookup"><span data-stu-id="eb395-116">Data elements in this stream are stored in little-endian byte order, immediately following each other in the following specified order:</span></span>
  
- <span data-ttu-id="eb395-117">**fielddefinitioncount**: このストリーム内のフィールド定義の数である DWORD (4 バイト)。</span><span class="sxs-lookup"><span data-stu-id="eb395-117">**FieldDefinitionCount**: DWORD (4 bytes), the number of field definitions in this stream.</span></span> <span data-ttu-id="eb395-118">これは、 **fielddefinitions**配列内の要素の数です。</span><span class="sxs-lookup"><span data-stu-id="eb395-118">This is the count of elements in the **FieldDefinitions** array.</span></span>
    
- <span data-ttu-id="eb395-119">**fielddefinitions**: folderfielddefinitiona stream 構造体の配列。</span><span class="sxs-lookup"><span data-stu-id="eb395-119">**FieldDefinitions**: An array of FolderFieldDefinitionA stream structures.</span></span> <span data-ttu-id="eb395-120">この配列の数は、 **fielddefinitioncount** data 要素と同じです。</span><span class="sxs-lookup"><span data-stu-id="eb395-120">The count of this array is equal to the **FieldDefinitionCount** data element.</span></span>
    
<span data-ttu-id="eb395-121">この folderuserfieldsa が folderuserfields 構造の folderuserfields w 部分でオーバーライドされていない限り、 **fielddefinitions**配列は、最後の folderuserfieldsa の FieldType フィールドを同じにすることで、"null で終了" している必要があります。ftnull になります。</span><span class="sxs-lookup"><span data-stu-id="eb395-121">Unless this FolderUserFieldsA is overridden by the FolderUserFieldsW part of the FolderUserFields structure, the **FieldDefinitions** array must be "null-terminated" by having its last FolderFieldDefinitionA element's Common.FieldType field equal to ftNull.</span></span>
  
## <a name="folderuserfieldsw-stream-structure"></a><span data-ttu-id="eb395-122">folderuserフィールド w Stream 構造</span><span class="sxs-lookup"><span data-stu-id="eb395-122">FolderUserFieldsW Stream Structure</span></span>

<span data-ttu-id="eb395-123">folderuserfields w stream 構造は、Outlook フォルダー内のすべてのユーザー定義フィールドの定義を含む folderuserfieldsw stream 構造体の配列です。</span><span class="sxs-lookup"><span data-stu-id="eb395-123">A FolderUserFieldsW stream structure is an array of FolderFieldDefinitionW stream structures that contain definitions for all user-defined fields in an Outlook folder.</span></span>
  
<span data-ttu-id="eb395-124">このストリームの Data 要素は、次の指定された順序で互いに直後に、リトルエンディアンバイト順に格納されます。</span><span class="sxs-lookup"><span data-stu-id="eb395-124">Data elements in this stream are stored in little-endian byte order, immediately following each other in the following specified order:</span></span>
  
- <span data-ttu-id="eb395-125">**fielddefinitioncount**: このストリーム内のフィールド定義の数である DWORD (4 バイト)。</span><span class="sxs-lookup"><span data-stu-id="eb395-125">**FieldDefinitionCount**: DWORD (4 bytes), the number of field definitions in this stream.</span></span> <span data-ttu-id="eb395-126">これは、 **fielddefinitions**配列内の要素の数です。</span><span class="sxs-lookup"><span data-stu-id="eb395-126">This is the count of elements in the **FieldDefinitions** array.</span></span>
    
- <span data-ttu-id="eb395-127">**fielddefinitions**: folderfielddefinitionw ストリーム構造の配列。</span><span class="sxs-lookup"><span data-stu-id="eb395-127">**FieldDefinitions**: An array of FolderFieldDefinitionW stream structures.</span></span> <span data-ttu-id="eb395-128">この配列の数は、 **fielddefinitioncount** data 要素と同じです。</span><span class="sxs-lookup"><span data-stu-id="eb395-128">The count of this array is equal to the **FieldDefinitionCount** data element.</span></span>
    
<span data-ttu-id="eb395-129">**fielddefinitions**配列は、最後の folderfielddefinitionw 要素の FieldType フィールドが ftnull と同じになるように "null で終了" になる必要があります。</span><span class="sxs-lookup"><span data-stu-id="eb395-129">The **FieldDefinitions** array must be "null-terminated" by having its last FolderFieldDefinitionW element's Common.FieldType field equal to ftNull.</span></span>
  
## <a name="folderfielddefinitiona-stream-structure"></a><span data-ttu-id="eb395-130">folderfielddefinitiona 構造体</span><span class="sxs-lookup"><span data-stu-id="eb395-130">FolderFieldDefinitionA Stream Structure</span></span>

<span data-ttu-id="eb395-131">folderfielddefinitiona 構造体には、ANSI に格納されているフィールド名を持つユーザー定義フィールドの定義が含まれています。</span><span class="sxs-lookup"><span data-stu-id="eb395-131">A FolderFieldDefinitionA stream structure contains a definition of a user-defined field with the field name stored in ANSI.</span></span>
  
<span data-ttu-id="eb395-132">このストリームの Data 要素は、次の指定された順序で互いに直後に、リトルエンディアンバイト順に格納されます。</span><span class="sxs-lookup"><span data-stu-id="eb395-132">Data elements in this stream are stored in little-endian byte order, immediately following each other in the following specified order:</span></span>
  
- <span data-ttu-id="eb395-133">**FieldType**: fldtype (4 バイト) (このフィールドの型)。</span><span class="sxs-lookup"><span data-stu-id="eb395-133">**FieldType**: FldType (4 bytes), the type of this field.</span></span>
    
- <span data-ttu-id="eb395-134">**FieldNameLength**: WORD (2 バイト)、 **FieldName**配列内の要素の数。</span><span class="sxs-lookup"><span data-stu-id="eb395-134">**FieldNameLength**: WORD (2 bytes), the number of elements in the **FieldName** array.</span></span>
    
- <span data-ttu-id="eb395-135">**FieldName**: CHAR の配列。</span><span class="sxs-lookup"><span data-stu-id="eb395-135">**FieldName**: An array of CHAR.</span></span> <span data-ttu-id="eb395-136">これは、フィールド名を表す ANSI CP_ACP コードページの表現です。</span><span class="sxs-lookup"><span data-stu-id="eb395-136">This is the ANSI CP_ACP codepage representation of the field name.</span></span> <span data-ttu-id="eb395-137">この配列の数は、 **FieldNameLength**と同じです。</span><span class="sxs-lookup"><span data-stu-id="eb395-137">The count of this array is equal to **FieldNameLength**.</span></span> <span data-ttu-id="eb395-138">フィールド名は、 [UserProperties](https://msdn.microsoft.com/library/microsoft.office.interop.outlook.userproperties.add.aspx)メソッドで指定されているように、name パラメーターの制限を満たす必要があります。</span><span class="sxs-lookup"><span data-stu-id="eb395-138">The field name must satisfy the restrictions on the Name parameter as specified in the [UserProperties.Add](https://msdn.microsoft.com/library/microsoft.office.interop.outlook.userproperties.add.aspx) Method.</span></span> 
    
   > [!NOTE]
   > <span data-ttu-id="eb395-139">以前のバージョンとの互換性を保つために、Outlook では、これらの制限に該当しないいくつかの**フィールド名**値を処理することができますが、このような場合についてはこのトピックでは説明しません。</span><span class="sxs-lookup"><span data-stu-id="eb395-139">For reasons of legacy compatibility, Outlook may be able to handle some **FieldName** values not satisfying these restrictions, however such cases are not covered by this topic.</span></span> 
  
- <span data-ttu-id="eb395-140">**common**: folderfielddefinitioncommon stream 構造。</span><span class="sxs-lookup"><span data-stu-id="eb395-140">**Common**: A FolderFieldDefinitionCommon stream structure.</span></span>
    
## <a name="folderfielddefinitionw-stream-structure"></a><span data-ttu-id="eb395-141">folderfielddefinitionw Stream 構造</span><span class="sxs-lookup"><span data-stu-id="eb395-141">FolderFieldDefinitionW Stream Structure</span></span>

<span data-ttu-id="eb395-142">folderfielddefinitionw stream 構造には、Unicode に格納されているフィールド名を持つユーザー定義フィールドの定義が含まれています。</span><span class="sxs-lookup"><span data-stu-id="eb395-142">A FolderFieldDefinitionW stream structure contains a definition of a user-defined field with the field name stored in Unicode.</span></span>
  
<span data-ttu-id="eb395-143">このストリームの Data 要素は、次の指定された順序で互いに直後に、リトルエンディアンバイト順に格納されます。</span><span class="sxs-lookup"><span data-stu-id="eb395-143">Data elements in this stream are stored in little-endian byte order, immediately following each other in the following specified order:</span></span>
  
- <span data-ttu-id="eb395-144">**FieldType**: fldtype (4 バイト) (このフィールドの型)。</span><span class="sxs-lookup"><span data-stu-id="eb395-144">**FieldType**: FldType (4 bytes), the type of this field.</span></span>
    
- <span data-ttu-id="eb395-145">**FieldNameLength**: WORD (2 バイト)、 **FieldName**配列内の要素の数。</span><span class="sxs-lookup"><span data-stu-id="eb395-145">**FieldNameLength**: WORD (2 bytes), the number of elements in the **FieldName** array.</span></span>
    
- <span data-ttu-id="eb395-146">**FieldName**: WCHAR の配列。</span><span class="sxs-lookup"><span data-stu-id="eb395-146">**FieldName**: An array of WCHAR.</span></span> <span data-ttu-id="eb395-147">これは、フィールド名の Unicode (utf-16) 表現です。</span><span class="sxs-lookup"><span data-stu-id="eb395-147">This is the Unicode (UTF-16) representation of the field name.</span></span> <span data-ttu-id="eb395-148">この配列の数は、 **FieldNameLength**と同じです。</span><span class="sxs-lookup"><span data-stu-id="eb395-148">The count of this array is equal to **FieldNameLength**.</span></span> <span data-ttu-id="eb395-149">フィールド名は、 [UserProperties](https://msdn.microsoft.com/library/microsoft.office.interop.outlook.userproperties.add.aspx)メソッドで指定されているように、name パラメーターの制限を満たす必要があります。</span><span class="sxs-lookup"><span data-stu-id="eb395-149">The field name must satisfy the restrictions on the Name parameter as specified in the [UserProperties.Add](https://msdn.microsoft.com/library/microsoft.office.interop.outlook.userproperties.add.aspx) Method.</span></span> 
    
   > [!NOTE]
   > <span data-ttu-id="eb395-150">以前のバージョンとの互換性を保つために、Outlook では、これらの制限に該当しないいくつかの**フィールド名**値を処理することができますが、そのような場合にはこのトピックでは説明しません。</span><span class="sxs-lookup"><span data-stu-id="eb395-150">For reasons of legacy compatibility, Outlook may be able to handle some **FieldName** values not satisfying these restrictions, but such cases are not covered by this topic.</span></span> 
  
- <span data-ttu-id="eb395-151">**common**: folderfielddefinitioncommon stream 構造。</span><span class="sxs-lookup"><span data-stu-id="eb395-151">**Common**: A FolderFieldDefinitionCommon stream structure.</span></span>
    
## <a name="fldtype-enumeration"></a><span data-ttu-id="eb395-152">fldtype 列挙</span><span class="sxs-lookup"><span data-stu-id="eb395-152">FldType Enumeration</span></span>

<span data-ttu-id="eb395-153">次の表に、 **fldtype**列挙値を一覧表示します。</span><span class="sxs-lookup"><span data-stu-id="eb395-153">**FldType** enumeration values are listed in the following table.</span></span> 
  
|<span data-ttu-id="eb395-154">名前</span><span class="sxs-lookup"><span data-stu-id="eb395-154">Name</span></span>|<span data-ttu-id="eb395-155">値</span><span class="sxs-lookup"><span data-stu-id="eb395-155">Value</span></span>|<span data-ttu-id="eb395-156">意味</span><span class="sxs-lookup"><span data-stu-id="eb395-156">Meaning</span></span>|
|:-----|:-----|:-----|
|<span data-ttu-id="eb395-157">ftnull</span><span class="sxs-lookup"><span data-stu-id="eb395-157">ftNull</span></span>  <br/> |<span data-ttu-id="eb395-158">0x0</span><span class="sxs-lookup"><span data-stu-id="eb395-158">0x0</span></span>  <br/> |<span data-ttu-id="eb395-159">このフィールド型は、フィールド定義の配列を null で終了するために使用されます。</span><span class="sxs-lookup"><span data-stu-id="eb395-159">This field type is used to null-terminate an array of field definitions.</span></span>  <br/> |
|<span data-ttu-id="eb395-160">ftstring</span><span class="sxs-lookup"><span data-stu-id="eb395-160">ftString</span></span>  <br/> |<span data-ttu-id="eb395-161">0x1</span><span class="sxs-lookup"><span data-stu-id="eb395-161">0x1</span></span>  <br/> |<span data-ttu-id="eb395-162">テキスト</span><span class="sxs-lookup"><span data-stu-id="eb395-162">Text</span></span>  <br/> |
|<span data-ttu-id="eb395-163">ftinteger</span><span class="sxs-lookup"><span data-stu-id="eb395-163">ftInteger</span></span>  <br/> |<span data-ttu-id="eb395-164">0x3</span><span class="sxs-lookup"><span data-stu-id="eb395-164">0x3</span></span>  <br/> |<span data-ttu-id="eb395-165">整数</span><span class="sxs-lookup"><span data-stu-id="eb395-165">Integer</span></span>  <br/> |
|<span data-ttu-id="eb395-166">fttime</span><span class="sxs-lookup"><span data-stu-id="eb395-166">ftTime</span></span>  <br/> |<span data-ttu-id="eb395-167">0x5</span><span class="sxs-lookup"><span data-stu-id="eb395-167">0x5</span></span>  <br/> |<span data-ttu-id="eb395-168">日付/時刻</span><span class="sxs-lookup"><span data-stu-id="eb395-168">Date/Time</span></span>  <br/> |
|<span data-ttu-id="eb395-169">ftboolean</span><span class="sxs-lookup"><span data-stu-id="eb395-169">ftBoolean</span></span>  <br/> |<span data-ttu-id="eb395-170">0x6</span><span class="sxs-lookup"><span data-stu-id="eb395-170">0x6</span></span>  <br/> |<span data-ttu-id="eb395-171">Yes/No</span><span class="sxs-lookup"><span data-stu-id="eb395-171">Yes/No</span></span>  <br/> |
|<span data-ttu-id="eb395-172">ftduration</span><span class="sxs-lookup"><span data-stu-id="eb395-172">ftDuration</span></span>  <br/> |<span data-ttu-id="eb395-173">0x7</span><span class="sxs-lookup"><span data-stu-id="eb395-173">0x7</span></span>  <br/> |<span data-ttu-id="eb395-174">期間</span><span class="sxs-lookup"><span data-stu-id="eb395-174">Duration</span></span>  <br/> |
|<span data-ttu-id="eb395-175">ftmultistring</span><span class="sxs-lookup"><span data-stu-id="eb395-175">ftMultiString</span></span>  <br/> |<span data-ttu-id="eb395-176">0xB</span><span class="sxs-lookup"><span data-stu-id="eb395-176">0xB</span></span>  <br/> |<span data-ttu-id="eb395-177">キーワード</span><span class="sxs-lookup"><span data-stu-id="eb395-177">Keywords</span></span>  <br/> |
|<span data-ttu-id="eb395-178">ftfloat</span><span class="sxs-lookup"><span data-stu-id="eb395-178">ftFloat</span></span>  <br/> |<span data-ttu-id="eb395-179">0xC</span><span class="sxs-lookup"><span data-stu-id="eb395-179">0xC</span></span>  <br/> |<span data-ttu-id="eb395-180">数値またはパーセント</span><span class="sxs-lookup"><span data-stu-id="eb395-180">Number or Percent</span></span>  <br/> |
|<span data-ttu-id="eb395-181">ftcurrency</span><span class="sxs-lookup"><span data-stu-id="eb395-181">ftCurrency</span></span>  <br/> |<span data-ttu-id="eb395-182">0xe</span><span class="sxs-lookup"><span data-stu-id="eb395-182">0xE</span></span>  <br/> |<span data-ttu-id="eb395-183">通貨</span><span class="sxs-lookup"><span data-stu-id="eb395-183">Currency</span></span>  <br/> |
|<span data-ttu-id="eb395-184">ftcalc</span><span class="sxs-lookup"><span data-stu-id="eb395-184">ftCalc</span></span>  <br/> |<span data-ttu-id="eb395-185">0x12</span><span class="sxs-lookup"><span data-stu-id="eb395-185">0x12</span></span>  <br/> |<span data-ttu-id="eb395-186">Formula</span><span class="sxs-lookup"><span data-stu-id="eb395-186">Formula</span></span>  <br/> |
|<span data-ttu-id="eb395-187">ftswitch</span><span class="sxs-lookup"><span data-stu-id="eb395-187">ftSwitch</span></span>  <br/> |<span data-ttu-id="eb395-188">0x13</span><span class="sxs-lookup"><span data-stu-id="eb395-188">0x13</span></span>  <br/> |<span data-ttu-id="eb395-189">最初の空ではないフィールドのみを示す型の組み合わせ。これ以降のフィールドは無視されます。</span><span class="sxs-lookup"><span data-stu-id="eb395-189">Combination of type showing only the first non-empty field - ignoring subsequent ones.</span></span>  <br/> |
|<span data-ttu-id="eb395-190">ftconcat</span><span class="sxs-lookup"><span data-stu-id="eb395-190">ftConcat</span></span>  <br/> |<span data-ttu-id="eb395-191">0x17</span><span class="sxs-lookup"><span data-stu-id="eb395-191">0x17</span></span>  <br/> |<span data-ttu-id="eb395-192">種類を結合するフィールドと、テキストフラグメントを相互に組み合わせたもの。</span><span class="sxs-lookup"><span data-stu-id="eb395-192">Combination of type joining fields and any text fragments to each other.</span></span>  <br/> |
   
## <a name="folderfielddefinitioncommon-stream-structure"></a><span data-ttu-id="eb395-193">folderfielddefinitioncommon Stream 構造</span><span class="sxs-lookup"><span data-stu-id="eb395-193">FolderFieldDefinitionCommon Stream Structure</span></span>

<span data-ttu-id="eb395-194">folderfielddefinitioncommon stream 構造には、folderfielddefinitioncommon と folderfielddefinitioncommon の両方に共通するユーザー定義のフィールド定義のデータが含まれています。</span><span class="sxs-lookup"><span data-stu-id="eb395-194">A FolderFieldDefinitionCommon stream structure contains the data of a user-defined field definition that is common to both a FolderFieldDefinitionA and a FolderFieldDefinitionW.</span></span>
  
<span data-ttu-id="eb395-195">このストリームの Data 要素は、次の指定された順序で互いに直後に、リトルエンディアンバイト順に格納されます。</span><span class="sxs-lookup"><span data-stu-id="eb395-195">Data elements in this stream are stored in little-endian byte order, immediately following each other in the following specified order:</span></span>
  
- <span data-ttu-id="eb395-196">**propsetguid**: guid (16 バイト)。このプロパティには、フォルダーフィールドの対応する MAPI プロパティ名の guid が設定されます。</span><span class="sxs-lookup"><span data-stu-id="eb395-196">**PropSetGuid**: GUID (16 bytes), the property set GUID of the folder field's corresponding MAPI property name.</span></span> <span data-ttu-id="eb395-197">このフィールドの値は、PS_PUBLIC_STRINGS に等しくなければなりません。ただし、フィールドの種類が**ftnone**の場合、このフィールドの値は GUID_NULL と同じでなければなりません。</span><span class="sxs-lookup"><span data-stu-id="eb395-197">This field's value must be equal to PS_PUBLIC_STRINGS, unless the field type is **ftNone** in which case this field's value must be equal to GUID_NULL.</span></span> 
    
   > [!NOTE]
   > <span data-ttu-id="eb395-198">以前のバージョンとの互換性を保つために、Outlook では、この制限に該当しない**propsetguid**値の一部を処理できることがありますが、このような場合はこのトピックでは説明しません。</span><span class="sxs-lookup"><span data-stu-id="eb395-198">For reasons of legacy compatibility, Outlook may be able to handle some **PropSetGuid** values not satisfying this restriction, however such cases are not covered by this topic.</span></span> 
  
- <span data-ttu-id="eb395-199">**fcapm**: DWORD (4 バイト) (0 個以上のフラグの組み合わせ) 次の表に、値と意味を示します。</span><span class="sxs-lookup"><span data-stu-id="eb395-199">**fcapm**: DWORD (4 bytes), a combination of zero or more flags the values of which and meanings are listed in the following table.</span></span> <span data-ttu-id="eb395-200">同じ値を持つフラグは、フィールドの型、つまり fldtype の値に依存する意味を持っています。</span><span class="sxs-lookup"><span data-stu-id="eb395-200">Flags with the same value have meanings dependent on the field's type, that is, FldType value.</span></span>
    
    |<span data-ttu-id="eb395-201">フラグ名</span><span class="sxs-lookup"><span data-stu-id="eb395-201">Flag name</span></span>|<span data-ttu-id="eb395-202">値</span><span class="sxs-lookup"><span data-stu-id="eb395-202">Value</span></span>|<span data-ttu-id="eb395-203">意味</span><span class="sxs-lookup"><span data-stu-id="eb395-203">Meaning</span></span>|
    |:-----|:-----|:-----|
    |<span data-ttu-id="eb395-204">FCAPM_CAN_EDIT</span><span class="sxs-lookup"><span data-stu-id="eb395-204">FCAPM_CAN_EDIT</span></span>  <br/> |<span data-ttu-id="eb395-205">0x00000001</span><span class="sxs-lookup"><span data-stu-id="eb395-205">0x00000001</span></span>  <br/> |<span data-ttu-id="eb395-206">フィールドは編集できます。</span><span class="sxs-lookup"><span data-stu-id="eb395-206">The field is editable.</span></span>  <br/> |
    |<span data-ttu-id="eb395-207">FCAPM_CAN_SORT</span><span class="sxs-lookup"><span data-stu-id="eb395-207">FCAPM_CAN_SORT</span></span>  <br/> |<span data-ttu-id="eb395-208">0x00000002</span><span class="sxs-lookup"><span data-stu-id="eb395-208">0x00000002</span></span>  <br/> |<span data-ttu-id="eb395-209">フィールドは並べ替え可能です。</span><span class="sxs-lookup"><span data-stu-id="eb395-209">The field is sortable.</span></span>  <br/> |
    |<span data-ttu-id="eb395-210">FCAPM_CAN_GROUP</span><span class="sxs-lookup"><span data-stu-id="eb395-210">FCAPM_CAN_GROUP</span></span>  <br/> |<span data-ttu-id="eb395-211">0x00000004</span><span class="sxs-lookup"><span data-stu-id="eb395-211">0x00000004</span></span>  <br/> |<span data-ttu-id="eb395-212">フィールドは groupable です。</span><span class="sxs-lookup"><span data-stu-id="eb395-212">The field is groupable.</span></span>  <br/> |
    |<span data-ttu-id="eb395-213">FCAPM_MULTILINE_TEXT</span><span class="sxs-lookup"><span data-stu-id="eb395-213">FCAPM_MULTILINE_TEXT</span></span>  <br/> |<span data-ttu-id="eb395-214">0x00000100</span><span class="sxs-lookup"><span data-stu-id="eb395-214">0x00000100</span></span>  <br/> |<span data-ttu-id="eb395-215">フィールドには複数行のテキストを含めることができます。</span><span class="sxs-lookup"><span data-stu-id="eb395-215">The field can hold multiple lines of text.</span></span>  <br/> |
    |<span data-ttu-id="eb395-216">FCAPM_PERCENT</span><span class="sxs-lookup"><span data-stu-id="eb395-216">FCAPM_PERCENT</span></span>  <br/> |<span data-ttu-id="eb395-217">0x01000000</span><span class="sxs-lookup"><span data-stu-id="eb395-217">0x01000000</span></span>  <br/> |<span data-ttu-id="eb395-218">ftfloat 型のこのフィールドは、パーセンテージフィールドです。</span><span class="sxs-lookup"><span data-stu-id="eb395-218">This field of the type ftFloat is a percentage field.</span></span>  <br/> |
    |<span data-ttu-id="eb395-219">FCAPM_DATEONLY</span><span class="sxs-lookup"><span data-stu-id="eb395-219">FCAPM_DATEONLY</span></span>  <br/> |<span data-ttu-id="eb395-220">0x01000000</span><span class="sxs-lookup"><span data-stu-id="eb395-220">0x01000000</span></span>  <br/> |<span data-ttu-id="eb395-221">fttime 型のこのフィールドは、日付のみの時間フィールドです。</span><span class="sxs-lookup"><span data-stu-id="eb395-221">This field of the type ftTime is a date-only time field.</span></span>  <br/> |
    |<span data-ttu-id="eb395-222">FCAPM_UNITLESS</span><span class="sxs-lookup"><span data-stu-id="eb395-222">FCAPM_UNITLESS</span></span>  <br/> |<span data-ttu-id="eb395-223">0x01000000</span><span class="sxs-lookup"><span data-stu-id="eb395-223">0x01000000</span></span>  <br/> |<span data-ttu-id="eb395-224">ftinteger 型のこのフィールドでは、表示形式では単位を使用できません。たとえば、"Computer-640 K..." のような形式を使用します。許可されていません。</span><span class="sxs-lookup"><span data-stu-id="eb395-224">For this field of the type ftInteger, no unit is allowed in display format; for example such formats as "Computer - 640 K…" are not allowed.</span></span>  <br/> |
    |<span data-ttu-id="eb395-225">FCAPM_CAN_EDIT_IN_ITEM</span><span class="sxs-lookup"><span data-stu-id="eb395-225">FCAPM_CAN_EDIT_IN_ITEM</span></span>  <br/> |<span data-ttu-id="eb395-226">0x80000000</span><span class="sxs-lookup"><span data-stu-id="eb395-226">0x80000000</span></span>  <br/> |<span data-ttu-id="eb395-227">このフィールドは、アイテム内で編集できます。これは、特にユーザー設定フォームの場合です。</span><span class="sxs-lookup"><span data-stu-id="eb395-227">The field can be edited in the item: This is specifically for custom forms.</span></span>  <br/> |
   
- <span data-ttu-id="eb395-228">**dwstring**: DWORD (4 バイト)。</span><span class="sxs-lookup"><span data-stu-id="eb395-228">**dwString**: DWORD (4 bytes).</span></span> <span data-ttu-id="eb395-229">最初の次の注を参照してください。</span><span class="sxs-lookup"><span data-stu-id="eb395-229">See the first following Note.</span></span>
    
- <span data-ttu-id="eb395-230">**dwbitmap**: DWORD (4 バイト)。</span><span class="sxs-lookup"><span data-stu-id="eb395-230">**dwBitmap**: DWORD (4 bytes).</span></span> <span data-ttu-id="eb395-231">最初の次の注を参照してください。</span><span class="sxs-lookup"><span data-stu-id="eb395-231">See the first following Note.</span></span>
    
- <span data-ttu-id="eb395-232">**dwdisplay**: DWORD (4 バイト)。</span><span class="sxs-lookup"><span data-stu-id="eb395-232">**dwDisplay**: DWORD (4 bytes).</span></span> <span data-ttu-id="eb395-233">最初の次の注を参照してください。</span><span class="sxs-lookup"><span data-stu-id="eb395-233">See the first following Note.</span></span>
    
- <span data-ttu-id="eb395-234">**ifmt**: INT (4 バイト)。</span><span class="sxs-lookup"><span data-stu-id="eb395-234">**iFmt**: INT (4 bytes).</span></span> <span data-ttu-id="eb395-235">[新しいフィールド]、[編集フィールド]、および [フィールドプロパティ] ダイアログボックスに "Format:" というコンボボックスがあるフィールドの種類については、そのコンボボックスで選択されている形式の0から始まるインデックス番号を指定します。</span><span class="sxs-lookup"><span data-stu-id="eb395-235">For the field types that have the "Format:" combo box in the "New Field", "Edit Field", and "Field Properties" dialogs, the 0-based index of the format selected in that combo box.</span></span> <span data-ttu-id="eb395-236">そのコンボボックスのないフィールド型の場合は、0である必要があります。</span><span class="sxs-lookup"><span data-stu-id="eb395-236">For the field types without that combo box, this must be 0.</span></span> <span data-ttu-id="eb395-237">フィールド型の値を使用して、 **dwstring**、 **dwstring**、および**dwstring**の各フィールドの値を一意に特定するには、最初に次の注意事項を参照してください。</span><span class="sxs-lookup"><span data-stu-id="eb395-237">The field's value together with the field type uniquely determine the values of the **dwString**, **dwBitmap**, and **dwDisplay** fields, see the first following Note.</span></span>
    
- <span data-ttu-id="eb395-238">**wszFormulaLength**: WORD (2 バイト)。 **wszFormulaLength**配列内の要素の数。</span><span class="sxs-lookup"><span data-stu-id="eb395-238">**wszFormulaLength**: WORD (2 bytes), the number of elements in the **wszFormulaLength** array.</span></span>
    
- <span data-ttu-id="eb395-239">**wszFormulaLength**: WCHAR の配列。</span><span class="sxs-lookup"><span data-stu-id="eb395-239">**wszFormulaLength**: An array of WCHAR.</span></span> <span data-ttu-id="eb395-240">これは、標準形式でのフィールドの数式文字列の Unicode (utf-16) 表現です。</span><span class="sxs-lookup"><span data-stu-id="eb395-240">This is the Unicode (UTF-16) representation of the field's formula string in its standard format.</span></span> <span data-ttu-id="eb395-241">フィールドの数式の標準および UI 書式の説明については、2番目の注意事項を参照してください。</span><span class="sxs-lookup"><span data-stu-id="eb395-241">See the second following Note for the description of the standard and UI formats of a field's formula.</span></span> <span data-ttu-id="eb395-242">この配列の数は、 **wszFormulaLength**と同じです。</span><span class="sxs-lookup"><span data-stu-id="eb395-242">The count of this array is equal to **wszFormulaLength**.</span></span> <span data-ttu-id="eb395-243">フィールド型が**ftcalc**、 **ftcalc** 、または**ftcalc**の場合を除き、式の文字列は空の文字列である必要があります。</span><span class="sxs-lookup"><span data-stu-id="eb395-243">The formula string must be an empty string unless the field type is **ftCalc**, **ftSwitch** or **ftConcat**.</span></span>
    
> [!NOTE]
> <span data-ttu-id="eb395-244">**dwstring**、 **dwstring**、および**dwstring**の値は、 **fldtype**の値および**ifmt**値に基づいて一意に決定されますが、適切な値は正しい値になる必要があります。Outlook によるフィールド定義の処理。</span><span class="sxs-lookup"><span data-stu-id="eb395-244">Although the values of **dwString**, **dwBitmap**, and **dwDisplay** are uniquely determined based on the **FldType** value and the **iFmt** value, which are redundant, their correct values are still necessary for correct processing of the field definition by Outlook.</span></span> <span data-ttu-id="eb395-245">この判断を実行するアルゴリズムの簡単な説明はありません。</span><span class="sxs-lookup"><span data-stu-id="eb395-245">There is no simple description of the algorithm that performs this determination.</span></span> 
> 
> <span data-ttu-id="eb395-246">そのため、指定した**fldtype**値および**ifmt**値に対応する**dwstring**、 **dwstring**、および**dwstring**の値を確認するには、その種類のユーザー定義フィールドを作成し、その形式を選択してテストを実行します。適用性を想定して、[**書式**] コンボボックスで、ユーザー定義フィールドに対して Outlook によって作成された結果の**folderuserfields**ストリームを調べます。</span><span class="sxs-lookup"><span data-stu-id="eb395-246">Therefore, to find out which **dwString**, **dwBitmap**, and **dwDisplay** values correspond to a given **FldType** value and **iFmt** value, perform a test by creating a user-defined field of that type, and with that format selected in the **Format** combo box, assuming its applicability, inspect the resulting **FolderUserFields** stream that Outlook creates for that user-defined field.</span></span> 
  
<span data-ttu-id="eb395-247">UI 形式のフィールドの数式は、ユーザー定義フィールドの [**新規フィールド**]、[**編集フィールド**]、および [**フィールドプロパティ**] ダイアログボックスの [**式**] テキストボックスで編集されます。</span><span class="sxs-lookup"><span data-stu-id="eb395-247">The field's formula in its UI format is edited in the **Formula** text box of the **New Field**, **Edit Field**, and **Field Properties** dialogs for the user-defined field.</span></span> <span data-ttu-id="eb395-248">次に示すように、UI 形式から標準形式に数式を変換するアルゴリズムは、フィールドの種類によって異なります。</span><span class="sxs-lookup"><span data-stu-id="eb395-248">The algorithm to convert a formula from the UI format to the standard format depends on the field type as described in the following:</span></span> 
- <span data-ttu-id="eb395-249">種類が**ftcalc**および**ftcalc**のフィールドについては、組み込みフィールドの標準形式 (対応する MAPI プロパティは、kind MNID\_STRING のプロパティと名前が付けられていません) は`[<field_name>]` 、フィールド名のフラグメントを置換することによって取得されます。フラグメント`[_<field_dispid_decimal>]`を使用します。</span><span class="sxs-lookup"><span data-stu-id="eb395-249">For fields of types **ftCalc** and **ftSwitch**, the standard format for built-in fields, which corresponding MAPI properties are not named properties of the kind MNID\_STRING, is obtained by replacing field name fragments, that is `[<field_name>]` with fragments `[_<field_dispid_decimal>]`.</span></span> 

  <span data-ttu-id="eb395-250">たとえば、 **ftcalc**という名前の`[Business Phone] & [My custom field]`**式**のフィールドに対する式の UI 書式が、Office UI 言語が英語`My custom field`の場合、ユーザー定義フィールドの名前である場合、そのような数式の標準形式は次のようになります。`[_14856] & [My custom field]`.</span><span class="sxs-lookup"><span data-stu-id="eb395-250">For example, if the UI format of a formula for a field of the type **Formula**, that is **ftCalc**, with the Office UI language being US English, is `[Business Phone] & [My custom field]`, where `My custom field` is the name of a user-defined field, the standard format of such a formula would be `[_14856] & [My custom field]`.</span></span>

- <span data-ttu-id="eb395-251">型**ftconcat**のフィールドについては、次の手順を実行して標準形式を取得します。</span><span class="sxs-lookup"><span data-stu-id="eb395-251">For fields of the type **ftConcat**, the standard format is obtained by performing the following:</span></span>

  1. <span data-ttu-id="eb395-252">先頭および末尾の空白文字を切り捨てます。</span><span class="sxs-lookup"><span data-stu-id="eb395-252">Truncate leading and trailing whitespace.</span></span> 
  2. <span data-ttu-id="eb395-253">数式を解析して、次の2種類の一連のフラグメントにします。</span><span class="sxs-lookup"><span data-stu-id="eb395-253">Parse the formula into a sequence of fragments of the following two kinds:</span></span> 
     - <span data-ttu-id="eb395-254">角かっこで囲まれたフィールド名 (つまり`[<field_name>]`、)。</span><span class="sxs-lookup"><span data-stu-id="eb395-254">A field name in square brackets, that is, `[<field_name>]`.</span></span> 
     - <span data-ttu-id="eb395-255">角かっこが含まれていない部分文字列。</span><span class="sxs-lookup"><span data-stu-id="eb395-255">A substring not containing any square brackets.</span></span>   
      <span data-ttu-id="eb395-256">2番目の種類の2つのフラグメントがシーケンス内で隣接していないことを保証します。</span><span class="sxs-lookup"><span data-stu-id="eb395-256">Assure that no two fragments of the second kind are adjacent in the sequence.</span></span> <span data-ttu-id="eb395-257">この方法で数式を解析できない場合は、無効であると見なされます。</span><span class="sxs-lookup"><span data-stu-id="eb395-257">If the formula cannot be parsed this way, it is considered invalid.</span></span> 
  3. <span data-ttu-id="eb395-258">**ftcalc**フィールドおよび**ftcalc**フィールドに対して、最初の種類のフラグメントに対して同じ置換を実行します。</span><span class="sxs-lookup"><span data-stu-id="eb395-258">Perform the same replacement for fragments of the first kind as for the **ftCalc** and **ftSwitch** fields.</span></span> 
  4. <span data-ttu-id="eb395-259">2番目の種類の各フラグメントに対して、二重引用符 ("") 文字がある場合は、二重引用符を2つ続けてエスケープし、二重引用符で囲みます。</span><span class="sxs-lookup"><span data-stu-id="eb395-259">For each fragment of the second kind, escape all double-quote (""") characters, if any, with two consecutive double-quote characters, and enclose it in double quotes.</span></span> 
  5. <span data-ttu-id="eb395-260">隣接する一連のフラグメント`&`間に、アンパサンド文字列 () を挿入します。</span><span class="sxs-lookup"><span data-stu-id="eb395-260">Insert an ampersand string (`&`) between each pair of adjacent fragments.</span></span>
 
  <span data-ttu-id="eb395-261">たとえば、「 **ftconcat** `text1 [Business Phone] "text2" [My custom field]` `My custom field` 」という型のフィールドの数式の ui 形式を使用している場合、このような数式の標準形式は、Office UI 言語の英語 (米国) を使用して`""text1" & [_14856] & """text2""" & [My custom field]"`います。</span><span class="sxs-lookup"><span data-stu-id="eb395-261">For example, using the Office UI language US English, if the UI format of a formula for a field of the type **ftConcat** is `text1 [Business Phone] "text2" [My custom field]`, where `My custom field` is the name of a user-defined field, the standard format for such a formula would be `""text1" & [_14856] & """text2""" & [My custom field]"`.</span></span> 
  
## <a name="see-also"></a><span data-ttu-id="eb395-262">関連項目</span><span class="sxs-lookup"><span data-stu-id="eb395-262">See also</span></span>

- [<span data-ttu-id="eb395-263">folderuserfields ストリームのサンプル</span><span class="sxs-lookup"><span data-stu-id="eb395-263">FolderUserFields Stream Sample</span></span>](folderuserfields-stream-sample.md)
- [<span data-ttu-id="eb395-264">新しいユーザー定義フィールドの定義を追加する</span><span class="sxs-lookup"><span data-stu-id="eb395-264">Add a Definition for a New User-Defined Field</span></span>](how-to-add-a-definition-for-a-new-user-defined-field.md)

