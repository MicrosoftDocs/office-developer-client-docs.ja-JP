---
title: フォルダー フィールド ストリーム構造
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
ms.assetid: edbc9e6c-008c-4c13-9a0c-cb47ac0f3686
description: '最終更新日: 2015 年 3 月 9 日'
ms.openlocfilehash: 96051bd2b62fd7c0e908a1018aac0225e44986be
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/23/2019
ms.locfileid: "32336891"
---
# <a name="folder-fields-stream-structures"></a><span data-ttu-id="096f5-103">フォルダー フィールド ストリーム構造</span><span class="sxs-lookup"><span data-stu-id="096f5-103">Folder Fields Stream Structures</span></span>

<span data-ttu-id="096f5-104">**適用対象**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="096f5-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="096f5-105">メッセージの [PidTagUserFields](pidtaguserfields-canonical-property.md) プロパティには、フォルダーのユーザー定義フィールド定義を含むバイナリ ストリーム FolderUserFields が含まれます。</span><span class="sxs-lookup"><span data-stu-id="096f5-105">A message's [PidTagUserFields](pidtaguserfields-canonical-property.md) property contains a binary stream, FolderUserFields, which contains the folder user-defined field definitions.</span></span> <span data-ttu-id="096f5-106">このトピックでは、フォルダーのユーザー定義フィールド定義のストリーム構造について説明します。</span><span class="sxs-lookup"><span data-stu-id="096f5-106">This topic describes the stream structures for folder user-defined field definitions.</span></span> 

<span data-ttu-id="096f5-107">FolderUserFields ストリーム構造は、FolderUserFieldsA 構造体または FolderUserFieldsA 構造体の後に FolderUserFieldsW 構造体で構成されます。</span><span class="sxs-lookup"><span data-stu-id="096f5-107">A FolderUserFields stream structure consists of either a FolderUserFieldsA structure or a FolderUserFieldsA structure followed by a FolderUserFieldsW structure.</span></span>
  
<span data-ttu-id="096f5-108">このストリーム内のデータ要素は、次の指定された順序で、お互いに直後に格納されます。</span><span class="sxs-lookup"><span data-stu-id="096f5-108">Data elements in this stream are stored immediately following each other in the following specified order:</span></span>
  
- <span data-ttu-id="096f5-109">**FolderUserFieldsAnsi**: FolderUserFieldsA ストリーム構造。</span><span class="sxs-lookup"><span data-stu-id="096f5-109">**FolderUserFieldsAnsi**: A FolderUserFieldsA stream structure.</span></span>
    
- <span data-ttu-id="096f5-110">**FolderUserFieldsUnicode** (省略可能): FolderUserFieldsW ストリーム構造。</span><span class="sxs-lookup"><span data-stu-id="096f5-110">**FolderUserFieldsUnicode** (optional): A FolderUserFieldsW stream structure.</span></span>
    
<span data-ttu-id="096f5-111">FolderUserFieldsUnicode の存在は、FolderUserFieldsAnsi の長さよりも大きい FolderUserFields の合計長によって検出されます。</span><span class="sxs-lookup"><span data-stu-id="096f5-111">The presence of FolderUserFieldsUnicode is detected by the total length of the FolderUserFields being greater than the length of FolderUserFieldsAnsi.</span></span>
  
> [!IMPORTANT]
> <span data-ttu-id="096f5-112">FolderUserFieldsAnsi は、古いバージョンの Unicode 以外の MAPI クライアントとの互換性のために使用されるため、FolderUserFieldsUnicode が存在する場合、FolderUserFieldsAnsi の内容は無視されます。</span><span class="sxs-lookup"><span data-stu-id="096f5-112">FolderUserFieldsAnsi is used for compatibility with older, non-Unicode, versions of MAPI clients, therefore if FolderUserFieldsUnicode is present, the contents of FolderUserFieldsAnsi is ignored.</span></span> <span data-ttu-id="096f5-113">ANSI 変換でデータが失われる可能性を回避するには、FolderUserFields ストリームを作成するときに必ず FolderUserFieldsW パーツを含める必要があります。</span><span class="sxs-lookup"><span data-stu-id="096f5-113">To avoid possible data loss in ANSI conversion, when creating a FolderUserFields stream always include the FolderUserFieldsW part.</span></span> 
  
## <a name="folderuserfieldsa-stream-structure"></a><span data-ttu-id="096f5-114">FolderUserFieldsA ストリーム構造</span><span class="sxs-lookup"><span data-stu-id="096f5-114">FolderUserFieldsA Stream Structure</span></span>

<span data-ttu-id="096f5-115">FolderUserFieldsA ストリーム構造は、FolderUserFields 構造体の FolderUserFieldsW 部分によってオーバーライドされない限り、Outlook フォルダー内のすべてのユーザー定義フィールドの定義を含む FolderFieldDefinitionA ストリーム構造の配列です。</span><span class="sxs-lookup"><span data-stu-id="096f5-115">A FolderUserFieldsA stream structure is an array of FolderFieldDefinitionA stream structures that contain definitions for all user-defined fields in an Outlook folder, unless overridden by the FolderUserFieldsW part of the FolderUserFields structure.</span></span>
  
<span data-ttu-id="096f5-116">このストリームのデータ要素は、次の指定された順序で互いに直後に続く、リトル エンディアン バイト順に格納されます。</span><span class="sxs-lookup"><span data-stu-id="096f5-116">Data elements in this stream are stored in little-endian byte order, immediately following each other in the following specified order:</span></span>
  
- <span data-ttu-id="096f5-117">**FieldDefinitionCount**: DWORD (4 バイト)、このストリーム内のフィールド定義の数。</span><span class="sxs-lookup"><span data-stu-id="096f5-117">**FieldDefinitionCount**: DWORD (4 bytes), the number of field definitions in this stream.</span></span> <span data-ttu-id="096f5-118">これは **、FieldDefinitions 配列内の要素の数** です。</span><span class="sxs-lookup"><span data-stu-id="096f5-118">This is the count of elements in the **FieldDefinitions** array.</span></span>
    
- <span data-ttu-id="096f5-119">**FieldDefinitions**: FolderFieldDefinitionA ストリーム構造の配列。</span><span class="sxs-lookup"><span data-stu-id="096f5-119">**FieldDefinitions**: An array of FolderFieldDefinitionA stream structures.</span></span> <span data-ttu-id="096f5-120">この配列の数は **、FieldDefinitionCount データ要素と** 等しくなります。</span><span class="sxs-lookup"><span data-stu-id="096f5-120">The count of this array is equal to the **FieldDefinitionCount** data element.</span></span>
    
<span data-ttu-id="096f5-121">この FolderUserFieldsA が FolderUserFields 構造体の FolderUserFieldsW 部分によってオーバーライドされない限り **、FieldDefinitions** 配列は、最後の FolderFieldDefinitionA 要素の Common.FieldType フィールドを ftNull に等しくすることで"null-terminated" である必要があります。</span><span class="sxs-lookup"><span data-stu-id="096f5-121">Unless this FolderUserFieldsA is overridden by the FolderUserFieldsW part of the FolderUserFields structure, the **FieldDefinitions** array must be "null-terminated" by having its last FolderFieldDefinitionA element's Common.FieldType field equal to ftNull.</span></span>
  
## <a name="folderuserfieldsw-stream-structure"></a><span data-ttu-id="096f5-122">FolderUserFieldsW ストリーム構造</span><span class="sxs-lookup"><span data-stu-id="096f5-122">FolderUserFieldsW Stream Structure</span></span>

<span data-ttu-id="096f5-123">FolderUserFieldsW ストリーム構造は、Outlook フォルダー内のすべてのユーザー定義フィールドの定義を含む FolderFieldDefinitionW ストリーム構造の配列です。</span><span class="sxs-lookup"><span data-stu-id="096f5-123">A FolderUserFieldsW stream structure is an array of FolderFieldDefinitionW stream structures that contain definitions for all user-defined fields in an Outlook folder.</span></span>
  
<span data-ttu-id="096f5-124">このストリームのデータ要素は、次の指定された順序で互いに直後に続く、リトル エンディアン バイト順に格納されます。</span><span class="sxs-lookup"><span data-stu-id="096f5-124">Data elements in this stream are stored in little-endian byte order, immediately following each other in the following specified order:</span></span>
  
- <span data-ttu-id="096f5-125">**FieldDefinitionCount**: DWORD (4 バイト)、このストリーム内のフィールド定義の数。</span><span class="sxs-lookup"><span data-stu-id="096f5-125">**FieldDefinitionCount**: DWORD (4 bytes), the number of field definitions in this stream.</span></span> <span data-ttu-id="096f5-126">これは **、FieldDefinitions 配列内の要素の数** です。</span><span class="sxs-lookup"><span data-stu-id="096f5-126">This is the count of elements in the **FieldDefinitions** array.</span></span>
    
- <span data-ttu-id="096f5-127">**FieldDefinitions**: FolderFieldDefinitionW ストリーム構造の配列。</span><span class="sxs-lookup"><span data-stu-id="096f5-127">**FieldDefinitions**: An array of FolderFieldDefinitionW stream structures.</span></span> <span data-ttu-id="096f5-128">この配列の数は **、FieldDefinitionCount データ要素と** 等しくなります。</span><span class="sxs-lookup"><span data-stu-id="096f5-128">The count of this array is equal to the **FieldDefinitionCount** data element.</span></span>
    
<span data-ttu-id="096f5-129">**FieldDefinitions** 配列は、最後の FolderFieldDefinitionW 要素の Common.FieldType フィールドが ftNull に等しくなります。</span><span class="sxs-lookup"><span data-stu-id="096f5-129">The **FieldDefinitions** array must be "null-terminated" by having its last FolderFieldDefinitionW element's Common.FieldType field equal to ftNull.</span></span>
  
## <a name="folderfielddefinitiona-stream-structure"></a><span data-ttu-id="096f5-130">FolderFieldDefinitionA ストリーム構造</span><span class="sxs-lookup"><span data-stu-id="096f5-130">FolderFieldDefinitionA Stream Structure</span></span>

<span data-ttu-id="096f5-131">FolderFieldDefinitionA ストリーム構造には、ANSI に格納されているフィールド名を持つユーザー定義フィールドの定義が含まれます。</span><span class="sxs-lookup"><span data-stu-id="096f5-131">A FolderFieldDefinitionA stream structure contains a definition of a user-defined field with the field name stored in ANSI.</span></span>
  
<span data-ttu-id="096f5-132">このストリームのデータ要素は、次の指定された順序で互いに直後に続く、リトル エンディアン バイト順に格納されます。</span><span class="sxs-lookup"><span data-stu-id="096f5-132">Data elements in this stream are stored in little-endian byte order, immediately following each other in the following specified order:</span></span>
  
- <span data-ttu-id="096f5-133">**FieldType**: FldType (4 バイト)、このフィールドの種類。</span><span class="sxs-lookup"><span data-stu-id="096f5-133">**FieldType**: FldType (4 bytes), the type of this field.</span></span>
    
- <span data-ttu-id="096f5-134">**FieldNameLength**: WORD (2 バイト **)、FieldName** 配列内の要素の数。</span><span class="sxs-lookup"><span data-stu-id="096f5-134">**FieldNameLength**: WORD (2 bytes), the number of elements in the **FieldName** array.</span></span>
    
- <span data-ttu-id="096f5-135">**FieldName**: CHAR の配列。</span><span class="sxs-lookup"><span data-stu-id="096f5-135">**FieldName**: An array of CHAR.</span></span> <span data-ttu-id="096f5-136">これは、フィールド名CP_ACPコード ページ表現の ANSI です。</span><span class="sxs-lookup"><span data-stu-id="096f5-136">This is the ANSI CP_ACP codepage representation of the field name.</span></span> <span data-ttu-id="096f5-137">この配列の数は **FieldNameLength と等しくなります**。</span><span class="sxs-lookup"><span data-stu-id="096f5-137">The count of this array is equal to **FieldNameLength**.</span></span> <span data-ttu-id="096f5-138">フィールド名は [、UserProperties.Add](https://msdn.microsoft.com/library/microsoft.office.interop.outlook.userproperties.add.aspx) メソッドで指定されている Name パラメーターの制限を満たす必要があります。</span><span class="sxs-lookup"><span data-stu-id="096f5-138">The field name must satisfy the restrictions on the Name parameter as specified in the [UserProperties.Add](https://msdn.microsoft.com/library/microsoft.office.interop.outlook.userproperties.add.aspx) Method.</span></span> 
    
   > [!NOTE]
   > <span data-ttu-id="096f5-139">従来の互換性の理由から、Outlook ではこれらの制限を満たしていない **FieldName** 値を処理できる場合があります。ただし、このようなケースについては、このトピックでは説明しない場合があります。</span><span class="sxs-lookup"><span data-stu-id="096f5-139">For reasons of legacy compatibility, Outlook may be able to handle some **FieldName** values not satisfying these restrictions, however such cases are not covered by this topic.</span></span> 
  
- <span data-ttu-id="096f5-140">**共通**: FolderFieldDefinitionCommon ストリーム構造。</span><span class="sxs-lookup"><span data-stu-id="096f5-140">**Common**: A FolderFieldDefinitionCommon stream structure.</span></span>
    
## <a name="folderfielddefinitionw-stream-structure"></a><span data-ttu-id="096f5-141">FolderFieldDefinitionW ストリーム構造</span><span class="sxs-lookup"><span data-stu-id="096f5-141">FolderFieldDefinitionW Stream Structure</span></span>

<span data-ttu-id="096f5-142">FolderFieldDefinitionW ストリーム構造には、Unicode に格納されているフィールド名を持つユーザー定義フィールドの定義が含まれます。</span><span class="sxs-lookup"><span data-stu-id="096f5-142">A FolderFieldDefinitionW stream structure contains a definition of a user-defined field with the field name stored in Unicode.</span></span>
  
<span data-ttu-id="096f5-143">このストリームのデータ要素は、次の指定された順序で互いに直後に続く、リトル エンディアン バイト順に格納されます。</span><span class="sxs-lookup"><span data-stu-id="096f5-143">Data elements in this stream are stored in little-endian byte order, immediately following each other in the following specified order:</span></span>
  
- <span data-ttu-id="096f5-144">**FieldType**: FldType (4 バイト)、このフィールドの種類。</span><span class="sxs-lookup"><span data-stu-id="096f5-144">**FieldType**: FldType (4 bytes), the type of this field.</span></span>
    
- <span data-ttu-id="096f5-145">**FieldNameLength**: WORD (2 バイト **)、FieldName** 配列内の要素の数。</span><span class="sxs-lookup"><span data-stu-id="096f5-145">**FieldNameLength**: WORD (2 bytes), the number of elements in the **FieldName** array.</span></span>
    
- <span data-ttu-id="096f5-146">**FieldName**: WCHAR の配列。</span><span class="sxs-lookup"><span data-stu-id="096f5-146">**FieldName**: An array of WCHAR.</span></span> <span data-ttu-id="096f5-147">これは、フィールド名の Unicode (UTF-16) 表記です。</span><span class="sxs-lookup"><span data-stu-id="096f5-147">This is the Unicode (UTF-16) representation of the field name.</span></span> <span data-ttu-id="096f5-148">この配列の数は **FieldNameLength と等しくなります**。</span><span class="sxs-lookup"><span data-stu-id="096f5-148">The count of this array is equal to **FieldNameLength**.</span></span> <span data-ttu-id="096f5-149">フィールド名は [、UserProperties.Add](https://msdn.microsoft.com/library/microsoft.office.interop.outlook.userproperties.add.aspx) メソッドで指定されている Name パラメーターの制限を満たす必要があります。</span><span class="sxs-lookup"><span data-stu-id="096f5-149">The field name must satisfy the restrictions on the Name parameter as specified in the [UserProperties.Add](https://msdn.microsoft.com/library/microsoft.office.interop.outlook.userproperties.add.aspx) Method.</span></span> 
    
   > [!NOTE]
   > <span data-ttu-id="096f5-150">従来の互換性の理由から、Outlook ではこれらの制限を満たしていない **FieldName** 値を処理できる場合がありますが、このようなケースについては、このトピックでは説明しない場合があります。</span><span class="sxs-lookup"><span data-stu-id="096f5-150">For reasons of legacy compatibility, Outlook may be able to handle some **FieldName** values not satisfying these restrictions, but such cases are not covered by this topic.</span></span> 
  
- <span data-ttu-id="096f5-151">**共通**: FolderFieldDefinitionCommon ストリーム構造。</span><span class="sxs-lookup"><span data-stu-id="096f5-151">**Common**: A FolderFieldDefinitionCommon stream structure.</span></span>
    
## <a name="fldtype-enumeration"></a><span data-ttu-id="096f5-152">FldType 列挙</span><span class="sxs-lookup"><span data-stu-id="096f5-152">FldType Enumeration</span></span>

<span data-ttu-id="096f5-153">**FldType** 列挙値を次の表に示します。</span><span class="sxs-lookup"><span data-stu-id="096f5-153">**FldType** enumeration values are listed in the following table.</span></span> 
  
|<span data-ttu-id="096f5-154">名前</span><span class="sxs-lookup"><span data-stu-id="096f5-154">Name</span></span>|<span data-ttu-id="096f5-155">値</span><span class="sxs-lookup"><span data-stu-id="096f5-155">Value</span></span>|<span data-ttu-id="096f5-156">意味</span><span class="sxs-lookup"><span data-stu-id="096f5-156">Meaning</span></span>|
|:-----|:-----|:-----|
|<span data-ttu-id="096f5-157">ftNull</span><span class="sxs-lookup"><span data-stu-id="096f5-157">ftNull</span></span>  <br/> |<span data-ttu-id="096f5-158">0x0</span><span class="sxs-lookup"><span data-stu-id="096f5-158">0x0</span></span>  <br/> |<span data-ttu-id="096f5-159">このフィールド型は、フィールド定義の配列を null で終了するために使用されます。</span><span class="sxs-lookup"><span data-stu-id="096f5-159">This field type is used to null-terminate an array of field definitions.</span></span>  <br/> |
|<span data-ttu-id="096f5-160">ftString</span><span class="sxs-lookup"><span data-stu-id="096f5-160">ftString</span></span>  <br/> |<span data-ttu-id="096f5-161">0x1</span><span class="sxs-lookup"><span data-stu-id="096f5-161">0x1</span></span>  <br/> |<span data-ttu-id="096f5-162">テキスト</span><span class="sxs-lookup"><span data-stu-id="096f5-162">Text</span></span>  <br/> |
|<span data-ttu-id="096f5-163">ftInteger</span><span class="sxs-lookup"><span data-stu-id="096f5-163">ftInteger</span></span>  <br/> |<span data-ttu-id="096f5-164">0x3</span><span class="sxs-lookup"><span data-stu-id="096f5-164">0x3</span></span>  <br/> |<span data-ttu-id="096f5-165">整数</span><span class="sxs-lookup"><span data-stu-id="096f5-165">Integer</span></span>  <br/> |
|<span data-ttu-id="096f5-166">ftTime</span><span class="sxs-lookup"><span data-stu-id="096f5-166">ftTime</span></span>  <br/> |<span data-ttu-id="096f5-167">0x5</span><span class="sxs-lookup"><span data-stu-id="096f5-167">0x5</span></span>  <br/> |<span data-ttu-id="096f5-168">日付/時刻</span><span class="sxs-lookup"><span data-stu-id="096f5-168">Date/Time</span></span>  <br/> |
|<span data-ttu-id="096f5-169">ftBoolean</span><span class="sxs-lookup"><span data-stu-id="096f5-169">ftBoolean</span></span>  <br/> |<span data-ttu-id="096f5-170">0x6</span><span class="sxs-lookup"><span data-stu-id="096f5-170">0x6</span></span>  <br/> |<span data-ttu-id="096f5-171">はい/いいえ</span><span class="sxs-lookup"><span data-stu-id="096f5-171">Yes/No</span></span>  <br/> |
|<span data-ttu-id="096f5-172">ftDuration</span><span class="sxs-lookup"><span data-stu-id="096f5-172">ftDuration</span></span>  <br/> |<span data-ttu-id="096f5-173">0x7</span><span class="sxs-lookup"><span data-stu-id="096f5-173">0x7</span></span>  <br/> |<span data-ttu-id="096f5-174">Duration</span><span class="sxs-lookup"><span data-stu-id="096f5-174">Duration</span></span>  <br/> |
|<span data-ttu-id="096f5-175">ftMultiString</span><span class="sxs-lookup"><span data-stu-id="096f5-175">ftMultiString</span></span>  <br/> |<span data-ttu-id="096f5-176">0xB</span><span class="sxs-lookup"><span data-stu-id="096f5-176">0xB</span></span>  <br/> |<span data-ttu-id="096f5-177">キーワード</span><span class="sxs-lookup"><span data-stu-id="096f5-177">Keywords</span></span>  <br/> |
|<span data-ttu-id="096f5-178">ftFloat</span><span class="sxs-lookup"><span data-stu-id="096f5-178">ftFloat</span></span>  <br/> |<span data-ttu-id="096f5-179">0xC</span><span class="sxs-lookup"><span data-stu-id="096f5-179">0xC</span></span>  <br/> |<span data-ttu-id="096f5-180">数値またはパーセント</span><span class="sxs-lookup"><span data-stu-id="096f5-180">Number or Percent</span></span>  <br/> |
|<span data-ttu-id="096f5-181">ftCurrency</span><span class="sxs-lookup"><span data-stu-id="096f5-181">ftCurrency</span></span>  <br/> |<span data-ttu-id="096f5-182">0xE</span><span class="sxs-lookup"><span data-stu-id="096f5-182">0xE</span></span>  <br/> |<span data-ttu-id="096f5-183">通貨</span><span class="sxs-lookup"><span data-stu-id="096f5-183">Currency</span></span>  <br/> |
|<span data-ttu-id="096f5-184">ftCalc</span><span class="sxs-lookup"><span data-stu-id="096f5-184">ftCalc</span></span>  <br/> |<span data-ttu-id="096f5-185">0x12</span><span class="sxs-lookup"><span data-stu-id="096f5-185">0x12</span></span>  <br/> |<span data-ttu-id="096f5-186">式</span><span class="sxs-lookup"><span data-stu-id="096f5-186">Formula</span></span>  <br/> |
|<span data-ttu-id="096f5-187">ftSwitch</span><span class="sxs-lookup"><span data-stu-id="096f5-187">ftSwitch</span></span>  <br/> |<span data-ttu-id="096f5-188">0x13</span><span class="sxs-lookup"><span data-stu-id="096f5-188">0x13</span></span>  <br/> |<span data-ttu-id="096f5-189">最初の空でないフィールドのみを表示する型の組み合わせ - 後続のフィールドを無視します。</span><span class="sxs-lookup"><span data-stu-id="096f5-189">Combination of type showing only the first non-empty field - ignoring subsequent ones.</span></span>  <br/> |
|<span data-ttu-id="096f5-190">ftConcat</span><span class="sxs-lookup"><span data-stu-id="096f5-190">ftConcat</span></span>  <br/> |<span data-ttu-id="096f5-191">0x17</span><span class="sxs-lookup"><span data-stu-id="096f5-191">0x17</span></span>  <br/> |<span data-ttu-id="096f5-192">結合フィールドの型とテキスト フラグメントの組み合わせ。</span><span class="sxs-lookup"><span data-stu-id="096f5-192">Combination of type joining fields and any text fragments to each other.</span></span>  <br/> |
   
## <a name="folderfielddefinitioncommon-stream-structure"></a><span data-ttu-id="096f5-193">FolderFieldDefinitionCommon ストリーム構造</span><span class="sxs-lookup"><span data-stu-id="096f5-193">FolderFieldDefinitionCommon Stream Structure</span></span>

<span data-ttu-id="096f5-194">FolderFieldDefinitionCommon ストリーム構造には、FolderFieldDefinitionA と FolderFieldDefinitionW の両方に共通するユーザー定義フィールド定義のデータが含まれます。</span><span class="sxs-lookup"><span data-stu-id="096f5-194">A FolderFieldDefinitionCommon stream structure contains the data of a user-defined field definition that is common to both a FolderFieldDefinitionA and a FolderFieldDefinitionW.</span></span>
  
<span data-ttu-id="096f5-195">このストリームのデータ要素は、次の指定された順序で互いに直後に続く、リトル エンディアン バイト順に格納されます。</span><span class="sxs-lookup"><span data-stu-id="096f5-195">Data elements in this stream are stored in little-endian byte order, immediately following each other in the following specified order:</span></span>
  
- <span data-ttu-id="096f5-196">**PropSetGuid**: GUID (16 バイト)、フォルダー フィールドの対応する MAPI プロパティ名のプロパティ セット GUID。</span><span class="sxs-lookup"><span data-stu-id="096f5-196">**PropSetGuid**: GUID (16 bytes), the property set GUID of the folder field's corresponding MAPI property name.</span></span> <span data-ttu-id="096f5-197">このフィールドの値は、フィールドの種類が **ftNone** の場合、このフィールドの値が GUID_NULL と等しい場合を指定しない限り、PS_PUBLIC_STRINGS と等しくする必要があります。</span><span class="sxs-lookup"><span data-stu-id="096f5-197">This field's value must be equal to PS_PUBLIC_STRINGS, unless the field type is **ftNone** in which case this field's value must be equal to GUID_NULL.</span></span> 
    
   > [!NOTE]
   > <span data-ttu-id="096f5-198">従来の互換性の理由から、Outlook は、この制限を満たしていない一部の **PropSetGuid** 値を処理できる場合があります。ただし、このようなケースについては、このトピックでは説明されません。</span><span class="sxs-lookup"><span data-stu-id="096f5-198">For reasons of legacy compatibility, Outlook may be able to handle some **PropSetGuid** values not satisfying this restriction, however such cases are not covered by this topic.</span></span> 
  
- <span data-ttu-id="096f5-199">**fcapm**: DWORD (4 バイト)、ゼロ以上の組み合わせで、値と意味を次の表に示します。</span><span class="sxs-lookup"><span data-stu-id="096f5-199">**fcapm**: DWORD (4 bytes), a combination of zero or more flags the values of which and meanings are listed in the following table.</span></span> <span data-ttu-id="096f5-200">同じ値を持つフラグは、フィールドの種類 、つまり FldType 値に依存する意味を持ちます。</span><span class="sxs-lookup"><span data-stu-id="096f5-200">Flags with the same value have meanings dependent on the field's type, that is, FldType value.</span></span>
    
    |<span data-ttu-id="096f5-201">フラグ名</span><span class="sxs-lookup"><span data-stu-id="096f5-201">Flag name</span></span>|<span data-ttu-id="096f5-202">値</span><span class="sxs-lookup"><span data-stu-id="096f5-202">Value</span></span>|<span data-ttu-id="096f5-203">意味</span><span class="sxs-lookup"><span data-stu-id="096f5-203">Meaning</span></span>|
    |:-----|:-----|:-----|
    |<span data-ttu-id="096f5-204">FCAPM_CAN_EDIT</span><span class="sxs-lookup"><span data-stu-id="096f5-204">FCAPM_CAN_EDIT</span></span>  <br/> |<span data-ttu-id="096f5-205">0x00000001</span><span class="sxs-lookup"><span data-stu-id="096f5-205">0x00000001</span></span>  <br/> |<span data-ttu-id="096f5-206">フィールドは編集可能です。</span><span class="sxs-lookup"><span data-stu-id="096f5-206">The field is editable.</span></span>  <br/> |
    |<span data-ttu-id="096f5-207">FCAPM_CAN_SORT</span><span class="sxs-lookup"><span data-stu-id="096f5-207">FCAPM_CAN_SORT</span></span>  <br/> |<span data-ttu-id="096f5-208">0x00000002</span><span class="sxs-lookup"><span data-stu-id="096f5-208">0x00000002</span></span>  <br/> |<span data-ttu-id="096f5-209">フィールドは並べ替え可能です。</span><span class="sxs-lookup"><span data-stu-id="096f5-209">The field is sortable.</span></span>  <br/> |
    |<span data-ttu-id="096f5-210">FCAPM_CAN_GROUP</span><span class="sxs-lookup"><span data-stu-id="096f5-210">FCAPM_CAN_GROUP</span></span>  <br/> |<span data-ttu-id="096f5-211">0x00000004</span><span class="sxs-lookup"><span data-stu-id="096f5-211">0x00000004</span></span>  <br/> |<span data-ttu-id="096f5-212">フィールドはグループ化可能です。</span><span class="sxs-lookup"><span data-stu-id="096f5-212">The field is groupable.</span></span>  <br/> |
    |<span data-ttu-id="096f5-213">FCAPM_MULTILINE_TEXT</span><span class="sxs-lookup"><span data-stu-id="096f5-213">FCAPM_MULTILINE_TEXT</span></span>  <br/> |<span data-ttu-id="096f5-214">0x00000100</span><span class="sxs-lookup"><span data-stu-id="096f5-214">0x00000100</span></span>  <br/> |<span data-ttu-id="096f5-215">フィールドには複数行のテキストを保持できます。</span><span class="sxs-lookup"><span data-stu-id="096f5-215">The field can hold multiple lines of text.</span></span>  <br/> |
    |<span data-ttu-id="096f5-216">FCAPM_PERCENT</span><span class="sxs-lookup"><span data-stu-id="096f5-216">FCAPM_PERCENT</span></span>  <br/> |<span data-ttu-id="096f5-217">0x01000000</span><span class="sxs-lookup"><span data-stu-id="096f5-217">0x01000000</span></span>  <br/> |<span data-ttu-id="096f5-218">ftFloat 型のこのフィールドはパーセンテージ フィールドです。</span><span class="sxs-lookup"><span data-stu-id="096f5-218">This field of the type ftFloat is a percentage field.</span></span>  <br/> |
    |<span data-ttu-id="096f5-219">FCAPM_DATEONLY</span><span class="sxs-lookup"><span data-stu-id="096f5-219">FCAPM_DATEONLY</span></span>  <br/> |<span data-ttu-id="096f5-220">0x01000000</span><span class="sxs-lookup"><span data-stu-id="096f5-220">0x01000000</span></span>  <br/> |<span data-ttu-id="096f5-221">ftTime 型のこのフィールドは、日付専用の時刻フィールドです。</span><span class="sxs-lookup"><span data-stu-id="096f5-221">This field of the type ftTime is a date-only time field.</span></span>  <br/> |
    |<span data-ttu-id="096f5-222">FCAPM_UNITLESS</span><span class="sxs-lookup"><span data-stu-id="096f5-222">FCAPM_UNITLESS</span></span>  <br/> |<span data-ttu-id="096f5-223">0x01000000</span><span class="sxs-lookup"><span data-stu-id="096f5-223">0x01000000</span></span>  <br/> |<span data-ttu-id="096f5-224">ftInteger 型のこのフィールドでは、表示形式で単位を使用できます。たとえば、"Computer - 640 K.." などの形式。は許可されません。</span><span class="sxs-lookup"><span data-stu-id="096f5-224">For this field of the type ftInteger, no unit is allowed in display format; for example such formats as "Computer - 640 K…" are not allowed.</span></span>  <br/> |
    |<span data-ttu-id="096f5-225">FCAPM_CAN_EDIT_IN_ITEM</span><span class="sxs-lookup"><span data-stu-id="096f5-225">FCAPM_CAN_EDIT_IN_ITEM</span></span>  <br/> |<span data-ttu-id="096f5-226">0x80000000</span><span class="sxs-lookup"><span data-stu-id="096f5-226">0x80000000</span></span>  <br/> |<span data-ttu-id="096f5-227">フィールドはアイテムで編集できます。これは特にカスタム フォーム用です。</span><span class="sxs-lookup"><span data-stu-id="096f5-227">The field can be edited in the item: This is specifically for custom forms.</span></span>  <br/> |
   
- <span data-ttu-id="096f5-228">**dwString**: DWORD (4 バイト)。</span><span class="sxs-lookup"><span data-stu-id="096f5-228">**dwString**: DWORD (4 bytes).</span></span> <span data-ttu-id="096f5-229">最初の次の注を参照してください。</span><span class="sxs-lookup"><span data-stu-id="096f5-229">See the first following Note.</span></span>
    
- <span data-ttu-id="096f5-230">**dwBitmap**: DWORD (4 バイト)。</span><span class="sxs-lookup"><span data-stu-id="096f5-230">**dwBitmap**: DWORD (4 bytes).</span></span> <span data-ttu-id="096f5-231">最初の次の注を参照してください。</span><span class="sxs-lookup"><span data-stu-id="096f5-231">See the first following Note.</span></span>
    
- <span data-ttu-id="096f5-232">**dwDisplay**: DWORD (4 バイト)。</span><span class="sxs-lookup"><span data-stu-id="096f5-232">**dwDisplay**: DWORD (4 bytes).</span></span> <span data-ttu-id="096f5-233">最初の次の注を参照してください。</span><span class="sxs-lookup"><span data-stu-id="096f5-233">See the first following Note.</span></span>
    
- <span data-ttu-id="096f5-234">**iFmt**: INT (4 バイト)。</span><span class="sxs-lookup"><span data-stu-id="096f5-234">**iFmt**: INT (4 bytes).</span></span> <span data-ttu-id="096f5-235">"New Field"、"Edit Field"、"Field Properties" ダイアログの "Format:" コンボ ボックスを持つフィールド型の場合、そのコンボ ボックスで選択された形式の 0 からベースのインデックス。</span><span class="sxs-lookup"><span data-stu-id="096f5-235">For the field types that have the "Format:" combo box in the "New Field", "Edit Field", and "Field Properties" dialogs, the 0-based index of the format selected in that combo box.</span></span> <span data-ttu-id="096f5-236">そのコンボ ボックスのないフィールドの種類の場合、これは 0 である必要があります。</span><span class="sxs-lookup"><span data-stu-id="096f5-236">For the field types without that combo box, this must be 0.</span></span> <span data-ttu-id="096f5-237">フィールドの値とフィールドの種類によって **、dwString フィールド、dwBitmap** フィールド、**および\*\*\*\*dwDisplay** フィールドの値が一意に決定されます。最初の次の注を参照してください。</span><span class="sxs-lookup"><span data-stu-id="096f5-237">The field's value together with the field type uniquely determine the values of the **dwString**, **dwBitmap**, and **dwDisplay** fields, see the first following Note.</span></span>
    
- <span data-ttu-id="096f5-238">**wszFormulaLength**: WORD (2 バイト **)、wszFormulaLength** 配列内の要素の数。</span><span class="sxs-lookup"><span data-stu-id="096f5-238">**wszFormulaLength**: WORD (2 bytes), the number of elements in the **wszFormulaLength** array.</span></span>
    
- <span data-ttu-id="096f5-239">**wszFormulaLength**: WCHAR の配列。</span><span class="sxs-lookup"><span data-stu-id="096f5-239">**wszFormulaLength**: An array of WCHAR.</span></span> <span data-ttu-id="096f5-240">これは、フィールドの数式文字列を標準形式で表す Unicode (UTF-16) 表記です。</span><span class="sxs-lookup"><span data-stu-id="096f5-240">This is the Unicode (UTF-16) representation of the field's formula string in its standard format.</span></span> <span data-ttu-id="096f5-241">フィールドの数式の標準形式と UI 形式の説明については、次の 2 番目の注を参照してください。</span><span class="sxs-lookup"><span data-stu-id="096f5-241">See the second following Note for the description of the standard and UI formats of a field's formula.</span></span> <span data-ttu-id="096f5-242">この配列の数は **wszFormulaLength と等しくなります**。</span><span class="sxs-lookup"><span data-stu-id="096f5-242">The count of this array is equal to **wszFormulaLength**.</span></span> <span data-ttu-id="096f5-243">フィールドの種類が **ftCalc、ftSwitch、\*\*\*\*または ftConcat** の場合を指定しない限り、数式文字列は空の **文字列である必要があります**。</span><span class="sxs-lookup"><span data-stu-id="096f5-243">The formula string must be an empty string unless the field type is **ftCalc**, **ftSwitch** or **ftConcat**.</span></span>
    
> [!NOTE]
> <span data-ttu-id="096f5-244">**dwString、dwBitmap、\*\*\*\*および dwDisplay** の値は **、FldType** 値と **iFmt** 値に基づいて一意に決定されます。冗長ですが、Outlook によるフィールド定義の正しい処理には、正しい値が必要です。 </span><span class="sxs-lookup"><span data-stu-id="096f5-244">Although the values of **dwString**, **dwBitmap**, and **dwDisplay** are uniquely determined based on the **FldType** value and the **iFmt** value, which are redundant, their correct values are still necessary for correct processing of the field definition by Outlook.</span></span> <span data-ttu-id="096f5-245">この決定を実行するアルゴリズムの簡単な説明はありません。</span><span class="sxs-lookup"><span data-stu-id="096f5-245">There is no simple description of the algorithm that performs this determination.</span></span> 
> 
> <span data-ttu-id="096f5-246">したがって、指定された **FldType** 値と **iFmt** 値に対応する **dwString** 値 **、dwBitmap** 値、および **dwDisplay** 値を確認するには、その型のユーザー定義フィールドを作成してテストを実行し、その形式を [書式] コンボ ボックスで選択し、適用性を前提として、Outlook が作成する **FolderUserFields** ストリームをそのユーザー定義フィールドに対して検査します。</span><span class="sxs-lookup"><span data-stu-id="096f5-246">Therefore, to find out which **dwString**, **dwBitmap**, and **dwDisplay** values correspond to a given **FldType** value and **iFmt** value, perform a test by creating a user-defined field of that type, and with that format selected in the **Format** combo box, assuming its applicability, inspect the resulting **FolderUserFields** stream that Outlook creates for that user-defined field.</span></span> 
  
<span data-ttu-id="096f5-247">UI 形式のフィールドの数式は、ユーザー定義フィールドの[新しいフィールド]、[フィールドの編集]、および [フィールド のプロパティ] ダイアログ ボックスの [数式] テキスト ボックスで編集されます。  </span><span class="sxs-lookup"><span data-stu-id="096f5-247">The field's formula in its UI format is edited in the **Formula** text box of the **New Field**, **Edit Field**, and **Field Properties** dialogs for the user-defined field.</span></span> <span data-ttu-id="096f5-248">数式を UI 形式から標準形式に変換するアルゴリズムは、次に示すフィールドの種類によって異なります。</span><span class="sxs-lookup"><span data-stu-id="096f5-248">The algorithm to convert a formula from the UI format to the standard format depends on the field type as described in the following:</span></span> 
- <span data-ttu-id="096f5-249">**ftCalc** 型と **ftSwitch** 型のフィールドでは、組み込みフィールドの標準形式であり、対応する MAPI プロパティは、MNID STRING の種類の名前付きプロパティではなく、フィールド名フラグメントをフラグメントに置き換えた結果を取得します。 \_ `[<field_name>]` `[_<field_dispid_decimal>]`</span><span class="sxs-lookup"><span data-stu-id="096f5-249">For fields of types **ftCalc** and **ftSwitch**, the standard format for built-in fields, which corresponding MAPI properties are not named properties of the kind MNID\_STRING, is obtained by replacing field name fragments, that is `[<field_name>]` with fragments `[_<field_dispid_decimal>]`.</span></span> 

  <span data-ttu-id="096f5-250">たとえば、数式型のフィールドの UI 形式が **ftCalc** で、Office UI 言語が米国英語である場合、ユーザー定義フィールドの名前は 、このような数式の標準形式になります。 `[Business Phone] & [My custom field]` `My custom field` `[_14856] & [My custom field]`</span><span class="sxs-lookup"><span data-stu-id="096f5-250">For example, if the UI format of a formula for a field of the type **Formula**, that is **ftCalc**, with the Office UI language being US English, is `[Business Phone] & [My custom field]`, where `My custom field` is the name of a user-defined field, the standard format of such a formula would be `[_14856] & [My custom field]`.</span></span>

- <span data-ttu-id="096f5-251">**ftConcat** 型のフィールドの場合、標準の形式は以下を実行して取得されます。</span><span class="sxs-lookup"><span data-stu-id="096f5-251">For fields of the type **ftConcat**, the standard format is obtained by performing the following:</span></span>

  1. <span data-ttu-id="096f5-252">先頭と末尾の空白を切り捨てる。</span><span class="sxs-lookup"><span data-stu-id="096f5-252">Truncate leading and trailing whitespace.</span></span> 
  2. <span data-ttu-id="096f5-253">次の 2 種類のフラグメントのシーケンスに数式を解析します。</span><span class="sxs-lookup"><span data-stu-id="096f5-253">Parse the formula into a sequence of fragments of the following two kinds:</span></span> 
     - <span data-ttu-id="096f5-254">角かっこで囲まれたフィールド名、つまり、 `[<field_name>]` を指定します。</span><span class="sxs-lookup"><span data-stu-id="096f5-254">A field name in square brackets, that is, `[<field_name>]`.</span></span> 
     - <span data-ttu-id="096f5-255">角かっこを含む部分文字列。</span><span class="sxs-lookup"><span data-stu-id="096f5-255">A substring not containing any square brackets.</span></span>   
      <span data-ttu-id="096f5-256">2 番目の種類の 2 つのフラグメントがシーケンス内で隣接しないなことを確認します。</span><span class="sxs-lookup"><span data-stu-id="096f5-256">Assure that no two fragments of the second kind are adjacent in the sequence.</span></span> <span data-ttu-id="096f5-257">この方法で数式を解析できない場合は、無効と見なされます。</span><span class="sxs-lookup"><span data-stu-id="096f5-257">If the formula cannot be parsed this way, it is considered invalid.</span></span> 
  3. <span data-ttu-id="096f5-258">ftCalc フィールドおよび **ftSwitch** フィールドと同じ種類のフラグメントに対して同じ置換 **を実行** します。</span><span class="sxs-lookup"><span data-stu-id="096f5-258">Perform the same replacement for fragments of the first kind as for the **ftCalc** and **ftSwitch** fields.</span></span> 
  4. <span data-ttu-id="096f5-259">2 番目の種類のフラグメントごとに、すべての二重引用符 (""") 文字がある場合は、2 つの連続する二重引用符文字をエスケープし、二重引用符で囲む必要があります。</span><span class="sxs-lookup"><span data-stu-id="096f5-259">For each fragment of the second kind, escape all double-quote (""") characters, if any, with two consecutive double-quote characters, and enclose it in double quotes.</span></span> 
  5. <span data-ttu-id="096f5-260">隣接するフラグメントの各ペアの間にアンパサンド文字列 ( `&` ) を挿入します。</span><span class="sxs-lookup"><span data-stu-id="096f5-260">Insert an ampersand string (`&`) between each pair of adjacent fragments.</span></span>
 
  <span data-ttu-id="096f5-261">たとえば、Office UI 言語の米国英語を使用して **、ftConcat** 型のフィールドの数式の UI 形式が 、ユーザー定義フィールドの名前である場合、そのような数式の標準書式になります。 `text1 [Business Phone] "text2" [My custom field]` `My custom field` `""text1" & [_14856] & """text2""" & [My custom field]"`</span><span class="sxs-lookup"><span data-stu-id="096f5-261">For example, using the Office UI language US English, if the UI format of a formula for a field of the type **ftConcat** is `text1 [Business Phone] "text2" [My custom field]`, where `My custom field` is the name of a user-defined field, the standard format for such a formula would be `""text1" & [_14856] & """text2""" & [My custom field]"`.</span></span> 
  
## <a name="see-also"></a><span data-ttu-id="096f5-262">関連項目</span><span class="sxs-lookup"><span data-stu-id="096f5-262">See also</span></span>

- [<span data-ttu-id="096f5-263">FolderUserFields ストリームのサンプル</span><span class="sxs-lookup"><span data-stu-id="096f5-263">FolderUserFields Stream Sample</span></span>](folderuserfields-stream-sample.md)
- [<span data-ttu-id="096f5-264">新しいフィールドの定義をUser-Definedする</span><span class="sxs-lookup"><span data-stu-id="096f5-264">Add a Definition for a New User-Defined Field</span></span>](how-to-add-a-definition-for-a-new-user-defined-field.md)

