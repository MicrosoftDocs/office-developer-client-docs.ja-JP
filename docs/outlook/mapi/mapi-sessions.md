---
title: MAPI セッション
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: c5a7c137-393e-40ff-a2b9-afe02da2435a
description: '�ŏI�X�V��: 2011�N7��23��'
ms.openlocfilehash: a2ab44081c79e72e082687006ab06d0f83b8367e
ms.sourcegitcommit: 0cf39e5382b8c6f236c8a63c6036849ed3527ded
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/23/2018
ms.locfileid: "22575029"
---
# <a name="mapi-sessions"></a><span data-ttu-id="b41b2-103">MAPI セッション</span><span class="sxs-lookup"><span data-stu-id="b41b2-103">MAPI sessions</span></span>

<span data-ttu-id="b41b2-104">**適用されます**: Outlook 2013 |Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="b41b2-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="b41b2-105">��ɂȂ郁�b�Z�[�W���O �V�X�e���Ăяo���N���C�A���g �A�v���P�[�V�����ɂ́A�O�ɁA�Z�b�V�����A�܂��� MAPI �T�u�V�X�e���Ƃ̐ڑ���m������K�v������܂��B</span><span class="sxs-lookup"><span data-stu-id="b41b2-105">Before the client application can call an underlying messaging system, it must establish a session, or connection, with the MAPI subsystem.</span></span>
  
<span data-ttu-id="b41b2-p101">���O�I������ƁA���[�U�[�A�L���ȃv���t�@�C���ɃA�N�Z�X���A���b�Z�[�W���O �V�X�e���ƃ��b�Z�[�W �T�[�r�X�̎��i����m�F����v���Z�X�́A�Z�b�V�������J�n����܂��B���ɁA�v���Z�X�ɂ��A���ׂẴv���t�@�C���̃��b�Z�[�W�̃T�[�r�X���������\������Ă��܂��B�N���C�A���g�̃C���^�[�t�F�C�X��g�p����ɂ́A���O�I���Ăяo�������܂�܂��BMAPI �N���C�A���g�ł́A [MAPILogonEx](mapilogonex.md)�֐���Ăяo���܂��B</span><span class="sxs-lookup"><span data-stu-id="b41b2-p101">Sessions are initiated when a user logs on, a process that accesses a valid profile and validates the messaging system and the message service credentials. Then, the process ensures that all of the profile's message services are correctly configured. The client interface you use determines the logon call. MAPI clients call the [MAPILogonEx](mapilogonex.md) function.</span></span> 
  
<span data-ttu-id="b41b2-110">メッセージ サービスの構成は、ログオン プロセスの最も重要な部分の 1 つです。</span><span class="sxs-lookup"><span data-stu-id="b41b2-110">Message service configuration is one of the most important parts of the logon process.</span></span> <span data-ttu-id="b41b2-111">プロファイルは、構成情報の最初のソースです。</span><span class="sxs-lookup"><span data-stu-id="b41b2-111">The profile is the initial source for configuration information.</span></span> <span data-ttu-id="b41b2-112">特定のメッセージ サービスの情報がない場合は、ログオン プロセスは、それを指定するように求めるしようとします。</span><span class="sxs-lookup"><span data-stu-id="b41b2-112">If information for a particular message service is missing, the logon process tries to prompt the user to supply it.</span></span> <span data-ttu-id="b41b2-113">これは常に成功した 2 つの理由: 最初に、ユーザーに確認が必要です] ダイアログ ボックスが表示します。</span><span class="sxs-lookup"><span data-stu-id="b41b2-113">This is not always successful for two reasons: First, prompting the user requires the display of a dialog box.</span></span> <span data-ttu-id="b41b2-114">クライアント ログオン呼び出しにフラグを渡すことにより、ユーザー インターフェイスの表示を禁止することができます。</span><span class="sxs-lookup"><span data-stu-id="b41b2-114">It is possible for clients to disallow the display of a user interface by passing a flag into the logon call.</span></span> <span data-ttu-id="b41b2-115">第 2 に、ユーザーは、必要な情報を追加する前に、ダイアログ ボックスをキャンセル可能性があります。</span><span class="sxs-lookup"><span data-stu-id="b41b2-115">Second, the user could cancel the dialog box before the needed information can be added.</span></span>
  
<span data-ttu-id="b41b2-116">ログオン プロセスでは、1 回失敗すると、ユーザー エラーの通知は、再試行するか、エラー状態を修正する機会を与えられました。</span><span class="sxs-lookup"><span data-stu-id="b41b2-116">When a logon process fails one time, the user is informed of the failure and given the chance to retry or correct the error condition.</span></span> <span data-ttu-id="b41b2-117">もう一度、ユーザー インターフェイスが表示されます、クライアントを使用して、そのユーザーがどのようなデータが不足しているを入力する求められます。</span><span class="sxs-lookup"><span data-stu-id="b41b2-117">Once again, a user interface will be displayed, if the client allows it, and the user will be prompted to enter whatever data is missing.</span></span> <span data-ttu-id="b41b2-118">この 2 つ目の試行が失敗した場合は、MAPI には、セッションの間のメッセージ サービスですべてのサービス プロバイダーが無効になります。</span><span class="sxs-lookup"><span data-stu-id="b41b2-118">If this second try is unsuccessful, MAPI disables all service providers in the message service for the duration of the session.</span></span> <span data-ttu-id="b41b2-119">実際には、メッセージ全体のサービスが無効になります。</span><span class="sxs-lookup"><span data-stu-id="b41b2-119">In effect, the whole message service is disabled.</span></span> <span data-ttu-id="b41b2-120">これは、ことを意味メッセージ サービスのサービス プロバイダーのことができます。</span><span class="sxs-lookup"><span data-stu-id="b41b2-120">This means that none of the service providers in the message service can work.</span></span> <span data-ttu-id="b41b2-121">これは 1 つのプロバイダーには、ログオンが失敗した場合、他のプロバイダーは、通常も失敗するためです。</span><span class="sxs-lookup"><span data-stu-id="b41b2-121">This is done because if one provider fails logon, the other providers usually also fail.</span></span> <span data-ttu-id="b41b2-122">ログオン プロセスは、互換性のないバージョンの MAPI、メッセージング サーバーを使用できない、またはデータの破損のために必要なリソースの無効なパスが原因で失敗します。</span><span class="sxs-lookup"><span data-stu-id="b41b2-122">The logon process can fail due to an invalid path for a necessary resource, an incompatible version of MAPI, an unavailable messaging server, or data corruption.</span></span> 
  
<span data-ttu-id="b41b2-p104">�N���C�A���g�����O�I���ʘb��m������Z�b�V������ 2 ��ނ̂����ꂩ��w��ł��܂��B �X �̃Z�b�V�����܂��͋��L�̃Z�b�V�����B�X �̃Z�b�V�����̓v���C�x�[�g�ڑ����܂��B�N���C�A���g �A�v���P�[�V������g�p���Ă���Z�b�V�����̊Ԃ̈�Έꃊ���[�V�����V�b�v������܂��B���ʂƂ��āA�Z�b�V�����̋��L��N���C�A���g �A�v���P�[�V������v���t�@�C������L���܂��B���L�Z�b�V������ 1 ��m�����܂����A������g�p����K�v�����邻�̑��̃N���C�A���g �A�v���P�[�V�����Ŏg�p���邱�Ƃ��ł��܂��B�v���t�@�C������ю��i���́A�ŏ��̃��O�I���݂̂�w�肵�܂��B</span><span class="sxs-lookup"><span data-stu-id="b41b2-p104">Clients can specify one of two types of sessions to be established in the logon call: an individual session or a shared session. Individual sessions are private connections; there is a one-to-one relationship between a client application and the session it is using. As a consequence, client applications that share a session also share a profile. Shared sessions are established once but can be used by other client applications that need to use them. The profile and credentials are specified only with the initial logon.</span></span> 
  
<span data-ttu-id="b41b2-128">クライアントにログオンできます複数回、同じユーザーまたは複数のユーザーとして。</span><span class="sxs-lookup"><span data-stu-id="b41b2-128">Clients can log on multiple times as the same user or as multiple users.</span></span> <span data-ttu-id="b41b2-129">MAPI は、これにも防止できません。</span><span class="sxs-lookup"><span data-stu-id="b41b2-129">MAPI does not prevent this.</span></span> <span data-ttu-id="b41b2-130">サービス プロバイダーによっては、ただし、あります、柔軟性が高く、一度ログオンするとエラー値 MAPI_E_SESSION_LIMIT が返されます。</span><span class="sxs-lookup"><span data-stu-id="b41b2-130">Some service providers, however, might not be as flexible, returning the error value MAPI_E_SESSION_LIMIT on subsequent logon attempts.</span></span> <span data-ttu-id="b41b2-131">基になるハードウェアの制限を使用するサービス プロバイダーは、セッションの制限を適用する必要あります。</span><span class="sxs-lookup"><span data-stu-id="b41b2-131">Service providers with underlying hardware limitations can be required to enforce a session limit.</span></span>
  
<span data-ttu-id="b41b2-132">セッションを確立するための関数呼び出しは、セッションを作成する方法を制御するフラグとパラメーターのコレクションを取得します。</span><span class="sxs-lookup"><span data-stu-id="b41b2-132">The function calls for establishing a session have a collection of flags and parameters that control how the session is created.</span></span> <span data-ttu-id="b41b2-133">クライアントは、省略可能なプロファイルの名前と表示されるダイアログ ボックスの親ウィンドウとして機能するウィンドウ ハンドルを指定します。</span><span class="sxs-lookup"><span data-stu-id="b41b2-133">The client specifies an optional profile name and a window handle that acts as the parent window for any dialog boxes that are displayed.</span></span> <span data-ttu-id="b41b2-134">フラグには、MAPI_NEW_SESSION で、(共有セッションではなく)、個々 の新しいセッションを確立することを要求して、MAPI_LOGON_UI のユーザー インターフェイスのフラグが含まれます。</span><span class="sxs-lookup"><span data-stu-id="b41b2-134">The flags include MAPI_NEW_SESSION, which requests that a new, individual session (rather than a shared session) be established, and the MAPI_LOGON_UI user interface flag.</span></span> <span data-ttu-id="b41b2-135">ログオン ダイアログ ボックスを要求するユーザー ・ インタ フェース ・ フラグが設定されています。</span><span class="sxs-lookup"><span data-stu-id="b41b2-135">The user interface flag is set to request a logon dialog box.</span></span>
  
<span data-ttu-id="b41b2-136">���̐}�́A�����̂��܂��܂ȃp�����[�^�[�ƃt���O�� MAPI �Z�b�V������m��������@������܂��B</span><span class="sxs-lookup"><span data-stu-id="b41b2-136">The following illustration shows how these various parameters and flags establish a MAPI session.</span></span>
  
<span data-ttu-id="b41b2-137">**MAPI �Z�b�V�����̃t���[�\`���[�g**</span><span class="sxs-lookup"><span data-stu-id="b41b2-137">**MAPI session flowchart**</span></span>
  
<span data-ttu-id="b41b2-138">![MAPI セッションのフローチャート](media/amapi_47.gif "MAPI セッションのフローチャート")</span><span class="sxs-lookup"><span data-stu-id="b41b2-138">![MAPI session flowchart](media/amapi_47.gif "MAPI session flowchart")</span></span>
  
<span data-ttu-id="b41b2-139">�N���C�A���g �A�v���P�[�V���������Z�b�V�����̏������@�̏ڍׂɂ��ẮA [MAPI �Z�b�V�����̏���](mapi-session-handling.md)��Q�Ƃ��Ă��������B</span><span class="sxs-lookup"><span data-stu-id="b41b2-139">For information about handling sessions from within a client application, see [MAPI Session Handling](mapi-session-handling.md)</span></span>
  
## <a name="see-also"></a><span data-ttu-id="b41b2-140">�֘A����</span><span class="sxs-lookup"><span data-stu-id="b41b2-140">See also</span></span>

- [<span data-ttu-id="b41b2-141">MAPILogonEx</span><span class="sxs-lookup"><span data-stu-id="b41b2-141">MAPILogonEx</span></span>](mapilogonex.md)  
- [<span data-ttu-id="b41b2-142">IMAPISession: IUnknown</span><span class="sxs-lookup"><span data-stu-id="b41b2-142">IMAPISession : IUnknown</span></span>](imapisessioniunknown.md)
- [<span data-ttu-id="b41b2-143">MAPI �Z�b�V�����̏���</span><span class="sxs-lookup"><span data-stu-id="b41b2-143">MAPI Session Handling</span></span>](mapi-session-handling.md)  
- [<span data-ttu-id="b41b2-144">MAPI �v���O���~���O�̊T�v</span><span class="sxs-lookup"><span data-stu-id="b41b2-144">MAPI Programming Overview</span></span>](mapi-programming-overview.md)

