---
title: MAPI アイドル エンジン
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 755d096a-2a61-44d2-a765-5d464a857756
description: '最終更新日時: 2015 年 3 月 9 日'
ms.openlocfilehash: 9fdc254053c2d35c83866bd8a076279fd383db02
ms.sourcegitcommit: 0cf39e5382b8c6f236c8a63c6036849ed3527ded
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/23/2018
ms.locfileid: "22583037"
---
# <a name="mapi-idle-engine"></a>MAPI アイドル エンジン

  
  
**適用対象**: Outlook 2013 | Outlook 2016 
  
MAPI には、アイドル状態のエンジンと総称されますいくつかの関数が用意されています。 これらの関数は、セッション、または低速に応答のピーク時にさまざまなタスクを実行するには、クライアント、アドレス帳プロバイダー、およびメッセージ ストア プロバイダーを使用できます。 クライアントとサービス ・ プロバイダーが遅い操作を延期など、長期間使用されていないままのファイルを閉じる。 トランスポート プロバイダー通常ために使用しないでアイドル状態のエンジン、 **IXPLogon::Idle**メソッドを引き継ぎます。 詳細については、 [IXPLogon::Idle](ixplogon-idle.md)を参照してください。
  
アイドル状態のエンジンを使用するには、クライアントとサービス ・ プロバイダーは、MAPI サブシステムがアイドル状態のときに実行するタスクが含まれているコールバック関数を作成します。 MAPI では、アイドル時間を検出すると、このコールバック関数を呼び出します。 コールバック関数は、次のように定義されている、 **FNIDLE**のプロトタイプを次に示します。 
  
 `BOOL (STDAPICALLTYPE FNIDLE) (LPVOID lpvContext)`
  
詳細については、 [FNIDLE](fnidle.md)を参照してください。
  
アイドル状態のエンジンを構成する関数は次のとおりです。
  
[ChangeIdleRoutine](changeidleroutine.md)
  
[DeregisterIdleRoutine](deregisteridleroutine.md)
  
[EnableIdleRoutine](enableidleroutine.md)
  
[FtgRegisterIdleRoutine](ftgregisteridleroutine.md)
  
[MAPIDeInitIdle](mapideinitidle.md)
  
[MAPIInitIdle](mapiinitidle.md)
  
コールバック関数を登録するには、クライアントとサービス ・ プロバイダーは、 **FtgRegisterIdleRoutine**関数を呼び出します。 入力パラメーターには、オプションの優先順位、適切な場合は、何らかの方法で使用する時間数の入力値として、コールバック関数に渡されるメモリのブロックが含まれ、オプションのフラグを設定します。 
  
クライアントとサービス ・ プロバイダー、アイドル状態の関数の実行方法を制御する_priIdle_パラメーターの優先順位を指定したり、優先順位に問題がない場合に 0 を指定できます。 負の数は、正の数または 0 よりも高い優先順位を表す、ため圧縮検索や検索割り当てる必要があります負の数です。 1 回発生する可能性のあるタスクには、正の値を割り当てる必要があります。 
  
作業中のコールバック関数の登録を解除するのには、クライアントとサービス ・ プロバイダーは、 **DeregisterIdleRoutine**関数を呼び出します。 **DeregisterIdleRoutine**は、非同期的に動作するためが登録抹消] の呼び出し中に呼び出されるコールバック関数の可能性があっても**DeregisterIdleRoutine**が返された後できます。 
  
コールバック関数の特性の一部またはすべてを変更するには、クライアントとサービス ・ プロバイダーは、 **ChangeIdleRoutine**関数を呼び出します。 **ChangeIdleRoutine**は、変更に応じてフラグ パラメーター _ircIdle_を設定する方法です。**ChangeIdleRoutine**には、関数自体、その優先順位、時間の設定、および入力パラメーターを変更できます。 
  
MAPI がアイドル状態を定義、オペレーティング ・ システム、オペレーティング システムには、定義するときと同じです。 Win32 では、MAPI は、アイドル状態のタスクをスケジュールするのには優先順位がアイドル クラスのスレッドを作成します。 このスレッドは、時間の追跡し、到着すると、その実行時間、アイドル状態のタスクを実行するスレッドにメッセージを投稿します。 Win32 では、スレッドをスケジュール、処理されません。 場合はワークステーションでは、アイドル状態の優先順位よりも高い優先順位のタスクが発生している、アイドル状態のタスク必要がありますいない取得の実行スケジュール タスクが完了するまで。 
  
**MAPIInitIdle**を呼び出したスレッドのすべてのアイドル タスクを実行します。 MAPI のスケジュールを設定すると、別のスレッドがアイドル状態のタスクは、対象となり、を介して初期化スレッドにメッセージをポストして、アイドル状態のタスクの実行があります。 異なる種類のクライアントに対する影響は次のとおりです。
  
|**スレッド モデル**|**意味**|
|:-----|:-----|
|シングル スレッド  <br/> |大丈夫。 アイドル関数では、クライアントのメイン スレッド上で実行し、メッセージ ループをシリアル化します。  <br/> |
|フリー スレッド  <br/> |アイドル状態の関数はスレッド セーフである必要がありますが、クライアントが既に必要なインフラストラクチャです。 クライアントは可能性があります MAPI アイドル エンジンをまったく必要ありません。  <br/> |
|アパートメント スレッド  <br/> |アイドル状態の関数は、MAPI、OLE、またはその他の任意の COM インターフェイスを使用する必要がある場合は、登録されている同じスレッドで実行すること。 最も簡単な方法は、MAPI スレッドを適切にメッセージを投稿すると、アイドル状態の関数を登録し、そのスレッドのメッセージ ループから直接「実際の」アイドル状態の関数にディスパッチします。  <br/> |
   

