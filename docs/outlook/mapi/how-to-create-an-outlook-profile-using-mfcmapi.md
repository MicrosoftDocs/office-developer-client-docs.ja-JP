---
title: MFCMAPI を使用して Outlook プロファイルを作成する
ms.date: 05/18/2016
ms.audience: Developer
localization_priority: Normal
ms.assetid: 85581bc7-2d81-46af-8836-adef39c933fc
description: mfcmapi は mapi ストアへのアクセスを提供して、Exchange と Outlook の問題を調査し、開発者に mapi 開発のサポートを提供します。
ms.openlocfilehash: 8a300ad53918b22cc3de5554a1e3c29289cd9365
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/23/2019
ms.locfileid: "32345991"
---
# <a name="create-an-outlook-profile-using-mfcmapi"></a><span data-ttu-id="3cc72-103">MFCMAPI を使用して Outlook プロファイルを作成する</span><span class="sxs-lookup"><span data-stu-id="3cc72-103">Create an Outlook profile using MFCMAPI</span></span>

<span data-ttu-id="3cc72-104">mfcmapi は mapi ストアへのアクセスを提供して、Exchange と Outlook の問題を調査し、開発者に mapi 開発のサポートを提供します。</span><span class="sxs-lookup"><span data-stu-id="3cc72-104">MFCMAPI provides access to MAPI stores to facilitate investigation of Exchange and Outlook issues and to provide developers with support for MAPI development.</span></span>

<span data-ttu-id="3cc72-105">**適用**対象: Office 365 |Outlook |Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="3cc72-105">**Applies to**: Office 365 | Outlook | Outlook 2016</span></span> 
  
<span data-ttu-id="3cc72-106">開発者以外の場合は、Outlook のユーザーインターフェイスを使用して Exchange 2013 のプロファイルを作成することをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="3cc72-106">For non-developers, it is recommended that you use the Outlook user interface to create profiles for Exchange 2013.</span></span>
  
## <a name="configure-an-outlook-profile-using-mfcmapi"></a><span data-ttu-id="3cc72-107">mfcmapi を使用して Outlook プロファイルを構成する</span><span class="sxs-lookup"><span data-stu-id="3cc72-107">Configure an Outlook profile using MFCMAPI</span></span>

1. <span data-ttu-id="3cc72-108">[mfcmapi](https://mfcmapi.codeplex.com/)を開き、[**プロファイル**] メニューの [**プロファイルの表示**] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="3cc72-108">Open [MFCMAPI](https://mfcmapi.codeplex.com/), and on the **Profile** menu, click **Show Profiles**.</span></span> 
    
2. <span data-ttu-id="3cc72-109">[**操作**] メニューの [**プロファイルの作成**] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="3cc72-109">On the **Actions** menu, click **Create Profile**.</span></span> 
    
3. <span data-ttu-id="3cc72-110">プロファイルの新しい名前を作成し、[ **OK**] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="3cc72-110">Create a new name for the profile, and then click **OK**.</span></span> 
    
4. <span data-ttu-id="3cc72-111">新しいプロファイルを右クリックし、[**サービス**] メニューの [サービスの**追加**] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="3cc72-111">Right-click the new profile, and then on the **Services** menu, click **Add Service**.</span></span> 
    
5. <span data-ttu-id="3cc72-112">[サービス UI の表示] チェックボックスをオフにして、[ **OK**] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="3cc72-112">Uncheck the"Display Service UI" box, and then click **OK**.</span></span> 
    
6. <span data-ttu-id="3cc72-113">新しく作成したプロファイルをダブルクリックし、[ **MSEMS** ] サービスをクリックします。</span><span class="sxs-lookup"><span data-stu-id="3cc72-113">Double-click the newly created profile, and then click the **MSEMS** service.</span></span> 
    
7. <span data-ttu-id="3cc72-114">[Exchange プロファイル] セクションを探します。</span><span class="sxs-lookup"><span data-stu-id="3cc72-114">Locate the Exchange Profile section.</span></span>
    
   <span data-ttu-id="3cc72-115">Outlook の MAPI では、2010以降にグローバルプロファイルセクションがなくなったので、これは困難な場合があります。</span><span class="sxs-lookup"><span data-stu-id="3cc72-115">This can be difficult in Outlook's MAPI, since in 2010 and above there is no longer the global profile section.</span></span> <span data-ttu-id="3cc72-116">[プロファイル] セクションを検索するには、プロパティ PR_EMSMDB_SECTION_UID (0x3d150102) を検索します。</span><span class="sxs-lookup"><span data-stu-id="3cc72-116">To find the Profile section, find the property PR_EMSMDB_SECTION_UID (0x3D150102).</span></span> <span data-ttu-id="3cc72-117">この値は、次の手順で使用する、バイナリ形式で保存されたプロファイルセクションの GUID になります。</span><span class="sxs-lookup"><span data-stu-id="3cc72-117">The value will be the GUID of the profile section persisted in binary form, which will be used in the subsequent steps.</span></span> <span data-ttu-id="3cc72-118">この値は、手順9で必要になります。</span><span class="sxs-lookup"><span data-stu-id="3cc72-118">You will need this value in step 9.</span></span>
    
8. <span data-ttu-id="3cc72-119">**MSEMS**サービスをダブルクリックします。</span><span class="sxs-lookup"><span data-stu-id="3cc72-119">Double-click the **MSEMS** service.</span></span> 
    
9. <span data-ttu-id="3cc72-120">手順7の UID を使用して**Exchange**プロファイルセクションを見つけ、シングルクリックでその行を選択します。</span><span class="sxs-lookup"><span data-stu-id="3cc72-120">Find the **Exchange** profile section by using the UID from step 7, and then single-click to select the row.</span></span> 
    
10. <span data-ttu-id="3cc72-121">[プロパティ] メニューの [**その他のプロパティ**] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="3cc72-121">On the Property menu, click **Additional Properties**.</span></span> 
    
11. <span data-ttu-id="3cc72-122">[**追加**] をクリックし、次のプロパティを追加します。</span><span class="sxs-lookup"><span data-stu-id="3cc72-122">Click **Add**, and then add the following properties:</span></span> 
    
    <span data-ttu-id="3cc72-123">**Outlook 2016 の場合**: `PR_PROFILE_USER_SMTP_EMAIL_ADDRESS_W (0x6641001F)`および`PR_DISPLAY_NAME_W`</span><span class="sxs-lookup"><span data-stu-id="3cc72-123">**For Outlook 2016**: `PR_PROFILE_USER_SMTP_EMAIL_ADDRESS_W (0x6641001F)` and `PR_DISPLAY_NAME_W`</span></span>
    
    <span data-ttu-id="3cc72-124">**Outlook for Office 365 の**場合`PR_PROFILE_UNRESOLVED_NAME`: `PR_PROFILE_UNRESOLVED_SERVER`、 `PR_ROH_PROXY_SERVER` `PR_ROH_FLAGS` `PR_ROH_PROXY_AUTH_SCHEME`、、、 `PR_PROFILE_AUTH_PACKAGE`、、、`PR_ROH_PROXY_PRINCIPAL_NAME`</span><span class="sxs-lookup"><span data-stu-id="3cc72-124">**For Outlook for Office 365**: `PR_PROFILE_UNRESOLVED_NAME`, `PR_PROFILE_UNRESOLVED_SERVER`, `PR_ROH_PROXY_SERVER`, `PR_ROH_FLAGS`, `PR_ROH_PROXY_AUTH_SCHEME`, `PR_PROFILE_AUTH_PACKAGE`, and `PR_ROH_PROXY_PRINCIPAL_NAME`</span></span> 
    
    <span data-ttu-id="3cc72-125">**Exchange 2013 の**場合`PR_PROFILE_UNRESOLVED_NAME`: `PR_PROFILE_UNRESOLVED_SERVER`、 `PR_ROH_PROXY_SERVER` `PR_ROH_FLAGS`、、 `PR_ROH_PROXY_AUTH_SCHEME`、、 `PR_PROFILE_AUTH_PACKAGE`、。</span><span class="sxs-lookup"><span data-stu-id="3cc72-125">**For Exchange 2013**: `PR_PROFILE_UNRESOLVED_NAME`, `PR_PROFILE_UNRESOLVED_SERVER`, `PR_ROH_PROXY_SERVER`, `PR_ROH_FLAGS`, `PR_ROH_PROXY_AUTH_SCHEME`, and `PR_PROFILE_AUTH_PACKAGE`.</span></span> 
    
12. <span data-ttu-id="3cc72-126">[ **OK**] をクリックし、接続先のバージョンに応じて、以下の表に従って各プロパティを構成します。</span><span class="sxs-lookup"><span data-stu-id="3cc72-126">Click **OK**, and then configure each property according to the table below, depending on the version you are connecting to.</span></span> 
    
13. <span data-ttu-id="3cc72-127">[**セッション**] メニューで、[**ログオンと表示ストア**] をクリックしてから、プロファイルを選択します (まだ選択されていない場合)。</span><span class="sxs-lookup"><span data-stu-id="3cc72-127">On the **Session** menu, click **Logon and Display Store**, and then select the profile (if it is not already selected).</span></span> 
    
### <a name="outlook-2016"></a><span data-ttu-id="3cc72-128">Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="3cc72-128">Outlook 2016</span></span>
  
||||
|:-----|:-----|:-----|
|<span data-ttu-id="3cc72-129">**Property**</span><span class="sxs-lookup"><span data-stu-id="3cc72-129">**Property**</span></span> <br/> |<span data-ttu-id="3cc72-130">**Tag**</span><span class="sxs-lookup"><span data-stu-id="3cc72-130">**Tag**</span></span> <br/> |<span data-ttu-id="3cc72-131">**説明**</span><span class="sxs-lookup"><span data-stu-id="3cc72-131">**Description**</span></span> <br/> |
| <span data-ttu-id="3cc72-132">PR_PROFILE_USER_SMTP_EMAIL_ADDRESS_W</span><span class="sxs-lookup"><span data-stu-id="3cc72-132">PR_PROFILE_USER_SMTP_EMAIL_ADDRESS_W</span></span>  <br/> |<span data-ttu-id="3cc72-133">0x6641001f</span><span class="sxs-lookup"><span data-stu-id="3cc72-133">0x6641001F</span></span>  <br/> |<span data-ttu-id="3cc72-134">ユーザーの SMTP アドレス</span><span class="sxs-lookup"><span data-stu-id="3cc72-134">SMTP Address of the user</span></span>  <br/> |
|<span data-ttu-id="3cc72-135">PR_DISPLAY_NAME_W</span><span class="sxs-lookup"><span data-stu-id="3cc72-135">PR_DISPLAY_NAME_W</span></span>  <br/> |<span data-ttu-id="3cc72-136">0x3001001F</span><span class="sxs-lookup"><span data-stu-id="3cc72-136">0x3001001F</span></span>  <br/> |<span data-ttu-id="3cc72-137">ユーザーの表示名</span><span class="sxs-lookup"><span data-stu-id="3cc72-137">The display name of the user</span></span>  <br/> |
|<span data-ttu-id="3cc72-138">PR_STORE_PROVIDERS</span><span class="sxs-lookup"><span data-stu-id="3cc72-138">PR_STORE_PROVIDERS</span></span>  <br/> |<span data-ttu-id="3cc72-139">0x3d000102</span><span class="sxs-lookup"><span data-stu-id="3cc72-139">0x3D000102</span></span>  <br/> |<span data-ttu-id="3cc72-140">**EMSMDB**セクションにあるこのプロパティの値を構成し、一致するプロパティに対応する UID を更新します。</span><span class="sxs-lookup"><span data-stu-id="3cc72-140">Configure the value of this property, located in the **EMSMDB** section, and update the corresponding UID for the matching property</span></span>  <br/> |
   
### <a name="outlook-for-office-365"></a><span data-ttu-id="3cc72-141">Outlook for Office 365</span><span class="sxs-lookup"><span data-stu-id="3cc72-141">Outlook for Office 365</span></span>
  
||||
|:-----|:-----|:-----|
|<span data-ttu-id="3cc72-142">**プロパティ**</span><span class="sxs-lookup"><span data-stu-id="3cc72-142">**Property**</span></span> <br/> |<span data-ttu-id="3cc72-143">**値**</span><span class="sxs-lookup"><span data-stu-id="3cc72-143">**Value**</span></span> <br/> |<span data-ttu-id="3cc72-144">**説明**</span><span class="sxs-lookup"><span data-stu-id="3cc72-144">**Description**</span></span> <br/> |
|<span data-ttu-id="3cc72-145">PR_PROFILE_UNRESOLVED_NAME<sup>1</sup></span><span class="sxs-lookup"><span data-stu-id="3cc72-145">PR_PROFILE_UNRESOLVED_NAME<sup>1</sup></span></span> <br/> |<span data-ttu-id="3cc72-146">メールボックスのエイリアス</span><span class="sxs-lookup"><span data-stu-id="3cc72-146">mailbox alias</span></span>  <br/> |<span data-ttu-id="3cc72-147">ターゲットメールボックスのエイリアス。たとえば、管理者</span><span class="sxs-lookup"><span data-stu-id="3cc72-147">The alias for the target mailbox; for example, Administrator</span></span>  <br/> |
|<span data-ttu-id="3cc72-148">PR_PROFILE_UNRESOLVED_SERVER<sup>1</sup></span><span class="sxs-lookup"><span data-stu-id="3cc72-148">PR_PROFILE_UNRESOLVED_SERVER<sup>1</sup></span></span> <br/> |<span data-ttu-id="3cc72-149">個人用のサーバー id</span><span class="sxs-lookup"><span data-stu-id="3cc72-149">personalized server id</span></span>  <br/> |<span data-ttu-id="3cc72-150">**自動検出**から取得された値。</span><span class="sxs-lookup"><span data-stu-id="3cc72-150">The value retrieved from **Autodiscover**.</span></span> <span data-ttu-id="3cc72-151">形式<guid>@tenant onmicrosoft.com。たとえば、F5FA2827-5978-43cd-8FA8-E07BC3BB5591@contoso.onmicrosoft.com</span><span class="sxs-lookup"><span data-stu-id="3cc72-151">in the format <guid>@tenant.onmicrosoft.com; for example, F5FA2827-5978-43cd-8FA8-E07BC3BB5591@contoso.onmicrosoft.com</span></span>  <br/>  <span data-ttu-id="3cc72-152">*自動検出ノード*: Response/Account/Protocol/Server (EXCH)</span><span class="sxs-lookup"><span data-stu-id="3cc72-152">*Autodiscover Node*  : Response/Account/Protocol/Server (EXCH)</span></span>  <br/> |
|<span data-ttu-id="3cc72-153">PR_ROH_PROXY_SERVER</span><span class="sxs-lookup"><span data-stu-id="3cc72-153">PR_ROH_PROXY_SERVER</span></span>  <br/> |<span data-ttu-id="3cc72-154">outlook.office365.com</span><span class="sxs-lookup"><span data-stu-id="3cc72-154">outlook.office365.com</span></span>  <br/> | <span data-ttu-id="3cc72-155">*自動検出ノード*: Response/Account/Protocol/Server (EXPR) <sup>2</sup></span><span class="sxs-lookup"><span data-stu-id="3cc72-155">*Autodiscover Node*  : Response/Account/Protocol/Server (EXPR) <sup>2</sup></span></span> <br/> |
|<span data-ttu-id="3cc72-156">PR_ROH_FLAGS</span><span class="sxs-lookup"><span data-stu-id="3cc72-156">PR_ROH_FLAGS</span></span>  <br/> |<span data-ttu-id="3cc72-157">ROHFLAGS_USE_ROH (0x1)</span><span class="sxs-lookup"><span data-stu-id="3cc72-157">ROHFLAGS_USE_ROH (0x1)</span></span>  <br/> <span data-ttu-id="3cc72-158">ROH_FLAGS_USE_SSL (0x2)</span><span class="sxs-lookup"><span data-stu-id="3cc72-158">ROH_FLAGS_USE_SSL (0x2)</span></span>  <br/>  <span data-ttu-id="3cc72-159">ROHFLAGS_MUTUAL_AUTH (0x4)</span><span class="sxs-lookup"><span data-stu-id="3cc72-159">ROHFLAGS_MUTUAL_AUTH (0x4)</span></span>  <br/>  <span data-ttu-id="3cc72-160">ROHFLAGS_HTTP_FIRST_ON_FAST (0x8)</span><span class="sxs-lookup"><span data-stu-id="3cc72-160">ROHFLAGS_HTTP_FIRST_ON_FAST (0x8)</span></span>  <br/>  <span data-ttu-id="3cc72-161">ROHFLAGS_HTTP_FIRST_ON_SLOW (0x20)</span><span class="sxs-lookup"><span data-stu-id="3cc72-161">ROHFLAGS_HTTP_FIRST_ON_SLOW (0x20)</span></span>  <br/> |<span data-ttu-id="3cc72-162">ハイパーテキスト転送プロトコル (HTTP) 経由のリモートプロシージャコール (RPC) を使用して Microsoft Exchange Server に接続するために Outlook で使用されるプロファイルの設定が含まれています。</span><span class="sxs-lookup"><span data-stu-id="3cc72-162">Contains the settings in a profile used by Outlook to connect to Microsoft Exchange Server by using a remote procedure call (RPC) over Hypertext Transfer Protocol (HTTP).</span></span> <span data-ttu-id="3cc72-163">*自動検出ノード*: Response/Account/Protocol/SSL (EXPR) <sup>2</sup></span><span class="sxs-lookup"><span data-stu-id="3cc72-163">*Autodiscover Node*  : Response/Account/Protocol/SSL (EXPR) <sup>2</sup></span></span> <br/> |
| <span data-ttu-id="3cc72-164">PR_ROH_PROXY_AUTH_SCHEME</span><span class="sxs-lookup"><span data-stu-id="3cc72-164">PR_ROH_PROXY_AUTH_SCHEME</span></span>  <br/> | <span data-ttu-id="3cc72-165">RPC_C_HTTP_AUTHN_SCHEME_BASIC (0x1)</span><span class="sxs-lookup"><span data-stu-id="3cc72-165">RPC_C_HTTP_AUTHN_SCHEME_BASIC (0x1)</span></span>  <br/> |<span data-ttu-id="3cc72-166">このプロファイル*自動検出ノード*に使用される認証プロトコルを表します。 Response/Account/protocol/authpackage (EXPR) <sup>2</sup></span><span class="sxs-lookup"><span data-stu-id="3cc72-166">Represents the authentication protocol to be used for this profile *Autodiscover Node*  : Response/Account/Protocol/AuthPackage (EXPR) <sup>2</sup></span></span> <br/> |
|<span data-ttu-id="3cc72-167">PR_PROFILE_AUTH_PACKAGE</span><span class="sxs-lookup"><span data-stu-id="3cc72-167">PR_PROFILE_AUTH_PACKAGE</span></span>  <br/> |<span data-ttu-id="3cc72-168">RPC_C_AUTHN_NONE (0x0)</span><span class="sxs-lookup"><span data-stu-id="3cc72-168">RPC_C_AUTHN_NONE (0x0)</span></span>  <br/> |<span data-ttu-id="3cc72-169">[RPC*自動検出] ノード*で使用する認証方式について説明します。 Response/Account/Protocol/authpackage (EXCH)) <sup>3</sup></span><span class="sxs-lookup"><span data-stu-id="3cc72-169">Describes the authentication scheme to use for the RPC *Autodiscover Node*  : Response/Account/Protocol/AuthPackage (EXCH) ) <sup>3</sup></span></span> <br/> |
|<span data-ttu-id="3cc72-170">PR_ROH_PROXY_PRINCIPAL_NAME</span><span class="sxs-lookup"><span data-stu-id="3cc72-170">PR_ROH_PROXY_PRINCIPAL_NAME</span></span>  <br/> |<span data-ttu-id="3cc72-171">CertPrincipalName 要素</span><span class="sxs-lookup"><span data-stu-id="3cc72-171">CertPrincipalName element</span></span>  <br/> |<span data-ttu-id="3cc72-172">相互認証をサポートするために使用されます。たとえば、msstd: outlook .com*自動検出ノード*: Response/Account/Protocol/CertPrincipalName (EXPR) <sup>2</sup></span><span class="sxs-lookup"><span data-stu-id="3cc72-172">Used to support mutual authentication; for example, msstd:outlook.com *Autodiscover Node*  : Response/Account/Protocol/CertPrincipalName (EXPR) ) <sup>2</sup></span></span> <br/> |
   
### <a name="exchange-2013"></a><span data-ttu-id="3cc72-173">Exchange 2013</span><span class="sxs-lookup"><span data-stu-id="3cc72-173">Exchange 2013</span></span>
  
||||
|:-----|:-----|:-----|
|<span data-ttu-id="3cc72-174">**プロパティ**</span><span class="sxs-lookup"><span data-stu-id="3cc72-174">**Property**</span></span> <br/> |<span data-ttu-id="3cc72-175">**値**</span><span class="sxs-lookup"><span data-stu-id="3cc72-175">**Value**</span></span> <br/> |<span data-ttu-id="3cc72-176">**説明**</span><span class="sxs-lookup"><span data-stu-id="3cc72-176">**Description**</span></span> <br/> |
|<span data-ttu-id="3cc72-177">PR_PROFILE_UNRESOLVED_NAME<sup>1</sup></span><span class="sxs-lookup"><span data-stu-id="3cc72-177">PR_PROFILE_UNRESOLVED_NAME<sup>1</sup></span></span> <br/> |<span data-ttu-id="3cc72-178">メールボックスのエイリアス</span><span class="sxs-lookup"><span data-stu-id="3cc72-178">mailbox alias</span></span>  <br/> |<span data-ttu-id="3cc72-179">ターゲットメールボックスのエイリアス。たとえば、管理者</span><span class="sxs-lookup"><span data-stu-id="3cc72-179">The alias for the target mailbox; for example, Administrator</span></span>  <br/> |
|<span data-ttu-id="3cc72-180">PR_PROFILE_UNRESOLVED_SERVER<sup>1</sup></span><span class="sxs-lookup"><span data-stu-id="3cc72-180">PR_PROFILE_UNRESOLVED_SERVER<sup>1</sup></span></span> <br/> |<span data-ttu-id="3cc72-181">個人用のサーバー id</span><span class="sxs-lookup"><span data-stu-id="3cc72-181">personalized server id</span></span>  <br/> |<span data-ttu-id="3cc72-182">**自動検出**から取得された値。</span><span class="sxs-lookup"><span data-stu-id="3cc72-182">The value retrieved from **Autodiscover**.</span></span> <span data-ttu-id="3cc72-183">形式<guid>@tenant onmicrosoft.com。たとえば、F5FA2827-5978-43cd-8FA8-E07BC3BB5591@contoso.onmicrosoft.com</span><span class="sxs-lookup"><span data-stu-id="3cc72-183">in the format <guid>@tenant.onmicrosoft.com; for example, F5FA2827-5978-43cd-8FA8-E07BC3BB5591@contoso.onmicrosoft.com</span></span>  <br/>  <span data-ttu-id="3cc72-184">*自動検出ノード*: Response/Account/Protocol/Server (EXCH)</span><span class="sxs-lookup"><span data-stu-id="3cc72-184">*Autodiscover Node*  : Response/Account/Protocol/Server (EXCH)</span></span>  <br/> |
|<span data-ttu-id="3cc72-185">PR_ROH_PROXY_SERVER</span><span class="sxs-lookup"><span data-stu-id="3cc72-185">PR_ROH_PROXY_SERVER</span></span>  <br/> | <span data-ttu-id="3cc72-186">クライアントアクセスサーバーのドメイン名</span><span class="sxs-lookup"><span data-stu-id="3cc72-186">client access server domain name</span></span>  <br/> | <span data-ttu-id="3cc72-187">完全修飾ドメイン名 (FQDN)。たとえば、e2013cas.contoso.com*自動検出ノード*: Response/Account/Protocol/Server (EXPR) <sup>2</sup></span><span class="sxs-lookup"><span data-stu-id="3cc72-187">The fully qualified domain name (FQDN); for example, e2013cas.contoso.com  *Autodiscover Node*  : Response/Account/Protocol/Server (EXPR) <sup>2</sup></span></span> <br/> |
|<span data-ttu-id="3cc72-188">PR_ROH_FLAGS</span><span class="sxs-lookup"><span data-stu-id="3cc72-188">PR_ROH_FLAGS</span></span>  <br/> |<span data-ttu-id="3cc72-189">ROHFLAGS_USE_ROH (0x1)</span><span class="sxs-lookup"><span data-stu-id="3cc72-189">ROHFLAGS_USE_ROH (0x1)</span></span>  <br/>  <span data-ttu-id="3cc72-190">ROHFLAGS_HTTP_FIRST_ON_FAST (0x8)</span><span class="sxs-lookup"><span data-stu-id="3cc72-190">ROHFLAGS_HTTP_FIRST_ON_FAST (0x8)</span></span>  <br/> <span data-ttu-id="3cc72-191">ROHFLAGS_HTTP_FIRST_ON_SLOW (0x20))</span><span class="sxs-lookup"><span data-stu-id="3cc72-191">ROHFLAGS_HTTP_FIRST_ON_SLOW (0x20))</span></span>  <br/> |<span data-ttu-id="3cc72-192">ハイパーテキスト転送プロトコル (HTTP)*自動検出ノード*経由のリモートプロシージャコール (RPC) を使用して Microsoft Exchange Server に接続するために Outlook で使用されるプロファイルの設定が含まれます。 Response/Account/Protocol/SSL (EXPR) <sup>2</sup></span><span class="sxs-lookup"><span data-stu-id="3cc72-192">Contains the settings in a profile used by Outlook to connect to Microsoft Exchange Server by using a remote procedure call (RPC) over Hypertext Transfer Protocol (HTTP) *Autodiscover Node*  : Response/Account/Protocol/SSL (EXPR) <sup>2</sup></span></span> <br/> |
| <span data-ttu-id="3cc72-193">PR_ROH_PROXY_AUTH_SCHEME</span><span class="sxs-lookup"><span data-stu-id="3cc72-193">PR_ROH_PROXY_AUTH_SCHEME</span></span>  <br/> | <span data-ttu-id="3cc72-194">RPC_C_HTTP_AUTHN_SCHEME_NTLM (0x2)</span><span class="sxs-lookup"><span data-stu-id="3cc72-194">RPC_C_HTTP_AUTHN_SCHEME_NTLM (0x2)</span></span>  <br/> |<span data-ttu-id="3cc72-195">このプロファイル*自動検出ノード*に使用される認証プロトコルを表します。 Response/Account/protocol/authpackage (EXPR) <sup>2</sup></span><span class="sxs-lookup"><span data-stu-id="3cc72-195">Represents the authentication protocol to be used for this profile *Autodiscover Node*  : Response/Account/Protocol/AuthPackage (EXPR) <sup>2</sup></span></span> <br/> |
|<span data-ttu-id="3cc72-196">PR_PROFILE_AUTH_PACKAGE</span><span class="sxs-lookup"><span data-stu-id="3cc72-196">PR_PROFILE_AUTH_PACKAGE</span></span>  <br/> |<span data-ttu-id="3cc72-197">RPC_C_AUTHN_WINNT (0xa)</span><span class="sxs-lookup"><span data-stu-id="3cc72-197">RPC_C_AUTHN_WINNT (0xA)</span></span>  <br/> |<span data-ttu-id="3cc72-198">[RPC*自動検出] ノード*で使用する認証方式について説明します。 Response/Account/Protocol/authpackage (EXCH)) <sup>3</sup></span><span class="sxs-lookup"><span data-stu-id="3cc72-198">Describes the authentication scheme to use for RPC *Autodiscover Node*  : Response/Account/Protocol/AuthPackage (EXCH) ) <sup>3</sup></span></span> <br/> |
   
> [!NOTE] 
> - <span data-ttu-id="3cc72-199">前述のすべてのプロパティ値は、特定の組織によって異なる場合があります。</span><span class="sxs-lookup"><span data-stu-id="3cc72-199">All property values mentioned above may vary for your particular organization.</span></span> 
> - <span data-ttu-id="3cc72-200"><sup>1</sup> ANSI バージョンではなく、Unicode バージョンを使用する必要があります。</span><span class="sxs-lookup"><span data-stu-id="3cc72-200"><sup>1</sup> You must use the Unicode version, rather than the ANSI version.</span></span> 
> - <span data-ttu-id="3cc72-201">プレーン旧 XML (POX) ベースの自動検出を使用する必要があります。</span><span class="sxs-lookup"><span data-stu-id="3cc72-201">You must use the Plain Old XML (POX) based Autodiscover.</span></span> <span data-ttu-id="3cc72-202">これは、Outlook/Exchange プロファイルを構成するためにサポートされている自動検出のみです。</span><span class="sxs-lookup"><span data-stu-id="3cc72-202">This is the only supported Autodiscover for configuring Outlook/Exchange profiles.</span></span>
> - <span data-ttu-id="3cc72-203">outlook を使用して、**システムトレイ**の outlook アイコンを右クリックし、CTRL キーを押しながら [**電子メールの構成のテスト**] をクリックすることによって、自動検出要求を行うことができます。</span><span class="sxs-lookup"><span data-stu-id="3cc72-203">You can use Outlook to make an Autodiscover request on your behalf by right-clicking the Outlook icon in the **System Tray**, while holding down CTRL and clicking **Test E-Mail Autoconfiguration**.</span></span> 
> - <span data-ttu-id="3cc72-204">PR_ROH_FLAGS の場合、使用している環境では、SSL のみを使用するように MAPI に通知するフラグ ROHFLAGS_SSL_ONLY (0x2) が必要な場合があります。</span><span class="sxs-lookup"><span data-stu-id="3cc72-204">For PR_ROH_FLAGS, your environment may require the flag ROHFLAGS_SSL_ONLY (0x2) to tell MAPI to use only SSL.</span></span> <span data-ttu-id="3cc72-205">環境で相互認証が必要な場合は、そのフラグを設定する必要があります (ROHFLAGS_MUTUAL_AUTH (0x4))。</span><span class="sxs-lookup"><span data-stu-id="3cc72-205">If your environment requires mutual authentication, you will need to set that flag as well [ROHFLAGS_MUTUAL_AUTH (0x4)].</span></span> <span data-ttu-id="3cc72-206">ROHFLAGS_MUTUAL_AUTH (0x4) を設定すると、プロパティ PR_ROH_PROXY_PRINCIPAL_NAME も設定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="3cc72-206">Setting ROHFLAGS_MUTUAL_AUTH (0x4) will require that you also set the property PR_ROH_PROXY_PRINCIPAL_NAME.</span></span> <span data-ttu-id="3cc72-207">これは、サーバーのプリンシパル名に設定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="3cc72-207">You should set this to be the principal name of the server.</span></span>
> - <span data-ttu-id="3cc72-208"><sup>2</sup> Outlook 2010 の場合は、EXPR プロトコルを使用する必要があります。</span><span class="sxs-lookup"><span data-stu-id="3cc72-208"><sup>2</sup> For Outlook 2010, you will need to use the EXPR protocol.</span></span> <span data-ttu-id="3cc72-209">Outlook 2013 は exhttp プロトコルを使用します。</span><span class="sxs-lookup"><span data-stu-id="3cc72-209">Outlook 2013 uses the EXHTTP protocol.</span></span> 
> - <span data-ttu-id="3cc72-210"><sup>3</sup>この値は、自動検出応答に含まれない場合があります。</span><span class="sxs-lookup"><span data-stu-id="3cc72-210"><sup>3</sup> This value may not be in the Autodiscover response.</span></span> <span data-ttu-id="3cc72-211">指定しない場合、クライアントは Kerberos または NTLM を使用する必要があります。</span><span class="sxs-lookup"><span data-stu-id="3cc72-211">If not specified, the client should use Kerberos or NTLM.</span></span> 
    
<span data-ttu-id="3cc72-212">トラブルシューティングのヒントについては、「 [mfcmapi を使用して Exchange 2013 用の Outlook プロファイルを構成する方法](https://blogs.msdn.microsoft.com/dvespa/2014/01/16/how-to-configure-an-outlook-profile-using-mfcmapi-for-exchange-2013)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="3cc72-212">For Troubleshooting tips, see [How to configure an Outlook profile using MFCMAPI for Exchange 2013](https://blogs.msdn.microsoft.com/dvespa/2014/01/16/how-to-configure-an-outlook-profile-using-mfcmapi-for-exchange-2013).</span></span>
  
## <a name="see-also"></a><span data-ttu-id="3cc72-213">関連項目</span><span class="sxs-lookup"><span data-stu-id="3cc72-213">See also</span></span>

- [<span data-ttu-id="3cc72-214">Outlook MAPI リファレンス</span><span class="sxs-lookup"><span data-stu-id="3cc72-214">Outlook MAPI Reference</span></span>](https://msdn.microsoft.com/library/office/cc765775.aspx)  
- [<span data-ttu-id="3cc72-215">Outlook でプログラムによってプロファイルを作成する</span><span class="sxs-lookup"><span data-stu-id="3cc72-215">Programmatically Create a Profile in Outlook</span></span>](https://msdn.microsoft.com/library/office/mt707568.aspx)
    

