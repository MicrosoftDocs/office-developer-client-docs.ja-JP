---
title: メッセージ サービスの設計
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 32627ebb-547f-4fac-a406-e7243ec5521b
description: '最終更新日: 2011 年 7 月 23 日'
ms.openlocfilehash: 19a8a939685c440901f3f57d72baf673a579e590
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/28/2019
ms.locfileid: "33404296"
---
# <a name="designing-a-message-service"></a>メッセージ サービスの設計

**適用対象**: Outlook 2013 | Outlook 2016 
  
メッセージ サービスをサポートするコードを記述する前に、デザインを作成することが重要です。 設計プロセスで次の問題を解決します。
  
1. メッセージ サービスに含めるサービス プロバイダーの数を決定します。 関連するサービス プロバイダー (つまり、同じメッセージング システムで動作するプロバイダー) のみをサービスに含める。 関連のないサービス プロバイダーは、同じメッセージ サービスに属していない。 プロファイルを使用して、関連のないサービス プロバイダーとメッセージ サービスを統合します。
    
2. メッセージ サービスに含めるサービス プロバイダーの種類を決定します。 ほとんどの混乱サービスには、各共通の種類のプロバイダーが 1 つ含まれます。 つまり、一般的なメッセージ サービスには、1 つのアドレス帳プロバイダー、1 つのメッセージ ストア プロバイダー、および 1 つのトランスポート プロバイダーがあります。
    
3. メッセージ サービスを含める DLL の数を決定します。 メッセージ サービスが使用する DLL の数は、次に依存します。
    
   - メッセージ サービスの作成者として処理する複雑さの程度。
    
   - メッセージ サービス内のサービス プロバイダーの種類。
    
   - メッセージ サービスが別のメッセージ サービスと持つ可能性のある関係。
    
   MAPI はプロバイダーの種類ごとにエントリ ポイントを 1 つしか格納しないので、同じ種類の複数のプロバイダーを 1 つの DLL に含めないためです。 1 つの種類の複数のプロバイダーを含めるのが理にかなっている場合は、それらを個別の DLL に実装するか、エントリ ポイント関数を共有します。 もう 1 つのオプションは、1 つの DLL で同じインストールおよび構成コードと同じ DLL エントリ ポイント関数を使用できる、関連するメッセージ サービス、またはメッセージ サービスを実装する方法です。
    
   可能であれば、シンプルにし、メッセージ サービス内のすべてのサービス プロバイダーの実装と、メッセージ サービスをインストールおよび構成するためにすべてのコードを含む 1 つの DLL を使用します。 これができない場合は、インストールと構成コードに 1 つの DLL を実装し、すべてのサービス プロバイダーに対して 1 つの DLL を実装するか、プロバイダーごとに 1 つの DLL を実装できます。
    
4. メッセージ サービス DLL または DLL の名前を決定します。 
    
## <a name="see-also"></a>関連項目

- [Message Service の実装](message-service-implementation.md)

