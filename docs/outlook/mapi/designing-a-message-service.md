---
title: メッセージ サービスの設計
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 32627ebb-547f-4fac-a406-e7243ec5521b
description: '最終更新日: 2011 年 7 月 23 日'
ms.openlocfilehash: 19a8a939685c440901f3f57d72baf673a579e590
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/28/2019
ms.locfileid: "33404296"
---
# <a name="designing-a-message-service"></a>メッセージ サービスの設計

**適用対象**: Outlook 2013 | Outlook 2016 
  
メッセージサービスをサポートするコードの記述を開始する前に、デザインを作成することが重要です。 設計プロセスでは、以下の問題を解決します。
  
1. メッセージサービスに含める必要があるサービスプロバイダーの数を決定します。 サービスでは、関連するサービスプロバイダー (つまり、同じメッセージングシステムと連携するプロバイダー) のみを含めます。 関連付けられていないサービスプロバイダーは、同じメッセージサービスに属していません。 関連性のないサービスプロバイダーとメッセージサービスを統合するには、プロファイルを使用します。
    
2. メッセージサービスに含める必要があるサービスプロバイダーの種類を決定します。 ほとんどの messge サービスには、一般的な各種類のプロバイダーが1つ含まれています。 つまり、一般的なメッセージサービスには、1つのアドレス帳プロバイダー、1つのメッセージストアプロバイダー、および1つのトランスポートプロバイダーがあります。
    
3. メッセージサービスを含める dll の数を決定します。 メッセージサービスが使用する dll の数は、以下によって決まります。
    
   - メッセージサービスのライターとして処理する複雑さの程度。
    
   - メッセージサービスのサービスプロバイダーの種類。
    
   - メッセージサービスが別のメッセージサービスとの関係を示します。
    
   MAPI にはプロバイダーの種類ごとに1つのエントリポイントのみが格納されるため、同じ種類の複数のプロバイダーを1つの DLL に含めないでください。 1つの種類の複数のプロバイダーを含めることが適切である場合は、それらを別の dll に実装するか、またはエントリポイント関数を共有することになります。 別の方法として、1つの dll で、同じインストールと構成のコードと同じ dll エントリポイント関数を使用できる、関連するメッセージサービスまたはメッセージサービスを実装する方法があります。
    
   可能であれば、単純にして、メッセージサービス内のすべてのサービスプロバイダーの実装を含む1つの DLL と、メッセージサービスをインストールして構成するすべてのコードを使用します。 これができない場合は、インストールと構成のコードに1つの dll を実装することができます。また、プロバイダーごとに1つの dll を実装することもできます。
    
4. メッセージサービス dll または dll の名前を特定します。 
    
## <a name="see-also"></a>関連項目

- [メッセージサービスの実装](message-service-implementation.md)

