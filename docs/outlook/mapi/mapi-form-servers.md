---
title: MAPI フォームサーバー
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 855292b8-028e-4c1e-87ed-3f20b9ba584a
description: '最終更新日: 2011 年 7 月 23 日'
ms.openlocfilehash: 3c95f6a1d4d50dd6552c6e786d17c40da14f3f3c
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/28/2019
ms.locfileid: "33419108"
---
# <a name="mapi-form-servers"></a>MAPI フォームサーバー

  
  
**適用対象**: Outlook 2013 | Outlook 2016 
  
ユーザーの視点から見ると、通常、フォームは、ユーザーが構造化された情報を入力できるようにする、メッセージまたはデータ入力フォームのプロパティシートです。 ただし、メッセージクラスに関連付けられている任意のユーザーインターフェイスを使用できます。 プログラマの視点から見ると、フォームは次の要素で構成されています。
  
- 独自のメッセージクラスと OLE 識別子を持つ MAPI メッセージの種類。
    
- フォームサーバーを実装する実行可能ファイル。
    
- フォームサーバーで使用される MAPI プロパティのコレクション (カスタムまたはそれ以外)。 これらの一部またはすべてを、メッセージングクライアントが使用できるようにすることができます。
    
- フォームを説明する構成ファイル。フォームマネージャーによって使用されます。
    
フォームは[IMessage](imessageimapiprop.md)オブジェクトであるため、MAPI メッセージオブジェクトと一貫性のあるプロパティと動作が表示されます。 ただし、フォームには、カスタムプロパティ、コントロール、およびアプリケーション固有の表示レンダリングがあるため、フォームで使用される MAPI インターフェイスは汎用的なものであり、必要なインターフェイスのあらゆる種類を許可します。 フォームの実際の定義は、フォームライブラリに格納されます。これについては、このセクションで後述します。 
  
> [!NOTE]
> 正確には、すべてのメッセージは MAPI フォームのインスタンスです。 ただし、通常の電子メールメッセージを作成するためのフォームが最もよく使用されるフォームなので、ユーザー設定フォームは、通常、メッセージの特殊なケースとして考えるほうが簡単です。 すべてのメッセージは単にフォームであるため、カスタムフォームには MAPI システムの他のメッセージと同じ状態が与えられます。 
  
すべてのフォームには一連のプロパティがあり、その一部はフォームのユーザーインターフェイスに表示されます。 通常、プロパティはフォームのユーザーインターフェイスのフィールドと一致します。 たとえば、発注書フォームには、フィールドアイテム、説明、価格、税金、および小計があります。 これらのフィールドは、同じ名前のフォームプロパティを視覚的に表示するだけです。 クライアントは、MAPI フォームマネージャーで実装されている[imapiforminfo:: CalcFormPropSet](imapiforminfo-calcformpropset.md)メソッドを使用して、特定のメッセージクラスでサポートされているプロパティを確認します。 
  
MAPI フォームには、基本メッセージと同様に、送信者、目的の受信者、メッセージの送信日時など、すべての標準メッセージプロパティを含めることができます。 フォームには、フォームに固有の任意の数のカスタムプロパティを含めることもできます。 たとえば、"バグレポート" フォームには、バグの種類、バグの重大度、および製品バージョンのカスタムプロパティが含まれている場合があります。
  
フォームを作成するには、フォームサーバーを実装する必要があります。 フォームサーバーは、メッセージングクライアントがフォームサーバーでサポートされている種類のメッセージを表示する必要がある場合に読み込まれる実行可能ファイルです。 その後、フォームサーバーは、必要に応じてフォームオブジェクトを作成し、特定のメッセージを表示して、それらのメッセージでのユーザー操作を処理します。
  
すべてのフォームサーバーには、構成ファイルが関連付けられています。 このファイルには、フォームマネージャーの利点を得るためのフォームサーバーを説明する情報が含まれています。 フォームマネージャーは、フォームサーバーをフォームライブラリにインストールするときにこの情報を使用します。
  
フォームのパーツを作成する方法の詳細については、「 [MAPI フォームサーバーの開発](developing-mapi-form-servers.md)」を参照してください。
  
フォームサーバーは、コンポーネントオブジェクトモデル (COM) に準拠しています。 フォームサーバーは、インプロセスサーバーとしてではなく、スタンドアロンの実行可能ファイルとして実行されます。 詳細については、Windows SDK の「COM および ActiveX のオブジェクトサービス」セクションを参照してください。
  
一意のクラス識別子 (CLSID) は、各フォームサーバーを識別します。 クラス識別子とそのメッセージクラスの間には、常に1対1のマッピングがあります。 ただし、フォームサーバーは、1つのメッセージクラスのメッセージでしか動作できないことを意味するわけではありません。 特定のクラスのメッセージを処理するためのフォームサーバーが利用できない場合、使用されているフォームマネージャーは、メッセージクラス階層内で上位にあるメッセージクラスのフォームサーバーの検索を試みる必要があります。Windows SDK で提供される既定のフォームマネージャーがこれを行います。 このようなフォームサーバーは、おそらく、メッセージのプロパティ (スーパークラスでサポートされているもの) のサブセットのみを表示できるようになりますが、nothing よりも優れています。 一致するフォームサーバーが見つからない場合は、使用されているフォームマネージャーに固有の実装の詳細が発生します。このイベントが発生した場合、既定のフォームマネージャーはメッセージを開きません。
  
詳細については、「 [MAPI メッセージクラス](mapi-message-classes.md)」を参照してください。
  
## <a name="see-also"></a>関連項目



[MAPI フォーム](mapi-forms.md)

