---
title: アドレス帳の識別子
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 40f6c699-86aa-4324-a30d-12c8f1e2de9c
description: '最終更新日: 2011 年 7 月 23 日'
ms.openlocfilehash: 822d83c4b77d06c2e000b391c7e229985470ccd3
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/28/2019
ms.locfileid: "33421572"
---
# <a name="address-book-identifiers"></a><span data-ttu-id="c1882-103">アドレス帳の識別子</span><span class="sxs-lookup"><span data-stu-id="c1882-103">Address Book Identifiers</span></span>

  
  
<span data-ttu-id="c1882-104">**適用対象**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="c1882-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="c1882-105">すべてのアドレス帳プロバイダーは、 **PR_ENTRYID** ([PidTagEntryId](pidtagentryid-canonical-property.md)) プロパティを使用して、メッセージングユーザーおよび配布リストオブジェクトにエントリ識別子を割り当てます。</span><span class="sxs-lookup"><span data-stu-id="c1882-105">All address book providers assign entry identifiers using the **PR_ENTRYID** ([PidTagEntryId](pidtagentryid-canonical-property.md)) property to their messaging user and distribution list objects.</span></span> <span data-ttu-id="c1882-106">クライアントアプリケーションは、これらのエントリ識別子を使用して、割り当てられているオブジェクトを開いてアクセスします。</span><span class="sxs-lookup"><span data-stu-id="c1882-106">Client applications use these entry identifiers to open and access the objects to which they are assigned.</span></span>
  
<span data-ttu-id="c1882-107">アドレス帳は、次の3種類の識別子を使用してオブジェクトを表します。</span><span class="sxs-lookup"><span data-stu-id="c1882-107">The address book makes use of three other types of identifiers to represent objects:</span></span>
  
- <span data-ttu-id="c1882-108">一時エントリ識別子</span><span class="sxs-lookup"><span data-stu-id="c1882-108">One-off entry identifiers</span></span>
    
- <span data-ttu-id="c1882-109">1回限りのテンプレートエントリ識別子</span><span class="sxs-lookup"><span data-stu-id="c1882-109">One-off template entry identifiers</span></span>
    
- <span data-ttu-id="c1882-110">テンプレート識別子</span><span class="sxs-lookup"><span data-stu-id="c1882-110">Template identifiers</span></span>
    
<span data-ttu-id="c1882-111">さまざまなエントリ識別子と、それらに関連する類似性があるため、それぞれの種類がどのように使用され、作成されるかについて、簡単に混乱する可能性があります。</span><span class="sxs-lookup"><span data-stu-id="c1882-111">Because of the variety of entry identifiers and the similarity with which they are named, it is easy to become confused about how each type is used and created.</span></span> 
  
<span data-ttu-id="c1882-112">1回限りのエントリ識別子は、1回限りの受信者またはカスタム受信者として知られる受信者の種類を開いてアクセスするために使用されるエントリ識別子です。</span><span class="sxs-lookup"><span data-stu-id="c1882-112">A one-off entry identifier is an entry identifier that is used to open and access the type of recipient known as a one-off, or custom recipient.</span></span> <span data-ttu-id="c1882-113">1回限りは、プロファイル内のどのアドレス帳プロバイダーにも属していない受信者です。</span><span class="sxs-lookup"><span data-stu-id="c1882-113">One-offs are recipients that do not belong to any of the address book providers in the profile.</span></span> <span data-ttu-id="c1882-114">1回限りのエントリ識別子は、1回限りの受信者に対して明示的に予約された形式を使用します。</span><span class="sxs-lookup"><span data-stu-id="c1882-114">The entry identifiers assigned to one-offs use a format specifically reserved for one-off recipients.</span></span> <span data-ttu-id="c1882-115">一時エントリ識別子は、オブジェクトを開いてアクセスするために使用されるため、PR_ENTRYID プロパティに格納されます。</span><span class="sxs-lookup"><span data-stu-id="c1882-115">Because one-off entry identifiers are used to open and access objects, they are stored in the PR_ENTRYID property.</span></span>
  
<span data-ttu-id="c1882-116">1回限りの、または1回限りのエントリ識別子が作成されます。</span><span class="sxs-lookup"><span data-stu-id="c1882-116">One-offs and one-off entry identifiers are created:</span></span>
  
- <span data-ttu-id="c1882-117">クライアントアプリケーションのユーザーが、アドレス帳のエントリを表さない受信者を、メッセージの受信者リストに追加することを選択した場合。</span><span class="sxs-lookup"><span data-stu-id="c1882-117">When users of a client application elect to add a recipient that does not represent any entry in the address book to a message's recipient list.</span></span>
    
- <span data-ttu-id="c1882-118">クライアントアプリケーションのユーザーが、アドレス帳のエントリを表さない受信者を、変更可能なアドレス帳コンテナーに追加することを選択した場合。</span><span class="sxs-lookup"><span data-stu-id="c1882-118">When users of a client application elect to add a recipient that does not represent any entry in the address book to a modifiable address book container.</span></span>
    
- <span data-ttu-id="c1882-119">トランスポートプロバイダーは、関連するアドレス帳プロバイダーでは処理できないアドレスを持つメッセージを受信します。</span><span class="sxs-lookup"><span data-stu-id="c1882-119">When a transport provider receives a message with an address that cannot be handled by its related address book provider.</span></span>
    
- <span data-ttu-id="c1882-120">ゲートウェイに属するアドレスを持つメッセージをトランスポートプロバイダーが受信したとき。</span><span class="sxs-lookup"><span data-stu-id="c1882-120">When a transport provider receives a message with an address that belongs to a gateway.</span></span>
    
<span data-ttu-id="c1882-121">最初の2つの状況で、クライアントは**IAddrBook:: createoneoff**を呼び出して、1回限りのエントリ識別子を新しく作成した受信者に関連付けます。</span><span class="sxs-lookup"><span data-stu-id="c1882-121">In the first two situations, the client calls **IAddrBook::CreateOneOff** to associate a one-off entry identifier with the newly created one-off recipient.</span></span> <span data-ttu-id="c1882-122">2番目の2つの状況では、トランスポートプロバイダーは**imapisupport:: createoneoff**を呼び出して、1回限りのエントリ識別子を外部アドレスに関連付けます。</span><span class="sxs-lookup"><span data-stu-id="c1882-122">In the second two situations, the transport provider calls **IMAPISupport::CreateOneOff** to associate a one-off entry identifier with the foreign address.</span></span> <span data-ttu-id="c1882-123">詳細については、「 [IAddrBook:: createoneoff](iaddrbook-createoneoff.md) 」および「 [imapisupport:: createoneoff](imapisupport-createoneoff.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="c1882-123">For more information, see [IAddrBook::CreateOneOff](iaddrbook-createoneoff.md) and [IMAPISupport::CreateOneOff](imapisupport-createoneoff.md).</span></span>
  
<span data-ttu-id="c1882-124">1回限りのテンプレートエントリ識別子は、一時的なエントリ識別子です。これを使用して、1回の一時ファイルを作成するためのテンプレートを開いたり、テンプレートにアクセスしたりできます。</span><span class="sxs-lookup"><span data-stu-id="c1882-124">A one-off template entry identifier is a short-term entry identifier that is used to open and access a template for creating one-offs.</span></span> <span data-ttu-id="c1882-125">特定の種類の受信者を作成するために必要な情報を入力するためのアドレス帳プロバイダーと MAPI 提供テンプレートの両方。</span><span class="sxs-lookup"><span data-stu-id="c1882-125">Both address book providers and MAPI supply templates for entering the information that is required to create a recipient of a particular type.</span></span> <span data-ttu-id="c1882-126">これらのテンプレートに関する情報 (エントリ識別子を含む) は、1回限りのテーブルで公開されます。</span><span class="sxs-lookup"><span data-stu-id="c1882-126">Information about these templates, including their entry identifiers, is published in the one-off table.</span></span> <span data-ttu-id="c1882-127">MAPI が**IABLogon:: getoneofftable**メソッドまたはアドレス帳コンテナーの**imapiprop:: openproperty**メソッドを呼び出して、 **PR_CREATE_TEMPLATES** ([PidTagCreateTemplates](pidtagcreatetemplates-canonical-property.md)) を要求すると、1回限りのテーブルが表示されます。プロパティ、またはプロバイダーが**imapisupport:: getoneofftable**を呼び出すとき。</span><span class="sxs-lookup"><span data-stu-id="c1882-127">One-off tables are displayed when MAPI calls either the **IABLogon::GetOneOffTable** method or an address book container's **IMAPIProp::OpenProperty** method to request the **PR_CREATE_TEMPLATES** ([PidTagCreateTemplates](pidtagcreatetemplates-canonical-property.md)) property or when a provider calls **IMAPISupport::GetOneOffTable**.</span></span> <span data-ttu-id="c1882-128">詳細については、「 [IABLogon:: getoneofftable](iablogon-getoneofftable.md)」、「 [imapiprop:: openproperty](imapiprop-openproperty.md)」、および「 [imapi support:: getoneofftable](imapisupport-getoneofftable.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="c1882-128">For more information, see [IABLogon::GetOneOffTable](iablogon-getoneofftable.md), [IMAPIProp::OpenProperty](imapiprop-openproperty.md), and [IMAPISupport::GetOneOffTable](imapisupport-getoneofftable.md).</span></span>
  
<span data-ttu-id="c1882-129">新しい1回限りのテンプレートを作成するには、1回限りのテーブルにリストされているテンプレートの1つを選択します。</span><span class="sxs-lookup"><span data-stu-id="c1882-129">To create a new one-off, a user selects one of the templates listed in the one-off table.</span></span> <span data-ttu-id="c1882-130">クライアントは、選択されている行から PR_ENTRYID 列を渡します。これは、選択したテンプレートの1回限りのテンプレートエントリ id であり、 _lpeidnewentrytpl_パラメーターの**IAddrBook:: newentry**になります。</span><span class="sxs-lookup"><span data-stu-id="c1882-130">The client passes the PR_ENTRYID column from the selected row, which is the one-off template entry identifier of the selected template, to **IAddrBook::NewEntry** in the  _lpEIDNewEntryTpl_ parameter.</span></span> <span data-ttu-id="c1882-131">詳細については、「 [IAddrBook:: newentry](iaddrbook-newentry.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="c1882-131">For more information, see [IAddrBook::NewEntry](iaddrbook-newentry.md).</span></span> <span data-ttu-id="c1882-132">MAPI では、1回限りのテンプレートエントリ識別子を使用してテンプレートが表示され、ユーザーは受信者の作成に必要な情報を入力できるようになります。</span><span class="sxs-lookup"><span data-stu-id="c1882-132">MAPI uses the one-off template entry identifier to display the template and to allow the user to enter the information needed to create the recipient.</span></span> 
  
<span data-ttu-id="c1882-133">テンプレート識別子は、PR_ENTRYID プロパティに格納されているエントリ識別子に加えて、アドレス帳プロバイダーが受信者に割り当てるエントリ識別子です。</span><span class="sxs-lookup"><span data-stu-id="c1882-133">A template identifier is an entry identifier that some address book providers assign to their recipients in addition to the entry identifier that is kept in the PR_ENTRYID property.</span></span> <span data-ttu-id="c1882-134">プロバイダーは、テンプレート識別子を格納するために受信者の**PR_TEMPLATEID** ([PidTagTemplateid](pidtagtemplateid-canonical-property.md)) プロパティを設定します。</span><span class="sxs-lookup"><span data-stu-id="c1882-134">Providers set a recipient's **PR_TEMPLATEID** ([PidTagTemplateid](pidtagtemplateid-canonical-property.md)) property to store its template identifier.</span></span> <span data-ttu-id="c1882-135">アドレス帳プロバイダーによっては、受信者のテンプレート識別子プロパティとエントリ id プロパティに同じ値が割り当てられます。</span><span class="sxs-lookup"><span data-stu-id="c1882-135">Some address book providers assign the same value for a recipient's template identifier and entry identifier properties.</span></span>
  
<span data-ttu-id="c1882-136">テンプレート識別子は、アドレス帳プロバイダーと MAPI によってのみ使用されます。ホストプロバイダーと呼ばれる1つのプロバイダーの受信者のデータを、別のプロバイダーの受信者のコードにバインドするには、外部プロバイダーと呼ばれます。</span><span class="sxs-lookup"><span data-stu-id="c1882-136">Template identifiers are used only by address book providers and by MAPI to bind recipient data in one provider, referred to as the host provider, to code for the recipient in another provider, referred to as the foreign provider.</span></span> <span data-ttu-id="c1882-137">ホストプロバイダーは、受信者のストレージを提供します。外部プロバイダーがロジックを提供します。</span><span class="sxs-lookup"><span data-stu-id="c1882-137">The host provider supplies the storage for the recipient; the foreign provider supplies the logic.</span></span> <span data-ttu-id="c1882-138">バインドプロセスにより、ホストプロバイダーは、外部プロバイダーのコードを使用して格納される受信者のデータを更新できます。</span><span class="sxs-lookup"><span data-stu-id="c1882-138">The binding process enables a host provider to update the data of a recipient that it stores using the code of a foreign provider.</span></span>
  
<span data-ttu-id="c1882-139">ホストプロバイダーが受信者を変更する準備ができたら、PR_TEMPLATEID プロパティを**imapisupport:: OpenTemplateID**メソッドの呼び出しで渡して、バインドプロセスを開始します。</span><span class="sxs-lookup"><span data-stu-id="c1882-139">When the host provider is ready to modify its recipient, it passes the PR_TEMPLATEID property in a call to the **IMAPISupport::OpenTemplateID** method to initiate the binding process.</span></span> <span data-ttu-id="c1882-140">MAPI では、 **IABLogon:: OpenTemplateID**メソッドへの呼び出しによって、テンプレート識別子を適切な外部プロバイダーに転送することによって、プロセスを続行します。</span><span class="sxs-lookup"><span data-stu-id="c1882-140">MAPI continues the process by transferring the template identifier to the appropriate foreign provider through a call to its **IABLogon::OpenTemplateID** method.</span></span> <span data-ttu-id="c1882-141">詳細については、「 [imapisupport:: OpenTemplateID](imapisupport-opentemplateid.md) and [IABLogon:: OpenTemplateID](iablogon-opentemplateid.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="c1882-141">For more information, see [IMAPISupport::OpenTemplateID](imapisupport-opentemplateid.md) and [IABLogon::OpenTemplateID](iablogon-opentemplateid.md).</span></span> <span data-ttu-id="c1882-142">外部プロバイダーは、受信者の**imapiprop**実装へのポインターを返します。これはホストプロバイダーが独自の実装の代わりに使用できます。</span><span class="sxs-lookup"><span data-stu-id="c1882-142">The foreign provider returns a pointer to its **IMAPIProp** implementation for the recipient, which the host provider can use in place of its own implementation.</span></span> 
  

