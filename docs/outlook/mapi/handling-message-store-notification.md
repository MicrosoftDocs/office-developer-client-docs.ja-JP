---
title: メッセージ ストアの通知を処理します。
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 3e0cc2f9-a88d-4cec-bef5-b60f2ec80f1c
description: '�ŏI�X�V��: 2015�N3��9��'
ms.openlocfilehash: 898f8b6ff3d0b0dd42a670596b54171f18b4a5e3
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 06/11/2018
ms.locfileid: "19800187"
---
# <a name="handling-message-store-notification"></a><span data-ttu-id="f0d6a-103">メッセージ ストアの通知を処理します。</span><span class="sxs-lookup"><span data-stu-id="f0d6a-103">Handling message store notification</span></span>
  
<span data-ttu-id="f0d6a-104">**適用されます**: Outlook</span><span class="sxs-lookup"><span data-stu-id="f0d6a-104">**Applies to**: Outlook</span></span> 
  
<span data-ttu-id="f0d6a-105">メッセージ ストアの通知を登録するに[IMAPISession::Advise](imapisession-advise.md)または[IMsgStore::Advise](imsgstore-advise.md)のいずれかのメソッドを呼び出すし、 _lpEntryID_パラメーターの内容のメッセージ ・ ストア、フォルダー、またはメッセージのエントリ id を指定します。</span><span class="sxs-lookup"><span data-stu-id="f0d6a-105">To register for message store notifications, call either the [IMAPISession::Advise](imapisession-advise.md) or [IMsgStore::Advise](imsgstore-advise.md) method and specify a message store, folder, or message entry identifier in the contents of the  _lpEntryID_ parameter.</span></span> <span data-ttu-id="f0d6a-106">メッセージ ストア プロバイダーは、オブジェクトと表の両方の通知をサポートします。</span><span class="sxs-lookup"><span data-stu-id="f0d6a-106">Message store providers support both object and table notifications.</span></span> <span data-ttu-id="f0d6a-107">方法および特定のメッセージ ストアのオブジェクトと、これらのオブジェクトを表すフォルダーの階層と内容のテーブルまたは両方のオブジェクトを登録して、テーブルは、表示、操作を実行する呼び出しの通知に依存するかどうかメッセージ ストア プロバイダーは、通知をサポートしています。</span><span class="sxs-lookup"><span data-stu-id="f0d6a-107">Whether you register with particular message store objects, with the folder hierarchy and contents tables that describe these objects, or with both objects and tables depends on the notifications you expect to see, the calls you make to perform operations, and how the message store provider supports notification.</span></span> 
  
<span data-ttu-id="f0d6a-108">MAPI プロバイダーが通知をサポートする方法に柔軟性が許可されているため、常に表示されませんと同じ種類の通知のすべてのメッセージ ストア プロバイダーから特定のイベントに応答してあります。</span><span class="sxs-lookup"><span data-stu-id="f0d6a-108">Because MAPI allows flexibility in how providers support notifications, be aware that you will not always receive the same type of notification in response to a particular event from all message store providers.</span></span> <span data-ttu-id="f0d6a-109">メッセージ ストア プロバイダーの中では、通知をすべてのサポートの操作を行います。</span><span class="sxs-lookup"><span data-stu-id="f0d6a-109">Some message store providers do not support notifications at all.</span></span> <span data-ttu-id="f0d6a-110">メッセージ ・ ストアを使用するかどうかを決定するには、通知、 **PR_STORE_SUPPORT_MASK** ([PidTagStoreSupportMask](pidtagstoresupportmask-canonical-property.md)) プロパティに STORE_NOTIFY_OK ビットのファイルの場所をサポートしています。</span><span class="sxs-lookup"><span data-stu-id="f0d6a-110">To determine if the message store you are using supports notification, look for the STORE_NOTIFY_OK bit in its **PR_STORE_SUPPORT_MASK** ([PidTagStoreSupportMask](pidtagstoresupportmask-canonical-property.md)) property.</span></span>
  
<span data-ttu-id="f0d6a-111">メッセージ ・ ストアのスペクトルの一方の端にある通知をサポートするプロバイダーは、「リッチ」通知を生成するプロバイダーです。これらのプロバイダーは、登録されているすべての通知をわかりやすいソースの通知を送信します。</span><span class="sxs-lookup"><span data-stu-id="f0d6a-111">At one end of the spectrum of message store providers that support notification are the providers that generate "rich" notifications; these providers send descriptive notifications for all registered advise sources.</span></span> <span data-ttu-id="f0d6a-112">他の最後にはメッセージ ストア プロバイダー制限通知をサポートします。これらのプロバイダーは、一般的なアドバイスのソース数が制限されている通知を送信します。</span><span class="sxs-lookup"><span data-stu-id="f0d6a-112">At the other end are the message store providers that support limited notifications; these providers send general notifications for a restricted number of advise sources.</span></span> 
  
<span data-ttu-id="f0d6a-113">などのメッセージをフォルダーにコピーする場合は、両方のオブジェクトのコピーを受信する登録すると通知、オブジェクトに移動、するか、コピーされるオブジェクトの通知を受け取らないことがあります。</span><span class="sxs-lookup"><span data-stu-id="f0d6a-113">For example, if you copy a message to a folder with which you have registered to receive both object copied and object moved notifications, you may or may not receive the object copied notification.</span></span> <span data-ttu-id="f0d6a-114">受信するかどうかによって異なります。</span><span class="sxs-lookup"><span data-stu-id="f0d6a-114">Whether or not you receive it depends on:</span></span>
  
- <span data-ttu-id="f0d6a-115">このメソッドは、コピーを実行すると呼ばれます。</span><span class="sxs-lookup"><span data-stu-id="f0d6a-115">The method that you called to perform the copy.</span></span> <span data-ttu-id="f0d6a-116">[IMAPIFolder::CopyMessages](imapifolder-copymessages.md)、 [IMAPIProp::CopyTo](imapiprop-copyto.md)、または[IMAPIProp::CopyProps](imapiprop-copyprops.md)可能性があります。</span><span class="sxs-lookup"><span data-stu-id="f0d6a-116">This could be [IMAPIFolder::CopyMessages](imapifolder-copymessages.md), [IMAPIProp::CopyTo](imapiprop-copyto.md), or [IMAPIProp::CopyProps](imapiprop-copyprops.md).</span></span>
    
- <span data-ttu-id="f0d6a-117">方法、メッセージ ・ ストア プロバイダーの実装、copy メソッドです。</span><span class="sxs-lookup"><span data-stu-id="f0d6a-117">How the message store provider implements the copy method.</span></span>
    
- <span data-ttu-id="f0d6a-118">かどうか、メッセージ ストア プロバイダーでは、フォルダーにコピーするオブジェクトの通知をサポートしています。</span><span class="sxs-lookup"><span data-stu-id="f0d6a-118">Whether or not the message store provider supports object copied notifications on folders.</span></span>
    
<span data-ttu-id="f0d6a-119">ストア プロバイダーにメッセージに関するイベント通知を実装する方法について説明する厳密なガイドラインはありませんがある、ためクライアントが一貫性のある動作を求めることはできません。</span><span class="sxs-lookup"><span data-stu-id="f0d6a-119">Because there are no strict guidelines that describe how to implement event notification for message store providers, clients cannot expect consistent behavior.</span></span> <span data-ttu-id="f0d6a-120">MAPI は、これらの推奨事項、プロバイダー実装のイベント通知と次の表にメッセージを格納する方法に関する推奨事項をことがあります。</span><span class="sxs-lookup"><span data-stu-id="f0d6a-120">MAPI does make recommendations as to how message store providers implement event notification and the following table outlines these recommendations.</span></span> <span data-ttu-id="f0d6a-121">テーブルを次のように読み取り: 3 番目の列に記載されているオブジェクトにその型を登録した場合に、2 番目の列に記載されている種類の通知を受信することが最初の列の操作を実行した後。</span><span class="sxs-lookup"><span data-stu-id="f0d6a-121">Read the table as follows: after you perform the operation in the first column, expect to receive a notification of the type listed in the second column if you have registered for that type with the object listed in the third column.</span></span> <span data-ttu-id="f0d6a-122">たとえば、フォルダーを作成した後のメッセージ ・ ストアの_fnevObjectCreated_の通知を登録する場合にのみ、 _fnevObjectCreated_の通知が表示されます。</span><span class="sxs-lookup"><span data-stu-id="f0d6a-122">For example, after you have created a folder, you will receive an  _fnevObjectCreated_ notification only if you have registered for  _fnevObjectCreated_ notifications with the message store.</span></span> 
  
|<span data-ttu-id="f0d6a-123">**Operation**</span><span class="sxs-lookup"><span data-stu-id="f0d6a-123">**Operation**</span></span>|<span data-ttu-id="f0d6a-124">**イベントの種類**</span><span class="sxs-lookup"><span data-stu-id="f0d6a-124">**Event type**</span></span>|<span data-ttu-id="f0d6a-125">**ソースをアドバイスします。**</span><span class="sxs-lookup"><span data-stu-id="f0d6a-125">**Advise source**</span></span>|
|:-----|:-----|:-----|
|<span data-ttu-id="f0d6a-126">フォルダーを作成する</span><span class="sxs-lookup"><span data-stu-id="f0d6a-126">Create a folder</span></span>  <br/> | <span data-ttu-id="f0d6a-127">_fnevObjectCreated_</span><span class="sxs-lookup"><span data-stu-id="f0d6a-127">_fnevObjectCreated_</span></span> <br/> |<span data-ttu-id="f0d6a-128">メッセージ ・ ストア</span><span class="sxs-lookup"><span data-stu-id="f0d6a-128">Message store</span></span>  <br/> |
|<span data-ttu-id="f0d6a-129">フォルダーを削除する</span><span class="sxs-lookup"><span data-stu-id="f0d6a-129">Delete a folder</span></span>  <br/> | <span data-ttu-id="f0d6a-130">_fnevObjectDeleted_</span><span class="sxs-lookup"><span data-stu-id="f0d6a-130">_fnevObjectDeleted_</span></span> <br/> |<span data-ttu-id="f0d6a-131">メッセージ ストアの削除済みフォルダー</span><span class="sxs-lookup"><span data-stu-id="f0d6a-131">Message store Deleted folder</span></span>  <br/> |
|<span data-ttu-id="f0d6a-132">1 つのフォルダーから別のフォルダーを移動します。</span><span class="sxs-lookup"><span data-stu-id="f0d6a-132">Move a folder from one folder to another</span></span>  <br/> | <span data-ttu-id="f0d6a-133">_fnevObjectMoved_</span><span class="sxs-lookup"><span data-stu-id="f0d6a-133">_fnevObjectMoved_</span></span> <br/> |<span data-ttu-id="f0d6a-134">メッセージ ストアのフォルダーの移動</span><span class="sxs-lookup"><span data-stu-id="f0d6a-134">Message store Moved folder</span></span>  <br/> |
|<span data-ttu-id="f0d6a-135">1 つのフォルダーから別のフォルダーをコピーします。</span><span class="sxs-lookup"><span data-stu-id="f0d6a-135">Copy a folder from one folder to another</span></span>  <br/> | <span data-ttu-id="f0d6a-136">_fnevObjectCopied_</span><span class="sxs-lookup"><span data-stu-id="f0d6a-136">_fnevObjectCopied_</span></span> <br/> |<span data-ttu-id="f0d6a-137">メッセージを格納し、( _fnevObjectCreated_通知は、フォルダーの新しいコピーを送信)] フォルダーをコピー</span><span class="sxs-lookup"><span data-stu-id="f0d6a-137">Message store and copied folder (no  _fnevObjectCreated_ notification sent for the new copy of the folder)</span></span>  <br/> |
|<span data-ttu-id="f0d6a-138">(**PR_SUBFOLDERS** ([PidTagSubfolders](pidtagsubfolders-canonical-property.md)) **PR_CONTENT_UNREAD** ([PidTagContentUnreadCount](pidtagcontentunreadcount-canonical-property.md))、 **PR_CONTENT_COUNT** ([PidTagContentCount](pidtagcontentcount-canonical-property.md)) は、計算済みのフォルダー プロパティの変更します。</span><span class="sxs-lookup"><span data-stu-id="f0d6a-138">Change in a computed folder property (**PR_SUBFOLDERS** ([PidTagSubfolders](pidtagsubfolders-canonical-property.md)), **PR_CONTENT_UNREAD** ([PidTagContentUnreadCount](pidtagcontentunreadcount-canonical-property.md)), **PR_CONTENT_COUNT** ([PidTagContentCount](pidtagcontentcount-canonical-property.md))</span></span>  <br/> | <span data-ttu-id="f0d6a-139">_fnevObjectModified_</span><span class="sxs-lookup"><span data-stu-id="f0d6a-139">_fnevObjectModified_</span></span> <br/> |<span data-ttu-id="f0d6a-140">ストアの変更されたフォルダー (親フォルダーに通知がない)</span><span class="sxs-lookup"><span data-stu-id="f0d6a-140">Message store Changed folder (No notification to parent folder)</span></span>  <br/> |
|<span data-ttu-id="f0d6a-141">メッセージを作成します。</span><span class="sxs-lookup"><span data-stu-id="f0d6a-141">Create a message</span></span>  <br/> | <span data-ttu-id="f0d6a-142">_fnevObjectCreated_</span><span class="sxs-lookup"><span data-stu-id="f0d6a-142">_fnevObjectCreated_</span></span> <br/> |<span data-ttu-id="f0d6a-143">メッセージ ・ ストア</span><span class="sxs-lookup"><span data-stu-id="f0d6a-143">Message store</span></span>  <br/> |
|<span data-ttu-id="f0d6a-144">変更されて、親フォルダーの**PR_CONTENT_COUNT**プロパティ、メッセージを削除します。</span><span class="sxs-lookup"><span data-stu-id="f0d6a-144">Delete a message, causing a change in the parent folder's **PR_CONTENT_COUNT** property</span></span>  <br/> | <span data-ttu-id="f0d6a-145">_fnevObjectDeleted_</span><span class="sxs-lookup"><span data-stu-id="f0d6a-145">_fnevObjectDeleted_</span></span> <br/> |<span data-ttu-id="f0d6a-146">削除済みメッセージのメッセージ ストア</span><span class="sxs-lookup"><span data-stu-id="f0d6a-146">Message store Deleted message</span></span>  <br/> |
|<span data-ttu-id="f0d6a-147">1 つのフォルダーからメッセージを移動します。</span><span class="sxs-lookup"><span data-stu-id="f0d6a-147">Move a message from one folder to another</span></span>  <br/> | <span data-ttu-id="f0d6a-148">_fnevObjectMoved_</span><span class="sxs-lookup"><span data-stu-id="f0d6a-148">_fnevObjectMoved_</span></span> <br/> |<span data-ttu-id="f0d6a-149">メッセージが移動されたメッセージを保存します。</span><span class="sxs-lookup"><span data-stu-id="f0d6a-149">Message store Moved message</span></span>  <br/> |
|<span data-ttu-id="f0d6a-150">1 つのフォルダーからメッセージをコピーします。</span><span class="sxs-lookup"><span data-stu-id="f0d6a-150">Copy a message from one folder to another</span></span>  <br/> | <span data-ttu-id="f0d6a-151">_fnevObjectCopied_</span><span class="sxs-lookup"><span data-stu-id="f0d6a-151">_fnevObjectCopied_</span></span> <br/> |<span data-ttu-id="f0d6a-152">メッセージのストア コピー メッセージ (ない_fnevObjectCreated_のコピーを新しいメッセージの通知)</span><span class="sxs-lookup"><span data-stu-id="f0d6a-152">Message store Copied message (No  _fnevObjectCreated_ notification for new copy of the message)</span></span>  <br/> |
|<span data-ttu-id="f0d6a-153">変更されて、親フォルダーの**PR_CONTENT_COUNT**プロパティ、メッセージを保存します。</span><span class="sxs-lookup"><span data-stu-id="f0d6a-153">Save a message, causing a change in the parent folder's **PR_CONTENT_COUNT** property</span></span>  <br/> | <span data-ttu-id="f0d6a-154">_fnevObjectCreated_</span><span class="sxs-lookup"><span data-stu-id="f0d6a-154">_fnevObjectCreated_</span></span> <br/> |<span data-ttu-id="f0d6a-155">最初の保存のみにメッセージ ・ ストア</span><span class="sxs-lookup"><span data-stu-id="f0d6a-155">Message store on first save only</span></span>  <br/> |
|<span data-ttu-id="f0d6a-156">メッセージを保存します。</span><span class="sxs-lookup"><span data-stu-id="f0d6a-156">Save a message</span></span>  <br/> | <span data-ttu-id="f0d6a-157">_fnevObjectModified_</span><span class="sxs-lookup"><span data-stu-id="f0d6a-157">_fnevObjectModified_</span></span> <br/> |<span data-ttu-id="f0d6a-158">最初の変更されたメッセージ (親フォルダーに通知がない) を保存した後の保存にメッセージ ・ ストア</span><span class="sxs-lookup"><span data-stu-id="f0d6a-158">Message store on saves after the first save Changed message (No notification to parent folder)</span></span>  <br/> |
|<span data-ttu-id="f0d6a-159">検索操作を完了します。</span><span class="sxs-lookup"><span data-stu-id="f0d6a-159">Complete a search operation</span></span>  <br/> | <span data-ttu-id="f0d6a-160">_fnevSearchComplete_</span><span class="sxs-lookup"><span data-stu-id="f0d6a-160">_fnevSearchComplete_</span></span> <br/> |<span data-ttu-id="f0d6a-161">ストアの検索フォルダー</span><span class="sxs-lookup"><span data-stu-id="f0d6a-161">Message store Search folder</span></span>  <br/> |
|<span data-ttu-id="f0d6a-162">新しいメッセージ</span><span class="sxs-lookup"><span data-stu-id="f0d6a-162">New message</span></span>  <br/> | <span data-ttu-id="f0d6a-163">_fnevNewMail_</span><span class="sxs-lookup"><span data-stu-id="f0d6a-163">_fnevNewMail_</span></span> <br/> |<span data-ttu-id="f0d6a-164">メッセージ ・ ストア</span><span class="sxs-lookup"><span data-stu-id="f0d6a-164">Message store</span></span>  <br/> |
   
> [!NOTE]
> <span data-ttu-id="f0d6a-165">オブジェクトの変更通知が表示されたら、 **OnNotify**呼び出しの_lpNotifications_パラメーターで指定された[OBJECT_NOTIFICATION](object_notification.md)構造体のプロパティ タグ配列の部分が可能性がありますまたは NULL にできない場合があることに注意してください。</span><span class="sxs-lookup"><span data-stu-id="f0d6a-165">When you receive an object modified notification, remember that the property tag array portion of the [OBJECT_NOTIFICATION](object_notification.md) structure pointed to by the  _lpNotifications_ parameter in the **OnNotify** call may or may not be NULL.</span></span> <span data-ttu-id="f0d6a-166">メッセージ ストア プロバイダーは、この配列のプロパティ情報を挿入し、最もしない必要はありません。</span><span class="sxs-lookup"><span data-stu-id="f0d6a-166">Message store providers are not required to insert property information in this array and most do not.</span></span> <span data-ttu-id="f0d6a-167">**OnNotify**メソッドは、 _lpPropTagArray_のポインターが NULL を大文字と小文字を処理できることを確認します。</span><span class="sxs-lookup"><span data-stu-id="f0d6a-167">Make sure your **OnNotify** method can handle the case where the  _lpPropTagArray_ pointer is NULL.</span></span> 
  
<span data-ttu-id="f0d6a-168">通知オブジェクトのすべてではない場合は、ほとんどは、影響を受けるフォルダーまたはフォルダーのビューを更新します。</span><span class="sxs-lookup"><span data-stu-id="f0d6a-168">For most, if not all object notifications, update the view of the affected folder or folders.</span></span>
  

