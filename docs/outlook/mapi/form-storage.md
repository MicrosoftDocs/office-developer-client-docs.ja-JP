---
title: フォーム ストレージ
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 6ddf9158-3c10-408a-aeaf-5a382c4339e7
description: '最終更新日: 2011 年 7 月 23 日'
ms.openlocfilehash: 793a34b093ba69f73be7e186bec0a769584bbac4
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/28/2019
ms.locfileid: "33414894"
---
# <a name="form-storage"></a><span data-ttu-id="d98d3-103">フォーム ストレージ</span><span class="sxs-lookup"><span data-stu-id="d98d3-103">Form storage</span></span>

<span data-ttu-id="d98d3-104">**適用対象**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="d98d3-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="d98d3-105">フォームがどのように物理的に保存されるかの詳細を知る必要はありませんが、主な概念のいくつかを理解すると便利です。</span><span class="sxs-lookup"><span data-stu-id="d98d3-105">Although it is not necessary to know all the details of how forms are physically stored, it is useful to understand a few of the main concepts.</span></span> <span data-ttu-id="d98d3-106">したがって、既定のフォーム マネージャーでサポートされている 3 種類のフォーム ライブラリについて説明する前に、フォームの保存方法の概要について説明します。</span><span class="sxs-lookup"><span data-stu-id="d98d3-106">Therefore, before describing the three types of form libraries supported by the default form manager, this topic gives an overview of how forms are stored.</span></span>
  
<span data-ttu-id="d98d3-107">フォーム定義は、1 つ以上の MAPI メッセージ ストア内のフォルダー内に物理的に格納できます。</span><span class="sxs-lookup"><span data-stu-id="d98d3-107">Form definitions can be physically stored within folders in one or more MAPI message stores.</span></span> <span data-ttu-id="d98d3-108">すべての MAPI フォルダーには、メッセージ オブジェクトを格納するための 2 つの領域 (標準パーツと関連付けられたパーツ) が含まれます。</span><span class="sxs-lookup"><span data-stu-id="d98d3-108">Every MAPI folder can be thought of as having two areas for storing message objects: the standard part and the associated part.</span></span> <span data-ttu-id="d98d3-109">フォルダーの標準部分には、ユーザーが操作するメッセージとフォルダーが含まれます。</span><span class="sxs-lookup"><span data-stu-id="d98d3-109">The standard part of the folder includes the messages and folders that users manipulate.</span></span>
  
<span data-ttu-id="d98d3-110">関連付けられたパーツには、フォーム定義、ビュー、ルール テンプレート、返信テンプレートなど、フォルダーに関連付けられている非表示のメッセージ オブジェクトが含まれます。</span><span class="sxs-lookup"><span data-stu-id="d98d3-110">The associated part includes hidden message objects that are associated with the folder, including form definitions, views, rule templates, reply templates, and so on.</span></span> <span data-ttu-id="d98d3-111">この代替パーツはフォルダーに関連付けられたコンテンツ テーブルと呼ばれます。関連付けられたコンテンツ テーブル内のメッセージのセットは、フォルダーに関連付けられた情報と呼ばれます。</span><span class="sxs-lookup"><span data-stu-id="d98d3-111">This alternate part is called the folder-associated contents table, and the set of messages in the associated contents table is referred to as the folder-associated information.</span></span> <span data-ttu-id="d98d3-112">非表示のメッセージは、フォルダーの不可欠な部分であり、フォルダーのコピー時に標準フォルダーの内容と共にコピーされます。</span><span class="sxs-lookup"><span data-stu-id="d98d3-112">The hidden messages are an integral part of the folder and are copied along with the standard folder contents when the folder is copied.</span></span> <span data-ttu-id="d98d3-113">メッセージとして物理的に格納されているが、フォルダーに関連付けられたコンテンツ テーブル内の情報は、表示可能なメッセージと同じようにプロパティと同様に動作します。</span><span class="sxs-lookup"><span data-stu-id="d98d3-113">Although physically stored as messages, information in a folder's associated contents table behaves more like properties than like viewable messages.</span></span> <span data-ttu-id="d98d3-114">関連付けられたコンテンツ テーブルをサポートするフォルダー オブジェクトは、カスタム フォームを格納できます。</span><span class="sxs-lookup"><span data-stu-id="d98d3-114">Any folder object that supports an associated contents table is capable of storing custom forms.</span></span> <span data-ttu-id="d98d3-115">[IMAPIContainer::GetContentsTable](imapicontainer-getcontentstable.md)メソッドは、メソッドの _ulflags_ パラメーターの値に応じて、標準コンテンツまたはフォルダーの関連コンテンツを返します。</span><span class="sxs-lookup"><span data-stu-id="d98d3-115">The [IMAPIContainer::GetContentsTable](imapicontainer-getcontentstable.md) method can return either the standard contents or the associated contents of the folder, depending on the value of the method's  _ulflags_ parameter.</span></span> 
  
<span data-ttu-id="d98d3-116">フォーム ライブラリは、フォルダーの関連付けられたコンテンツ テーブルに格納されているフォーム定義で構成されます。</span><span class="sxs-lookup"><span data-stu-id="d98d3-116">A form library consists of form definitions stored in a folder's associated contents table.</span></span> <span data-ttu-id="d98d3-117">フォーム定義には、フォームのプロパティ、フォームがサポートするアクション、1 つ以上のメッセージ添付ファイルとして保存されるフォーム サーバー実行可能ファイルが含まれます。</span><span class="sxs-lookup"><span data-stu-id="d98d3-117">The form definition includes the form's properties, the actions the form supports, and even the form server executable file, which is stored as one or more message attachments.</span></span>
  
<span data-ttu-id="d98d3-118">さらに、使用するフォーム マネージャーがサポートする任意のファイルまたは場所にフォームを格納できます。</span><span class="sxs-lookup"><span data-stu-id="d98d3-118">Additionally, forms can be stored in any file or location that the form manager being used supports.</span></span> <span data-ttu-id="d98d3-119">既定のフォーム マネージャーは、MAPI フォルダーにフォーム サーバーを格納しますが、カスタム フォーム マネージャーは、フォーム サーバー用に独自の記憶域を実装できます。</span><span class="sxs-lookup"><span data-stu-id="d98d3-119">The default form manager stores form servers in MAPI folders, but a custom form manager could implement its own storage for form servers.</span></span>
  
<span data-ttu-id="d98d3-120">フォームには、メッセージ クラスにバインドされている複数のユーザー インターフェイスを含めできます。</span><span class="sxs-lookup"><span data-stu-id="d98d3-120">A form can have multiple user interfaces that are bound to its message class.</span></span> <span data-ttu-id="d98d3-121">たとえば、フォームに個別のユーザー インターフェイスの作成と読み取りを設定できます。</span><span class="sxs-lookup"><span data-stu-id="d98d3-121">For example, a form can have separate Compose and Read user interfaces.</span></span> <span data-ttu-id="d98d3-122">フォームは、呼び出されているフォームの動詞に応じて、さまざまなユーザー要求に対して適切なユーザー インターフェイスを呼び出す処理を行います。</span><span class="sxs-lookup"><span data-stu-id="d98d3-122">The form takes care of invoking the proper user interface for different user requests, depending on which of the form's verbs is being called.</span></span> <span data-ttu-id="d98d3-123">たとえば、フォーム サーバーに個別のユーザー インターフェイスの作成と読み取りがある場合、ユーザーがフォームのメッセージ クラスの新しいメッセージを作成すると、作成ユーザー インターフェイスを自動的に開き、ユーザーがフォームのメッセージ クラスの既存のメッセージを開くと、ユーザー インターフェイスの読み取りを自動的に開く可能性があります。</span><span class="sxs-lookup"><span data-stu-id="d98d3-123">For example, if your form server has separate composing and reading user interfaces, the Compose user interface can be opened automatically when the user creates a new message of the form's message class and the Read user interface can be opened automatically when the user opens an existing message of the form's message class.</span></span>
  
<span data-ttu-id="d98d3-124">フォーム定義に格納されているほとんどの情報は **、IMAPIFormInfo** オブジェクトで [IMAPIFormInfo::IMAPIProp](imapiforminfoimapiprop.md)メソッドを呼び出して使用できます。</span><span class="sxs-lookup"><span data-stu-id="d98d3-124">Most of the information stored within a form definition is available by invoking the [IMAPIFormInfo::IMAPIProp](imapiforminfoimapiprop.md) method on an **IMAPIFormInfo** object.</span></span> <span data-ttu-id="d98d3-125">**IMAPIFormInfo** インターフェイスは、情報を取得するために必要なすべての MAPI フォルダーとメッセージ メソッドを呼び出すことによって、フォーム情報へのアクセスを簡素化します。</span><span class="sxs-lookup"><span data-stu-id="d98d3-125">The **IMAPIFormInfo** interface simplifies access to form information by calling all the MAPI folder and message methods needed to retrieve the information.</span></span> <span data-ttu-id="d98d3-126">**IMAPIFormInfo** オブジェクトは [、IMAPIFormContainer::ResolveMessageClass](imapiformcontainer-resolvemessageclass.md)メソッドを呼び出すことによって取得できます。</span><span class="sxs-lookup"><span data-stu-id="d98d3-126">An **IMAPIFormInfo** object can be obtained by calling the [IMAPIFormContainer::ResolveMessageClass](imapiformcontainer-resolvemessageclass.md) method.</span></span> 
  
<span data-ttu-id="d98d3-127">3 種類のフォーム ライブラリについては、「ローカル[](local-form-libraries.md)フォーム ライブラリ、フォルダー[](folder-form-libraries.md)フォーム ライブラリ、個人用フォーム ライブラリ」のトピック[で説明します](personal-form-libraries.md)。</span><span class="sxs-lookup"><span data-stu-id="d98d3-127">The three types of form libraries are described in the topics [Local Form Libraries](local-form-libraries.md), [Folder Form Libraries](folder-form-libraries.md) and [Personal Form Libraries](personal-form-libraries.md).</span></span>
  
## <a name="see-also"></a><span data-ttu-id="d98d3-128">関連項目</span><span class="sxs-lookup"><span data-stu-id="d98d3-128">See also</span></span>

- [<span data-ttu-id="d98d3-129">MAPI フォーム</span><span class="sxs-lookup"><span data-stu-id="d98d3-129">MAPI Forms</span></span>](mapi-forms.md)

