---
title: スレッド セーフなオブジェクトを実装します。
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 3c911694-b953-4d35-9a3a-22c17cfd79bc
description: '�ŏI�X�V��: 2011�N7��23��'
ms.openlocfilehash: 8c8c89f3626d54f04896ad54de5d7e480dd9b568
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 06/11/2018
ms.locfileid: "19800968"
---
# <a name="implementing-thread-safe-objects"></a>スレッド セーフなオブジェクトを実装します。

  
  
**適用されます**: Outlook 
  
直接インターフェイス メソッドの呼び出しから返されるオブジェクトの場合は、スレッド セーフのプロバイダーの責任は。 コールバック オブジェクトとは、クライアント アプリケーションの責任です。
  
クライアントは、MAPI ユーティリティ[HrThisThreadAdviseSink](hrthisthreadadvisesink.md)を呼び出すことにより、スレッド セーフである通知コールバックを実装できます。 **HrThisThreadAdviseSink**は、スレッド セーフのアドバイズ シンクをスレッド セーフである 1 つに変換します。 進捗状況のコールバックには、このようなユーティリティはありません。 クライアントは、MAPI 処理中のスレッド セーフであるオブジェクトを使用するか、手動で作成できます。 
  
スレッド セーフなオブジェクトは、できない可能性がありますもスレッドに対応していません。 スレッドに対応していないオブジェクトは、それを使用するすべてのスレッドを別のコンテキストを保持します。 サービス プロバイダーは、スレッド対応のサポートはいくつかの状況で役に立ちますが、スレッド セーフのオブジェクトでスレッド認識をサポートする必要はありません。 2 つの MAPI テーブルは、常に定義して、独自のコンテキストを提供します。 1 つのテーブルを異なるスレッドで使用しないし、一意のコンテキストを提供する必要があります。
  
**生じます**に使用した同じスレッドで通知を受け取る間、クライアントことができます**アドバイス**の呼び出しに使用されたのと同じスレッド上または MAPI によって所有されている別のスレッドを呼び出します。 **生じます**を呼び出すために使用されたのと同じスレッド上に通知が到達することを確認するには、クライアントは[生じます](mapiinitialize.md)を呼び出すし、 **ulFlags** 、 [MAPIINIT_0](mapiinit_0.md)構造体のメンバーに 0 を渡します。 通知は、メイン メッセージ ループの中に配信されます。 
  
MAPI が所有するスレッドに通知を受信するには、クライアントは、 **ulFlags** 、 **MAPIINIT_0**構造体のメンバー MAPI_MULTITHREAD_NOTIFICATIONS に設定して**生じます**を呼び出します。 **アドバイス**の呼び出しが行われるクライアントがラップされたバージョンではなく、シンク オブジェクトに通知します。 
  
**アドバイズ**を呼び出すために使用されたのと同じスレッド上に通知が到達することを確認するには、クライアントが[HrThisThreadAdviseSink](hrthisthreadadvisesink.md)を呼び出すし、パスが新しく作成されたラップが**アドバイズ**シンクではなく元のアドバイズ シンクをアドバイスします。 **生じます**は、いずれかのフラグの値を呼び出すことができます。 
  

