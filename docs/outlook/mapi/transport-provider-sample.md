---
title: トランスポートプロバイダーのサンプル
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: ec6eb6c0-bfe3-4989-9071-89a14c0e7bdd
description: '最終更新日時: 2015 年 3 月 9 日'
ms.openlocfilehash: def51a752abcb79a35980ed12eb73011c26d2597
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/23/2019
ms.locfileid: "32356589"
---
# <a name="transport-provider-sample"></a>トランスポートプロバイダーのサンプル

  
  
**適用対象**: Outlook 2013 | Outlook 2016 
  
この例では、ファイルとディレクトリを使用して、メッセージの送受信を行います。 これは、各送信メッセージにテキスト行を追加する非常に単純なプリプロセッサを実装して登録します。 このサンプルは、トランスポートニュートラルカプセル化形式 (TNEF) とテキストの間でメッセージの内容を分割する方法を示しています。 また、すべての構成オプション (プロパティシート、ウィザード、およびプログラムの構成) とメッセージオプションもサポートしています。 リモートトランスポートインターフェイスはサポートされていません。 
  
このサンプルは、 [Outlook Messaging API (MAPI) コードサンプル](https://go.microsoft.com/fwlink/?LinkId=129740)からダウンロードできます。
  
|||
|:-----|:-----|
|実行可能  <br/> |mrxp32  <br/> |
|ソースコードディレクトリ:  <br/> |SampleTransportProvider\MRXP  <br/> |
|言語  <br/> |+  <br/> |
|対象  <br/> |windows Vista、windows server 2008、windows XP SP2、および windows server 2003 SP1 用にコンパイルする Visual Studio 2008  <br/> |
   
## <a name="supported-features"></a>サポートされる機能

この例では、次の機能をサポートしています。
  
- 新しいメッセージの送信、受信、ポーリングなどの基本的な機能。
    
- 対話型およびプログラムによる構成。
    
- **imapistatus**インターフェイス。ただし、プロパティの設定は除きます。 詳細については、 [imapistatus: imapistatus](imapistatusimapiprop.md)インターフェイスを参照してください。 
    
- スレッドの安全性。
    
- テキストファイルへのイベントログ。 ファイルは、指定したサイズに自動的に制限されます。 すべてのトランスポートセッションは同じファイルを使用します。
    
## <a name="unsupported-features"></a>サポートされない機能

このサンプルでは、受信メッセージの非同期検出をサポートしていません。
  
 **サンプルトランスポートプロバイダーをインストールするには**
  
1. サンプルトランスポートプロバイダーをダウンロードするには、「 [Outlook MAPI サンプルのダウンロード](downloading-the-outlook-mapi-samples.md)」を参照してください。
    
2. Outlook MAPI サンプルを保存したフォルダーを見つけます。 **OutlookMAPISamples-\<version\>番号**の zip フォルダーを右クリックし、[**すべて抽出**] をクリックします。
    
3. [**参照**] をクリックして、サンプルを保存する場所を選択し、[**抽出**] をクリックします。
    
4. Visual Studio 2008 を実行します。
    
5. Visual Studio 2008 で、[**ファイル**] をクリックし、[**開く**] を選択して、[**プロジェクト/ソリューション**] をクリックします。
    
6. サンプルを保存した場所を参照し、[ **mrxp32**] をクリックして、[**開く**] をクリックします。
    
7. [**ビルド**] メニューの [**構成マネージャー**] をクリックします。
    
8. [**構成マネージャー** ] ダイアログボックスで、 **mrxp32**の行に移動し、[**構成**] 列の [**リリース**] を選択して、[**閉じる**] をクリックします。
    
9. [ **ビルド**] メニューで、[ **ソリューションのビルド**] をクリックします。
    
10. [名前を付け**てファイルを保存**] ダイアログボックスで、[**保存**] をクリックします。
    
11. サンプルを保存したフォルダーで、インストールバッチファイルを右クリックし、[**管理者として実行**] をクリックします。
    
12. [**ユーザー アカウント制御**] ダイアログ ボックスで、[**続行**] をクリックします。
    
    > [!NOTE]
    > **.bat をインストール**すると、.dll は既定の Microsoft Office インストールフォルダーである C:\Program C:\Program Office\Office12 にコピーされます。\. 別の場所に Office 製品をインストールした場合は、[**インストール**] を右クリックし、[**編集**] をクリックします。 ファイルがメモ帳で開きます。 既定のインストールパスを、コンピューターで使用されているインストールパスに置き換えます。 
  
 **Outlook でトランスポートプロバイダーをセットアップするには**
  
1. Outlook の [**ツール**] メニューの [**アカウント設定**] をクリックします。
    
2. [**アカウント設定**] ダイアログボックスの [**電子メール**] タブで、[**新規**] をクリックします。
    
3. [**電子メールサービスの選択**] で [**その他**] をクリックし、[ **MRXP Sample Transport**] を選択して、[**次へ**] をクリックします。
    
4. [ **MRXP Transport Configuration** ] ダイアログボックスで、**ユーザーの表示名**を入力します。
    
5. [ **path to Inbox (UNC 共有)** ] で、フォルダーのパスを入力します。 また、ローカルフォルダーへのパスを指定することもできます。 
    
    > [!IMPORTANT]
    > このパスは存在する必要があります。 
  
6. **[OK]** をクリックします。
    
7. [**電子メールアカウントの追加**] ダイアログボックスで、[ **OK**] をクリックします。 [**完了**] をクリックし、[**閉じる**] をクリックします。
    
8. MRXP アカウントの使用を開始するには、Outlook を終了して再起動します。
    
 **トランスポートプロバイダーのサンプルを使用して Outlook でメッセージを送信するには**
  
1. [**ファイル**] メニューの [**新規作成**] をクリックし、[**メールメッセージ**] をクリックします。
    
2. [宛先**** ] ボックスに、受信者の名前を **[MRXP:\<\>ADDRESS]** の形式で入力します。 このアドレスは、受信者の受信トレイへの UNC 共有またはローカルフォルダーのパスです。
    
    > [!NOTE]
    > アドレスにコロンまたは円記号がある場合は、各コロンまたは円記号の前にバックスラッシュを挿入する必要があります。 たとえば、[MRXP: C: \Mail\myDir] にメールを送信するには、 `[MRXP:C\:\\Mail\\myDir]`次のように入力する必要があります。 
  
    > [!IMPORTANT]
    > 受信者のアドレスが存在している必要があります。 
  
3. [**アカウント**] をクリックし、[ **MRXP Sample Transport**] をクリックします。
    
4. メッセージを入力し、[**送信**] をクリックします。 メッセージは MRXP トランスポートプロバイダーを使用して送信されます。
    
 **トランスポートプロバイダーのサンプルを使用して Outlook でメッセージを受信するには**
  
1. [**ファイル**] メニューの [**新規作成**] をクリックし、[**メールメッセージ**] をクリックします。
    
2. メッセージを入力します。
    
3. **Microsoft Office ボタン**をクリックし、[名前を付け**て保存**] をクリックし、[名前を付けて保存] をクリックし**て**、セットアップ時に指定した受信トレイフォルダーにファイルを保存します。 
    
4. [**名前を付けて保存**] ダイアログボックスで、受信トレイとして設定した UNC 共有またはローカルフォルダーを参照します。 
    
5. [**ファイルの種類**] ドロップダウンで、[ **Outlook メッセージ形式**] をクリックします。
    
6. ファイルの名前を入力し、[**保存**] をクリックします。
    
7. ファイルが共有フォルダーに保存されます。 MRXP トランスポートプロバイダーは、Outlook の受信トレイにメッセージを配信します。
    

