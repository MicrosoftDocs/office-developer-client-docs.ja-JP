---
title: トランスポート プロバイダー サンプル
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: ec6eb6c0-bfe3-4989-9071-89a14c0e7bdd
description: '最終更新日時: 2015 年 3 月 9 日'
ms.openlocfilehash: def51a752abcb79a35980ed12eb73011c26d2597
ms.sourcegitcommit: ef717c65d8dd41ababffb01eafc443c79950aed4
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 10/04/2018
ms.locfileid: "25401406"
---
# <a name="transport-provider-sample"></a>トランスポート プロバイダー サンプル

  
  
**適用対象**: Outlook 2013 | Outlook 2016 
  
このサンプルでは、メッセージを送受信するためのファイルとディレクトリを使用します。 実装し、各送信メッセージにテキストの行を追加する非常に単純なプリプロセッサを登録します。 サンプルでは、トランスポート ニュートラル カプセル化形式 (TNEF) とテキストの間でメッセージの内容を分割する方法を示します。 すべての (プロパティ シート、ウィザード、およびプログラムの構成) の構成オプションとメッセージ オプションもサポートしています。 リモート トランスポート インターフェイスにサポートしていません。 
  
[Outlook メッセージング API (MAPI) のサンプル コード](https://go.microsoft.com/fwlink/?LinkId=129740)からは、このサンプルをダウンロードできます。
  
|||
|:-----|:-----|
|実行可能ファイル:  <br/> |mrxp32.dll  <br/> |
|ソース コードのディレクトリ:  <br/> |SampleTransportProvider\MRXP  <br/> |
|言語:  <br/> |C++  <br/> |
|プラットフォーム:  <br/> |Windows Vista、Windows Server 2008、Windows XP SP2、および Windows Server 2003 SP1 のプログラムをコンパイルするのには、Visual Studio 2008  <br/> |
   
## <a name="supported-features"></a>サポートされている機能

このサンプルには、次の機能がサポートされています。
  
- 送信、受信、および新着メッセージのポーリングなどの基本的な機能です。
    
- インタラクティブおよびプログラマティックな構成です。
    
- **IMAPIStatus**インターフェイス、プロパティの設定を除く。 詳細についてを参照してください、 [IMAPIStatus: IMAPIProp](imapistatusimapiprop.md)インタ フェースです。 
    
- スレッド セーフにします。
    
- テキスト ファイルにイベント ログを記録します。 ファイルは、自動的に指定したサイズに制限します。 トランスポートのすべてのセッションでは、同じファイルを使用します。
    
## <a name="unsupported-features"></a>サポートされていない機能

このサンプルでは、受信メッセージの非同期の検出をサポートしていません。
  
 **サンプルのトランスポート プロバイダーをインストールするのには**
  
1. サンプルのトランスポート プロバイダーをダウンロードするには、 [Outlook MAPI サンプルのダウンロード](downloading-the-outlook-mapi-samples.md)を参照してください。
    
2. Outlook MAPI サンプルを保存したフォルダーを見つけます。 右クリックし、 **OutlookMAPISamples ・\<バージョン番号\>** フォルダーを zip し、[**すべて展開**] をクリックします。
    
3. **参照**] をクリックして、サンプルを保存する場所を選択し、[**抽出**] をクリックします。
    
4. Visual Studio 2008年を実行します。
    
5. Visual Studio 2008 では、[**ファイル**] をクリックして、[**開いている**、および**プロジェクト/ソリューション**] をクリックし。
    
6. サンプルを保存する場所を参照する**mrxp32.vcproj**をクリックし、[**開く**] をクリックします。
    
7. **[ビルド**] メニューで、[**構成マネージャー**] をクリックします。
    
8. **[構成マネージャー** ] ダイアログ ボックスで、 **mrxp32**行に移動して [**構成**] 列には、**リリース**を選択し、[**閉じる**] をクリックします。
    
9. [ **ビルド**] メニューで、[ **ソリューションのビルド**] をクリックします。
    
10. **ファイルに名前を付けて**保存] ダイアログ ボックスで [**保存**] をクリックします。
    
11. サンプルを保存したフォルダーにインストール バッチ ファイルを右クリックし、**管理者として実行**] をクリックします。
    
12. **ユーザー アカウント制御**] ダイアログ ボックスで [**続行**] をクリックします。
    
    > [!NOTE]
    > **install.bat**コピー .dll ファイルを既定の Microsoft Office のインストール フォルダー、C:\Program ファイル Office\Office12\. 別の場所に Office 製品をインストールした場合は、 **install.bat**を右クリックし、[**編集**] をクリックします。 ファイルがメモ帳で開きます。 既定のインストール パスをお使いのコンピューターで使用されているインストール パスに置き換えます。 
  
 **トランスポート プロバイダーは、outlook を設定するには**
  
1. [Outlook の [**ツール**] メニューには、**アカウントの設定**をクリックします。
    
2. **アカウントの設定**] ダイアログ ボックスの [**電子メール**] タブで [**新規**] をクリックします。
    
3. **電子メール サービスの選択**の下では、[**その他**、 **MRXP サンプルのトランスポート**を選択し、[**次へ**] をクリックします。
    
4. **MRXP トランスポートの構成**] ダイアログ ボックスで、**ユーザーの表示名**を入力します。
    
5. **受信トレイ (UNC 共有) へのパス**の下には、フォルダーのパスを入力します。 ローカル フォルダーへのパスもできます。 
    
    > [!IMPORTANT]
    > このパスが存在する必要があります。 
  
6. **[OK]** をクリックします。
    
7. **電子メール アカウントの追加**] ダイアログ ボックスで [ **OK**を] をクリックします。 [**完了**] をクリックし、[**閉じる**] をクリックします。
    
8. MRXP アカウントを使用するには、終了し、Outlook を再起動します。
    
 **Outlook でメッセージを送信するトランスポート プロバイダーのサンプルを使用するには**
  
1. [**ファイル**] メニューで、[**新規**作成] をクリックし、[**メール メッセージ**] をクリックします。
    
2. 形式を使用して受信者の名前を入力 **] ボックス**に **[MRXP:\<アドレス\>]**。 アドレスは、UNC 共有または受信者の受信トレイにフォルダーのローカル パスです。
    
    > [!NOTE]
    > コロンまたはアドレスには、円記号 () がある場合は、各コロンまたは円記号の前に円記号を挿入する必要があります。 たとえば、メールを送信するのには [MRXP:C:\Mail\myDir] を入力しなければなりません`[MRXP:C\:\\Mail\\myDir]`。 
  
    > [!IMPORTANT]
    > 受信者のアドレスが存在する必要があります。 
  
3. **アカウント**をクリックし、 **MRXP サンプルのトランスポート**をクリックします。
    
4. メッセージを入力し、[**送信**] をクリックします。 MRXP トランスポート プロバイダーを使用してメッセージが送信されます。
    
 **トランスポート プロバイダーのサンプルを使用して、Outlook でメッセージを受信するのには**
  
1. [**ファイル**] メニューで、[**新規**作成] をクリックし、[**メール メッセージ**] をクリックします。
    
2. メッセージを入力します。
    
3. **Microsoft Office ボタン**をクリックを**名前を付けて保存**、**名前を付けて**[受信トレイ] フォルダーがセットアップ中に指定するファイルを保存する] をクリックします。 
    
4. **名前を付けて**保存] ダイアログ ボックスで、UNC 共有またはローカル フォルダー、受信トレイとして設定するを参照します。 
    
5. **ファイルの種類**] ボックスで、 **Outlook のメッセージの形式**をクリックします。
    
6. ファイルの名前を入力し、[**保存**] をクリックします。
    
7. ファイルは、共有フォルダーに保存されます。 MRXP トランスポート プロバイダーは、Outlook の受信トレイにメッセージを配信します。
    

