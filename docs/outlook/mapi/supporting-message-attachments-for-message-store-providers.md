---
title: メッセージストアプロバイダーのメッセージ添付ファイルのサポート
manager: soliver
ms.date: 12/07/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: d5fabc40-71e8-4afa-9846-533da605ce6c
description: '�ŏI�X�V��: 2015�N12��7��'
ms.openlocfilehash: 69d1df5bf206cddd0d25698665c9fd87b81e4ea5
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/23/2019
ms.locfileid: "32350625"
---
# <a name="supporting-message-attachments-for-message-store-providers"></a><span data-ttu-id="e97a0-103">メッセージストアプロバイダーのメッセージ添付ファイルのサポート</span><span class="sxs-lookup"><span data-stu-id="e97a0-103">Supporting Message Attachments for Message Store Providers</span></span>

 
  
<span data-ttu-id="e97a0-104">**適用対象**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="e97a0-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="e97a0-105">メッセージストアプロバイダーは、メッセージの添付ファイルをサポートする必要はありません。</span><span class="sxs-lookup"><span data-stu-id="e97a0-105">Your message store provider does not need to support message attachments.</span></span> <span data-ttu-id="e97a0-106">ただし、多くのクライアントアプリケーションでは、メッセージに添付ファイルを追加できることが想定されています。</span><span class="sxs-lookup"><span data-stu-id="e97a0-106">However, many client applications expect to be able to add attachments to messages.</span></span> <span data-ttu-id="e97a0-107">メッセージストアを使用して、IPM を作成または保存する場合。メッセージを確認してから、メッセージの添付ファイルをサポートする必要があります。</span><span class="sxs-lookup"><span data-stu-id="e97a0-107">If your message store will be used to create or store IPM.Note messages, then you should support message attachments.</span></span> <span data-ttu-id="e97a0-108">既定のメッセージストアプロバイダーは、メッセージの添付ファイルもサポートする必要があります。</span><span class="sxs-lookup"><span data-stu-id="e97a0-108">Default message store providers should also support message attachments.</span></span> <span data-ttu-id="e97a0-109">詳細については、「 [MAPI メッセージクラス](mapi-message-classes.md)」および「[既定のメッセージストア](default-message-stores.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="e97a0-109">For more information, see [MAPI Message Classes](mapi-message-classes.md), and [Default Message Stores](default-message-stores.md).</span></span>
  
<span data-ttu-id="e97a0-110">MAPI がサポートする添付ファイルには、添付ファイル、データ添付ファイル、メッセージの添付ファイル、OLE オブジェクトの添付ファイル、リンクの5種類があります。</span><span class="sxs-lookup"><span data-stu-id="e97a0-110">There are five types of attachments that MAPI supports: file attachments, data attachments, message attachments, OLE object attachments, and links.</span></span> <span data-ttu-id="e97a0-111">各種類をサポートするための要件は異なります。</span><span class="sxs-lookup"><span data-stu-id="e97a0-111">The requirements for supporting each type are different.</span></span> <span data-ttu-id="e97a0-112">クライアントは、attachment オブジェクトの**PR_ATTACH_METHOD** ([PidTagAttachMethod](pidtagattachmethod-canonical-property.md)) プロパティを使って、2種類の添付ファイルを区別します。</span><span class="sxs-lookup"><span data-stu-id="e97a0-112">Clients differentiate between the two types of attachments by means of the **PR_ATTACH_METHOD** ([PidTagAttachMethod](pidtagattachmethod-canonical-property.md)) property on attachment objects.</span></span>
  
<span data-ttu-id="e97a0-113">添付ファイルのサポートとは、 [iattach: imapiprop](iattachimapiprop.md)インターフェイスを実装することを意味します。</span><span class="sxs-lookup"><span data-stu-id="e97a0-113">Supporting attachments means implementing the [IAttach : IMAPIProp](iattachimapiprop.md) interface.</span></span> <span data-ttu-id="e97a0-114">**iattach**インターフェイスには、独自のメソッドはありません。[imapiprop](imapipropiunknown.md)インターフェイスから継承されたメソッドのみが含まれています。</span><span class="sxs-lookup"><span data-stu-id="e97a0-114">The **IAttach** interface has no methods of its own; it has only methods that are inherited from the [IMAPIProp](imapipropiunknown.md) interface.</span></span> <span data-ttu-id="e97a0-115">メッセージストアプロバイダーは、既にメッセージオブジェクトのプロパティを実装している必要があるので、これにより、添付ファイルをサポートするタスクが大幅に簡略化されます。</span><span class="sxs-lookup"><span data-stu-id="e97a0-115">Because your message store provider must already implement properties for message objects, this greatly simplifies the task of supporting attachments.</span></span> <span data-ttu-id="e97a0-116">**iattach**の実装は基本的に、クライアントがメッセージの特定の添付ファイルのプロパティのテーブルにアクセスする方法を提供することを意味します。</span><span class="sxs-lookup"><span data-stu-id="e97a0-116">Implementing **IAttach** basically means providing a way for clients to access a table of properties for particular attachments on messages.</span></span> 
  
<span data-ttu-id="e97a0-117">データの添付ファイルは、添付ファイルの内容が添付ファイルの**PR_ATTACH_DATA_BIN** ([PidTagAttachDataBinary](pidtagattachdatabinary-canonical-property.md)) プロパティに直接格納される添付ファイルです。</span><span class="sxs-lookup"><span data-stu-id="e97a0-117">Data attachments are simply attachments for which the contents of the attachment are stored directly in an attachment's **PR_ATTACH_DATA_BIN** ([PidTagAttachDataBinary](pidtagattachdatabinary-canonical-property.md)) property.</span></span> <span data-ttu-id="e97a0-118">データの添付ファイルは主に、メッセージの送信者と受信者が共通のファイルサーバーにアクセスできない場合に、クライアントがメッセージにファイルを添付できるようにすることを目的としています。</span><span class="sxs-lookup"><span data-stu-id="e97a0-118">Data attachments exist primarily to allow clients to attach files to a message when the sender and the recipient of the message do not have access to a common file server.</span></span> <span data-ttu-id="e97a0-119">詳細については、 **PR_ATTACH_METHOD** ([PidTagAttachMethod](pidtagattachmethod-canonical-property.md)) プロパティを参照してください。</span><span class="sxs-lookup"><span data-stu-id="e97a0-119">For more information, see the **PR_ATTACH_METHOD** ([PidTagAttachMethod](pidtagattachmethod-canonical-property.md)) property.</span></span>
  
<span data-ttu-id="e97a0-120">メッセージの添付ファイルは、添付ファイルサブオブジェクトが別の[IMessage: MAPIProp](imessageimapiprop.md)オブジェクトである添付ファイルです。</span><span class="sxs-lookup"><span data-stu-id="e97a0-120">Message attachments are attachments for which the attachment subobject is another [IMessage : MAPIProp](imessageimapiprop.md) object.</span></span> <span data-ttu-id="e97a0-121">メッセージストアプロバイダーは**IMessage**インターフェイスを既にサポートしているため、メッセージの添付ファイルをサポートするのは困難ではありません。</span><span class="sxs-lookup"><span data-stu-id="e97a0-121">Because message store providers already support the **IMessage** interface, supporting message attachments is not difficult.</span></span> 
  
<span data-ttu-id="e97a0-122">ole オブジェクトの添付ファイルをサポートすることは、ole **IStorage**、 **IStream**、および**IStreamDocfile**インターフェイスを実装することを意味します。</span><span class="sxs-lookup"><span data-stu-id="e97a0-122">Supporting OLE object attachments means implementing the OLE **IStorage**, **IStream**, and **IStreamDocfile** interfaces.</span></span> <span data-ttu-id="e97a0-123">クライアントがオブジェクトを開いたとき、メッセージストアプロバイダーは、メッセージに格納されている ole オブジェクトデータをアクティブな ole オブジェクトに変換できる必要があります。</span><span class="sxs-lookup"><span data-stu-id="e97a0-123">Your message store provider must be able to convert OLE object data stored in the message into an active OLE object when a client opens the object.</span></span> 
  
<span data-ttu-id="e97a0-124">リンクには、ファイルへのリンクと他のメッセージへのリンクの2種類があります。</span><span class="sxs-lookup"><span data-stu-id="e97a0-124">Links come in two types: links to files and links to other messages.</span></span> <span data-ttu-id="e97a0-125">ファイルへのリンク**PR_ATTACH_METHOD**プロパティの ATTACH_BY_REF_ONLY 値を**PR_ATTACH_PATHNAME** ([PidTagAttachPathname](pidtagattachpathname-canonical-property.md)) または**PR_ATTACH_LONG_PATHNAME** ([PidTagAttachLongPathname](pidtagattachlongpathname-canonical-property.md)) と共に使用して指定します。ファイルの場所を指定します。</span><span class="sxs-lookup"><span data-stu-id="e97a0-125">Links to files use the ATTACH_BY_REF_ONLY value for the **PR_ATTACH_METHOD** property along with **PR_ATTACH_PATHNAME** ([PidTagAttachPathname](pidtagattachpathname-canonical-property.md)) or **PR_ATTACH_LONG_PATHNAME** ([PidTagAttachLongPathname](pidtagattachlongpathname-canonical-property.md)) to specify the location of a file.</span></span>
  
<span data-ttu-id="e97a0-126">メッセージへのリンクを実装する方法は、ローカルメッセージングシステムの機能によって異なる場合があります。そのため、ここでは完全にドキュメント化することはできません。</span><span class="sxs-lookup"><span data-stu-id="e97a0-126">How one implements links to messages may depend on aspects of the local messaging system and, as such, cannot be fully documented here.</span></span> <span data-ttu-id="e97a0-127">たとえば、サーバーベースのメッセージストアに格納されているメッセージにリンクを送信する場合は、通常、リンクされたメッセージのエントリ識別子を送信するだけで、送信者と受信者の両方がそのサーバーにアクセスできるようになります。</span><span class="sxs-lookup"><span data-stu-id="e97a0-127">For example, sending a link to a message that is stored on a server-based message store is typically just a matter of sending the entry identifier of the linked message, providing that both the sender and recipient have access to that server.</span></span> <span data-ttu-id="e97a0-128">他のメッセージングシステム構成には、メッセージへのリンクの実装に関するその他の要件および課題があります。</span><span class="sxs-lookup"><span data-stu-id="e97a0-128">Other messaging system configurations present other requirements and challenges for implementing links to messages.</span></span>
  
## <a name="see-also"></a><span data-ttu-id="e97a0-129">関連項目</span><span class="sxs-lookup"><span data-stu-id="e97a0-129">See also</span></span>



<span data-ttu-id="e97a0-130">[���b�Z�[�W�̃X�g�A�̋@�[](message-store-features.md)(message-store-features.md)</span><span class="sxs-lookup"><span data-stu-id="e97a0-130">[Message Store Features](message-store-features.md)</span></span>

