---
title: メッセージ ストア プロバイダーのメッセージ添付ファイルのサポート
manager: soliver
ms.date: 12/07/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: d5fabc40-71e8-4afa-9846-533da605ce6c
description: '�ŏI�X�V��: 2015�N12��7��'
ms.openlocfilehash: 69d1df5bf206cddd0d25698665c9fd87b81e4ea5
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/28/2019
ms.locfileid: "33412136"
---
# <a name="supporting-message-attachments-for-message-store-providers"></a><span data-ttu-id="fcba3-103">メッセージ ストア プロバイダーのメッセージ添付ファイルのサポート</span><span class="sxs-lookup"><span data-stu-id="fcba3-103">Supporting Message Attachments for Message Store Providers</span></span>

 
  
<span data-ttu-id="fcba3-104">**適用対象**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="fcba3-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="fcba3-105">メッセージ ストア プロバイダーがメッセージの添付ファイルをサポートする必要はない。</span><span class="sxs-lookup"><span data-stu-id="fcba3-105">Your message store provider does not need to support message attachments.</span></span> <span data-ttu-id="fcba3-106">ただし、多くのクライアント アプリケーションでは、メッセージに添付ファイルを追加できると予想されます。</span><span class="sxs-lookup"><span data-stu-id="fcba3-106">However, many client applications expect to be able to add attachments to messages.</span></span> <span data-ttu-id="fcba3-107">メッセージ ストアを使用して IPM を作成または保存する場合。メッセージをメモし、メッセージの添付ファイルをサポートする必要があります。</span><span class="sxs-lookup"><span data-stu-id="fcba3-107">If your message store will be used to create or store IPM.Note messages, then you should support message attachments.</span></span> <span data-ttu-id="fcba3-108">既定のメッセージ ストア プロバイダーは、メッセージの添付ファイルもサポートする必要があります。</span><span class="sxs-lookup"><span data-stu-id="fcba3-108">Default message store providers should also support message attachments.</span></span> <span data-ttu-id="fcba3-109">詳細については、「MAPI メッセージ [クラス」および「](mapi-message-classes.md)既定 [のメッセージ ストア」を参照してください](default-message-stores.md)。</span><span class="sxs-lookup"><span data-stu-id="fcba3-109">For more information, see [MAPI Message Classes](mapi-message-classes.md), and [Default Message Stores](default-message-stores.md).</span></span>
  
<span data-ttu-id="fcba3-110">MAPI でサポートされる添付ファイルには、ファイル添付ファイル、データ添付ファイル、メッセージ添付ファイル、OLE オブジェクト添付ファイル、およびリンクの 5 種類があります。</span><span class="sxs-lookup"><span data-stu-id="fcba3-110">There are five types of attachments that MAPI supports: file attachments, data attachments, message attachments, OLE object attachments, and links.</span></span> <span data-ttu-id="fcba3-111">各種類をサポートするための要件は異なります。</span><span class="sxs-lookup"><span data-stu-id="fcba3-111">The requirements for supporting each type are different.</span></span> <span data-ttu-id="fcba3-112">クライアントは、添付ファイル オブジェクトの PR_ATTACH_METHOD **(** [PidTagAttachMethod](pidtagattachmethod-canonical-property.md)) プロパティを使用して、2 種類の添付ファイルを区別します。</span><span class="sxs-lookup"><span data-stu-id="fcba3-112">Clients differentiate between the two types of attachments by means of the **PR_ATTACH_METHOD** ([PidTagAttachMethod](pidtagattachmethod-canonical-property.md)) property on attachment objects.</span></span>
  
<span data-ttu-id="fcba3-113">添付ファイルのサポートとは [、IAttach : IMAPIProp インターフェイスの実装を意味](iattachimapiprop.md) します。</span><span class="sxs-lookup"><span data-stu-id="fcba3-113">Supporting attachments means implementing the [IAttach : IMAPIProp](iattachimapiprop.md) interface.</span></span> <span data-ttu-id="fcba3-114">**IAttach インターフェイス** には、独自のメソッドはありません。[IMAPIProp](imapipropiunknown.md)インターフェイスから継承されるメソッドだけが存在します。</span><span class="sxs-lookup"><span data-stu-id="fcba3-114">The **IAttach** interface has no methods of its own; it has only methods that are inherited from the [IMAPIProp](imapipropiunknown.md) interface.</span></span> <span data-ttu-id="fcba3-115">メッセージ ストア プロバイダーは既にメッセージ オブジェクトのプロパティを実装する必要があります。これにより、添付ファイルのサポートタスクが大幅に簡素化されます。</span><span class="sxs-lookup"><span data-stu-id="fcba3-115">Because your message store provider must already implement properties for message objects, this greatly simplifies the task of supporting attachments.</span></span> <span data-ttu-id="fcba3-116">**IAttach を実装する** ということは、基本的には、クライアントがメッセージの特定の添付ファイルのプロパティ テーブルにアクセスする方法を提供する手段を提供します。</span><span class="sxs-lookup"><span data-stu-id="fcba3-116">Implementing **IAttach** basically means providing a way for clients to access a table of properties for particular attachments on messages.</span></span> 
  
<span data-ttu-id="fcba3-117">データ添付ファイルは、添付ファイルの内容が添付ファイルのプロパティ **(** [PidTagAttachDataBinary](pidtagattachdatabinary-canonical-property.md)) プロパティに直接格納PR_ATTACH_DATA_BIN添付ファイルです。</span><span class="sxs-lookup"><span data-stu-id="fcba3-117">Data attachments are simply attachments for which the contents of the attachment are stored directly in an attachment's **PR_ATTACH_DATA_BIN** ([PidTagAttachDataBinary](pidtagattachdatabinary-canonical-property.md)) property.</span></span> <span data-ttu-id="fcba3-118">データ添付ファイルは、主に、メッセージの送信者と受信者が共通のファイル サーバーにアクセスできない場合に、クライアントがメッセージにファイルを添付するために存在します。</span><span class="sxs-lookup"><span data-stu-id="fcba3-118">Data attachments exist primarily to allow clients to attach files to a message when the sender and the recipient of the message do not have access to a common file server.</span></span> <span data-ttu-id="fcba3-119">詳細については、「PR_ATTACH_METHOD **(** [PidTagAttachMethod](pidtagattachmethod-canonical-property.md)) プロパティ」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="fcba3-119">For more information, see the **PR_ATTACH_METHOD** ([PidTagAttachMethod](pidtagattachmethod-canonical-property.md)) property.</span></span>
  
<span data-ttu-id="fcba3-120">メッセージの添付ファイルは、添付ファイルサブオブジェクトが別の [IMessage : MAPIProp オブジェクトである添付ファイル](imessageimapiprop.md) です。</span><span class="sxs-lookup"><span data-stu-id="fcba3-120">Message attachments are attachments for which the attachment subobject is another [IMessage : MAPIProp](imessageimapiprop.md) object.</span></span> <span data-ttu-id="fcba3-121">メッセージ ストア プロバイダーは既に **IMessage** インターフェイスをサポートしています。メッセージの添付ファイルをサポートすることは困難ではありません。</span><span class="sxs-lookup"><span data-stu-id="fcba3-121">Because message store providers already support the **IMessage** interface, supporting message attachments is not difficult.</span></span> 
  
<span data-ttu-id="fcba3-122">OLE オブジェクトの添付ファイルのサポートとは、OLE **IStorage、IStream、\*\*\*\*および IStreamDocfile インターフェイスを実装する方法** を意味します。 </span><span class="sxs-lookup"><span data-stu-id="fcba3-122">Supporting OLE object attachments means implementing the OLE **IStorage**, **IStream**, and **IStreamDocfile** interfaces.</span></span> <span data-ttu-id="fcba3-123">メッセージ ストア プロバイダーは、クライアントがオブジェクトを開くと、メッセージに格納されている OLE オブジェクト データをアクティブな OLE オブジェクトに変換できる必要があります。</span><span class="sxs-lookup"><span data-stu-id="fcba3-123">Your message store provider must be able to convert OLE object data stored in the message into an active OLE object when a client opens the object.</span></span> 
  
<span data-ttu-id="fcba3-124">リンクには、ファイルへのリンクと他のメッセージへのリンクの 2 種類があります。</span><span class="sxs-lookup"><span data-stu-id="fcba3-124">Links come in two types: links to files and links to other messages.</span></span> <span data-ttu-id="fcba3-125">ファイルへのリンクでは **、PR_ATTACH_METHOD** プロパティの ATTACH_BY_REF_ONLY 値と PR_ATTACH_PATHNAME ([PidTagAttachPathname](pidtagattachpathname-canonical-property.md)) または **PR_ATTACH_LONG_PATHNAME** ([PidTagAttachLongPathname](pidtagattachlongpathname-canonical-property.md)) を使用して、ファイルの場所を指定します。 </span><span class="sxs-lookup"><span data-stu-id="fcba3-125">Links to files use the ATTACH_BY_REF_ONLY value for the **PR_ATTACH_METHOD** property along with **PR_ATTACH_PATHNAME** ([PidTagAttachPathname](pidtagattachpathname-canonical-property.md)) or **PR_ATTACH_LONG_PATHNAME** ([PidTagAttachLongPathname](pidtagattachlongpathname-canonical-property.md)) to specify the location of a file.</span></span>
  
<span data-ttu-id="fcba3-126">メッセージへのリンクを実装する方法は、ローカル メッセージング システムの側面によって異なる場合があります。そのため、ここでは完全に文書化できません。</span><span class="sxs-lookup"><span data-stu-id="fcba3-126">How one implements links to messages may depend on aspects of the local messaging system and, as such, cannot be fully documented here.</span></span> <span data-ttu-id="fcba3-127">たとえば、サーバー ベースのメッセージ ストアに格納されているメッセージへのリンクの送信は、通常、リンクされたメッセージのエントリ識別子を送信し、送信者と受信者の両方がサーバーにアクセスできるだけの問題です。</span><span class="sxs-lookup"><span data-stu-id="fcba3-127">For example, sending a link to a message that is stored on a server-based message store is typically just a matter of sending the entry identifier of the linked message, providing that both the sender and recipient have access to that server.</span></span> <span data-ttu-id="fcba3-128">他のメッセージング システム構成では、メッセージへのリンクを実装するためのその他の要件と課題が示されています。</span><span class="sxs-lookup"><span data-stu-id="fcba3-128">Other messaging system configurations present other requirements and challenges for implementing links to messages.</span></span>
  
## <a name="see-also"></a><span data-ttu-id="fcba3-129">関連項目</span><span class="sxs-lookup"><span data-stu-id="fcba3-129">See also</span></span>



<span data-ttu-id="fcba3-130">[���b�Z�[�W�̃X�g�A�̋@�[](message-store-features.md)(message-store-features.md)</span><span class="sxs-lookup"><span data-stu-id="fcba3-130">[Message Store Features](message-store-features.md)</span></span>

