---
title: メッセージ ストア プロバイダーのメッセージの添付ファイルをサポートしています。
manager: soliver
ms.date: 12/07/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: d5fabc40-71e8-4afa-9846-533da605ce6c
description: '�ŏI�X�V��: 2015�N12��7��'
ms.openlocfilehash: e3d6844f8fe6121d6ea063a9594aaf1fed581ee5
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 06/11/2018
ms.locfileid: "19804029"
---
# <a name="supporting-message-attachments-for-message-store-providers"></a><span data-ttu-id="9c81c-103">メッセージ ストア プロバイダーのメッセージの添付ファイルをサポートしています。</span><span class="sxs-lookup"><span data-stu-id="9c81c-103">Supporting Message Attachments for Message Store Providers</span></span>

 
  
<span data-ttu-id="9c81c-104">**適用されます**: Outlook</span><span class="sxs-lookup"><span data-stu-id="9c81c-104">**Applies to**: Outlook</span></span> 
  
<span data-ttu-id="9c81c-105">メッセージ ストア プロバイダーは、メッセージの添付ファイルをサポートする必要はありません。</span><span class="sxs-lookup"><span data-stu-id="9c81c-105">Your message store provider does not need to support message attachments.</span></span> <span data-ttu-id="9c81c-106">ただし、多くのクライアント アプリケーションは、メッセージに添付ファイルを追加するのにはできるはずです。</span><span class="sxs-lookup"><span data-stu-id="9c81c-106">However, many client applications expect to be able to add attachments to messages.</span></span> <span data-ttu-id="9c81c-107">作成または IPM を格納する場合は、メッセージ ・ ストアが使用されます。メッセージの添付ファイルをサポートする必要がありますし、メッセージに注意してください。</span><span class="sxs-lookup"><span data-stu-id="9c81c-107">If your message store will be used to create or store IPM.Note messages, then you should support message attachments.</span></span> <span data-ttu-id="9c81c-108">既定のメッセージ ストア プロバイダーは、メッセージの添付ファイルもサポートする必要があります。</span><span class="sxs-lookup"><span data-stu-id="9c81c-108">Default message store providers should also support message attachments.</span></span> <span data-ttu-id="9c81c-109">詳細については、 [MAPI メッセージ クラス](mapi-message-classes.md)、および[既定のメッセージ ストア](default-message-stores.md)を参照してください。</span><span class="sxs-lookup"><span data-stu-id="9c81c-109">For more information, see [MAPI Message Classes](mapi-message-classes.md), and [Default Message Stores](default-message-stores.md).</span></span>
  
<span data-ttu-id="9c81c-110">MAPI をサポートしている添付ファイルの 5 種類があります: ファイルの添付ファイル、データの添付ファイル、メッセージの添付ファイル、OLE オブジェクトの添付ファイルとリンクします。</span><span class="sxs-lookup"><span data-stu-id="9c81c-110">There are five types of attachments that MAPI supports: file attachments, data attachments, message attachments, OLE object attachments, and links.</span></span> <span data-ttu-id="9c81c-111">それぞれの種類をサポートするための要件は、異なります。</span><span class="sxs-lookup"><span data-stu-id="9c81c-111">The requirements for supporting each type are different.</span></span> <span data-ttu-id="9c81c-112">クライアントは、オブジェクトの添付ファイルの**PR_ATTACH_METHOD** ([PidTagAttachMethod](pidtagattachmethod-canonical-property.md)) プロパティを使用して添付ファイルの 2 種類を区別します。</span><span class="sxs-lookup"><span data-stu-id="9c81c-112">Clients differentiate between the two types of attachments by means of the **PR_ATTACH_METHOD** ([PidTagAttachMethod](pidtagattachmethod-canonical-property.md)) property on attachment objects.</span></span>
  
<span data-ttu-id="9c81c-113">添付ファイルのサポートを実装することを意味します[IAttach: IMAPIProp](iattachimapiprop.md)インタ フェースです。</span><span class="sxs-lookup"><span data-stu-id="9c81c-113">Supporting attachments means implementing the [IAttach : IMAPIProp](iattachimapiprop.md) interface.</span></span> <span data-ttu-id="9c81c-114">**IAttach**インターフェイスには独自のメソッドがありません。[IMAPIProp](imapipropiunknown.md)インターフェイスから継承されたメソッドのみを備えています。</span><span class="sxs-lookup"><span data-stu-id="9c81c-114">The **IAttach** interface has no methods of its own; it has only methods that are inherited from the [IMAPIProp](imapipropiunknown.md) interface.</span></span> <span data-ttu-id="9c81c-115">メッセージ ストア プロバイダーは、メッセージ オブジェクトのプロパティを実装する必要があります既にため、この大幅に簡略化タスクの添付ファイルをサポートします。</span><span class="sxs-lookup"><span data-stu-id="9c81c-115">Because your message store provider must already implement properties for message objects, this greatly simplifies the task of supporting attachments.</span></span> <span data-ttu-id="9c81c-116">基本的に**IAttach**を実装すると、クライアントがメッセージの添付ファイルを特定のプロパティのテーブルにアクセスするための手段を提供することを意味します。</span><span class="sxs-lookup"><span data-stu-id="9c81c-116">Implementing **IAttach** basically means providing a way for clients to access a table of properties for particular attachments on messages.</span></span> 
  
<span data-ttu-id="9c81c-117">データの添付ファイルは、添付ファイルの内容は、添付ファイルの**PR_ATTACH_DATA_BIN** ([PidTagAttachDataBinary](pidtagattachdatabinary-canonical-property.md)) のプロパティに直接格納されている添付ファイルだけです。</span><span class="sxs-lookup"><span data-stu-id="9c81c-117">Data attachments are simply attachments for which the contents of the attachment are stored directly in an attachment's **PR_ATTACH_DATA_BIN** ([PidTagAttachDataBinary](pidtagattachdatabinary-canonical-property.md)) property.</span></span> <span data-ttu-id="9c81c-118">データの添付ファイルは、クライアントが送信者とメッセージの受信者に共通のファイル ・ サーバへのアクセスがないときに、メッセージにファイルを添付できるようにするには、主に存在します。</span><span class="sxs-lookup"><span data-stu-id="9c81c-118">Data attachments exist primarily to allow clients to attach files to a message when the sender and the recipient of the message do not have access to a common file server.</span></span> <span data-ttu-id="9c81c-119">詳細については、 **PR_ATTACH_METHOD** ([PidTagAttachMethod](pidtagattachmethod-canonical-property.md)) のプロパティを参照してください。</span><span class="sxs-lookup"><span data-stu-id="9c81c-119">For more information, see the **PR_ATTACH_METHOD** ([PidTagAttachMethod](pidtagattachmethod-canonical-property.md)) property.</span></span>
  
<span data-ttu-id="9c81c-120">メッセージの添付ファイルは、添付ファイルの添付ファイルのサブオブジェクトの別[IMessage: MAPIProp](imessageimapiprop.md)オブジェクトです。</span><span class="sxs-lookup"><span data-stu-id="9c81c-120">Message attachments are attachments for which the attachment subobject is another [IMessage : MAPIProp](imessageimapiprop.md) object.</span></span> <span data-ttu-id="9c81c-121">メッセージ ストア プロバイダーは、既に**IMessage**インターフェイスをサポートするので、メッセージの添付ファイルをサポートしている困難はありません。</span><span class="sxs-lookup"><span data-stu-id="9c81c-121">Because message store providers already support the **IMessage** interface, supporting message attachments is not difficult.</span></span> 
  
<span data-ttu-id="9c81c-122">オブジェクトの OLE 添付ファイルをサポートしている OLE **IStorage**、 **IStream**を**IStreamDocfile**インターフェイスを実装することを意味します。</span><span class="sxs-lookup"><span data-stu-id="9c81c-122">Supporting OLE object attachments means implementing the OLE **IStorage**, **IStream**, and **IStreamDocfile** interfaces.</span></span> <span data-ttu-id="9c81c-123">メッセージ ストア プロバイダーは、クライアントがオブジェクトを開いたときにアクティブな OLE オブジェクト、メッセージに格納されている OLE オブジェクトのデータに変換できる必要があります。</span><span class="sxs-lookup"><span data-stu-id="9c81c-123">Your message store provider must be able to convert OLE object data stored in the message into an active OLE object when a client opens the object.</span></span> 
  
<span data-ttu-id="9c81c-124">リンクには 2 つの種類: ファイルおよびその他のメッセージへのリンクへのリンクです。</span><span class="sxs-lookup"><span data-stu-id="9c81c-124">Links come in two types: links to files and links to other messages.</span></span> <span data-ttu-id="9c81c-125">ファイルへのリンクでは、 **PR_ATTACH_METHOD**プロパティを**PR_ATTACH_PATHNAME** ([PidTagAttachPathname](pidtagattachpathname-canonical-property.md)) または**PR_ATTACH_LONG_PATHNAME** ([PidTagAttachLongPathname](pidtagattachlongpathname-canonical-property.md)) およびの ATTACH_BY_REF_ONLY 値を使用してファイルの場所です。</span><span class="sxs-lookup"><span data-stu-id="9c81c-125">Links to files use the ATTACH_BY_REF_ONLY value for the **PR_ATTACH_METHOD** property along with **PR_ATTACH_PATHNAME** ([PidTagAttachPathname](pidtagattachpathname-canonical-property.md)) or **PR_ATTACH_LONG_PATHNAME** ([PidTagAttachLongPathname](pidtagattachlongpathname-canonical-property.md)) to specify the location of a file.</span></span>
  
<span data-ttu-id="9c81c-126">メッセージへのリンクを実装するいずれかの方法ローカルのメッセージング システムの側面に依存している可能性があり、として次のようなことはできません完全に記述するここで。</span><span class="sxs-lookup"><span data-stu-id="9c81c-126">How one implements links to messages may depend on aspects of the local messaging system and, as such, cannot be fully documented here.</span></span> <span data-ttu-id="9c81c-127">リンクを送信するサーバー ベースのメッセージ ストアに保存されているメッセージには通常、送信者と受信者の両方があるそのサーバーへのアクセスを提供する、リンクされているメッセージのエントリ id を送信するだけで済みます。</span><span class="sxs-lookup"><span data-stu-id="9c81c-127">For example, sending a link to a message that is stored on a server-based message store is typically just a matter of sending the entry identifier of the linked message, providing that both the sender and recipient have access to that server.</span></span> <span data-ttu-id="9c81c-128">他のメッセージング システムの構成では、他の要件とメッセージへのリンクを実装するための課題を提示します。</span><span class="sxs-lookup"><span data-stu-id="9c81c-128">Other messaging system configurations present other requirements and challenges for implementing links to messages.</span></span>
  
## <a name="see-also"></a><span data-ttu-id="9c81c-129">関連項目</span><span class="sxs-lookup"><span data-stu-id="9c81c-129">See also</span></span>



<span data-ttu-id="9c81c-130">[���b�Z�[�W�̃X�g�A�̋@�[](message-store-features.md)(message-store-features.md)</span><span class="sxs-lookup"><span data-stu-id="9c81c-130">[Message Store Features](message-store-features.md)</span></span>

