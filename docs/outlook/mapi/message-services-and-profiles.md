---
title: メッセージ サービスとプロファイル
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: df0db1e4-69c8-44ec-bb2a-d31fc8a564b9
description: '最終更新日: 2011 年 7 月 23 日'
ms.openlocfilehash: 78a13bacf13b019bbf9436830ad66db7fdfaf425
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/23/2019
ms.locfileid: "32356963"
---
# <a name="message-services-and-profiles"></a><span data-ttu-id="f80f9-103">メッセージ サービスとプロファイル</span><span class="sxs-lookup"><span data-stu-id="f80f9-103">Message services and profiles</span></span>
  
<span data-ttu-id="f80f9-104">**適用対象**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="f80f9-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="f80f9-105">一部のユーザーは、1つ以上のサービスプロバイダーを備えた複数のメッセージングシステムのサービスを必要とします。</span><span class="sxs-lookup"><span data-stu-id="f80f9-105">Some users require the services of several messaging systems, each with one or more service providers.</span></span> <span data-ttu-id="f80f9-106">各サービスプロバイダーを個別にインストールして構成するのは煩雑なため、メッセージングサーバーでは通常、すべての機能を公開するために関連するプロバイダーのグループが必要になるため、MAPI にはメッセージサービスの概念が含まれています。</span><span class="sxs-lookup"><span data-stu-id="f80f9-106">Because it is cumbersome to install and configure each of these service providers individually, and because a messaging server usually requires a group of related providers to expose all its functionality, MAPI includes the concept of a message service.</span></span> <span data-ttu-id="f80f9-107">メッセージサービスは、ユーザーがサービスプロバイダーをインストールして構成する際に役立ちます。</span><span class="sxs-lookup"><span data-stu-id="f80f9-107">Message services help users install and configure their service providers.</span></span>
  
<span data-ttu-id="f80f9-108">メッセージサービスを作成するために、開発者は、サービスの各プロバイダーの構成を処理するためのメッセージサービスエントリポイントプログラムと、次の操作を行うセットアッププログラムを記述します。</span><span class="sxs-lookup"><span data-stu-id="f80f9-108">To create a message service, a developer writes a message-service entry point program to handle the configuration of each provider in the service and a setup program to do the following:</span></span>
  
- <span data-ttu-id="f80f9-109">サービスに各プロバイダーをインストールします。</span><span class="sxs-lookup"><span data-stu-id="f80f9-109">Install each provider in the service.</span></span>
    
- <span data-ttu-id="f80f9-110">レジストリおよび初期化ファイルのエントリを作成します。</span><span class="sxs-lookup"><span data-stu-id="f80f9-110">Create registry and initialization file entries.</span></span>
    
- <span data-ttu-id="f80f9-111">MAPI 構成ファイル mapisvc.inf にエントリを作成します。</span><span class="sxs-lookup"><span data-stu-id="f80f9-111">Create entries in the MAPI configuration file, Mapisvc.inf.</span></span>
    
<span data-ttu-id="f80f9-112">mapisvc.inf ファイルには、コンピューターにインストールされているすべてのメッセージサービスおよびサービスプロバイダーの構成に関連する情報が含まれています。</span><span class="sxs-lookup"><span data-stu-id="f80f9-112">The Mapisvc.inf file contains information that relates to the configuration of all message services and service providers installed on the computer.</span></span> <span data-ttu-id="f80f9-113">階層構造のセクションで構成され、各レベルは次のようにリンクされています。</span><span class="sxs-lookup"><span data-stu-id="f80f9-113">It is organized in hierarchical sections, with each level linked to the next.</span></span> <span data-ttu-id="f80f9-114">上部には、次のものを含む3つのセクションがあります。</span><span class="sxs-lookup"><span data-stu-id="f80f9-114">At the top are three sections that contain the following:</span></span> 
  
- <span data-ttu-id="f80f9-115">メッセージサービスのヘルプファイルの一覧。</span><span class="sxs-lookup"><span data-stu-id="f80f9-115">A list of message service Help files.</span></span>
    
- <span data-ttu-id="f80f9-116">最も重要な、または既定のメッセージサービスのリスト。</span><span class="sxs-lookup"><span data-stu-id="f80f9-116">A list of the most important, or default, message services.</span></span>
    
- <span data-ttu-id="f80f9-117">コンピューター上のすべてのサービスのリスト。</span><span class="sxs-lookup"><span data-stu-id="f80f9-117">A list of all the services on the computer.</span></span>
    
<span data-ttu-id="f80f9-118">次のレベルには、各メッセージサービスのセクションが含まれ、最後のレベルにはサービスの各サービスプロバイダーのセクションが含まれています。</span><span class="sxs-lookup"><span data-stu-id="f80f9-118">The next level contains sections for each message service, and the last level contains sections for each service provider in a service.</span></span> <span data-ttu-id="f80f9-119">MAPI では、サービスプロバイダーとメッセージサービスの開発者が mapisvc.inf に特定のエントリを追加する必要があります。開発者は、自分の裁量で他のエントリを追加できます。</span><span class="sxs-lookup"><span data-stu-id="f80f9-119">MAPI requires that developers of service providers and message services add certain entries to Mapisvc.inf; developers can add other entries at their own discretion.</span></span> <span data-ttu-id="f80f9-120">mapisvc.inf の情報のほとんどは、1つ以上のプロファイルで構成されています。これは、ユーザーが指定した一連のメッセージサービスの構成情報の集合です。</span><span class="sxs-lookup"><span data-stu-id="f80f9-120">Most of the information in Mapisvc.inf ends up in one or more profiles, a collection of configuration information for a user's preferred set of message services.</span></span> <span data-ttu-id="f80f9-121">コンピューターは複数のユーザーを持つことができ、1人のユーザーが複数のユーザー設定を持つことができるため、コンピューター上には多くのプロファイルが存在できます。</span><span class="sxs-lookup"><span data-stu-id="f80f9-121">Because a computer can have multiple users and a single user can have multiple sets of preferences, many profiles can exist on a computer.</span></span> <span data-ttu-id="f80f9-122">各プロファイルは、異なるメッセージサービスのセットを記述します。</span><span class="sxs-lookup"><span data-stu-id="f80f9-122">Each profile describes a different set of message services.</span></span> <span data-ttu-id="f80f9-123">複数のプロファイルを持つことで、ユーザーは、たとえば1組のメッセージサービスとオフィスで異なるセットを使用して、自宅で作業することができます。</span><span class="sxs-lookup"><span data-stu-id="f80f9-123">Having multiple profiles enables a user to work, for example, at home with one set of message services and at the office with a different set.</span></span>
  
<span data-ttu-id="f80f9-124">プロファイルは、構成サポートを提供するクライアントアプリケーションによって、メッセージサービスのインストール時またはログオン時に作成されます。</span><span class="sxs-lookup"><span data-stu-id="f80f9-124">Profiles are created at message service installation or logon time by a client application that provides configuration support.</span></span> <span data-ttu-id="f80f9-125">MAPI には、コントロールパネルアイテムとプロファイルウィザードという2つのクライアントアプリケーションが用意されています。</span><span class="sxs-lookup"><span data-stu-id="f80f9-125">MAPI provides two such client applications: a Control Panel item and the Profile Wizard.</span></span> <span data-ttu-id="f80f9-126">コントロールパネルの項目は、ユーザーがプロファイルの作成、削除、編集、コピー、およびプロファイル内のエントリの変更を行うことができる、完全なサービス構成アプリケーションです。</span><span class="sxs-lookup"><span data-stu-id="f80f9-126">The Control Panel item is a full-service configuration application with which users can create, delete, edit, and copy profiles, as well as make modifications to the entries in a profile.</span></span> <span data-ttu-id="f80f9-127">プロファイルウィザードは、メッセージサービスを可能な限り簡単にプロファイルに追加できるように設計された単純なアプリケーションです。</span><span class="sxs-lookup"><span data-stu-id="f80f9-127">The Profile Wizard is a simple application designed to make adding a message service to a profile as easy as possible.</span></span> <span data-ttu-id="f80f9-128">プロファイルウィザードは、"プロパティページ" と呼ばれる一連のダイアログボックスで構成されており、ユーザーにサービスのインストールと構成のプロセスを促します。</span><span class="sxs-lookup"><span data-stu-id="f80f9-128">The Profile Wizard consists of a series of dialog boxes, called property pages, that prompt the user through the process of installing and configuring a service.</span></span> <span data-ttu-id="f80f9-129">ユーザーには、最も重要な設定の値のみが表示されます。他のすべての設定は既定値を継承します。</span><span class="sxs-lookup"><span data-stu-id="f80f9-129">The user is prompted only for values for the most critical settings; all other settings inherit default values.</span></span> <span data-ttu-id="f80f9-130">プロファイルが作成されると、ユーザーは変更を行うことができなくなります。</span><span class="sxs-lookup"><span data-stu-id="f80f9-130">Once the profile has been created, users are not allowed to make changes.</span></span> 
  
<span data-ttu-id="f80f9-131">コントロールパネルの項目は常にコントロールパネルから呼び出されますが、プロファイルウィザードを呼び出す可能性があるさまざまなシナリオがあります。</span><span class="sxs-lookup"><span data-stu-id="f80f9-131">Whereas the Control Panel item is always invoked through the Control Panel, there are a variety of scenarios that can cause the Profile Wizard to be called.</span></span> <span data-ttu-id="f80f9-132">クライアントアプリケーションは、プロファイルウィザードを呼び出して、ログオン時に、まだ作成されていない既定のプロファイルを作成できます。</span><span class="sxs-lookup"><span data-stu-id="f80f9-132">Client applications can call the Profile Wizard to create a default profile at logon time when one has not yet been created.</span></span> <span data-ttu-id="f80f9-133">コードを再実装してプロファイルを追加するのではなく、コントロールパネルのアイテムまたは他のクライアントアプリケーションがプロファイルウィザードで既に使用されている機能に依存していることがあります。</span><span class="sxs-lookup"><span data-stu-id="f80f9-133">Rather than reimplementing code to add a profile, the Control Panel item or another client application can rely on the functionality already in the Profile Wizard.</span></span> <span data-ttu-id="f80f9-134">そのエントリポイント関数のメッセージサービスは、サービスを既定のプロファイルに追加する必要がある場合に、プロファイルウィザードを呼び出すことができます。</span><span class="sxs-lookup"><span data-stu-id="f80f9-134">A message service, in its entry point function, can call the Profile Wizard when the service needs to be added to the default profile.</span></span> <span data-ttu-id="f80f9-135">プロファイルウィザードを使用するメッセージサービスは、付加的なエントリポイント関数と Windows の標準ダイアログボックスプロシージャを記述する必要があります。</span><span class="sxs-lookup"><span data-stu-id="f80f9-135">Message services that use the Profile Wizard must write an extra entry point function and a standard Windows dialog box procedure.</span></span> <span data-ttu-id="f80f9-136">プロファイルウィザードは、このダイアログボックスが使用されている場合に生成されるメッセージをダイアログボックスプロシージャが処理する一方で、サービスの構成ダイアログボックスを取得するエントリポイント関数を呼び出します。</span><span class="sxs-lookup"><span data-stu-id="f80f9-136">The Profile Wizard calls the entry point function to retrieve the service's configuration dialog box while the dialog box procedure handles the messages that are generated when this dialog box is in use.</span></span> 
  
<span data-ttu-id="f80f9-137">プロファイルは、mapisvc.inf ファイルと同様の方法で整理されています。</span><span class="sxs-lookup"><span data-stu-id="f80f9-137">Profiles are organized in a similar way to the Mapisvc.inf file.</span></span> <span data-ttu-id="f80f9-138">プロファイルは階層構造のセクションをリンクしています。サービスプロバイダーは、最下位レベルのセクション、メッセージサービス独自のセクション、中間レベルのセクション、MAPI は最上位レベルのセクションを所有します。</span><span class="sxs-lookup"><span data-stu-id="f80f9-138">Profiles have linked hierarchical sections; service providers own sections in the lowest level, message services own sections in the middle level, and MAPI owns sections in the highest level.</span></span> <span data-ttu-id="f80f9-139">各セクションは、 [MAPIUID](mapiuid.md)と呼ばれる一意の識別子で識別されます。</span><span class="sxs-lookup"><span data-stu-id="f80f9-139">Each section is identified with a unique identifier known as a [MAPIUID](mapiuid.md).</span></span> <span data-ttu-id="f80f9-140">mapi セクションには、すべてのメッセージサービスプロファイルセクションの識別子、その他の各セクションへのリンクなど、mapi の内部情報が含まれています。</span><span class="sxs-lookup"><span data-stu-id="f80f9-140">The MAPI sections contain information internal to MAPI, such as the identifiers of all of the message service profile sections and links to each of the other sections.</span></span> <span data-ttu-id="f80f9-141">各メッセージサービスセクションには、プロバイダーセクションへのリンクが格納されています。各プロバイダーセクションには、そのサービスセクションへのリンクが格納されています。</span><span class="sxs-lookup"><span data-stu-id="f80f9-141">Each message service section stores links to its provider sections, and each provider section stores a link to its service section.</span></span> 
  
<span data-ttu-id="f80f9-142">次の図は、2つの一般的なプロファイルの内容を示しています。</span><span class="sxs-lookup"><span data-stu-id="f80f9-142">The following illustration shows the contents of two typical profiles.</span></span> <span data-ttu-id="f80f9-143">Sam には、自分のコンピューターに2つのプロファイルがあり、1つは自宅用で、もう1つは office 用です。</span><span class="sxs-lookup"><span data-stu-id="f80f9-143">Sam has two profiles on his computer, one for home use and one for office use.</span></span> <span data-ttu-id="f80f9-144">ホームプロファイルには3つのメッセージサービスが含まれています。</span><span class="sxs-lookup"><span data-stu-id="f80f9-144">The home profile contains three message services.</span></span> <span data-ttu-id="f80f9-145">Message Service X は、アドレス帳管理用の単一のプロバイダーサービスです。</span><span class="sxs-lookup"><span data-stu-id="f80f9-145">Message Service X is a single provider service for address book management.</span></span> <span data-ttu-id="f80f9-146">メッセージサービス Y および Z には、アドレス帳プロバイダー、メッセージストアプロバイダー、トランスポートプロバイダーという3つのプロバイダーがあります。</span><span class="sxs-lookup"><span data-stu-id="f80f9-146">Message Services Y and Z have three providers — an address book provider, a message store provider, and a transport provider.</span></span> <span data-ttu-id="f80f9-147">Sam の作業プロファイルには2つの異なるメッセージサービスが含まれており、それぞれにアドレス帳プロバイダー、メッセージストアプロバイダー、トランスポートプロバイダーがあります。</span><span class="sxs-lookup"><span data-stu-id="f80f9-147">Sam's Work Profile contains two different message services, each of which has an address book provider, a message store provider, and a transport provider.</span></span> 
  
<span data-ttu-id="f80f9-148">**プロファイルの例**</span><span class="sxs-lookup"><span data-stu-id="f80f9-148">**Profile example**</span></span>
  
<span data-ttu-id="f80f9-149">![プロファイルの例](media/amapi_56.gif "プロファイルの例")</span><span class="sxs-lookup"><span data-stu-id="f80f9-149">![Profile example](media/amapi_56.gif "Profile example")</span></span>
  
<span data-ttu-id="f80f9-150">次の図は、2つのメッセージサービスを含むプロファイルを示しています。</span><span class="sxs-lookup"><span data-stu-id="f80f9-150">The following illustration shows a profile that includes two message services.</span></span> <span data-ttu-id="f80f9-151">メッセージサービスに属するサービスプロバイダーをインストールして構成するためのコードは、プロバイダーのコードと同じ DLL に格納されます。</span><span class="sxs-lookup"><span data-stu-id="f80f9-151">The code for installing and configuring the service providers that belong to the message service resides in the same DLL as the code for the providers.</span></span> <span data-ttu-id="f80f9-152">このコードでは、ログオン時にプロファイルから情報を読み取り、サービスプロバイダーを構成します。また、必要であれば、不足している情報についてユーザーに確認します。</span><span class="sxs-lookup"><span data-stu-id="f80f9-152">This code reads information from the profile at logon time to configure the service providers, and it prompts the user, if possible and necessary, for missing information.</span></span> <span data-ttu-id="f80f9-153">プロバイダーの構成設定を表示または変更するクライアントからの要求も、この共通コードによって処理されます。</span><span class="sxs-lookup"><span data-stu-id="f80f9-153">Requests from a client to view or change configuration settings for any of the providers are also handled by this common code.</span></span>
  
<span data-ttu-id="f80f9-154">**サービス プロバイダーのインストールおよび構成**</span><span class="sxs-lookup"><span data-stu-id="f80f9-154">**Installing and configuring service providers**</span></span>
  
<span data-ttu-id="f80f9-155">![サービスプロバイダーをインストールおよび構成]する(media/amapi_55.gif "サービスプロバイダーをインストールおよび構成")する</span><span class="sxs-lookup"><span data-stu-id="f80f9-155">![Installing and configuring service providers](media/amapi_55.gif "Installing and configuring service providers")</span></span>
  
## <a name="see-also"></a><span data-ttu-id="f80f9-156">関連項目</span><span class="sxs-lookup"><span data-stu-id="f80f9-156">See also</span></span>

- [<span data-ttu-id="f80f9-157">MAPIUID</span><span class="sxs-lookup"><span data-stu-id="f80f9-157">MAPIUID</span></span>](mapiuid.md)
- [<span data-ttu-id="f80f9-158">MAPI �v���O���~���O�̊T�v</span><span class="sxs-lookup"><span data-stu-id="f80f9-158">MAPI Programming Overview</span></span>](mapi-programming-overview.md)

