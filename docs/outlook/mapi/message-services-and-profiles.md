---
title: メッセージ サービス、およびプロファイル
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: df0db1e4-69c8-44ec-bb2a-d31fc8a564b9
description: '�ŏI�X�V��: 2011�N7��23��'
ms.openlocfilehash: 0f55d4cda013810884177a0f47e861e3693defd7
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 06/11/2018
ms.locfileid: "19801650"
---
# <a name="message-services-and-profiles"></a><span data-ttu-id="fbfab-103">メッセージ サービス、およびプロファイル</span><span class="sxs-lookup"><span data-stu-id="fbfab-103">Message services and profiles</span></span>
  
<span data-ttu-id="fbfab-104">**適用対象**: Outlook</span><span class="sxs-lookup"><span data-stu-id="fbfab-104">**Applies to**: Outlook</span></span> 
  
<span data-ttu-id="fbfab-105">一部のユーザーは、それぞれ 1 つまたは複数のサービス プロバイダーが、いくつかのメッセージング システムのサービスを必要とします。</span><span class="sxs-lookup"><span data-stu-id="fbfab-105">Some users require the services of several messaging systems, each with one or more service providers.</span></span> <span data-ttu-id="fbfab-106">インストールし、これらのサービス プロバイダーのそれぞれを個別に構成するのには煩雑なため、メッセージング サーバーは通常、すべての機能を公開するのには関連するプロバイダーのグループを必要とするため、MAPI には、メッセージ サービスの概念が含まれています。</span><span class="sxs-lookup"><span data-stu-id="fbfab-106">Because it is cumbersome to install and configure each of these service providers individually, and because a messaging server usually requires a group of related providers to expose all its functionality, MAPI includes the concept of a message service.</span></span> <span data-ttu-id="fbfab-107">メッセージ サービスでは、ユーザーをインストールし、サービス プロバイダーの構成を支援します。</span><span class="sxs-lookup"><span data-stu-id="fbfab-107">Message services help users install and configure their service providers.</span></span>
  
<span data-ttu-id="fbfab-108">メッセージ サービスを作成するには、開発者は、サービス内の各プロバイダーの構成を処理するために、メッセージ サービスのエントリ ポイント プログラムとは、次のセットアップ プログラムを書き込みます。</span><span class="sxs-lookup"><span data-stu-id="fbfab-108">To create a message service, a developer writes a message-service entry point program to handle the configuration of each provider in the service and a setup program to do the following:</span></span>
  
- <span data-ttu-id="fbfab-109">サービスでは、各プロバイダーをインストールします。</span><span class="sxs-lookup"><span data-stu-id="fbfab-109">Install each provider in the service.</span></span>
    
- <span data-ttu-id="fbfab-110">レジストリと初期化ファイルのエントリを作成します。</span><span class="sxs-lookup"><span data-stu-id="fbfab-110">Create registry and initialization file entries.</span></span>
    
- <span data-ttu-id="fbfab-111">Mapisvc.inf MAPI 構成ファイルにエントリを作成します。</span><span class="sxs-lookup"><span data-stu-id="fbfab-111">Create entries in the MAPI configuration file, Mapisvc.inf.</span></span>
    
<span data-ttu-id="fbfab-112">Mapisvc.inf ファイルには、すべてのメッセージ サービス、およびコンピューターにインストールされているサービス プロバイダーの構成に関連する情報が含まれています。</span><span class="sxs-lookup"><span data-stu-id="fbfab-112">The Mapisvc.inf file contains information that relates to the configuration of all message services and service providers installed on the computer.</span></span> <span data-ttu-id="fbfab-113">構造になっている階層のセクションで次にリンクされている各レベルにします。</span><span class="sxs-lookup"><span data-stu-id="fbfab-113">It is organized in hierarchical sections, with each level linked to the next.</span></span> <span data-ttu-id="fbfab-114">上部の内容は以下の 3 つのセクションには。</span><span class="sxs-lookup"><span data-stu-id="fbfab-114">At the top are three sections that contain the following:</span></span> 
  
- <span data-ttu-id="fbfab-115">メッセージ サービスのヘルプ ファイルの一覧です。</span><span class="sxs-lookup"><span data-stu-id="fbfab-115">A list of message service Help files.</span></span>
    
- <span data-ttu-id="fbfab-116">最も重要なまたは、既定のメッセージ サービスの一覧です。</span><span class="sxs-lookup"><span data-stu-id="fbfab-116">A list of the most important, or default, message services.</span></span>
    
- <span data-ttu-id="fbfab-117">コンピューター上のすべてのサービスの一覧です。</span><span class="sxs-lookup"><span data-stu-id="fbfab-117">A list of all the services on the computer.</span></span>
    
<span data-ttu-id="fbfab-118">次のレベルには、各メッセージのサービスについては、セクションが含まれているし、最後のレベルには、サービスのサービス プロバイダーごとにセクションが含まれています。</span><span class="sxs-lookup"><span data-stu-id="fbfab-118">The next level contains sections for each message service, and the last level contains sections for each service provider in a service.</span></span> <span data-ttu-id="fbfab-119">MAPI は、サービス プロバイダーおよびメッセージ サービスの開発者が Mapisvc.inf; に特定のエントリを追加する必要があります。開発者は、独自の裁量により、他のエントリを追加できます。</span><span class="sxs-lookup"><span data-stu-id="fbfab-119">MAPI requires that developers of service providers and message services add certain entries to Mapisvc.inf; developers can add other entries at their own discretion.</span></span> <span data-ttu-id="fbfab-120">Mapisvc.inf の末尾を 1 つの情報のほとんど、または複数のプロファイルのユーザーの構成情報のコレクションでは、メッセージ サービスのセットが優先されます。</span><span class="sxs-lookup"><span data-stu-id="fbfab-120">Most of the information in Mapisvc.inf ends up in one or more profiles, a collection of configuration information for a user's preferred set of message services.</span></span> <span data-ttu-id="fbfab-121">コンピューターが複数のユーザーを持つことができますので、1 人のユーザーが複数の環境設定のセットを持つことができます多くのプロファイルがコンピューターに存在できます。</span><span class="sxs-lookup"><span data-stu-id="fbfab-121">Because a computer can have multiple users and a single user can have multiple sets of preferences, many profiles can exist on a computer.</span></span> <span data-ttu-id="fbfab-122">各プロファイルでは、別のメッセージ サービスのセットについて説明します。</span><span class="sxs-lookup"><span data-stu-id="fbfab-122">Each profile describes a different set of message services.</span></span> <span data-ttu-id="fbfab-123">複数のプロファイルを持つ、たとえば、自宅セットを操作する 1 つのメッセージ サービスとオフィスの異なるセットを使用してユーザーを有効にします。</span><span class="sxs-lookup"><span data-stu-id="fbfab-123">Having multiple profiles enables a user to work, for example, at home with one set of message services and at the office with a different set.</span></span>
  
<span data-ttu-id="fbfab-124">プロファイルは、構成のサポートを提供するクライアント ・ アプリケーションで、メッセージ サービスのインストールまたはログオン時に作成されます。</span><span class="sxs-lookup"><span data-stu-id="fbfab-124">Profiles are created at message service installation or logon time by a client application that provides configuration support.</span></span> <span data-ttu-id="fbfab-125">MAPI がこのような 2 つのクライアント アプリケーションを実現しています: コントロール パネルの項目と、プロファイル ウィザードです。</span><span class="sxs-lookup"><span data-stu-id="fbfab-125">MAPI provides two such client applications: a Control Panel item and the Profile Wizard.</span></span> <span data-ttu-id="fbfab-126">コントロール パネルのアイテムは、フル構成のアプリケーションをユーザーが作成、削除、編集、プロファイルをコピーし、プロファイル内のエントリに変更を加えるです。</span><span class="sxs-lookup"><span data-stu-id="fbfab-126">The Control Panel item is a full-service configuration application with which users can create, delete, edit, and copy profiles, as well as make modifications to the entries in a profile.</span></span> <span data-ttu-id="fbfab-127">プロファイル ウィザードは、メッセージ サービスを追加するプロファイルをできるだけ簡単にするように設計された単純なアプリケーションです。</span><span class="sxs-lookup"><span data-stu-id="fbfab-127">The Profile Wizard is a simple application designed to make adding a message service to a profile as easy as possible.</span></span> <span data-ttu-id="fbfab-128">プロファイル ウィザードは、ダイアログ ボックス、[プロパティ ページ] のインストールと構成、サービスのプロセスをユーザーに確認すると呼ばれる一連ので構成されます。</span><span class="sxs-lookup"><span data-stu-id="fbfab-128">The Profile Wizard consists of a series of dialog boxes, called property pages, that prompt the user through the process of installing and configuring a service.</span></span> <span data-ttu-id="fbfab-129">ユーザーは、値が要求されただけの最も重要な設定です。その他のすべての設定は、既定値を継承します。</span><span class="sxs-lookup"><span data-stu-id="fbfab-129">The user is prompted only for values for the most critical settings; all other settings inherit default values.</span></span> <span data-ttu-id="fbfab-130">プロファイルが作成されると、変更を加えるユーザーを作成できません。</span><span class="sxs-lookup"><span data-stu-id="fbfab-130">Once the profile has been created, users are not allowed to make changes.</span></span> 
  
<span data-ttu-id="fbfab-131">コントロール パネルからコントロール パネルの項目が常に呼び出されると、一方は、呼び出されるプロファイル ウィザードを引き起こす可能性のあるシナリオのさまざまながあります。</span><span class="sxs-lookup"><span data-stu-id="fbfab-131">Whereas the Control Panel item is always invoked through the Control Panel, there are a variety of scenarios that can cause the Profile Wizard to be called.</span></span> <span data-ttu-id="fbfab-132">クライアント アプリケーションと 1 つがまだ作成されていないログオン時に既定のプロファイルを作成するのにはプロファイル ウィザードを呼び出すことができます。</span><span class="sxs-lookup"><span data-stu-id="fbfab-132">Client applications can call the Profile Wizard to create a default profile at logon time when one has not yet been created.</span></span> <span data-ttu-id="fbfab-133">プロファイルを追加するコードを再実装をするのではなく、コントロール パネルの項目または別のクライアント アプリケーションは、プロファイル ウィザード内の既存の機能に利用できます。</span><span class="sxs-lookup"><span data-stu-id="fbfab-133">Rather than reimplementing code to add a profile, the Control Panel item or another client application can rely on the functionality already in the Profile Wizard.</span></span> <span data-ttu-id="fbfab-134">メッセージ サービスでは、そのエントリ ポイント関数で呼び出すことができますプロファイル ウィザード サービスが既定のプロファイルに追加する必要がある場合。</span><span class="sxs-lookup"><span data-stu-id="fbfab-134">A message service, in its entry point function, can call the Profile Wizard when the service needs to be added to the default profile.</span></span> <span data-ttu-id="fbfab-135">プロファイル ウィザードを使用するメッセージ サービスには、余分なエントリ ポイント関数と標準の Windows ダイアログ ボックス プロシージャを書き込む必要があります。</span><span class="sxs-lookup"><span data-stu-id="fbfab-135">Message services that use the Profile Wizard must write an extra entry point function and a standard Windows dialog box procedure.</span></span> <span data-ttu-id="fbfab-136">プロファイル ウィザードは、ダイアログ ボックス プロシージャがこのダイアログ ボックスが使用しているときに生成されるメッセージを処理中にサービスの構成] ダイアログ ボックスを取得するためにエントリ ポイント関数を呼び出します。</span><span class="sxs-lookup"><span data-stu-id="fbfab-136">The Profile Wizard calls the entry point function to retrieve the service's configuration dialog box while the dialog box procedure handles the messages that are generated when this dialog box is in use.</span></span> 
  
<span data-ttu-id="fbfab-137">Mapisvc.inf ファイルを同様の方法では、プロファイルが構成されています。</span><span class="sxs-lookup"><span data-stu-id="fbfab-137">Profiles are organized in a similar way to the Mapisvc.inf file.</span></span> <span data-ttu-id="fbfab-138">プロファイルへのリンクが階層的なセクションです。サービス プロバイダー固有のセクションで最下位レベルで、メッセージ サービスが、中間レベルのセクションを所有して、MAPI は、最上位レベルのセクションを所有しています。</span><span class="sxs-lookup"><span data-stu-id="fbfab-138">Profiles have linked hierarchical sections; service providers own sections in the lowest level, message services own sections in the middle level, and MAPI owns sections in the highest level.</span></span> <span data-ttu-id="fbfab-139">各セクションは、 [MAPIUID](mapiuid.md)と呼ばれる一意の識別子で識別されます。</span><span class="sxs-lookup"><span data-stu-id="fbfab-139">Each section is identified with a unique identifier known as a [MAPIUID](mapiuid.md).</span></span> <span data-ttu-id="fbfab-140">MAPI セクションなどの他のセクションへのリンク、メッセージ サービスのプロファイル セクションのすべての識別子は、mapi の内部の情報が含まれています。</span><span class="sxs-lookup"><span data-stu-id="fbfab-140">The MAPI sections contain information internal to MAPI, such as the identifiers of all of the message service profile sections and links to each of the other sections.</span></span> <span data-ttu-id="fbfab-141">各メッセージのサービス] セクションは、そのプロバイダーのセクションへのリンクを格納し、各プロバイダー] セクションの [サービス] セクションへのリンクを格納します。</span><span class="sxs-lookup"><span data-stu-id="fbfab-141">Each message service section stores links to its provider sections, and each provider section stores a link to its service section.</span></span> 
  
<span data-ttu-id="fbfab-142">次の図は、2 つの一般的なプロファイルの内容を示しています。</span><span class="sxs-lookup"><span data-stu-id="fbfab-142">The following illustration shows the contents of two typical profiles.</span></span> <span data-ttu-id="fbfab-143">Sam では、自分のコンピューター、ホーム用とオフィス用の 2 つのプロファイルがあります。</span><span class="sxs-lookup"><span data-stu-id="fbfab-143">Sam has two profiles on his computer, one for home use and one for office use.</span></span> <span data-ttu-id="fbfab-144">ホームのプロファイルには、次の 3 つのメッセージ サービスが含まれています。</span><span class="sxs-lookup"><span data-stu-id="fbfab-144">The home profile contains three message services.</span></span> <span data-ttu-id="fbfab-145">サービス X のメッセージは、アドレス帳の管理を 1 つのプロバイダー サービスです。</span><span class="sxs-lookup"><span data-stu-id="fbfab-145">Message Service X is a single provider service for address book management.</span></span> <span data-ttu-id="fbfab-146">サービスの Y および Z は、次の 3 つのプロバイダーを持つメッセージ、アドレス帳プロバイダー、メッセージ ストア プロバイダー、およびトランスポート プロバイダー。</span><span class="sxs-lookup"><span data-stu-id="fbfab-146">Message Services Y and Z have three providers — an address book provider, a message store provider, and a transport provider.</span></span> <span data-ttu-id="fbfab-147">Sam の作業プロファイルには、それぞれが持つアドレス帳プロバイダー、メッセージ ストア プロバイダー、およびトランスポート プロバイダーの 2 つの異なるメッセージ サービスが含まれています。</span><span class="sxs-lookup"><span data-stu-id="fbfab-147">Sam's Work Profile contains two different message services, each of which has an address book provider, a message store provider, and a transport provider.</span></span> 
  
<span data-ttu-id="fbfab-148">**プロファイルの例**</span><span class="sxs-lookup"><span data-stu-id="fbfab-148">**Profile example**</span></span>
  
<span data-ttu-id="fbfab-149">![プロファイルの例](media/amapi_56.gif "プロファイルの例")</span><span class="sxs-lookup"><span data-stu-id="fbfab-149">![Profile example](media/amapi_56.gif "Profile example")</span></span>
  
<span data-ttu-id="fbfab-150">次の図は、2 つのメッセージ サービスを含むプロファイルを示します。</span><span class="sxs-lookup"><span data-stu-id="fbfab-150">The following illustration shows a profile that includes two message services.</span></span> <span data-ttu-id="fbfab-151">インストールしてメッセージ サービスに属しているサービス プロバイダーを構成するためのコードでは、プロバイダーのコードと同じ DLL に存在します。</span><span class="sxs-lookup"><span data-stu-id="fbfab-151">The code for installing and configuring the service providers that belong to the message service resides in the same DLL as the code for the providers.</span></span> <span data-ttu-id="fbfab-152">このコードは、サービス ・ プロバイダーを構成するのにはログオン時にプロファイルから情報を読み取るし、ユーザー、可能であれば、必要に応じて、不足している情報のメッセージが表示されます。</span><span class="sxs-lookup"><span data-stu-id="fbfab-152">This code reads information from the profile at logon time to configure the service providers, and it prompts the user, if possible and necessary, for missing information.</span></span> <span data-ttu-id="fbfab-153">表示または任意のプロバイダーの構成設定を変更するようにクライアントからの要求も、この共通のコードで処理します。</span><span class="sxs-lookup"><span data-stu-id="fbfab-153">Requests from a client to view or change configuration settings for any of the providers are also handled by this common code.</span></span>
  
<span data-ttu-id="fbfab-154">**サービス プロバイダーのインストールおよび構成**</span><span class="sxs-lookup"><span data-stu-id="fbfab-154">**Installing and configuring service providers**</span></span>
  
<span data-ttu-id="fbfab-155">![インストールおよびサービス プロバイダーを構成します。](media/amapi_55.gif "インストールおよびサービス プロバイダーを構成します。")</span><span class="sxs-lookup"><span data-stu-id="fbfab-155">![Installing and configuring service providers](media/amapi_55.gif "Installing and configuring service providers")</span></span>
  
## <a name="see-also"></a><span data-ttu-id="fbfab-156">関連項目</span><span class="sxs-lookup"><span data-stu-id="fbfab-156">See also</span></span>

- [<span data-ttu-id="fbfab-157">MAPIUID</span><span class="sxs-lookup"><span data-stu-id="fbfab-157">MAPIUID</span></span>](mapiuid.md)
- [<span data-ttu-id="fbfab-158">MAPI �v���O���~���O�̊T�v</span><span class="sxs-lookup"><span data-stu-id="fbfab-158">MAPI Programming Overview</span></span>](mapi-programming-overview.md)

