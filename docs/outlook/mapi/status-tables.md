---
title: 状態テーブル
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: f2b2aca7-757f-4260-96a5-d0af55189711
description: '最終更新日時: 2015 年 3 月 9 日'
ms.openlocfilehash: afbef333af46051284fa51d52c2e3f77607b0b13
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 06/11/2018
ms.locfileid: "19804016"
---
# <a name="status-tables"></a><span data-ttu-id="f5a68-103">状態テーブル</span><span class="sxs-lookup"><span data-stu-id="f5a68-103">Status Tables</span></span>

  
  
<span data-ttu-id="f5a68-104">**適用対象**: Outlook</span><span class="sxs-lookup"><span data-stu-id="f5a68-104">**Applies to**: Outlook</span></span> 
  
<span data-ttu-id="f5a68-105">ステータス テーブルには、現在のセッションの状態に関連する情報が含まれています。</span><span class="sxs-lookup"><span data-stu-id="f5a68-105">The status table contains information relating to the state of the current session.</span></span> <span data-ttu-id="f5a68-106">MAPI とサービス ・ プロバイダーによって提供される情報が含まれるすべての MAPI セッションの状態の 1 つのテーブルがあります。</span><span class="sxs-lookup"><span data-stu-id="f5a68-106">There is one status table for every MAPI session that includes information provided by MAPI and by service providers.</span></span> <span data-ttu-id="f5a68-107">MAPI では、3 つの行のデータが用意されています: MAPI のサブシステムに対応する行、行、MAPI スプーラーを無効、および統合アドレス帳の行です。</span><span class="sxs-lookup"><span data-stu-id="f5a68-107">MAPI provides data for three rows: a row for the MAPI subsystem, a row for the MAPI spooler, and a row for the integrated address book.</span></span> <span data-ttu-id="f5a68-108">トランスポート プロバイダーは、状態テーブルに状態情報を提供する必要が、ため、すべてのアクティブなトランスポート プロバイダーの 1 つの行があります。</span><span class="sxs-lookup"><span data-stu-id="f5a68-108">Because transport providers are required to supply status information to the status table, there is one row for every active transport provider.</span></span> <span data-ttu-id="f5a68-109">アドレス帳、メッセージ ストア プロバイダーは、状態テーブルをサポートするかどうかを選択できます。</span><span class="sxs-lookup"><span data-stu-id="f5a68-109">Address book and message store providers can choose whether to support the status table.</span></span> 
  
<span data-ttu-id="f5a68-110">それぞれの行は、別のリソースによって提供されるがため、列のセットは行ごとにそれぞれ異なります。</span><span class="sxs-lookup"><span data-stu-id="f5a68-110">Because each row is provided by a different resource, the set of columns can vary from row to row.</span></span> <span data-ttu-id="f5a68-111">ステータスのすべてのオブジェクトが指定する必要がある列のセット、MAPI が提供する列のセットがありません。</span><span class="sxs-lookup"><span data-stu-id="f5a68-111">There is a set of columns that every status object is required to supply and a set of columns that MAPI supplies.</span></span> <span data-ttu-id="f5a68-112">サービス プロバイダーは、プロバイダー固有のプロパティを公開するためのこれらのセットに追加できます。</span><span class="sxs-lookup"><span data-stu-id="f5a68-112">A service provider can add to these sets to expose provider-specific properties.</span></span> <span data-ttu-id="f5a68-113">たとえば、メッセージ ストア プロバイダーは、 **PR_STORE_RECORD_KEY** ([PidTagStoreRecordKey](pidtagstorerecordkey-canonical-property.md)) が、メッセージ ・ ストアの id をクライアントに提供するのにを追加できます。</span><span class="sxs-lookup"><span data-stu-id="f5a68-113">For example, message store providers might add **PR_STORE_RECORD_KEY** ([PidTagStoreRecordKey](pidtagstorerecordkey-canonical-property.md)) to supply clients with the identifier of their message store.</span></span> <span data-ttu-id="f5a68-114">クライアントが使用できる余分な情報の有無の事前知識が必要です。</span><span class="sxs-lookup"><span data-stu-id="f5a68-114">Clients must have advance knowledge of the existence of this extra information to be able to use it.</span></span> 
  
<span data-ttu-id="f5a68-115">状態テーブルのすべての行にする必要があるプロパティを次の表に一覧します。</span><span class="sxs-lookup"><span data-stu-id="f5a68-115">The following table lists the properties that must be in every status table row.</span></span> <span data-ttu-id="f5a68-116">ステータス オブジェクトの実装は、いくつかのプロパティの他のユーザーは、MAPI によって計算されます。</span><span class="sxs-lookup"><span data-stu-id="f5a68-116">The implementer of the status object provides some of the properties; others are computed by MAPI.</span></span>
  
|<span data-ttu-id="f5a68-117">**ステータス オブジェクトによって提供されるプロパティ**</span><span class="sxs-lookup"><span data-stu-id="f5a68-117">**Properties provided by status object**</span></span>|<span data-ttu-id="f5a68-118">**MAPI によって提供されるプロパティ**</span><span class="sxs-lookup"><span data-stu-id="f5a68-118">**Properties provided by MAPI**</span></span>|
|:-----|:-----|
|<span data-ttu-id="f5a68-119">**PR_DISPLAY_NAME**([PidTagDisplayName](pidtagdisplayname-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="f5a68-119">**PR_DISPLAY_NAME** ([PidTagDisplayName](pidtagdisplayname-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="f5a68-120">**PR_PROVIDER_DLL_NAME**([PidTagProviderDllName](pidtagproviderdllname-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="f5a68-120">**PR_PROVIDER_DLL_NAME** ([PidTagProviderDllName](pidtagproviderdllname-canonical-property.md))</span></span>  <br/> |
|<span data-ttu-id="f5a68-121">**PR_STATUS_CODE**([PidTagStatusCode](pidtagstatuscode-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="f5a68-121">**PR_STATUS_CODE** ([PidTagStatusCode](pidtagstatuscode-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="f5a68-122">**PR_RESOURCE_FLAGS**([PidTagResourceFlags](pidtagresourceflags-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="f5a68-122">**PR_RESOURCE_FLAGS** ([PidTagResourceFlags](pidtagresourceflags-canonical-property.md))</span></span>  <br/> |
|<span data-ttu-id="f5a68-123">**PR_RESOURCE_METHODS**([PidTagResourceMethods](pidtagresourcemethods-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="f5a68-123">**PR_RESOURCE_METHODS** ([PidTagResourceMethods](pidtagresourcemethods-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="f5a68-124">**PR_RESOURCE_TYPE**([PidTagResourceType](pidtagresourcetype-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="f5a68-124">**PR_RESOURCE_TYPE** ([PidTagResourceType](pidtagresourcetype-canonical-property.md))</span></span>  <br/> |
   
<span data-ttu-id="f5a68-125">**PR_IDENTITY_DISPLAY** ([PidTagIdentityDisplay](pidtagidentitydisplay-canonical-property.md))、 **PR_IDENTITY_ENTRYID** ([PidTagIdentityEntryId](pidtagidentityentryid-canonical-property.md)) と**PR_IDENTITY_SEARCH_KEY** ([に設定する必要があります状態オブジェクトは、id を提供する場合PidTagIdentitySearchKey](pidtagidentitysearchkey-canonical-property.md))、これらのプロパティをテーブルに含めるとします。</span><span class="sxs-lookup"><span data-stu-id="f5a68-125">If the status object provides an identity, it should set **PR_IDENTITY_DISPLAY** ([PidTagIdentityDisplay](pidtagidentitydisplay-canonical-property.md)), **PR_IDENTITY_ENTRYID** ([PidTagIdentityEntryId](pidtagidentityentryid-canonical-property.md)), and **PR_IDENTITY_SEARCH_KEY** ([PidTagIdentitySearchKey](pidtagidentitysearchkey-canonical-property.md)), and include these properties in the table.</span></span> 
  
<span data-ttu-id="f5a68-126">4 つのプロパティは、MAPI によってステータス テーブルの行ごとに計算されます。</span><span class="sxs-lookup"><span data-stu-id="f5a68-126">Four properties are computed by MAPI for each status table row:</span></span>
  
|||
|:-----|:-----|
|<span data-ttu-id="f5a68-127">**PR_ENTRYID**([PidTagEntryId](pidtagentryid-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="f5a68-127">**PR_ENTRYID** ([PidTagEntryId](pidtagentryid-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="f5a68-128">**PR_INSTANCE_KEY**([PidTagInstanceKey](pidtaginstancekey-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="f5a68-128">**PR_INSTANCE_KEY** ([PidTagInstanceKey](pidtaginstancekey-canonical-property.md))</span></span>  <br/> |
|<span data-ttu-id="f5a68-129">**PR_OBJECT_TYPE**([PidTagObjectType](pidtagobjecttype-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="f5a68-129">**PR_OBJECT_TYPE** ([PidTagObjectType](pidtagobjecttype-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="f5a68-130">**PR_ROWID**([PidTagRowid](pidtagrowid-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="f5a68-130">**PR_ROWID** ([PidTagRowid](pidtagrowid-canonical-property.md))</span></span>  <br/> |
   
<span data-ttu-id="f5a68-131">MAPI は、クライアントを開くには、対応する状態オブジェクトを有効にするのには [状態] 行に、エントリ id を割り当てます。</span><span class="sxs-lookup"><span data-stu-id="f5a68-131">MAPI assigns an entry identifier to the status row to enable clients to open the corresponding status object.</span></span> <span data-ttu-id="f5a68-132">行識別子は、状態オブジェクト内のデータを識別するのには、インスタンスのキーが格納されるテーブルの行を識別するのにも割り当てられます。</span><span class="sxs-lookup"><span data-stu-id="f5a68-132">A row identifier is also assigned to identify the row in the table as is an instance key to identify the data in the status object.</span></span> <span data-ttu-id="f5a68-133">MAPI_STATUS に**PR_OBJECT_TYPE**プロパティが設定されています。</span><span class="sxs-lookup"><span data-stu-id="f5a68-133">The **PR_OBJECT_TYPE** property is set to MAPI_STATUS.</span></span> 
  
<span data-ttu-id="f5a68-134">ステータス テーブルにアクセスするには、クライアントは、 [IMAPISession::GetStatusTable](imapisession-getstatustable.md)メソッドを呼び出します。</span><span class="sxs-lookup"><span data-stu-id="f5a68-134">To access the status table, clients call the [IMAPISession::GetStatusTable](imapisession-getstatustable.md) method.</span></span> <span data-ttu-id="f5a68-135">この呼び出しは、起動時にすぐにない実行する必要があります。</span><span class="sxs-lookup"><span data-stu-id="f5a68-135">This call should not be made immediately upon startup.</span></span> <span data-ttu-id="f5a68-136">**GetStatusTable**には、トランスポート プロバイダーを初期化するために MAPI スプーラーが、クライアントが、ログオンを完了した後まで延期されている操作を待機するためです。</span><span class="sxs-lookup"><span data-stu-id="f5a68-136">This is because **GetStatusTable** has to wait for the MAPI spooler to initialize the transport providers, an operation that is postponed until after the client has finished its logon.</span></span> <span data-ttu-id="f5a68-137">**GetStatusTable**は、MAPI スプーラーが起動処理を完了した後、比較的高速な呼び出しです。</span><span class="sxs-lookup"><span data-stu-id="f5a68-137">**GetStatusTable** is a relatively fast call after the MAPI spooler has completed its startup processing.</span></span> 
  
<span data-ttu-id="f5a68-138">テーブルのステータス情報は、状態オブジェクトは、クライアントが接続されているまたはオフライン モードで実行されているかどうかを判断し、プロバイダーの状態を監視するためにアクセスするなど、さまざまな方法で使用できます。</span><span class="sxs-lookup"><span data-stu-id="f5a68-138">Status table information can be used in a variety of ways, such as to access a status object, to determine whether a client is running in a connected or offline mode, and to monitor a provider's state.</span></span> <span data-ttu-id="f5a68-139">などのクライアントは、 **PR_ENTRYID**プロパティの値を[IMAPISession::OpenEntry](imapisession-openentry.md)メソッドに渡すことによって、特定のサービス プロバイダーの状態のオブジェクトを開くことができます。</span><span class="sxs-lookup"><span data-stu-id="f5a68-139">For example, clients can open a specific service provider's status object by passing the value of the **PR_ENTRYID** property to the [IMAPISession::OpenEntry](imapisession-openentry.md) method.</span></span> <span data-ttu-id="f5a68-140">状態オブジェクトには、 **IMAPIStatus**インターフェイス、サービス プロバイダーのパスワードを変更する、メッセージ キューのフラッシュ、[設定] プロパティ シートを表示またはプロバイダーの状態を直接確認するメソッドを持つインターフェイスがサポートされています。</span><span class="sxs-lookup"><span data-stu-id="f5a68-140">The status object supports the **IMAPIStatus** interface, an interface that contains methods to change a service provider password, flush the message queue, display a configuration property sheet, or confirm status with a provider directly.</span></span> <span data-ttu-id="f5a68-141">テーブルのステータス情報は、時間のかかる操作中に進行状況をクライアントに通知するダイアログ ボックスをビルドするのにも使用できます。</span><span class="sxs-lookup"><span data-stu-id="f5a68-141">Status table information can also be used to build a dialog box to inform clients of progress during a lengthy operation.</span></span> 
  
<span data-ttu-id="f5a68-142">状態テーブルをサポートしているサービス プロバイダーを作成し、その行を更新する[IMAPISupport::ModifyStatusRow](imapisupport-modifystatusrow.md)メソッドを使用します。</span><span class="sxs-lookup"><span data-stu-id="f5a68-142">Service providers who do support the status table use the [IMAPISupport::ModifyStatusRow](imapisupport-modifystatusrow.md) method to create and update their row.</span></span> <span data-ttu-id="f5a68-143">その行に変更が発生すると、状態テーブルの通知を受信する登録されているシンク オブジェクトに通知する必要がありますすべてを案内します。</span><span class="sxs-lookup"><span data-stu-id="f5a68-143">Whenever a change occurs to their row, all advise sink objects registered to receive status table notifications must be notified.</span></span> <span data-ttu-id="f5a68-144">MAPI 通知ユーティリティを使用している各アドバイズ シンクの[IMAPIAdviseSink::OnNotify](imapiadvisesink-onnotify.md)メソッドを直接呼び出す場合、サービス プロバイダーは、 [IMAPISupport::Notify](imapisupport-notify.md)メソッドを呼び出すことができます。</span><span class="sxs-lookup"><span data-stu-id="f5a68-144">Service providers can call the [IMAPISupport::Notify](imapisupport-notify.md) method if they are using the MAPI notification utility or call each advise sink's [IMAPIAdviseSink::OnNotify](imapiadvisesink-onnotify.md) method directly.</span></span> 
  
## <a name="see-also"></a><span data-ttu-id="f5a68-145">関連項目</span><span class="sxs-lookup"><span data-stu-id="f5a68-145">See also</span></span>



[<span data-ttu-id="f5a68-146">MAPI テーブル</span><span class="sxs-lookup"><span data-stu-id="f5a68-146">MAPI Tables</span></span>](mapi-tables.md)

