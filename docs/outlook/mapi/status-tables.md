---
title: 状態テーブル
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: f2b2aca7-757f-4260-96a5-d0af55189711
description: '最終更新日: 2015 年 3 月 9 日'
ms.openlocfilehash: d612738ef8bf0e6925d89a5be7cb423695672d28
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/28/2019
ms.locfileid: "33422363"
---
# <a name="status-tables"></a><span data-ttu-id="3a1a6-103">状態テーブル</span><span class="sxs-lookup"><span data-stu-id="3a1a6-103">Status Tables</span></span>

  
  
<span data-ttu-id="3a1a6-104">**適用対象**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="3a1a6-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="3a1a6-105">状態テーブルには、現在のセッションの状態に関する情報が含まれています。</span><span class="sxs-lookup"><span data-stu-id="3a1a6-105">The status table contains information relating to the state of the current session.</span></span> <span data-ttu-id="3a1a6-106">mapi およびサービスプロバイダーによって提供される情報を含むすべての mapi セッションに対して、1つの状態テーブルがあります。</span><span class="sxs-lookup"><span data-stu-id="3a1a6-106">There is one status table for every MAPI session that includes information provided by MAPI and by service providers.</span></span> <span data-ttu-id="3a1a6-107">mapi では、mapi サブシステムの行、mapi スプーラーの行、統合アドレス帳の行という3つの行のデータが提供されます。</span><span class="sxs-lookup"><span data-stu-id="3a1a6-107">MAPI provides data for three rows: a row for the MAPI subsystem, a row for the MAPI spooler, and a row for the integrated address book.</span></span> <span data-ttu-id="3a1a6-108">状態情報を状態テーブルに提供するにはトランスポートプロバイダーが必要であるため、アクティブなトランスポートプロバイダーごとに1つの行があります。</span><span class="sxs-lookup"><span data-stu-id="3a1a6-108">Because transport providers are required to supply status information to the status table, there is one row for every active transport provider.</span></span> <span data-ttu-id="3a1a6-109">アドレス帳およびメッセージストアプロバイダーは、状態テーブルをサポートするかどうかを選択できます。</span><span class="sxs-lookup"><span data-stu-id="3a1a6-109">Address book and message store providers can choose whether to support the status table.</span></span> 
  
<span data-ttu-id="3a1a6-110">各行は別のリソースによって提供されるため、列のセットは行ごとに異なる場合があります。</span><span class="sxs-lookup"><span data-stu-id="3a1a6-110">Because each row is provided by a different resource, the set of columns can vary from row to row.</span></span> <span data-ttu-id="3a1a6-111">すべてのステータスオブジェクトに必要な列のセットと、MAPI が提供する列のセットがあります。</span><span class="sxs-lookup"><span data-stu-id="3a1a6-111">There is a set of columns that every status object is required to supply and a set of columns that MAPI supplies.</span></span> <span data-ttu-id="3a1a6-112">サービスプロバイダーは、これらのセットに追加して、プロバイダー固有のプロパティを公開することができます。</span><span class="sxs-lookup"><span data-stu-id="3a1a6-112">A service provider can add to these sets to expose provider-specific properties.</span></span> <span data-ttu-id="3a1a6-113">たとえば、メッセージストアプロバイダーが**PR_STORE_RECORD_KEY** ([PidTagStoreRecordKey](pidtagstorerecordkey-canonical-property.md)) を追加して、クライアントにメッセージストアの識別子を提供する場合があります。</span><span class="sxs-lookup"><span data-stu-id="3a1a6-113">For example, message store providers might add **PR_STORE_RECORD_KEY** ([PidTagStoreRecordKey](pidtagstorerecordkey-canonical-property.md)) to supply clients with the identifier of their message store.</span></span> <span data-ttu-id="3a1a6-114">クライアントは、この情報を使用できるようにするために、この特別な情報があるかどうかを事前に知っておく必要があります。</span><span class="sxs-lookup"><span data-stu-id="3a1a6-114">Clients must have advance knowledge of the existence of this extra information to be able to use it.</span></span> 
  
<span data-ttu-id="3a1a6-115">次の表に、すべての状態テーブルの行に必要なプロパティを示します。</span><span class="sxs-lookup"><span data-stu-id="3a1a6-115">The following table lists the properties that must be in every status table row.</span></span> <span data-ttu-id="3a1a6-116">status オブジェクトの実装側は、いくつかのプロパティを提供します。他のユーザーは MAPI によって計算されます。</span><span class="sxs-lookup"><span data-stu-id="3a1a6-116">The implementer of the status object provides some of the properties; others are computed by MAPI.</span></span>
  
|<span data-ttu-id="3a1a6-117">**status オブジェクトによって提供されるプロパティ**</span><span class="sxs-lookup"><span data-stu-id="3a1a6-117">**Properties provided by status object**</span></span>|<span data-ttu-id="3a1a6-118">**MAPI で提供されるプロパティ**</span><span class="sxs-lookup"><span data-stu-id="3a1a6-118">**Properties provided by MAPI**</span></span>|
|:-----|:-----|
|<span data-ttu-id="3a1a6-119">**PR_DISPLAY_NAME**([PidTagDisplayName](pidtagdisplayname-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="3a1a6-119">**PR_DISPLAY_NAME** ([PidTagDisplayName](pidtagdisplayname-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="3a1a6-120">**PR_PROVIDER_DLL_NAME**([PidTagProviderDllName](pidtagproviderdllname-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="3a1a6-120">**PR_PROVIDER_DLL_NAME** ([PidTagProviderDllName](pidtagproviderdllname-canonical-property.md))</span></span>  <br/> |
|<span data-ttu-id="3a1a6-121">**PR_STATUS_CODE**([PidTagStatusCode](pidtagstatuscode-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="3a1a6-121">**PR_STATUS_CODE** ([PidTagStatusCode](pidtagstatuscode-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="3a1a6-122">**PR_RESOURCE_FLAGS**([PidTagResourceFlags](pidtagresourceflags-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="3a1a6-122">**PR_RESOURCE_FLAGS** ([PidTagResourceFlags](pidtagresourceflags-canonical-property.md))</span></span>  <br/> |
|<span data-ttu-id="3a1a6-123">**PR_RESOURCE_METHODS**([PidTagResourceMethods](pidtagresourcemethods-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="3a1a6-123">**PR_RESOURCE_METHODS** ([PidTagResourceMethods](pidtagresourcemethods-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="3a1a6-124">**PR_RESOURCE_TYPE**([PidTagResourceType](pidtagresourcetype-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="3a1a6-124">**PR_RESOURCE_TYPE** ([PidTagResourceType](pidtagresourcetype-canonical-property.md))</span></span>  <br/> |
   
<span data-ttu-id="3a1a6-125">status オブジェクトが id を提供する場合は、 **PR_IDENTITY_DISPLAY** ([PidTagIdentityDisplay](pidtagidentitydisplay-canonical-property.md))、 **PR_IDENTITY_ENTRYID** ([PidTagIdentityEntryId](pidtagidentityentryid-canonical-property.md))、および**PR_IDENTITY_SEARCH_KEY**を設定する必要があります ([PidTagIdentitySearchKey](pidtagidentitysearchkey-canonical-property.md)) を指定し、これらのプロパティをテーブルに含めます。</span><span class="sxs-lookup"><span data-stu-id="3a1a6-125">If the status object provides an identity, it should set **PR_IDENTITY_DISPLAY** ([PidTagIdentityDisplay](pidtagidentitydisplay-canonical-property.md)), **PR_IDENTITY_ENTRYID** ([PidTagIdentityEntryId](pidtagidentityentryid-canonical-property.md)), and **PR_IDENTITY_SEARCH_KEY** ([PidTagIdentitySearchKey](pidtagidentitysearchkey-canonical-property.md)), and include these properties in the table.</span></span> 
  
<span data-ttu-id="3a1a6-126">各状態テーブルの行では、次の4つのプロパティが MAPI によって計算されます。</span><span class="sxs-lookup"><span data-stu-id="3a1a6-126">Four properties are computed by MAPI for each status table row:</span></span>
  
|||
|:-----|:-----|
|<span data-ttu-id="3a1a6-127">**PR_ENTRYID**([PidTagEntryId](pidtagentryid-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="3a1a6-127">**PR_ENTRYID** ([PidTagEntryId](pidtagentryid-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="3a1a6-128">**PR_INSTANCE_KEY**([PidTagInstanceKey](pidtaginstancekey-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="3a1a6-128">**PR_INSTANCE_KEY** ([PidTagInstanceKey](pidtaginstancekey-canonical-property.md))</span></span>  <br/> |
|<span data-ttu-id="3a1a6-129">**PR_OBJECT_TYPE**([PidTagObjectType](pidtagobjecttype-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="3a1a6-129">**PR_OBJECT_TYPE** ([PidTagObjectType](pidtagobjecttype-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="3a1a6-130">**PR_ROWID**([PidTagRowid](pidtagrowid-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="3a1a6-130">**PR_ROWID** ([PidTagRowid](pidtagrowid-canonical-property.md))</span></span>  <br/> |
   
<span data-ttu-id="3a1a6-131">MAPI は、ステータス行にエントリ識別子を割り当てて、クライアントが対応する status オブジェクトを開くことができるようにします。</span><span class="sxs-lookup"><span data-stu-id="3a1a6-131">MAPI assigns an entry identifier to the status row to enable clients to open the corresponding status object.</span></span> <span data-ttu-id="3a1a6-132">また、status オブジェクトのデータを識別するためのインスタンスキーとして、テーブル内の行を識別するための行識別子も割り当てられます。</span><span class="sxs-lookup"><span data-stu-id="3a1a6-132">A row identifier is also assigned to identify the row in the table as is an instance key to identify the data in the status object.</span></span> <span data-ttu-id="3a1a6-133">**PR_OBJECT_TYPE**プロパティは MAPI_STATUS に設定されています。</span><span class="sxs-lookup"><span data-stu-id="3a1a6-133">The **PR_OBJECT_TYPE** property is set to MAPI_STATUS.</span></span> 
  
<span data-ttu-id="3a1a6-134">状態テーブルにアクセスするために、クライアントは[imapisession:: getstatustable](imapisession-getstatustable.md)メソッドを呼び出します。</span><span class="sxs-lookup"><span data-stu-id="3a1a6-134">To access the status table, clients call the [IMAPISession::GetStatusTable](imapisession-getstatustable.md) method.</span></span> <span data-ttu-id="3a1a6-135">この呼び出しは、スタートアップ時に直ちに行わないでください。</span><span class="sxs-lookup"><span data-stu-id="3a1a6-135">This call should not be made immediately upon startup.</span></span> <span data-ttu-id="3a1a6-136">これは、 **getstatustable**が MAPI スプーラーによるトランスポートプロバイダーの初期化を待機する必要があるためです。これは、クライアントがログオンを終了するまで延期される操作です。</span><span class="sxs-lookup"><span data-stu-id="3a1a6-136">This is because **GetStatusTable** has to wait for the MAPI spooler to initialize the transport providers, an operation that is postponed until after the client has finished its logon.</span></span> <span data-ttu-id="3a1a6-137">**getstatustable**は、MAPI スプーラーがスタートアップ処理を完了した後、比較的高速な呼び出しです。</span><span class="sxs-lookup"><span data-stu-id="3a1a6-137">**GetStatusTable** is a relatively fast call after the MAPI spooler has completed its startup processing.</span></span> 
  
<span data-ttu-id="3a1a6-138">状態テーブル情報は、ステータスオブジェクトへのアクセスなど、さまざまな方法で使用でき、クライアントが接続モードまたはオフラインモードで実行されているかどうかを確認し、プロバイダーの状態を監視します。</span><span class="sxs-lookup"><span data-stu-id="3a1a6-138">Status table information can be used in a variety of ways, such as to access a status object, to determine whether a client is running in a connected or offline mode, and to monitor a provider's state.</span></span> <span data-ttu-id="3a1a6-139">たとえば、クライアントは、 **PR_ENTRYID**プロパティの値を[imapisession:: openentry](imapisession-openentry.md)メソッドに渡すことによって、特定のサービスプロバイダーの状態オブジェクトを開くことができます。</span><span class="sxs-lookup"><span data-stu-id="3a1a6-139">For example, clients can open a specific service provider's status object by passing the value of the **PR_ENTRYID** property to the [IMAPISession::OpenEntry](imapisession-openentry.md) method.</span></span> <span data-ttu-id="3a1a6-140">status オブジェクトは、 **imapistatus**インターフェイスをサポートしています。このインターフェイスには、サービスプロバイダのパスワードを変更するメソッド、メッセージキューをフラッシュするメソッド、構成プロパティシートを表示するメソッド、またはプロバイダーによる状態を直接確認するメソッドが含まれています。</span><span class="sxs-lookup"><span data-stu-id="3a1a6-140">The status object supports the **IMAPIStatus** interface, an interface that contains methods to change a service provider password, flush the message queue, display a configuration property sheet, or confirm status with a provider directly.</span></span> <span data-ttu-id="3a1a6-141">状態テーブル情報を使用して、時間のかかる操作中にクライアントに進行状況を通知するダイアログボックスを作成することもできます。</span><span class="sxs-lookup"><span data-stu-id="3a1a6-141">Status table information can also be used to build a dialog box to inform clients of progress during a lengthy operation.</span></span> 
  
<span data-ttu-id="3a1a6-142">状態テーブルをサポートするサービスプロバイダーは、 [imapisupport:: modifystatusrow](imapisupport-modifystatusrow.md)メソッドを使用して、行を作成および更新します。</span><span class="sxs-lookup"><span data-stu-id="3a1a6-142">Service providers who do support the status table use the [IMAPISupport::ModifyStatusRow](imapisupport-modifystatusrow.md) method to create and update their row.</span></span> <span data-ttu-id="3a1a6-143">行が変更されるたびに、状態テーブル通知を受信するように登録されているすべてのアドバイズシンクオブジェクトに通知する必要があります。</span><span class="sxs-lookup"><span data-stu-id="3a1a6-143">Whenever a change occurs to their row, all advise sink objects registered to receive status table notifications must be notified.</span></span> <span data-ttu-id="3a1a6-144">MAPI 通知ユーティリティを使用している場合、または各アドバイズシンクの[IMAPIAdviseSink:: onnotify](imapiadvisesink-onnotify.md)メソッドを直接呼び出している場合は、サービスプロバイダーは[imapisupport:: Notify](imapisupport-notify.md)メソッドを呼び出すことができます。</span><span class="sxs-lookup"><span data-stu-id="3a1a6-144">Service providers can call the [IMAPISupport::Notify](imapisupport-notify.md) method if they are using the MAPI notification utility or call each advise sink's [IMAPIAdviseSink::OnNotify](imapiadvisesink-onnotify.md) method directly.</span></span> 
  
## <a name="see-also"></a><span data-ttu-id="3a1a6-145">関連項目</span><span class="sxs-lookup"><span data-stu-id="3a1a6-145">See also</span></span>



[<span data-ttu-id="3a1a6-146">MAPI テーブル</span><span class="sxs-lookup"><span data-stu-id="3a1a6-146">MAPI Tables</span></span>](mapi-tables.md)

