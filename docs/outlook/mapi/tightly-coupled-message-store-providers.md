---
title: 密結合メッセージストアプロバイダー
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 2eb493d7-bbd1-45b2-bd82-2bc452b2deab
description: '最終更新日: 2011 年 7 月 23 日'
ms.openlocfilehash: 3c9996dad1e9aa8c291f1cd593d9651994d86141
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/23/2019
ms.locfileid: "32330059"
---
# <a name="tightly-coupled-message-store-providers"></a>密結合メッセージストアプロバイダー

  
  
**適用対象**: Outlook 2013 | Outlook 2016 
  
メッセージストアプロバイダーは、トランスポートプロバイダーと密に結合できます。 MAPI サービスプロバイダーは、ストアプロバイダーとトランスポートプロバイダーが通信できるように2つのプロバイダーを実装することによって、メッセージの送信と受信をより効率的に行うことができます。 これを実現する利点は、2つのサービスプロバイダーが MAPI スプーラーを使用するのではなく、互いに直接対話できる場合に、パフォーマンスが向上する可能性があることです。 メッセージストアプロバイダーを厳密にトランスポートプロバイダーに結合するには、トランスポートプロバイダーは、トランスポートプロバイダーの**PR_OWN_STORE_ENTRYID** ([PidTagOwnStoreEntryId](pidtagownstoreentryid-canonical-property.md)) プロパティにメッセージストアプロバイダーのエントリ識別子を配置する必要があります。MAPI 状態テーブルの行。 これにより、MAPI スプーラーはストアプロバイダーをトランスポートプロバイダーに接続できます。
  
メッセージストアプロバイダーを他のサービスプロバイダーと密に結合する必要はありません。 メッセージストアプロバイダーと密接に連携する最も一般的なサービスプロバイダーは、トランスポートプロバイダーです。 これは通常、MAPI スプーラーを使用せずに、メッセージの送受信を行うことができるようにするためです。 たとえば、ユーザーが送信メッセージを送信すると、メッセージストアプロバイダーとトランスポートプロバイダーの組み合わせによって直接送信できます。 統合されたサービスプロバイダーは、最初に処理すべき新しいメッセージがあることを mapi スプーラーに通知し、mapi スプーラーがメッセージストアプロバイダーからトランスポートプロバイダーにメッセージを転送するプロセスを開始するのを待機する必要はありません。 これは、ユーザーのコンピューターとサーバー間のネットワークトラフィックを最小限に抑えることによって、サーバーベースのメッセージストアが使用されている場合に特に利点があります。
  
一般に、サービスプロバイダーを密に結合するための適切に指定された手順はありません。 ただし、次のガイドラインを使用する必要があります。
  
- サービスプロバイダーが密に結合している理由がパフォーマンスにある場合は、これらのパーツが通常関与するプロセスから MAPI サブシステムの一部を取得することに注意してください。 これは、統合されたサービスプロバイダーの個々のパーツが相互に通信する必要があることを意味します。これは、通常、使用されていない MAPI サブシステムの部分に対する対話をシミュレートすることです。
    
- 密結合サービスプロバイダーが他の MAPI コンポーネントと対話する場合、密接に結合されていない場合でも、まったく同じように操作する必要があります。 たとえば、ユーザーが統合されたメッセージストアプロバイダーとトランスポートプロバイダーを既定のメッセージストアとして使用していて、別のトランスポートプロバイダーを使用してメッセージを送信する場合は、ユーザーが外出中にコンピューターを使用してリモートトランスポート pr に切り替えたときに発生する可能性があります。ovider-密結合サービスプロバイダーのメッセージストア部分は、スタンドアロンのメッセージストアプロバイダーの場合と同様に、MAPI スプーラーと対話する必要があります。
    
## <a name="see-also"></a>関連項目



[MAPI メッセージ ストア プロバイダーの開発](developing-a-mapi-message-store-provider.md)

