---
title: エントリ識別子を構築する
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: bc2a9116-948e-4da3-96b8-26d73bcd63c4
description: '最終更新日: 2011 年 7 月 23 日'
ms.openlocfilehash: 8d48c2584fa5b7e862102e401ea8165821607f77
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/28/2019
ms.locfileid: "33427949"
---
# <a name="constructing-entry-identifiers"></a>エントリ識別子を構築する

  
  
**適用対象**: Outlook 2013 | Outlook 2016 
  
エントリ識別子は[ENTRYID](entryid.md)構造で構成されます。 **ENTRYID**構造は、エントリ識別子の属性と実際のエントリ識別子を記述するフラグで構成されます。 
  
## <a name="entryid-structure"></a>ENTRYID 構造体

**ENTRYID**構造体は、次のように定義されます。 
  
```cpp
typedef struct
{
    BYTE        abFlags[4];
    BYTE        ab[MAPI_DIM];
}  ENTRYID, FAR *LPENTRYID;
 
```

MAPI_DIM は、mapidefs.h ヘッダーファイルで定義されている定数です。 
  
4バイトの**abflags**メンバーの最初のバイトは、エントリ識別子の種類と使用について説明し、次の値を指定できます。 
  
- MAPI_NOTRECI-エントリ id をメッセージの受信者として使用できないことを示します。
    
- MAPI_NOTRESERVED —他のユーザーがエントリ識別子にアクセスできないことを示します。
    
- MAPI_NOW —他の場合にエントリ識別子を使用できないことを示します。
    
- MAPI_SHORTTERM-エントリ識別子が短時間であることを示します。 このバイトの他のすべての値は、エントリ識別子の他の使用が許可されていない限り、設定する必要があります。
    
- MAPI_THISSESSION —他のセッションでエントリ識別子を使用できないことを示します。
    
- MAPI_NOTRESERVED —他のオブジェクトについて、他のサービスプロバイダーが入力識別子を使用できることを示します。
    
アドレス帳およびメッセージストアプロバイダーによって作成されるエントリ識別子の**ab**メンバーは、サービスプロバイダーを識別する16バイトの[MAPIUID](mapiuid.md)構造と、オブジェクトを識別する1つの要素で構成されます。 **MAPIUID**は、グローバル一意識別子または GUID を含む構造体です。 guid は、Microsoft Visual Studio の*guid の作成** ツールを使用して作成できる、バイト順に依存しない識別子です。 
  
サービスプロバイダーは、 [imapisupport:: setprovideruid](imapisupport-setprovideruid.md)メソッドへの呼び出しで、ログオンプロセス時に MAPI に**MAPIUID**構造を登録します。 クライアントが**openentry**メソッドを呼び出してオブジェクトにアクセスすると、MAPI は**MAPIUID**構造を使用して、そのアクセスを提供できるサービスプロバイダーを特定します。 サービスプロバイダーは、すべてのバージョンの DLL に対して同じ**MAPIUID**構造を使用する必要があります。 これにより、新しいバージョンのクライアントは、以前のバージョンで送信され、保存されたメッセージに応答することができます。 
  
16バイトの**MAPIUID**の後の残りの**ab**メンバーには、特定のオブジェクトを識別するためのサービスプロバイダー固有のバイナリデータが含まれています。 この部分には、エントリ識別子の固定サイズはありません。 理由として、任意のサイズを指定できます。 通常、サービスプロバイダーには、エントリ識別子のこの部分に次の情報が含まれています。 
  
- バージョン情報—サービスプロバイダーが、エントリ識別子の形式をバージョンからバージョンに変更することが一般的なので、バージョン情報を格納することで、エントリ識別子の解読方法をすばやく判断することができるようになります。
    
- 場所情報: 場所情報は、エントリ識別子によって表されるオブジェクトを検索する方法を示すインジケーターをサービスプロバイダーに提供するデータです。 たとえば、サービスプロバイダーは、オブジェクトが格納されていたデータファイル内の最後の位置のディスクオフセットを格納できます。 この種の情報は時間の経過とともに変化する可能性があるため、サービスプロバイダーは、エントリ識別子でオブジェクトを検索する複数の方法を提供する必要があります。
    
サービスプロバイダーは、エントリ id をリサイクルすることができますが、この方法を回避する必要があります。 エントリ識別子を再利用する必要がある場合、サービスプロバイダーは最初の使用と再利用の間に経過する期間を可能な限り長くする必要があります。 また、エントリ識別子を同じ種類の別のオブジェクトに再割り当てする必要があります。 つまり、特定のエントリ識別子を最初にメッセージに関連付け、次にフォルダーに関連付けることはできません。
  
## <a name="see-also"></a>関連項目



[MAPI エントリ識別子](mapi-entry-identifiers.md)

