---
title: MAPI プロパティの種類の概要
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: b762f5fb-7c2c-4303-96f7-0b6e657146c9
description: '最終更新日: 2011 年 7 月 23 日'
ms.openlocfilehash: 58dd25f09b76d97fd6441915225756a19f4ec3cb
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/28/2019
ms.locfileid: "33438198"
---
# <a name="mapi-property-type-overview"></a><span data-ttu-id="34dc3-103">MAPI プロパティの種類の概要</span><span class="sxs-lookup"><span data-stu-id="34dc3-103">MAPI property type overview</span></span>
  
<span data-ttu-id="34dc3-104">**適用対象**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="34dc3-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="34dc3-105">プロパティの種類は、MAPIDEFS で MAPI によって定義される定数です。プロパティ値の基になるデータ型を示す H ヘッダー ファイル。</span><span class="sxs-lookup"><span data-stu-id="34dc3-105">Property types are constants defined by MAPI in the MAPIDEFS.H header file that indicate the underlying data type of a property value.</span></span> <span data-ttu-id="34dc3-106">MAPI、クライアント アプリケーション、またはサービス プロバイダーによって定義されるプロパティはすべて、次のいずれかの種類を使用します。</span><span class="sxs-lookup"><span data-stu-id="34dc3-106">All properties, whether they are defined by MAPI, by client applications, or by service providers, use one of these types.</span></span> 
  
<span data-ttu-id="34dc3-107">プロパティの種類は、プロパティ タグに使用される名前付け規則と同様の名前付け規則に従います。</span><span class="sxs-lookup"><span data-stu-id="34dc3-107">Property types follow a similar naming convention to the one used for property tags.</span></span> <span data-ttu-id="34dc3-108">多くのプロパティ型には、単一値バージョンと複数値バージョンの両方があります。</span><span class="sxs-lookup"><span data-stu-id="34dc3-108">Many property types have both a single-value and multiple-value version.</span></span> <span data-ttu-id="34dc3-109">単一の値を持つプロパティには、1 つの整数や文字列など、その型の 1 つの値が含まれます。</span><span class="sxs-lookup"><span data-stu-id="34dc3-109">Single valued properties contain one value of its type such as a single integer or character string.</span></span> <span data-ttu-id="34dc3-110">単一の値プロパティを表す定数には、プレフィックス PT_、LONG や STRING8 などの実際の型を表す文字列の 2 つの部分があります。</span><span class="sxs-lookup"><span data-stu-id="34dc3-110">The constant used to represent a single value property has two parts: the prefix PT_ and a string describing the actual type, such as LONG or STRING8.</span></span> 
  
<span data-ttu-id="34dc3-111">複数値のプロパティには、その型の複数の値が含まれる。</span><span class="sxs-lookup"><span data-stu-id="34dc3-111">Multiple-value properties contain more than one value of its type.</span></span> <span data-ttu-id="34dc3-112">OLE バリアント配列とは異なり、複数値プロパティのすべての値は同じ型です。</span><span class="sxs-lookup"><span data-stu-id="34dc3-112">Unlike OLE variant arrays, every value in a multivalued property is of the same type.</span></span> <span data-ttu-id="34dc3-113">複数値プロパティを表す定数は、MV_FLAG フラグと基本型を表す対応する単一値定数を組み合わせることによって作成されます。</span><span class="sxs-lookup"><span data-stu-id="34dc3-113">The constant used to represent multivalued properties is created by combining the MV_FLAG flag with the corresponding single value constant representing the base type.</span></span> <span data-ttu-id="34dc3-114">次の 3 つの部分があります。プレフィックスPT_続MV_型を表す文字列が続きます。</span><span class="sxs-lookup"><span data-stu-id="34dc3-114">There are three parts: the prefix PT_ followed by MV_ followed by a string that describes the type.</span></span> <span data-ttu-id="34dc3-115">たとえば、複数の整数を含むプロパティの型はPT_MV_LONG、複数の文字列の場合はPT_MV_STRING8。</span><span class="sxs-lookup"><span data-stu-id="34dc3-115">For example, the type for a property containing multiple integers is PT_MV_LONG and for multiple character strings is PT_MV_STRING8.</span></span>
  
<span data-ttu-id="34dc3-116">次の図は、複数値の整数を表す [SPropValue](spropvalue.md) 構造体の構造を示PT_MV_LONG。</span><span class="sxs-lookup"><span data-stu-id="34dc3-116">The following illustration shows the structure of an [SPropValue](spropvalue.md) structure to describe a multiple-value integer, a property of type PT_MV_LONG.</span></span> <span data-ttu-id="34dc3-117">**Value メンバー** が展開され、プロパティ内の整数値の数と、それらの値の配列へのポインターが含まれます。</span><span class="sxs-lookup"><span data-stu-id="34dc3-117">The **Value** member is expanded to include a count of the number of integer values in the property and a pointer to an array of those values.</span></span> 
  
<span data-ttu-id="34dc3-118">**複数値プロパティ**</span><span class="sxs-lookup"><span data-stu-id="34dc3-118">**Multiple-value properties**</span></span>
  
<span data-ttu-id="34dc3-119">![複数値のプロパティ](media/amapi_12.gif "複数値のプロパティ")</span><span class="sxs-lookup"><span data-stu-id="34dc3-119">![Multiple-value properties](media/amapi_12.gif "Multiple-value properties")</span></span>
  
<span data-ttu-id="34dc3-120">複数値のプロパティのサポートは省略可能ですが、MAPI に準拠したコンポーネント間の相互作用が大きいので、クライアントとサービス プロバイダーは両方の種類のプロパティをサポートする必要があります。</span><span class="sxs-lookup"><span data-stu-id="34dc3-120">Although support for multiple-value properties is optional, MAPI recommends that clients and service providers support both types of properties because doing so enables greater interaction between MAPI-compliant components.</span></span>
  
<span data-ttu-id="34dc3-121">次の図は **、SPropValue** 構造体に格納されている場所を示す、さまざまなプロパティ型の定数の一覧です。</span><span class="sxs-lookup"><span data-stu-id="34dc3-121">The following illustration lists all of the different property type constants, showing where they are stored in an **SPropValue** structure.</span></span> <span data-ttu-id="34dc3-122">Value メンバーのサイズ **は** 、特定の型によって異なります。</span><span class="sxs-lookup"><span data-stu-id="34dc3-122">The size of the **Value** member is dependent on the particular type.</span></span> <span data-ttu-id="34dc3-123">すべての単一値型に複数値の同等の値があるというのではありません。</span><span class="sxs-lookup"><span data-stu-id="34dc3-123">Notice that not all of the single-value types have multiple-value equivalents.</span></span> 
  
<span data-ttu-id="34dc3-124">**プロパティ タイプ定数**</span><span class="sxs-lookup"><span data-stu-id="34dc3-124">**Property type constants**</span></span>
  
<span data-ttu-id="34dc3-125">![プロパティの種類の定数](media/amapi_11.gif "プロパティの種類の定数")</span><span class="sxs-lookup"><span data-stu-id="34dc3-125">![Property type constants](media/amapi_11.gif "Property type constants")</span></span>
  
<span data-ttu-id="34dc3-126">プロパティを操作するクライアントとサービス プロバイダーは、次の 2 つの手順に従う必要があります。</span><span class="sxs-lookup"><span data-stu-id="34dc3-126">Clients and service providers working with a property need to follow two steps:</span></span>
  
1. <span data-ttu-id="34dc3-127">プロパティが使用可能か使用できないか確認します。</span><span class="sxs-lookup"><span data-stu-id="34dc3-127">Determine if the property is available or unavailable.</span></span>
    
2. <span data-ttu-id="34dc3-128">使用可能な場合は、プロパティの値を取得します。</span><span class="sxs-lookup"><span data-stu-id="34dc3-128">If available, retrieve the property's value.</span></span>
    
<span data-ttu-id="34dc3-129">クライアントまたはサービス プロバイダーは、プロパティの存在のみを確認する必要がある場合があります。それ以外の場合は、特定の値を確認する必要があります。</span><span class="sxs-lookup"><span data-stu-id="34dc3-129">Sometimes a client or service provider need only check for the existence of a property; other times it is necessary to check for a specific value.</span></span> <span data-ttu-id="34dc3-130">たとえば、トランスポート プロバイダーには **\_ 、PR SEND_RICH_INFO** ([PidTagSendRichInfo](pidtagsendrichinfo-canonical-property.md)) プロパティを処理する 3 つの異なるアクション コースがあります。メッセージを書式設定されたテキストで送信するかどうかを示すブール値です。</span><span class="sxs-lookup"><span data-stu-id="34dc3-130">For example, transport providers have three different courses of action for processing the **PR\_SEND_RICH_INFO** ([PidTagSendRichInfo](pidtagsendrichinfo-canonical-property.md)) property, a Boolean value that indicates whether or not a message should be transmitted with formatted text.</span></span> <span data-ttu-id="34dc3-131">**PR メッセージ \_ SEND_RICH_INFO** TRUE に設定されている場合、トランスポート プロバイダーは書式設定されたテキストを送信します。</span><span class="sxs-lookup"><span data-stu-id="34dc3-131">If **PR\_SEND_RICH_INFO** is set to TRUE, the transport provider transmits the formatted text.</span></span> <span data-ttu-id="34dc3-132">FALSE に設定されている場合、書式設定されたテキストは送信前に破棄されます。</span><span class="sxs-lookup"><span data-stu-id="34dc3-132">If it is set to FALSE, the formatted text is discarded before transmission.</span></span> <span data-ttu-id="34dc3-133">この **PR_SEND_RICH_INFO** 使用できない場合、トランスポート プロバイダーは、特定のプロバイダーに対する既定の処理に従います。</span><span class="sxs-lookup"><span data-stu-id="34dc3-133">If **PR_SEND_RICH_INFO** is unavailable, the transport provider follows its default course of action, whatever that is for the particular provider.</span></span> 
  
<span data-ttu-id="34dc3-134">MAPI では、クライアントまたはサービス プロバイダー PT_UNSPECIFIEDプロパティの種類が不明な場合にプロパティを取得するために使用できる特別なプロパティの種類を定義します。その種類を事前に知らなくてもプロパティを取得するには、クライアントまたはサービス プロバイダーがオブジェクトの [IMAPIProp::GetProps](imapiprop-getprops.md) メソッドを呼び出し、プロパティの識別子と PT_UNSPECIFIED プロパティの種類で構成されるプロパティ タグを渡します。</span><span class="sxs-lookup"><span data-stu-id="34dc3-134">MAPI defines a special property type, PT_UNSPECIFIED, that a client or service provider can use to retrieve a property when the property type is unknown.To retrieve a property without advance knowledge of its type, a client or service provider calls an object's [IMAPIProp::GetProps](imapiprop-getprops.md) method and passes a property tag made up of the property's identifier and the PT_UNSPECIFIED property type.</span></span> <span data-ttu-id="34dc3-135">**GetProps は** 、プロパティの [SPropValue](spropvalue.md) 構造体を返し、プロパティのPT_UNSPECIFIEDを適切な型に置き換える。</span><span class="sxs-lookup"><span data-stu-id="34dc3-135">**GetProps** returns an [SPropValue](spropvalue.md) structure for the property, replacing PT_UNSPECIFIED with the appropriate type.</span></span> <span data-ttu-id="34dc3-136">**GetProps** を実装するサービス プロバイダーは、この機能をサポートPT_UNSPECIFIED。</span><span class="sxs-lookup"><span data-stu-id="34dc3-136">Service providers implementing **GetProps** are required to support PT_UNSPECIFIED.</span></span> 
  
<span data-ttu-id="34dc3-137">一部の MAPI オブジェクトは、自身のオブジェクトであるプロパティをサポートしています。</span><span class="sxs-lookup"><span data-stu-id="34dc3-137">Some MAPI objects support properties that are themselves objects.</span></span> <span data-ttu-id="34dc3-138">オブジェクト プロパティの型は、PT_OBJECT。</span><span class="sxs-lookup"><span data-stu-id="34dc3-138">Object properties have the type PT_OBJECT.</span></span> <span data-ttu-id="34dc3-139">**IMAPIProp::GetProps** を使用してこれらのプロパティにアクセスする代わりに、クライアントとサービス プロバイダーは通常 [、IMAPIProp::OpenProperty](imapiprop-openproperty.md)メソッド、アクセスに適切なインターフェイスを指定する方法、またはプロパティをサポートするオブジェクトのメソッドのいずれかをユーザーにします。</span><span class="sxs-lookup"><span data-stu-id="34dc3-139">Instead of using **IMAPIProp::GetProps** to access these properties, clients and service providers typically user either the [IMAPIProp::OpenProperty](imapiprop-openproperty.md) method, specifying the appropriate interface for access, or a method on the object supporting the property.</span></span> 
  
<span data-ttu-id="34dc3-140">オブジェクト プロパティの値にアクセスするには、オブジェクトのインターフェイスの 1 つを使用する必要があります **。GetProps は** 不適切です。</span><span class="sxs-lookup"><span data-stu-id="34dc3-140">Because accessing the value of an object property involves using one of the interfaces for the object, **GetProps** is inappropriate.</span></span> <span data-ttu-id="34dc3-141">**GetProps を使用すると**、呼び出し元は SPropValue 構造体を介してプロパティの **値にアクセス** します。</span><span class="sxs-lookup"><span data-stu-id="34dc3-141">With **GetProps**, the caller accesses a property's value through an **SPropValue** structure.</span></span> <span data-ttu-id="34dc3-142">**IMAPIProp::OpenProperty では**、呼び出し元はオブジェクトにアクセスできるインターフェイスへのポインターを取得します。</span><span class="sxs-lookup"><span data-stu-id="34dc3-142">With **IMAPIProp::OpenProperty**, the caller retrieves a pointer to an interface that can access the object.</span></span> <span data-ttu-id="34dc3-143">**OpenProperty は** 、オブジェクト プロパティを取得するために常に使用できます。</span><span class="sxs-lookup"><span data-stu-id="34dc3-143">**OpenProperty** can always be used to retrieve an object property.</span></span> <span data-ttu-id="34dc3-144">オブジェクトのメソッドを呼び出すもう 1 つのオプションは、すべてのオブジェクト プロパティで使用できるとは言えな。</span><span class="sxs-lookup"><span data-stu-id="34dc3-144">The other option, calling a method on the object, is not available with every object property.</span></span> 
  
<span data-ttu-id="34dc3-145">たとえば、すべてのフォルダーは、階層テーブルとコンテンツ テーブルという 2 つのテーブルをサポートします。</span><span class="sxs-lookup"><span data-stu-id="34dc3-145">For example, every folder supports two tables, a hierarchy table and a contents table.</span></span> <span data-ttu-id="34dc3-146">これらのテーブルは、フォルダーのプロパティです。プロパティ タグは **、PR_CONTAINER_HIERARCHY** ([PidTagContainerHierarchy](pidtagcontainerhierarchy-canonical-property.md)) および PR_CONTAINER_CONTENTS **(** [PidTagContainerContents](pidtagcontainercontents-canonical-property.md)) です。</span><span class="sxs-lookup"><span data-stu-id="34dc3-146">These tables are properties of the folder; their property tags are **PR_CONTAINER_HIERARCHY** ([PidTagContainerHierarchy](pidtagcontainerhierarchy-canonical-property.md)) and **PR_CONTAINER_CONTENTS** ([PidTagContainerContents](pidtagcontainercontents-canonical-property.md)).</span></span> <span data-ttu-id="34dc3-147">テーブルは、アクセスに **IMAPITable インターフェイスを必要とする** オブジェクトです。</span><span class="sxs-lookup"><span data-stu-id="34dc3-147">Tables are objects that require the **IMAPITable** interface for access.</span></span> <span data-ttu-id="34dc3-148">クライアントは、フォルダーの [IMAPIContainer::GetHierarchyTable](imapicontainer-gethierarchytable.md) メソッドを呼び出して、階層テーブル、フォルダーの [IMAPIContainer::GetContentsTable](imapicontainer-getcontentstable.md) メソッドを呼び出してコンテンツ テーブルにアクセスしたり、フォルダーの [IMAPIProp::OpenProperty](imapiprop-openproperty.md) メソッドを使用していずれかのテーブルにアクセスできます。</span><span class="sxs-lookup"><span data-stu-id="34dc3-148">A client can call the folder's [IMAPIContainer::GetHierarchyTable](imapicontainer-gethierarchytable.md) method to access the hierarchy table, the folder's [IMAPIContainer::GetContentsTable](imapicontainer-getcontentstable.md) method to access the contents table, or the folder's [IMAPIProp::OpenProperty](imapiprop-openproperty.md) method to access either table.</span></span> <span data-ttu-id="34dc3-149">**OpenProperty** を呼び出す場合、クライアントはプロパティのプロパティ タグを最初のパラメーターとして渡し、2 番目のパラメーターとしてアクセスに使用するインターフェイスのインターフェイス識別子を渡します。</span><span class="sxs-lookup"><span data-stu-id="34dc3-149">To call **OpenProperty**, a client passes the property tag for the property as the first parameter and an interface identifier for the interface to be used for access as the second parameter.</span></span> <span data-ttu-id="34dc3-150">これらのパラメーター **は、PR_CONTAINER_HIERARCHY\*\*\*\*またはPR_CONTAINER_CONTENTS\*\*\*\*と** IID_IMAPITable。</span><span class="sxs-lookup"><span data-stu-id="34dc3-150">These parameters would be **PR_CONTAINER_HIERARCHY** or **PR_CONTAINER_CONTENTS** and **IID_IMAPITable**.</span></span>
  
<span data-ttu-id="34dc3-151">単一値および複数値のプロパティ型の完全な一覧については、「Property [Types」を参照してください](property-types.md)。</span><span class="sxs-lookup"><span data-stu-id="34dc3-151">For a complete list of the single-value and multiple-value property types, see [Property Types](property-types.md).</span></span> 
  
## <a name="see-also"></a><span data-ttu-id="34dc3-152">関連項目</span><span class="sxs-lookup"><span data-stu-id="34dc3-152">See also</span></span>

- [<span data-ttu-id="34dc3-153">MAPI のプロパティの概要</span><span class="sxs-lookup"><span data-stu-id="34dc3-153">MAPI Property Overview</span></span>](mapi-property-overview.md)

