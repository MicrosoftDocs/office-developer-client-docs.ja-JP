---
title: オートコンプリート ストリーム
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
ms.assetid: d4f380fa-2ed9-4c7c-9ef3-b32f8409f657
description: '�ŏI�X�V��: 2015�N3��9��'
ms.openlocfilehash: 7fc1fae4ed648d59c273b20ced247f6d20e01a6f
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 06/11/2018
ms.locfileid: "19799731"
---
# <a name="autocomplete-stream"></a>オートコンプリート ストリーム

  
  
**適用されます**: Outlook 
  
Microsoft Outlook のオートコンプリートのストリームに対話する方法を知ることだけでなくもオートコンプリート ストリームのバイナリ形式を理解する必要があります。
  
オートコンプリートのストリームは、Microsoft Outlook 2013、Microsoft Outlook 2010、Microsoft Office Outlook 2007 では、Microsoft Outlook 2003 でのみ使用されるいくつかの管理メタデータおよびバイナリ ストリームとして保存されている受信者のプロパティの行のセットです。 メタデータはオートコンプリートのストリームに、Outlook の相互作用に関連するオートコンプリート機能が変更されたストリームを保存するときのメタデータの各ブロックではサード ・ パーティを保持する必要があります。 つまり、サード ・ パーティはバイナリ形式の行セットの一部のみを変更し、のオートコンプリートのストリームのメタデータのブロックが既に保持する必要があります。
  
## <a name="stream-visualization"></a>ストリームのビジュアル化

オートコンプリートのストリームの大まかなレイアウトは次のとおりです。
  
メタデータ (4 バイト)
  
メジャー バージョン番号 (4 バイト)
  
マイナー バージョン番号 (4 バイト)
  
行 n (4 バイト) の数
  
(4 バイト) を 1 つの行のプロパティ p の数
  
プロパティ タグのプロパティの 1 の (4 バイト)
  
プロパティ 1 (4 バイト) のデータを予約
  
プロパティの値の和集合 (8 バイト)
  
プロパティの値のデータ (0 または変数のバイト数)
  
… (P-1 のプロパティをプロパティ 2)
  
プロパティ タグのプロパティ p の (4 バイト)
  
プロパティ p (4 バイト) のデータを予約します。
  
プロパティ p の値の和集合 (8 バイト)
  
プロパティ p の値のデータ (0 または変数のバイト数)
  
プロパティで [q 行 2 (4 バイト) の数
  
… (2 つの行のプロパティ)
  
… (n-1 の行を 3 行目)
  
プロパティの r n (4 バイト) の行の数です。
  
… (n's の行のプロパティ)
  
情報の余分なバイト数 EI (4 バイト)
  
余分な情報 (EI バイト)
  
メタデータ (8 バイト)
  
バイナリ構造体の例は、バイナリの例を参照してください、 [Outlook 2003/2007 NK2 ファイル形式と開発者のガイドライン](http://portalvhds6gyn3khqwmgzd.blob.core.windows.net/files/NK2/NK2WithBinaryExample.pdf)。
  
## <a name="high-level-layout"></a>大まかなレイアウト

大まかに言うと、オートコンプリートのストリームのレイアウトのとおりです。
  
|**値のデータ**|**バイト数**|
|:-----|:-----|
|メタデータ  <br/> |4  <br/> |
|メジャー バージョン番号  <br/> |4  <br/> |
|マイナー バージョン番号  <br/> |4  <br/> |
|行セット  <br/> |可変  <br/> |
|情報の余分なバイト数 EI  <br/> |4  <br/> |
|追加情報  <br/> |EI  <br/> |
|メタデータ  <br/> |8  <br/> |
   
メジャー バージョンは 12 とは異なる場合、このストリームを読み取り、ときに、このストリームする必要がありますできません読み取りまたは書き込み。 オートコンプリートのストリームの現在のマイナー バージョンは、余分な情報のバイト カウントが 0 に設定する 0 です。 マイナー バージョンが 0 以外の場合は、ストリームを読み取るときに読み取りおよびストリームを作成するときに保持する必要がある余分な情報の情報があります。 マイナー バージョンのストリームを作成するときに保持する必要があります。 これらの両方は保持されません、追加情報を記述した Outlook のインスタンスでデータが失われます。 
  
> [!NOTE]
> アプリケーションは、追加の情報フィールドにカスタム データを追加や形式に、Outlook の拡張機能していない任意のサードパーティの拡張機能をサポートするためには、この機能には、マイナー バージョンを変更する必要がありますいません。 
  
## <a name="row-set-layout"></a>行セットのレイアウト

行セットのレイアウトは次のとおりです。 
  
|**値のデータ**|**バイト数**|
|:-----|:-----|
|行数  <br/> |4  <br/> |
|Rows  <br/> |可変  <br/> |
   
行の数は、行の数には、バイナリ ストリーム シーケンスの次の部分を識別します。
  
## <a name="row-layout"></a>行レイアウト

各行は、次の形式のです。
  
|**値のデータ**|**バイト数**|
|:-----|:-----|
|プロパティの数  <br/> |4  <br/> |
|プロパティ  <br/> |可変  <br/> |
   
プロパティの数は、数のプロパティには、バイナリ ストリーム シーケンスの次の部分を識別します。
  
## <a name="property-layout"></a>プロパティのレイアウト

各プロパティは、次の形式のです。
  
|**値のデータ**|**バイト数**|
|:-----|:-----|
|プロパティ タグ  <br/> |4  <br/> |
|予約済みのデータ  <br/> |4  <br/> |
|プロパティの値の和集合  <br/> ||
|値のデータ  <br/> |0 または変数 (prop タグによって)  <br/> |
   
## <a name="interpreting-the-property-value"></a>プロパティの値を解釈します。

プロパティ値ユニオンと値のデータは、プロパティ ブロックの最初の 4 バイトのプロパティ タグに基づいて解釈されます。 このプロパティ タグは、MAPI プロパティ タグと同じ形式にします。 ビット 0 ~ 15 のプロパティ タグは、プロパティの種類です。 31 までの 16 ビットとは、プロパティの識別子です。 プロパティの型は、プロパティの残りの部分を読み取る必要がある方法を決定します。
  
## <a name="static-value"></a>静的な値

いくつかのプロパティは、値のデータが含まれていないとだけ、共用体のデータがあります。 (プロパティ タグからのもの) を次のプロパティの種類は、次のように 8 バイトのプロパティの共用体のデータを扱う必要があります。
  
|**プロペラの種類**|**プロパティの共用体の解釈**|
|:-----|:-----|
|PT_I2  <br/> |短い int  <br/> |
|PT_LONG  <br/> |long  <br/> |
|PT_R4  <br/> |浮動小数点数  <br/> |
|PT_DOUBLE  <br/> |double  <br/> |
|PT_BOOLEAN  <br/> |短い int  <br/> |
|PT_SYSTIME  <br/> |FILETIME  <br/> |
|PT_I8  <br/> |LARGE_INTEGER  <br/> |
   
## <a name="dynamic-values"></a>動的な値

プロパティ タグ、予約済みのデータでは、およびそのプロパティ値共用体に含まれる最初の 16 バイトの後の他のプロパティ値のデータ ブロックのデータであります。 静的な値とは異なりは、8 バイトのプロパティの値の共用体に格納されているデータは読み取りに関連するではありません。 記述する場合は、値を使用して、これらの 8 バイトを入力することを確認します。 ただし、8 バイトの内容は重要ではありません。 動的な値では、プロパティ タグの種類は、値のデータを解釈する方法を決定します。
  
PT_STRING8 
  
|**値のデータ**|**バイト数**|
|:-----|:-----|
|バイト n の数  <br/> |4  <br/> |
|ANSI 文字列 (終端の NULL 文字が含まれています) として解釈されるバイト数  <br/> |n  <br/> |
   
PT_CLSID
  
|**値のデータ**|**バイト数**|
|:-----|:-----|
|GUID として解釈されるバイト数  <br/> |16  <br/> |
|||
   
PT_BINARY 
  
|**値のデータ**|**バイト数**|
|:-----|:-----|
|バイト n の数  <br/> |4  <br/> |
|バイトをバイト配列として解釈されるように  <br/> |n  <br/> |
   
PT_ERROR
  
|**値のデータ**|**バイト数**|
|:-----|:-----|
|バイト n の数  <br/> |4  <br/> |
|バイトをバイト配列として解釈されるように  <br/> |n  <br/> |
   
PT_MV_BINARY
  
|**値のデータ**|**バイト数**|
|:-----|:-----|
|バイナリ配列 X の数  <br/> |4  <br/> |
|A が X を含むバイトの実行バイナリ配列です。 各配列は、実行 PT_BINARY バイトと同じように解釈する必要があります。  <br/> |可変  <br/> |
   
PT_MV_STRING8 (Outlook 2007、Outlook 2010、Outlook 2013)
  
|**値のデータ**|**バイト数**|
|:-----|:-----|
|ANSI 文字列 X の数  <br/> |4  <br/> |
|X の ANSI 文字列を含むバイトの実行します。 実行 PT_STRING8 バイトと同じように各文字列を解釈する必要があります。  <br/> |可変  <br/> |
   
PT_MV_UNICODE (Outlook 2007、Outlook 2010、Outlook 2013)
  
|**値のデータ**|**バイト数**|
|:-----|:-----|
|UNICODE 文字列 X の数  <br/> |4  <br/> |
|X UNICODE の文字列が格納されたバイトの実行します。 実行 PT_UNICODE バイトと同じように各文字列を解釈する必要があります。  <br/> |可変  <br/> |
   
## <a name="significant-properties"></a>重要なプロパティ

このトピックで述べたように、アドレス帳の受信者のプロパティに対応するプロパティ タグがあるプロパティを表すバイナリのブロックです。 プロパティの説明を検索するには、ここに示されていないプロパティの場合は、 http://msdn.microsoft.com/en-us/library/cc433490(EXCHG.80).aspx。
  
|**プロパティ名**|**プロパティ タグ**|**説明 (詳細については MSDN を参照してください)**|
|:-----|:-----|:-----|
|(オートコンプリートのストリームのみを特定の受信者には送信されません) PR_NICK_NAME_W  <br/> |0x6001001f  <br/> |このプロパティは、受信者の各行の先頭である必要があります。 機能的には受信者の行のキーの識別子として機能します。  <br/> |
|PR_ENTRYID  <br/> |0x0FFF0102  <br/> |受信者のアドレス帳エントリの識別子です。  <br/> |
|PR_DISPLAY_NAME_W  <br/> |0x3001001F  <br/> |受信者の表示名です。  <br/> |
|PR_EMAIL_ADDRESS_W  <br/> |0x3003001F  <br/> |受信者の電子メール アドレス (johndoe@contoso.com または/o など = Contoso と OU = Foo と cn = 受信者と cn = johndoe)  <br/> |
|PR_ADDRTYPE_W  <br/> |0x3002001F  <br/> |受信者のアドレスの種類 (SMTP または EX など)。  <br/> |
|PR_SEARCH_KEY  <br/> |0x300B0102  <br/> |受信者の MAPI 検索キーです。  <br/> |
|PR_SMTP_ADDRESS_W  <br/> |0x39FE001f  <br/> |受信者の SMTP アドレスです。  <br/> |
|(オートコンプリートのストリームのみを特定の受信者には送信されません) PR_DROPDOWN_DISPLAY_NAME_W  <br/> |0X6003001f  <br/> |オートコンプリートの候補一覧に表示される表示文字列。  <br/> |
|(オートコンプリートのストリームのみを特定の受信者には送信されません) PR_NICK_NAME_WEIGHT  <br/> |0x60040003  <br/> |このオートコンプリート エントリの重量。 重量を使用すると、オートコンプリートの候補一覧を照合するときにどのような順序のオートコンプリート エントリが発生するを決定します。 下の重みを持つエントリの前より高い負荷を持つエントリが表示されます。 完全なオートコンプリート リストは、このプロパティによって並べ替えられます。 重量は定期的に時間の経過と共に減少し、ユーザーは、この受信者に電子メールを送信すると大ききます。 このプロパティの詳細についてはこのトピックの後半の説明を参照してください。  <br/> |
   
PR_NICK_NAME_WEIGHT
  
オートコンプリートのストリーム内の行のセットが PR_NICK_NAME_WEIGHT プロパティによって降順にソートし、オートコンプリートのストリームは、この並べ替えられた特性に常に保存する必要があります。 したがって、行の幅への変更も確認してくださいの行の位置が、完全な行セットの並べ替え順を維持します。 並べ替えの順序を維持するために適切な位置に挿入する行セットに追加します。
  
この重量の最小値は 0x1 で、最大値は LONG_MAX です。 重量の他の値は、無効と見なされます。
  
ときにメールを送信する Outlook 2007 上げたり、受信者を解決するにはその受信者の重量 0x2000 で。
  

