---
title: MAPI カスタムフォームオブジェクト
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 306d62b1-d541-4039-9759-3903f62e0f26
description: '最終更新日時: 2015 年 3 月 9 日'
ms.openlocfilehash: 4c1c04e5b04be9bb67b050f5cf498be89d380410
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/23/2019
ms.locfileid: "32318248"
---
# <a name="mapi-custom-form-objects"></a>MAPI カスタムフォームオブジェクト
  
**適用対象**: Outlook 2013 | Outlook 2016 
  
ユーザー設定フォームのオブジェクトは、3つの異なるコンポーネントによって実装されます。
  
- フォームサーバー。
    
- フォームライブラリプロバイダ。
    
- フォームビューアー
    
フォームサーバーは、OLE 複合ドキュメントオブジェクトアプリケーションの機能に似ています。 フォームを実装する実行可能コンポーネントです。ユーザーが実行できる表示と操作を制御します。 MAPI は、フォームサーバーでサポートされているフォームを使用して表示されるメッセージクラスと共にメッセージを表示するときに、要求時にフォームサーバーを開始します。 フォームサーバーは、標準の OLE クラスファクトリに似たフォームファクトリオブジェクト、フォーム固有のイベントを処理するためのフォームアドバイズシンク、フォーム自体の3つのオブジェクトを実装します。 
  
フォームライブラリプロバイダーは、クライアントへのアクセスをフォームのプロパティセット、そのコンテナー、および特定のクラスのフォームを開くことができるサーバーにそのクラスのメッセージをリンクするオブジェクトに渡します。 フォームライブラリプロバイダーは、フォーム情報オブジェクト、フォームコンテナー、およびメッセージをメッセージのクラスに基づいて適切なフォームサーバーにバインドするフォームマネージャーの3つのオブジェクトを実装します。
  
フォームビューアーは、フォルダービューアーでのユーザー設定フォームの表示をサポートするクライアントに含まれるコンポーネントです。 フォームビューアーは、フォームライブラリプロバイダーやフォームサーバーと同様に、独立した MAPI コンポーネントではありません。 フォームビューアーは、フォームサーバーを起動し、それらのコンテキストを提供します。 フォームビューアーは、メッセージサイト、ビューコンテキスト、およびビュー固有のイベントを処理するためのアドバイズシンクの3つのオブジェクトを実装します。
  
次の表では、すべてのカスタムフォームオブジェクトについて説明します。 
  
|**Form オブジェクト**|**説明**|
|:-----|:-----|
|[Form/フォーム]  <br/> |特定のクラスのメッセージを表示するためのユーザー設定フォームの表示と操作を制御します。  <br/> |
|フォームアドバイズシンク  <br/> |フォームビューアーからの通知を処理します。  <br/> |
|フォームファクトリ  <br/> |フォームのインスタンスを作成し、そのサーバーをメモリ内に残すことができるようにします。  <br/> |
|Form コンテナー  <br/> |フォーム情報を含みます。  <br/> |
|フォーム情報  <br/> |メッセージおよびその他のメッセージコンテナーが保存されています。  <br/> |
|フォーム マネージャー  <br/> |インストールされているすべてのフォームに関連するユーザー設定フォーム情報の統合ビューへのアクセスを提供します。 また、対応するフォームクラス識別子を持つメッセージクラスにも一致します。  <br/> |
|メッセージサイト  <br/> |クライアント内部からフォームオブジェクトの操作を処理し、フォームマネージャーオブジェクトへのアクセスを提供します。  <br/> |
|ビューのコンテキスト  <br/> |次および前のメッセージをアクティブにし、保存または印刷するためのフォームコマンドをサポートします。  <br/> |
|アドバイズシンクの表示  <br/> |フォームサーバーからの通知を処理します。  <br/> |
   
次の図は、カスタムフォームコンポーネント、それらが実装するオブジェクトとインターフェイス、およびオブジェクトのユーザーであるコンポーネント間の関係を示しています。 その他のほとんどの MAPI オブジェクトとは異なり、form オブジェクトは直接的な継承によって関連付けられていない2つのインターフェイスを実装していることに注意してください。 オブジェクトが複数の独立したインターフェイスを公開する場合、いずれかのインターフェイスへのポインターを持つオブジェクトのユーザーは、他のインターフェイスへのポインターを取得することができます。 このオブジェクトのインターフェイス実装間を移動する機能は、 [IUnknown:: QueryInterface](https://msdn.microsoft.com/library/54d5ff80-18db-43f2-b636-f93ac053146d%28Office.15%29.aspx)メソッドの機能です。 
  
**カスタム フォーム コンポーネント**
  
![カスタムフォームコンポーネント](media/amapi_67.gif "カスタムフォームコンポーネント")
  
## <a name="see-also"></a>関連項目

- [MAPI のオブジェクトとインターフェイスの概要](mapi-object-and-interface-overview.md)

