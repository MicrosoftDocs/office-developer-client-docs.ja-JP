---
title: MAPI メッセージ ストア プロバイダーの開発
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 83692674-0b5a-468d-9cd7-a2ac3d140bda
description: '�ŏI�X�V��: 2011�N7��23��'
ms.openlocfilehash: 040c851d64f60c319250fd0e08620285b6f2f0db
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 06/11/2018
ms.locfileid: "19799922"
---
# <a name="developing-a-mapi-message-store-provider"></a>MAPI メッセージ ストア プロバイダーの開発
  
**適用されます**: Outlook 
  
その他の MAPI サービス プロバイダーでは、ようなメッセージ ・ ストアは MAPI クライアント アプリケーションと MAPI スプーラーを基になるストレージ ・ メカニズムのサービスを提供するダイナミック リンク ライブラリ (Dll) がします。 メッセージ ストア プロバイダーは、階層的な一連のフォルダーとメッセージの MAPI クライアントと、MAPI スプーラーを使用すると基になるストレージ機構について説明します。
  
基本の MAPI メッセージ ストアのアーキテクチャを次の図に示します。
  
**メッセージ ストアのアーキテクチャ**
  
![メッセージ ストアのアーキテクチャ](media/storearc.gif "メッセージ ストアのアーキテクチャ")
  
ように、基になるストレージ機構の任意の並べ替えを使用してメッセージ ストア プロバイダーを実装できます。 ただし、パフォーマンスの問題に注意する必要があります。 さらに、基になるストレージ機構が MAPI オブジェクトの階層コレクションとして表示する必要があります。 これらの要件は、データベース内のオブジェクトの階層型ストレージをサポートして、プログラミング ・ インタ フェースまたは明確に定義されたファイルの構造を持つ既存のデータベース製品を使用して、メッセージ ・ ストアが通常実装されているを意味します。 たとえば、Microsoft Office Access、SQL、Oracle データベースは、基になるストレージ機構として使用できます。 データベース製品によっては、データベース製品の選択は、メッセージ ストア プロバイダーがサポートする必要がある機能の影響を受ける可能性がありますので、MAPI 機能を実装しやすく機能セットを持っています。
  
として、基になるストレージ機構作業を省けることが簡単だから通常の MAPI クライアントに現在のデータベース オブジェクトを MAPI オブジェクトとして、独自の階層型ストレージ ・ メカニズムを実装するより、既存のデータベースを使用します。 これを使用すると、独自の階層型ストレージ ・ メカニズムを実装する場合よりも高いレベルでの MAPI 操作を処理します。 たとえば、特定の件名とメッセージの検索を構築して、適切なデータベースのクエリを送信するではなく、階層型ストレージ ・ メカニズムを検索するのには複雑なルーチンを実装するのはかなり簡単な問題になります。
  
メッセージ ストア プロバイダーは、フォルダーおよびオブジェクトの操作を実行するには、MAPI クライアントと MAPI スプーラーと通信します。 メッセージ ストア プロバイダーは、基になるストレージ機構の下位レベルの操作にこれらの操作を変換します。 MAPI スプーラーは、通常、メッセージの送受信中にメッセージ ストア プロバイダーと通信します。 MAPI クライアントは、通常、フォルダーの階層を操作し、読み取り、編集、削除、およびメッセージを送信、メッセージ ストア プロバイダーと通信します。
  
MAPI スプーラーと MAPI クライアントは、新しいメッセージを作成するのには、メッセージ ストア プロバイダーと通信します。 クライアント アプリケーションはユーザーがメッセージを作成するときにこれを行います。 MAPI スプーラーは受信メッセージを受信するとします。 どちらの場合で、新しいメッセージが通常作成メッセージ ・ ストアの受信トレイ フォルダーに 1 つを使用する必要がある場合。
  
メッセージ ストア プロバイダーは、MAPI テーブル、フォルダー、メッセージ、およびプロパティの使用を確認します。 [MAPI テーブル](mapi-tables.md)、 [MAPI フォルダー](mapi-folders.md)、 [MAPI メッセージ](mapi-messages.md)、および[MAPI プロパティの概要](mapi-property-overview.md)では、これらのオブジェクトの実装の詳細が記載されています。 把握する材料でメッセージ ストア プロバイダーを実装する前に。
  
メッセージ ストア プロバイダーの 2 つの重要な種類があります: ユーザーの既定値として機能するもののメッセージ ストアと、そのことはできません。 既定のメッセージ ストアは、クライアント アプリケーションと MAPI スプーラーを実行できますメッセージの受信、フォルダーの作成など、任意のメッセージング タスクです。 既定のメッセージ ストア プロバイダーは、すべてのメッセージ ストア プロバイダーに必要な最小数より多くの機能をいくつかをサポートしなければなりません。
  
## <a name="see-also"></a>関連項目

- [MAPI の概念](mapi-concepts.md)

