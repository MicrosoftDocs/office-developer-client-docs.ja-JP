---
title: MAPI メッセージ ストア プロバイダーの開発
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 83692674-0b5a-468d-9cd7-a2ac3d140bda
description: '最終更新日: 2011 年 7 月 23 日'
ms.openlocfilehash: 76332b57b2957b5682efb415121ea6db42409c30
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/23/2019
ms.locfileid: "32316762"
---
# <a name="developing-a-mapi-message-store-provider"></a><span data-ttu-id="66339-103">MAPI メッセージ ストア プロバイダーの開発</span><span class="sxs-lookup"><span data-stu-id="66339-103">Developing a MAPI message store provider</span></span>
  
<span data-ttu-id="66339-104">**適用対象**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="66339-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="66339-105">他の mapi サービスプロバイダーと同様に、メッセージストアはダイナミックリンクライブラリ (dll) です。これは、基礎となるストレージメカニズムのサービスを mapi クライアントアプリケーションおよび mapi スプーラーに提供します。</span><span class="sxs-lookup"><span data-stu-id="66339-105">Like other MAPI service providers, message stores are dynamic-link libraries (DLLs) that present the services of an underlying storage mechanism to MAPI client applications and the MAPI spooler.</span></span> <span data-ttu-id="66339-106">メッセージストアプロバイダーは、mapi クライアントと mapi スプーラーで使用できるフォルダーとメッセージの階層的なセットとして、基盤となるストレージメカニズムを提供します。</span><span class="sxs-lookup"><span data-stu-id="66339-106">The message store provider presents the underlying storage mechanism as a hierarchical set of folders and messages that MAPI clients and the MAPI spooler can use.</span></span>
  
<span data-ttu-id="66339-107">次の図は、基本的な MAPI メッセージストアのアーキテクチャを示しています。</span><span class="sxs-lookup"><span data-stu-id="66339-107">The following illustration shows the basic MAPI message store architecture.</span></span>
  
<span data-ttu-id="66339-108">**メッセージ ストアのアーキテクチャ**</span><span class="sxs-lookup"><span data-stu-id="66339-108">**Message store architecture**</span></span>
  
<span data-ttu-id="66339-109">![メッセージストアのアーキテクチャ](media/storearc.gif "メッセージストアのアーキテクチャ")</span><span class="sxs-lookup"><span data-stu-id="66339-109">![Message store architecture](media/storearc.gif "Message store architecture")</span></span>
  
<span data-ttu-id="66339-110">任意の種類の基本的なストレージ機構を使用して、メッセージストアプロバイダーを実装できます。</span><span class="sxs-lookup"><span data-stu-id="66339-110">You can implement a message store provider by using any sort of underlying storage mechanism you like.</span></span> <span data-ttu-id="66339-111">ただし、パフォーマンスの問題に注意する必要があります。</span><span class="sxs-lookup"><span data-stu-id="66339-111">However, you need to be aware of performance concerns.</span></span> <span data-ttu-id="66339-112">さらに、基盤となるストレージメカニズムを MAPI オブジェクトの階層コレクションとして提示する必要があります。</span><span class="sxs-lookup"><span data-stu-id="66339-112">In addition, the underlying storage mechanism must be presented as a hierarchical collection of MAPI objects.</span></span> <span data-ttu-id="66339-113">これらの要件は、通常、データベース内のオブジェクトの階層型ストレージをサポートする既存のデータベース製品を使用してメッセージストアが実装されており、プログラミングインターフェイスまたは適切に定義されたファイル構造を備えていることを意味します。</span><span class="sxs-lookup"><span data-stu-id="66339-113">These requirements mean that message stores are typically implemented by using an existing database product that supports hierarchical storage of objects in the database and that has a programming interface or well-defined file structure.</span></span> <span data-ttu-id="66339-114">たとえば、Microsoft Office Access、SQL、Oracle の各データベースを基盤となるストレージメカニズムとして使用できます。</span><span class="sxs-lookup"><span data-stu-id="66339-114">For example, Microsoft Office Access, SQL, and Oracle databases can be used as the underlying storage mechanism.</span></span> <span data-ttu-id="66339-115">一部のデータベース製品には MAPI 機能を実装しやすくする機能セットがあるため、選択したデータベース製品が、メッセージストアプロバイダーがサポートする必要のある機能の影響を受ける可能性があります。</span><span class="sxs-lookup"><span data-stu-id="66339-115">Some database products have feature sets that make it easier to implement MAPI features, so your choice of database product may be affected by the features that your message store provider needs to support.</span></span>
  
<span data-ttu-id="66339-116">既存のデータベースを基礎となるストレージメカニズムとして使用すると、通常は、データベースオブジェクトを mapi オブジェクトとして使用する方が、独自の階層ストレージメカニズムを実装するよりも簡単になるため、作業を節約できます。</span><span class="sxs-lookup"><span data-stu-id="66339-116">Using an existing database as the underlying storage mechanism saves you work because it is usually easier to present database objects to MAPI clients as MAPI objects than to implement your own hierarchical storage mechanism.</span></span> <span data-ttu-id="66339-117">これにより、独自の階層ストレージメカニズムを実装する場合よりも高いレベルで MAPI 操作を処理することができます。</span><span class="sxs-lookup"><span data-stu-id="66339-117">Doing this enables you to treat MAPI operations at a higher level than if you implement your own hierarchical storage mechanism.</span></span> <span data-ttu-id="66339-118">たとえば、特定の件名行を持つメッセージを検索すると、階層ストレージ機構を検索する複雑なルーチンを実装するのではなく、適切なデータベースクエリを構築して送信することが非常に簡単になります。</span><span class="sxs-lookup"><span data-stu-id="66339-118">For example, searching for a message with a particular subject line becomes a fairly simple matter of constructing and submitting an appropriate database query, rather than implementing complex routines to search your hierarchical storage mechanism.</span></span>
  
<span data-ttu-id="66339-119">メッセージストアプロバイダーは、mapi クライアントおよび mapi スプーラーと通信して、フォルダーとオブジェクトに対する操作を実行します。</span><span class="sxs-lookup"><span data-stu-id="66339-119">Message store providers communicate with MAPI clients and the MAPI spooler to perform operations on folders and objects.</span></span> <span data-ttu-id="66339-120">メッセージストアプロバイダーは、基礎となるストレージメカニズムで、これらの操作を低レベルの操作に変換します。</span><span class="sxs-lookup"><span data-stu-id="66339-120">The message store provider translates those operations into lower level operations on the underlying storage mechanism.</span></span> <span data-ttu-id="66339-121">MAPI スプーラーは、通常、メッセージの送受信中にメッセージストアプロバイダーと通信します。</span><span class="sxs-lookup"><span data-stu-id="66339-121">The MAPI spooler typically communicates with the message store provider while sending and receiving messages.</span></span> <span data-ttu-id="66339-122">MAPI クライアントは、通常、フォルダー階層を操作したり、メッセージを読み取り、編集、削除、および送信したりするために、メッセージストアプロバイダーと通信します。</span><span class="sxs-lookup"><span data-stu-id="66339-122">MAPI clients typically communicate with message store providers to manipulate the folder hierarchy and to read, edit, delete, and send messages.</span></span>
  
<span data-ttu-id="66339-123">mapi スプーラーと mapi の両方のクライアントは、メッセージストアプロバイダーと通信して、新しいメッセージを作成します。</span><span class="sxs-lookup"><span data-stu-id="66339-123">Both the MAPI spooler and MAPI clients communicate with the message store provider to create new messages.</span></span> <span data-ttu-id="66339-124">クライアントアプリケーションは、ユーザーがメッセージを作成するときにこれを実行します。</span><span class="sxs-lookup"><span data-stu-id="66339-124">Client applications do this when users compose a message.</span></span> <span data-ttu-id="66339-125">MAPI スプーラーは、受信メッセージを受信したときにこれを実行します。</span><span class="sxs-lookup"><span data-stu-id="66339-125">The MAPI spooler does this when it receives an incoming message.</span></span> <span data-ttu-id="66339-126">どちらの場合も、新しいメッセージは通常、メッセージストアの受信トレイフォルダーに作成されます (存在する場合)。</span><span class="sxs-lookup"><span data-stu-id="66339-126">In either case, the new message is usually created in the Inbox folder of the message store, if there is one.</span></span>
  
<span data-ttu-id="66339-127">メッセージストアプロバイダーは、MAPI テーブル、フォルダー、メッセージ、およびプロパティを頻繁に使用します。</span><span class="sxs-lookup"><span data-stu-id="66339-127">Message store providers make heavy use of MAPI tables, folders, messages, and properties.</span></span> <span data-ttu-id="66339-128">これらのオブジェクトの実装の詳細については、「 [mapi の表](mapi-tables.md)」、「mapi[フォルダー](mapi-folders.md)」、「mapi[メッセージ](mapi-messages.md)」、および[「mapi のプロパティの概要](mapi-property-overview.md)」で説明されています。</span><span class="sxs-lookup"><span data-stu-id="66339-128">The implementation details for those objects are documented in [MAPI Tables](mapi-tables.md), [MAPI Folders](mapi-folders.md), [MAPI Messages](mapi-messages.md), and [MAPI Property Overview](mapi-property-overview.md).</span></span> <span data-ttu-id="66339-129">メッセージストアプロバイダーを実装する前に、その資料を理解しておく必要があります。</span><span class="sxs-lookup"><span data-stu-id="66339-129">You should familiarize yourself with that material before attempting to implement a message store provider.</span></span>
  
<span data-ttu-id="66339-130">メッセージストアプロバイダーには、次の2つの重要な種類があります。これは、ユーザーの既定のメッセージストアとして機能することも、できないものでもかまいません。</span><span class="sxs-lookup"><span data-stu-id="66339-130">There are two important types of message store providers: those that can act as a user's default message store and those that cannot.</span></span> <span data-ttu-id="66339-131">既定のメッセージストアとは、メッセージの受信やフォルダーの作成など、クライアントアプリケーションと MAPI スプーラーがどのようなメッセージタスクでも実行できるもののことです。</span><span class="sxs-lookup"><span data-stu-id="66339-131">A default message store is one in which client applications and the MAPI spooler can perform any messaging task, such as receiving messages or creating folders.</span></span> <span data-ttu-id="66339-132">既定のメッセージストアプロバイダーは、すべてのメッセージストアプロバイダーに必要な最小数よりも多くの機能をサポートする必要があります。</span><span class="sxs-lookup"><span data-stu-id="66339-132">A default message store provider must support several more features than the minimum number required for all message store providers.</span></span>
  
## <a name="see-also"></a><span data-ttu-id="66339-133">関連項目</span><span class="sxs-lookup"><span data-stu-id="66339-133">See also</span></span>

- [<span data-ttu-id="66339-134">MAPI の概念</span><span class="sxs-lookup"><span data-stu-id="66339-134">MAPI concepts</span></span>](mapi-concepts.md)

