---
title: MAPI メッセージ ストア プロバイダーの開発
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 83692674-0b5a-468d-9cd7-a2ac3d140bda
description: '�ŏI�X�V��: 2011�N7��23��'
ms.openlocfilehash: 36233d51f47c53d6a69494c0fcd799a7c83add29
ms.sourcegitcommit: 0cf39e5382b8c6f236c8a63c6036849ed3527ded
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/23/2018
ms.locfileid: "22567875"
---
# <a name="developing-a-mapi-message-store-provider"></a><span data-ttu-id="a0f40-103">MAPI メッセージ ストア プロバイダーの開発</span><span class="sxs-lookup"><span data-stu-id="a0f40-103">Developing a MAPI message store provider</span></span>
  
<span data-ttu-id="a0f40-104">**適用されます**: Outlook 2013 |Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="a0f40-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="a0f40-105">その他の MAPI サービス プロバイダーでは、ようなメッセージ ・ ストアは MAPI クライアント アプリケーションと MAPI スプーラーを基になるストレージ ・ メカニズムのサービスを提供するダイナミック リンク ライブラリ (Dll) がします。</span><span class="sxs-lookup"><span data-stu-id="a0f40-105">Like other MAPI service providers, message stores are dynamic-link libraries (DLLs) that present the services of an underlying storage mechanism to MAPI client applications and the MAPI spooler.</span></span> <span data-ttu-id="a0f40-106">メッセージ ストア プロバイダーは、階層的な一連のフォルダーとメッセージの MAPI クライアントと、MAPI スプーラーを使用すると基になるストレージ機構について説明します。</span><span class="sxs-lookup"><span data-stu-id="a0f40-106">The message store provider presents the underlying storage mechanism as a hierarchical set of folders and messages that MAPI clients and the MAPI spooler can use.</span></span>
  
<span data-ttu-id="a0f40-107">基本の MAPI メッセージ ストアのアーキテクチャを次の図に示します。</span><span class="sxs-lookup"><span data-stu-id="a0f40-107">The following illustration shows the basic MAPI message store architecture.</span></span>
  
<span data-ttu-id="a0f40-108">**メッセージ ストアのアーキテクチャ**</span><span class="sxs-lookup"><span data-stu-id="a0f40-108">**Message store architecture**</span></span>
  
<span data-ttu-id="a0f40-109">![メッセージ ストアのアーキテクチャ](media/storearc.gif "メッセージ ストアのアーキテクチャ")</span><span class="sxs-lookup"><span data-stu-id="a0f40-109">![Message store architecture](media/storearc.gif "Message store architecture")</span></span>
  
<span data-ttu-id="a0f40-110">ように、基になるストレージ機構の任意の並べ替えを使用してメッセージ ストア プロバイダーを実装できます。</span><span class="sxs-lookup"><span data-stu-id="a0f40-110">You can implement a message store provider by using any sort of underlying storage mechanism you like.</span></span> <span data-ttu-id="a0f40-111">ただし、パフォーマンスの問題に注意する必要があります。</span><span class="sxs-lookup"><span data-stu-id="a0f40-111">However, you need to be aware of performance concerns.</span></span> <span data-ttu-id="a0f40-112">さらに、基になるストレージ機構が MAPI オブジェクトの階層コレクションとして表示する必要があります。</span><span class="sxs-lookup"><span data-stu-id="a0f40-112">In addition, the underlying storage mechanism must be presented as a hierarchical collection of MAPI objects.</span></span> <span data-ttu-id="a0f40-113">これらの要件は、データベース内のオブジェクトの階層型ストレージをサポートして、プログラミング ・ インタ フェースまたは明確に定義されたファイルの構造を持つ既存のデータベース製品を使用して、メッセージ ・ ストアが通常実装されているを意味します。</span><span class="sxs-lookup"><span data-stu-id="a0f40-113">These requirements mean that message stores are typically implemented by using an existing database product that supports hierarchical storage of objects in the database and that has a programming interface or well-defined file structure.</span></span> <span data-ttu-id="a0f40-114">たとえば、Microsoft Office Access、SQL、Oracle データベースは、基になるストレージ機構として使用できます。</span><span class="sxs-lookup"><span data-stu-id="a0f40-114">For example, Microsoft Office Access, SQL, and Oracle databases can be used as the underlying storage mechanism.</span></span> <span data-ttu-id="a0f40-115">データベース製品によっては、データベース製品の選択は、メッセージ ストア プロバイダーがサポートする必要がある機能の影響を受ける可能性がありますので、MAPI 機能を実装しやすく機能セットを持っています。</span><span class="sxs-lookup"><span data-stu-id="a0f40-115">Some database products have feature sets that make it easier to implement MAPI features, so your choice of database product may be affected by the features that your message store provider needs to support.</span></span>
  
<span data-ttu-id="a0f40-116">として、基になるストレージ機構作業を省けることが簡単だから通常の MAPI クライアントに現在のデータベース オブジェクトを MAPI オブジェクトとして、独自の階層型ストレージ ・ メカニズムを実装するより、既存のデータベースを使用します。</span><span class="sxs-lookup"><span data-stu-id="a0f40-116">Using an existing database as the underlying storage mechanism saves you work because it is usually easier to present database objects to MAPI clients as MAPI objects than to implement your own hierarchical storage mechanism.</span></span> <span data-ttu-id="a0f40-117">これを使用すると、独自の階層型ストレージ ・ メカニズムを実装する場合よりも高いレベルでの MAPI 操作を処理します。</span><span class="sxs-lookup"><span data-stu-id="a0f40-117">Doing this enables you to treat MAPI operations at a higher level than if you implement your own hierarchical storage mechanism.</span></span> <span data-ttu-id="a0f40-118">たとえば、特定の件名とメッセージの検索を構築して、適切なデータベースのクエリを送信するではなく、階層型ストレージ ・ メカニズムを検索するのには複雑なルーチンを実装するのはかなり簡単な問題になります。</span><span class="sxs-lookup"><span data-stu-id="a0f40-118">For example, searching for a message with a particular subject line becomes a fairly simple matter of constructing and submitting an appropriate database query, rather than implementing complex routines to search your hierarchical storage mechanism.</span></span>
  
<span data-ttu-id="a0f40-119">メッセージ ストア プロバイダーは、フォルダーおよびオブジェクトの操作を実行するには、MAPI クライアントと MAPI スプーラーと通信します。</span><span class="sxs-lookup"><span data-stu-id="a0f40-119">Message store providers communicate with MAPI clients and the MAPI spooler to perform operations on folders and objects.</span></span> <span data-ttu-id="a0f40-120">メッセージ ストア プロバイダーは、基になるストレージ機構の下位レベルの操作にこれらの操作を変換します。</span><span class="sxs-lookup"><span data-stu-id="a0f40-120">The message store provider translates those operations into lower level operations on the underlying storage mechanism.</span></span> <span data-ttu-id="a0f40-121">MAPI スプーラーは、通常、メッセージの送受信中にメッセージ ストア プロバイダーと通信します。</span><span class="sxs-lookup"><span data-stu-id="a0f40-121">The MAPI spooler typically communicates with the message store provider while sending and receiving messages.</span></span> <span data-ttu-id="a0f40-122">MAPI クライアントは、通常、フォルダーの階層を操作し、読み取り、編集、削除、およびメッセージを送信、メッセージ ストア プロバイダーと通信します。</span><span class="sxs-lookup"><span data-stu-id="a0f40-122">MAPI clients typically communicate with message store providers to manipulate the folder hierarchy and to read, edit, delete, and send messages.</span></span>
  
<span data-ttu-id="a0f40-123">MAPI スプーラーと MAPI クライアントは、新しいメッセージを作成するのには、メッセージ ストア プロバイダーと通信します。</span><span class="sxs-lookup"><span data-stu-id="a0f40-123">Both the MAPI spooler and MAPI clients communicate with the message store provider to create new messages.</span></span> <span data-ttu-id="a0f40-124">クライアント アプリケーションはユーザーがメッセージを作成するときにこれを行います。</span><span class="sxs-lookup"><span data-stu-id="a0f40-124">Client applications do this when users compose a message.</span></span> <span data-ttu-id="a0f40-125">MAPI スプーラーは受信メッセージを受信するとします。</span><span class="sxs-lookup"><span data-stu-id="a0f40-125">The MAPI spooler does this when it receives an incoming message.</span></span> <span data-ttu-id="a0f40-126">どちらの場合で、新しいメッセージが通常作成メッセージ ・ ストアの受信トレイ フォルダーに 1 つを使用する必要がある場合。</span><span class="sxs-lookup"><span data-stu-id="a0f40-126">In either case, the new message is usually created in the Inbox folder of the message store, if there is one.</span></span>
  
<span data-ttu-id="a0f40-127">メッセージ ストア プロバイダーは、MAPI テーブル、フォルダー、メッセージ、およびプロパティの使用を確認します。</span><span class="sxs-lookup"><span data-stu-id="a0f40-127">Message store providers make heavy use of MAPI tables, folders, messages, and properties.</span></span> <span data-ttu-id="a0f40-128">[MAPI テーブル](mapi-tables.md)、 [MAPI フォルダー](mapi-folders.md)、 [MAPI メッセージ](mapi-messages.md)、および[MAPI プロパティの概要](mapi-property-overview.md)では、これらのオブジェクトの実装の詳細が記載されています。</span><span class="sxs-lookup"><span data-stu-id="a0f40-128">The implementation details for those objects are documented in [MAPI Tables](mapi-tables.md), [MAPI Folders](mapi-folders.md), [MAPI Messages](mapi-messages.md), and [MAPI Property Overview](mapi-property-overview.md).</span></span> <span data-ttu-id="a0f40-129">把握する材料でメッセージ ストア プロバイダーを実装する前に。</span><span class="sxs-lookup"><span data-stu-id="a0f40-129">You should familiarize yourself with that material before attempting to implement a message store provider.</span></span>
  
<span data-ttu-id="a0f40-130">メッセージ ストア プロバイダーの 2 つの重要な種類があります: ユーザーの既定値として機能するもののメッセージ ストアと、そのことはできません。</span><span class="sxs-lookup"><span data-stu-id="a0f40-130">There are two important types of message store providers: those that can act as a user's default message store and those that cannot.</span></span> <span data-ttu-id="a0f40-131">既定のメッセージ ストアは、クライアント アプリケーションと MAPI スプーラーを実行できますメッセージの受信、フォルダーの作成など、任意のメッセージング タスクです。</span><span class="sxs-lookup"><span data-stu-id="a0f40-131">A default message store is one in which client applications and the MAPI spooler can perform any messaging task, such as receiving messages or creating folders.</span></span> <span data-ttu-id="a0f40-132">既定のメッセージ ストア プロバイダーは、すべてのメッセージ ストア プロバイダーに必要な最小数より多くの機能をいくつかをサポートしなければなりません。</span><span class="sxs-lookup"><span data-stu-id="a0f40-132">A default message store provider must support several more features than the minimum number required for all message store providers.</span></span>
  
## <a name="see-also"></a><span data-ttu-id="a0f40-133">関連項目</span><span class="sxs-lookup"><span data-stu-id="a0f40-133">See also</span></span>

- [<span data-ttu-id="a0f40-134">MAPI の概念</span><span class="sxs-lookup"><span data-stu-id="a0f40-134">MAPI concepts</span></span>](mapi-concepts.md)

