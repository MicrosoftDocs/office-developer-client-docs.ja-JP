---
title: MAPI メッセージ ストア プロバイダーの開発
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 83692674-0b5a-468d-9cd7-a2ac3d140bda
description: '最終更新日: 2011 年 7 月 23 日'
ms.openlocfilehash: 76332b57b2957b5682efb415121ea6db42409c30
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/23/2019
ms.locfileid: "32316762"
---
# <a name="developing-a-mapi-message-store-provider"></a>MAPI メッセージ ストア プロバイダーの開発
  
**適用対象**: Outlook 2013 | Outlook 2016 
  
他の mapi サービスプロバイダーと同様に、メッセージストアはダイナミックリンクライブラリ (dll) です。これは、基礎となるストレージメカニズムのサービスを mapi クライアントアプリケーションおよび mapi スプーラーに提供します。 メッセージストアプロバイダーは、mapi クライアントと mapi スプーラーで使用できるフォルダーとメッセージの階層的なセットとして、基盤となるストレージメカニズムを提供します。
  
次の図は、基本的な MAPI メッセージストアのアーキテクチャを示しています。
  
**メッセージ ストアのアーキテクチャ**
  
![メッセージストアのアーキテクチャ](media/storearc.gif "メッセージストアのアーキテクチャ")
  
任意の種類の基本的なストレージ機構を使用して、メッセージストアプロバイダーを実装できます。 ただし、パフォーマンスの問題に注意する必要があります。 さらに、基盤となるストレージメカニズムを MAPI オブジェクトの階層コレクションとして提示する必要があります。 これらの要件は、通常、データベース内のオブジェクトの階層型ストレージをサポートする既存のデータベース製品を使用してメッセージストアが実装されており、プログラミングインターフェイスまたは適切に定義されたファイル構造を備えていることを意味します。 たとえば、Microsoft Office Access、SQL、Oracle の各データベースを基盤となるストレージメカニズムとして使用できます。 一部のデータベース製品には MAPI 機能を実装しやすくする機能セットがあるため、選択したデータベース製品が、メッセージストアプロバイダーがサポートする必要のある機能の影響を受ける可能性があります。
  
既存のデータベースを基礎となるストレージメカニズムとして使用すると、通常は、データベースオブジェクトを mapi オブジェクトとして使用する方が、独自の階層ストレージメカニズムを実装するよりも簡単になるため、作業を節約できます。 これにより、独自の階層ストレージメカニズムを実装する場合よりも高いレベルで MAPI 操作を処理することができます。 たとえば、特定の件名行を持つメッセージを検索すると、階層ストレージ機構を検索する複雑なルーチンを実装するのではなく、適切なデータベースクエリを構築して送信することが非常に簡単になります。
  
メッセージストアプロバイダーは、mapi クライアントおよび mapi スプーラーと通信して、フォルダーとオブジェクトに対する操作を実行します。 メッセージストアプロバイダーは、基礎となるストレージメカニズムで、これらの操作を低レベルの操作に変換します。 MAPI スプーラーは、通常、メッセージの送受信中にメッセージストアプロバイダーと通信します。 MAPI クライアントは、通常、フォルダー階層を操作したり、メッセージを読み取り、編集、削除、および送信したりするために、メッセージストアプロバイダーと通信します。
  
mapi スプーラーと mapi の両方のクライアントは、メッセージストアプロバイダーと通信して、新しいメッセージを作成します。 クライアントアプリケーションは、ユーザーがメッセージを作成するときにこれを実行します。 MAPI スプーラーは、受信メッセージを受信したときにこれを実行します。 どちらの場合も、新しいメッセージは通常、メッセージストアの受信トレイフォルダーに作成されます (存在する場合)。
  
メッセージストアプロバイダーは、MAPI テーブル、フォルダー、メッセージ、およびプロパティを頻繁に使用します。 これらのオブジェクトの実装の詳細については、「 [mapi の表](mapi-tables.md)」、「mapi[フォルダー](mapi-folders.md)」、「mapi[メッセージ](mapi-messages.md)」、および[「mapi のプロパティの概要](mapi-property-overview.md)」で説明されています。 メッセージストアプロバイダーを実装する前に、その資料を理解しておく必要があります。
  
メッセージストアプロバイダーには、次の2つの重要な種類があります。これは、ユーザーの既定のメッセージストアとして機能することも、できないものでもかまいません。 既定のメッセージストアとは、メッセージの受信やフォルダーの作成など、クライアントアプリケーションと MAPI スプーラーがどのようなメッセージタスクでも実行できるもののことです。 既定のメッセージストアプロバイダーは、すべてのメッセージストアプロバイダーに必要な最小数よりも多くの機能をサポートする必要があります。
  
## <a name="see-also"></a>関連項目

- [MAPI の概念](mapi-concepts.md)

