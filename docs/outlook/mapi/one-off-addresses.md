---
title: 一時アドレス
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 9224c694-b26f-42c7-9404-ee2dd832cfbb
description: '最終更新日: 2015 年 3 月 9 日'
ms.openlocfilehash: e6bda55951d8df5c5da272750c631ec105b2ccf2
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/28/2019
ms.locfileid: "33409112"
---
# <a name="one-off-addresses"></a>一時アドレス

**適用対象**: Outlook 2013 | Outlook 2016 
  
一時アドレスは、1回限りの受信者にメッセージを送信するために使用されます。受信者は、セッションのアドレス帳コンテナーのいずれかに対応するエントリがないことになります。 クライアントは、送信メッセージの受信者一覧に新しいエントリをアドレス帳または新しい受信者に追加するときに、1回限りのアドレスを作成できます。 変更可能な任意のコンテナーに、1回限りのアドレスを追加できます。
  
1回限りのアドレスを作成するには、クライアントは編集コントロールを含む特別なテンプレートを使用して、1回限りのアドレスを構成するすべての情報を入力します。 その他の種類のアドレスなどの1回限りのアドレスは、定義済みの形式を使用します。 1回限りのアドレス形式は、次のように MAPI によって定義されます。
  
`Display name[Address type:Email address]`
  
この形式には6つのコンポーネントがあり、文字のクォートにはいくつかのルールがあります。 次の表では、これらのコンポーネントについて説明します。
  
|**コンポーネント**|**用途**|**説明**|
|:-----|:-----|:-----|
|識別名 (DN)  <br/> |省略可能  <br/> |存在しない場合、 **IAddrBook:: ResolveName**は、電子メールアドレスの表示名として表示される部分を使用します。 空白を含めることができます。 詳細については、「 [IAddrBook:: ResolveName](iaddrbook-resolvename.md)」を参照してください。  <br/> |
|[  <br/> |必須  <br/> |表しの種類と住所情報の開始。  <br/> |
|]  <br/> |必須  <br/> |表しは、型と住所情報の最後を示します。 この文字の後に空白以外の文字を入力した場合、エントリはカスタム受信者として扱われません。  <br/> |
|アドレスの種類  <br/> |必須  <br/> |住所の種類。特定のアドレス形式にマップします。 詳細については、「 [MAPI アドレスの種類](mapi-address-types.md)」を参照してください。  <br/> |
|:  <br/> |必須  <br/> |アドレスの種類を電子メールアドレスから分離します。  <br/> |
|電子メール アドレス  <br/> |必須  <br/> |��M�҂̃A�h���X�ł��B 空白を含めることができます。  <br/> |
   
MAPI では、特定の引用符文字のセットを使用して、コンマ (,)、左大かっこ ([)、コロン (:) などの特殊文字をアドレスに含めることができます。また、キャリッジリターンや改行などの何らかのシリアライズ可能な文字、またはその他の16進数に相当するものもあります。 クォート文字は、バックスラッシュ (\)) です。 そのため、クライアントまたはプロバイダーがアドレスにバックスラッシュを挿入する必要がある場合は、その preceed を\\クォート文字 ("") で囲む必要があります。
  
クライアントおよびサービスプロバイダーは、固定されていない任意の型のフィールドでこのクォート手法を使用できます。 たとえば、次のエントリは、請求書 Lee を表示名、アドレスの種類\\としては mルード、電子メールアドレスとしては、次のように変換します。
  
`Bill Lee[MSPEER:\\\\billl\in]`

特別な非種類のシリアライズ可能な文字を挿入するには、クライアントとサービスプロバイダーは、クォート文字の後に x と2桁の16進数を使用して、それに相当する16進数を表します。 たとえば、アドレスに、キャリッジリターンに相当する非検出可能な文字 (\ 0d) がある場合、16進数ではクライアントは次のように入力します。
  
`Fax Recipient[fax:recipient\x0dbuilding\x0doffice\x0d555-1212\x0d]`

**IAddrBook:: ResolveName**は、ほとんどの SMTP アドレスを自動的に解析し、次の形式のアドレスを検索します。 
  
`XXX@YYY.ZZZ`

使用可能な RFC822 形式の一部は処理されませんが、ほとんどのユーザーにとってこの自動解析は十分です。 **ResolveName**にはこの機能が含まれており、ユーザーが SMTP アドレスを直接メッセージに入力し、そのメッセージがインターネットユーザーに送られるようにすることができます。 住所の XXX、YYY、および ZZZ コンポーネントには、1つ以上の文字を指定できます。 アットマーク (@) は、XXX、yyy、または ZZZ のいずれかのアドレスコンポーネントに含めることはできません。また、yyy コンポーネントに期間を含めることもできません。 SMTP アドレスでは次の文字が特殊文字なので、MAPI はこれらの文字を含む表示名を、1回限りのアドレスに自動的に変換します。 
  
- \>\>
    
- @
    
- \<\>
    
- .
    
すべての1回限りのアドレスには、対応する1回限りのエントリ識別子が割り当てられます。 この割り当てを行うために、クライアントは**IAddrBook:: createoneoff**を呼び出し、トランスポートプロバイダは**imapisupport:: createoneoff**を呼び出します。 詳細については、「 [IAddrBook:: createoneoff](iaddrbook-createoneoff.md) 」および「 [imapisupport:: createoneoff](imapisupport-createoneoff.md)」を参照してください。 受信メッセージを処理する場合、トランスポートプロバイダーは、ゲートウェイアドレスと、トランスポートに関連付けられたアドレス帳プロバイダーによって処理できないアドレスに対して、1回限りのエントリ識別子を作成します。 トランスポートプロバイダーメッセージ内の各アドレスの種類をチェックして、トランスポートに関連付けられているアドレス帳プロバイダーによって処理できるかどうかを判断します。 送信できない場合、トランスポートプロバイダーは**imapisupport:: createoneoff**を呼び出して、アドレスを1回限りのエントリ識別子に関連付けます。 
  
1回限りのエントリ識別子には、次の順序で情報が含まれます。
  
1. **MAPIUID**
    
2. バージョン
    
3. フラグ
    
4. 識別名 (DN)
    
5. アドレスの種類
    
6. 電子メール アドレス
    
**IAddrBook:: createoneoff**および**imapisupport:: createoneoff**の場合、クライアントとトランスポートプロバイダーは、1回限りのアドレスで表される受信者が書式設定されたテキストや埋め込み OLE を処理できるかどうかを示すフラグを設定できます。対象. 受信者が書式設定されたテキストと OLE オブジェクトを処理できることを示すために、クライアントとトランスポートプロバイダーは_ulflags_パラメーターに MAPI_SEND_NO_RICH_INFO フラグを設定します。 その後、MAPI は、1回限りの受信者の**PR_SEND_RICH_INFO** ([PidTagSendRichInfo](pidtagsendrichinfo-canonical-property.md)) プロパティを FALSE に設定します。 このフラグが設定されていない場合、MAPI は、1回限りのアドレスが SMTP アドレスとして解釈される場合を除き、 **PR_SEND_RICH_INFO**を TRUE に設定します。 この1つの場合、 **PR_SEND_RICH_INFO**の既定値は FALSE です。 
  
## <a name="see-also"></a>関連項目

- [IAddrBook::ResolveName](iaddrbook-resolvename.md)

