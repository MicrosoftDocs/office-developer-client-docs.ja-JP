---
title: MAPI にログオンします。
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 05bafe43-a78a-4659-92f0-0b4fe444c64f
description: '�ŏI�X�V��: 2011�N7��23��'
ms.openlocfilehash: 1ae3c47964ff238f57e98e0005a966008192f7c7
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 06/11/2018
ms.locfileid: "19801296"
---
# <a name="logging-on-to-mapi"></a>MAPI にログオンします。
 
**適用されます**: Outlook 
  
**MAPILogonEx**関数を呼び出すことによって、MAPI サブシステムには、クライアント アプリケーションがログオンするとします。 詳細については、 [MAPILogonEx](mapilogonex.md)を参照してください。 **MAPILogonEx**では、プロファイルの選択と、プロファイル内の各サービス プロバイダーの構成を検証します。 構成にすると、MAPI は、メッセージ ストア プロバイダーを開始する前に、アドレス帳プロバイダーを起動します。 トランスポート プロバイダーは、そのサービスは、まず、必要なときに開始されます。 
  
## <a name="choose-a-profile"></a>プロファイルを選択します。
  
- **MAPILogonEx**、 _lpszProfileName_パラメーターにプロファイルの名前を表す文字列を渡すか、.
    
- プロファイルを指定するには、 _lpszProfileName_パラメーターに NULL を渡すと、MAPI_LOGON_UI フラグを設定するユーザーを許可するか、. 

- 既定のプロファイルを選択するには、 _lpszProfileName_パラメーターに NULL を渡すと、MAPI_USE_DEFAULT フラグを設定します。 
    
デフォルトのプロファイル以外の特定のプロファイルを必要とする場合の構成データベースの名前を保存するか、特定の命名規則を使用してください。 MAPI は、プロファイル テーブルの名前と既定のフラグ以外のすべてのプロファイル属性を公開していないと、メッセージング クライアントおよび関連する IPM アプリケーションの既定のプロファイル フラグが予約されています。
  
部分的なプロファイル] または [ **MAPILogonEx**プロバイダーの構成情報を提供するクライアントでは、表示されるダイアログ ボックスを許可することでユーザーに追加のデータを求める必要があります。 情報が不足しているユーザーにそれを入力することはできません**MAPILogonEx**の入力を求める場合は、ログオンが失敗します。 しない必要があるユーザーの入力を実行するクライアントでは、ダイアログ ボックスの表示を抑制できます。 
  
**MAPILogonEx**を使用してユーザー インターフェイスを有効にするためのフラグは相互に排他的です。1 つだけを設定することができます。 これらのフラグを設定しないまま、必要な情報が存在しない場合にエラーが発生する**MAPILogonEx**の原因で、ユーザー インターフェイスの表示を抑制します。 つまり、 _lpszProfileName_パラメーターに NULL を渡すと、MAPI_USE_DEFAULT フラグを設定しないし、ユーザー ・ インタ フェースを無効にする場合、は、 **MAPILogonEx**はプロファイル名を取得できないために失敗します。 
  
**MAPILogonEx**が確立したセッションには、個別のメッセージング セッション、メッセージの共有セッション、またはメッセージング セッションができます。 個々 のメッセージング セッション、クライアントと、MAPI サブシステムのプライベート接続は、 **MAPILogonEx**の呼び出しで、MAPI_NEW_SESSION フラグを設定することによって確立することができます。
  
メッセージング セッションの共有は、複数のメッセージング クライアントを使用している接続です。 同じプロファイルを使用するクライアントの通常の共有セッションを確立します。 共有セッションに新しいセッションを確立するために MAPI_ALLOW_OTHERS フラグを設定します。 
  
## <a name="use-an-existing-shared-session"></a>既存の共有セッションを使用します。
  
- MAPI_NEW_SESSION フラグを設定しません。
    
- MAPI_ALLOW_OTHERS フラグを設定しません。
    
- _LpszProfileName_パラメーターに NULL を渡します。 
    
- _LpszPassword_パラメーターに NULL を渡します。 
    
メッセージング セッションでは、MAPI のサブシステムにアクセスするクライアントを許可するが、メッセージの送信または受信を許可しません。 構成または管理アプリケーションでは、メッセージング セッションを確立する必要があるクライアントの例を示します。 メッセージング セッションを要求するには、MAPI_NO_MAIL フラグを設定します。 このフラグを設定、MAPI スプーラーに通知せず、クライアントを記録します。 このフラグを使用して MAPI にログオンするクライアントは、読み取りの進捗レポートを受け取ることはありませんすることはできません。
  
MAPI_NO_MAIL フラグを設定する必要がありますのみ。
  
- 場合は、クライアントは、送信またはセッション中にメッセージを受信ができません。
    
- 場合は、クライアントには、プロファイルの内容を完全に制御し、メッセージの送信し受信は密結合を使用してメッセージ ストアと、トランスポート プロバイダーは、Microsoft Exchange プロバイダー。
    
メッセージング クライアントは、メッセージング クライアントを使用してセッションを共有できます。 共有セッションの 1 つのメンバーの特性は、他のメンバーの特性の影響を受けません。 MAPI_NO_MAIL と MAPI_ALLOW_OTHERS のフラグのセットを使用してログオンする場合、セッションにログオンしているメッセージング クライアントには影響しません、クライアント、およびその逆の操作です。 メッセージング クライアントは、メッセージの送受信を行うことができ、クライアントには表示されません。
  
**MAPILogonEx**に設定できるその他のいくつかのフラグが定義されています。 
  
- MAPI_FORCE_DOWNLOAD は、 **MAPILogonEx**が返される前に受信したメッセージをダウンロードする必要があることを示します。 このフラグを設定しない場合、メッセージは後でバック グラウンドでダウンロードします。 
    
- MAPI_SERVICE_UI_ALWAYS は、プロファイル内のすべてのメッセージ サービスが、[構成] ダイアログ ボックスを表示することを要求します。
    
- MAPI_NT_SERVICE では、クライアントが Windows サービスとして実装されていることを示します。 クライアントがサービスである場合、このフラグを設定する必要があります。
    
成功したログオンのたびには、 **MAPILogonEx**は、MAPI セッションへのポインターを返します。 **IMAPISession**インターフェイスのメソッドを呼び出すには、このポインターを使用できます。 詳細についてを参照してください[IMAPISession: IUnknown](imapisessioniunknown.md)。 セッションの種類に関係なく、セッションのポインターは、そのメッセージを受信し、有効ではないタスク全体にわたってクライアントに固有です。
  

