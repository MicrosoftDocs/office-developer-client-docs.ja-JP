---
title: MAPI プロファイル
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 493c87a4-317d-47ec-850b-342cac59594b
description: '最終更新日時: 2015 年 3 月 9 日'
ms.openlocfilehash: 9db1f8e163e44a44df1e798cebccb3639325275e
ms.sourcegitcommit: ef717c65d8dd41ababffb01eafc443c79950aed4
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 10/04/2018
ms.locfileid: "25391431"
---
# <a name="mapi-profiles"></a><span data-ttu-id="d3c8b-103">MAPI プロファイル</span><span class="sxs-lookup"><span data-stu-id="d3c8b-103">MAPI Profiles</span></span>

  
  
<span data-ttu-id="d3c8b-104">**適用対象**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="d3c8b-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="d3c8b-105">プロファイルは、サービス ・ プロバイダーおよびコンピューターにインストールされているメッセージのサービスに関する情報を格納します。</span><span class="sxs-lookup"><span data-stu-id="d3c8b-105">A profile stores information about service providers and message services that are installed on a computer.</span></span> <span data-ttu-id="d3c8b-106">すべてのセッションは、ログオン時にクライアントは、使用するプロバイダーとのサービスを説明する 1 つのプロファイルを選択します。</span><span class="sxs-lookup"><span data-stu-id="d3c8b-106">For every session, a client at logon time selects one profile that describes the providers and services to be used.</span></span> <span data-ttu-id="d3c8b-107">できるプロファイルのコレクションから選択して、クライアントが必要な場合は、既定値として 1 つを確立します。</span><span class="sxs-lookup"><span data-stu-id="d3c8b-107">A client can choose from a collection of profiles and, if desired, establish one as the default.</span></span> <span data-ttu-id="d3c8b-108">既定のプロファイルは、クライアントがセッションを開始して、プロファイルを明示的に指定することがないときに自動的に選択されているプロファイルです。</span><span class="sxs-lookup"><span data-stu-id="d3c8b-108">The default profile is the profile that is selected automatically when a client starts a session and has not explicitly specified a profile.</span></span>
  
<span data-ttu-id="d3c8b-109">これらのトピックでは、バイナリ ストリームに格納されているニックネームのキャッシュの詳細を検索は。</span><span class="sxs-lookup"><span data-stu-id="d3c8b-109">Also in these topics, you will find a discussion of the nickname cache, which is stored in a binary stream.</span></span>
  
- [<span data-ttu-id="d3c8b-110">ニックネーム キャッシュ</span><span class="sxs-lookup"><span data-stu-id="d3c8b-110">Nickname cache</span></span>](nickname-cache.md)
    
- [<span data-ttu-id="d3c8b-111">オートコンプリート ストリーム</span><span class="sxs-lookup"><span data-stu-id="d3c8b-111">Autocomplete Stream</span></span>](autocomplete-stream.md)
    
- [<span data-ttu-id="d3c8b-112">バイナリ ファイルの解析</span><span class="sxs-lookup"><span data-stu-id="d3c8b-112">Binary File Parsing</span></span>](https://portalvhds6gyn3khqwmgzd.blob.core.windows.net/files/NK2/NK2WithBinaryExample.pdf)
    
## <a name="profile-sections"></a><span data-ttu-id="d3c8b-113">プロファイル セクション</span><span class="sxs-lookup"><span data-stu-id="d3c8b-113">Profile Sections</span></span>

<span data-ttu-id="d3c8b-114">プロファイルは、クライアント セクションに分かれていますが、ユーザーにプロファイル プロパティを表示する、または構成を変更するのにはサービス ・ プロバイダーがアクセスします。</span><span class="sxs-lookup"><span data-stu-id="d3c8b-114">Profiles are divided into sections that clients and service providers access to display profile properties to users or to make configuration changes.</span></span> <span data-ttu-id="d3c8b-115">プロファイル セクションは、 **IProfSect**インターフェイスを実装する MAPI オブジェクト、 **IMAPIProp**から派生し、追加のメソッドを持たないインタ フェースです。</span><span class="sxs-lookup"><span data-stu-id="d3c8b-115">A profile section is a MAPI object that implements the **IProfSect** interface, an interface that derives from **IMAPIProp** and has no additional methods.</span></span> <span data-ttu-id="d3c8b-116">詳細についてを参照してください[IProfSect: IMAPIProp](iprofsectimapiprop.md)。</span><span class="sxs-lookup"><span data-stu-id="d3c8b-116">For more information, see [IProfSect : IMAPIProp](iprofsectimapiprop.md).</span></span> <span data-ttu-id="d3c8b-117">その唯一の目的は、プロファイル セクションのプロパティを操作するためです。</span><span class="sxs-lookup"><span data-stu-id="d3c8b-117">Its only purpose is to manipulate the properties of a profile section.</span></span> <span data-ttu-id="d3c8b-118">クライアントとサービス ・ プロバイダーは、特定のプロファイル セクションに、 **IProfSect**のポインターを取得するためにメソッドを呼び出します。</span><span class="sxs-lookup"><span data-stu-id="d3c8b-118">To retrieve an **IProfSect** pointer to a particular profile section, clients and service providers call the following methods.</span></span> 
  
|||
|:-----|:-----|
|<span data-ttu-id="d3c8b-119">クライアントが呼び出すことができます。</span><span class="sxs-lookup"><span data-stu-id="d3c8b-119">Clients can call:</span></span>  <br/> |[<span data-ttu-id="d3c8b-120">IMAPISession::OpenProfileSection</span><span class="sxs-lookup"><span data-stu-id="d3c8b-120">IMAPISession::OpenProfileSection</span></span>](imapisession-openprofilesection.md) <br/> |
|<span data-ttu-id="d3c8b-121">サービス プロバイダーを呼び出すことができます。</span><span class="sxs-lookup"><span data-stu-id="d3c8b-121">Service providers can call:</span></span>  <br/> |[<span data-ttu-id="d3c8b-122">IMAPISupport::OpenProfileSection</span><span class="sxs-lookup"><span data-stu-id="d3c8b-122">IMAPISupport::OpenProfileSection</span></span>](imapisupport-openprofilesection.md) <br/> |
|<span data-ttu-id="d3c8b-123">クライアントまたはプロバイダーのいずれかを呼び出すことができます。</span><span class="sxs-lookup"><span data-stu-id="d3c8b-123">Either clients or providers can call:</span></span>  <br/> |[<span data-ttu-id="d3c8b-124">IProviderAdmin::OpenProfileSection</span><span class="sxs-lookup"><span data-stu-id="d3c8b-124">IProviderAdmin::OpenProfileSection</span></span>](iprovideradmin-openprofilesection.md) <br/> |
   
<span data-ttu-id="d3c8b-125">プロファイルは階層構造により、MAPISVC のように。INF ファイルです。</span><span class="sxs-lookup"><span data-stu-id="d3c8b-125">Profiles are organized hierarchically much like the MAPISVC.INF file.</span></span> <span data-ttu-id="d3c8b-126">階層の上部には、プロファイルに関連する情報が含まれているプロファイル セクションがあります。</span><span class="sxs-lookup"><span data-stu-id="d3c8b-126">At the top of the hierarchy, there are profile sections that contain information relevant to the profile.</span></span> <span data-ttu-id="d3c8b-127">中間レベルには、特定のメッセージのサービスに関する情報が含まれているセクションが含まれています、下位レベルには、メッセージ サービスのサービス プロバイダーのいずれかに関する情報が含まれているセクションが含まれています。</span><span class="sxs-lookup"><span data-stu-id="d3c8b-127">The middle level includes sections that contain information about a particular message service and the lower level includes sections that contain information about one of the service providers in a message service.</span></span> 
  
<span data-ttu-id="d3c8b-128">すべてのプロファイルには、1 つまたは複数のプロファイルのセクションに格納されているいくつかの必要なプロパティがあります。</span><span class="sxs-lookup"><span data-stu-id="d3c8b-128">Every profile has several required properties that are stored in one or more of the sections of the profile.</span></span> <span data-ttu-id="d3c8b-129">たとえば、すべてのプロファイルは、 **PR_PROFILE_NAME** ([PidTagProfileName](pidtagprofilename-canonical-property.md)) と**PR_SEARCH_KEY** ([PidTagSearchKey](pidtagsearchkey-canonical-property.md)) のプロパティを持ちます。</span><span class="sxs-lookup"><span data-stu-id="d3c8b-129">For example, every profile has the **PR_PROFILE_NAME** ([PidTagProfileName](pidtagprofilename-canonical-property.md)) and **PR_SEARCH_KEY** ([PidTagSearchKey](pidtagsearchkey-canonical-property.md)) properties.</span></span> <span data-ttu-id="d3c8b-130">プロファイルの検索キーは、MAPIGUID で定義されている値に設定されます。MUID_PROFILE_INSTANCE と H し、常にすべてのプロファイルが既に存在します。</span><span class="sxs-lookup"><span data-stu-id="d3c8b-130">A profile's search key is set to the value defined in MAPIGUID.H as MUID_PROFILE_INSTANCE and is always guaranteed to be unique among all profiles.</span></span> <span data-ttu-id="d3c8b-131">2 つのプロファイルには、同じ名前を持つことができます、検索キーを同時に持つことはできません。</span><span class="sxs-lookup"><span data-stu-id="d3c8b-131">Although two profiles can have the same name, they cannot have the same search key.</span></span> <span data-ttu-id="d3c8b-132">検索キーは、特定の種類のデータではなくバイナリ データとして扱います。</span><span class="sxs-lookup"><span data-stu-id="d3c8b-132">Search keys should be treated as binary data instead of data of any particular type.</span></span>
  
<span data-ttu-id="d3c8b-133">メッセージ ストア プロバイダーは、プロファイルのプロファイルのセクションで、メッセージ ・ ストアの**PR_DISPLAY_NAME** ([PidTagDisplayName](pidtagdisplayname-canonical-property.md)) のプロパティを含めるし、メッセージのプロバイダーを格納して、これらのエントリの同期を維持するには必要です。</span><span class="sxs-lookup"><span data-stu-id="d3c8b-133">Message store providers are required to include their message store's **PR_DISPLAY_NAME** ([PidTagDisplayName](pidtagdisplayname-canonical-property.md)) property in the profile sections for the profile and for their message store provider and to keep these entries synchronized.</span></span> <span data-ttu-id="d3c8b-134">メッセージ ストアが作成されると、プロバイダーはこれらのプロファイル セクションに格納されている値に基づいて**PR_DISPLAY_NAME**を設定します。</span><span class="sxs-lookup"><span data-stu-id="d3c8b-134">When a message store is created, the provider sets **PR_DISPLAY_NAME** based on the value stored in these profile sections.</span></span> 
  
<span data-ttu-id="d3c8b-135">プロファイル セクションと**IMAPIProp**を継承する他のオブジェクトとの間の 2 つの主な違いがあります。</span><span class="sxs-lookup"><span data-stu-id="d3c8b-135">There are two major differences between profile sections and other objects that inherit from **IMAPIProp**:</span></span> 
  
- <span data-ttu-id="d3c8b-136">プロファイル セクションでは、トランザクションをサポートしていません。</span><span class="sxs-lookup"><span data-stu-id="d3c8b-136">Profile sections do not support transactions.</span></span>
    
- <span data-ttu-id="d3c8b-137">プロファイル セクションでは、 **IMAPIProp::GetIDsFromNames**と**IMAPIProp::GetNamesFromIDs**の導入から MAPI_E_NO_SUPPORT を取得する、名前付きプロパティをサポートしていません。</span><span class="sxs-lookup"><span data-stu-id="d3c8b-137">Profile sections do not support named properties, returning MAPI_E_NO_SUPPORT from their **IMAPIProp::GetIDsFromNames** and **IMAPIProp::GetNamesFromIDs** implementations.</span></span> <span data-ttu-id="d3c8b-138">詳細については、 [IMAPIProp::GetIDsFromNames](imapiprop-getidsfromnames.md)および[IMAPIProp::GetNamesFromIDs](imapiprop-getnamesfromids.md)を参照してください。</span><span class="sxs-lookup"><span data-stu-id="d3c8b-138">For more information, see [IMAPIProp::GetIDsFromNames](imapiprop-getidsfromnames.md) and [IMAPIProp::GetNamesFromIDs](imapiprop-getnamesfromids.md).</span></span>
    
<span data-ttu-id="d3c8b-139">プロファイル セクションでは、トランザクション、 **IMAPIProp::CopyProps**への呼び出しに加えられた変更をサポートしていないため**CopyTo**、または**SetProps**即時に反映します。</span><span class="sxs-lookup"><span data-stu-id="d3c8b-139">Because profile sections do not support transactions, any changes made with calls to **IMAPIProp::CopyProps**, **CopyTo**, or **SetProps** immediately take effect.</span></span> <span data-ttu-id="d3c8b-140">詳細については、 [IMAPIProp::CopyProps](imapiprop-copyprops.md)を参照してください。</span><span class="sxs-lookup"><span data-stu-id="d3c8b-140">For more information, see [IMAPIProp::CopyProps](imapiprop-copyprops.md).</span></span> <span data-ttu-id="d3c8b-141">クライアントとサービス ・ プロバイダーはプロファイル セクションの**IMAPIProp::SaveChanges**メソッドを呼び出すことができ、成功しますが、プロファイル セクションのデータには影響しません。</span><span class="sxs-lookup"><span data-stu-id="d3c8b-141">Clients and service providers can call a profile section's **IMAPIProp::SaveChanges** method and it will succeed, but it does not affect the profile section data.</span></span> <span data-ttu-id="d3c8b-142">詳細については、 [IMAPIProp::SaveChanges](imapiprop-savechanges.md)を参照してください。</span><span class="sxs-lookup"><span data-stu-id="d3c8b-142">For more information, see [IMAPIProp::SaveChanges](imapiprop-savechanges.md).</span></span> <span data-ttu-id="d3c8b-143">すぐに変更することは、サービス プロバイダーがユーザーにプロファイル プロパティを表示するクライアントを使用するプロパティ シートを実装する方法に影響します。</span><span class="sxs-lookup"><span data-stu-id="d3c8b-143">Having changes occur immediately can affect how service providers implement the property sheets that clients use to display profile properties to users.</span></span> <span data-ttu-id="d3c8b-144">ユーザーが延期または変更を元に戻すことができるようにするサービス プロバイダーでは、実際のセクションではなく、プロファイルの各セクションのコピーでは、そのプロパティ シートを実装しなければなりません。</span><span class="sxs-lookup"><span data-stu-id="d3c8b-144">Service providers that want users to be able to postpone or undo changes must implement their property sheets with copies of profile sections instead of the real sections.</span></span> <span data-ttu-id="d3c8b-145">コピーを使用すると、ユーザーが変更を加えるし、後でそれらの変更をキャンセル、元のプロファイル セクションを変更を加えずにそのままです。</span><span class="sxs-lookup"><span data-stu-id="d3c8b-145">By using copies, users can make changes and then later cancel those changes, leaving the original profile sections untouched.</span></span> 
  
<span data-ttu-id="d3c8b-146">プロファイルの情報が表示される順序は、MAPI のリソースを構成して、セッション内の割り当てに影響します。</span><span class="sxs-lookup"><span data-stu-id="d3c8b-146">The order in which information appears in a profile affects how MAPI configures resources and makes assignments in a session.</span></span> <span data-ttu-id="d3c8b-147">プロファイルの順序では、以下の割り当てが影響を受けます。</span><span class="sxs-lookup"><span data-stu-id="d3c8b-147">The following assignments are affected by profile order:</span></span>
  
- <span data-ttu-id="d3c8b-148">既定のメッセージ ストア</span><span class="sxs-lookup"><span data-stu-id="d3c8b-148">Default message store</span></span>
    
- <span data-ttu-id="d3c8b-149">個人用アドレス帳</span><span class="sxs-lookup"><span data-stu-id="d3c8b-149">Personal address book</span></span>
    
- <span data-ttu-id="d3c8b-150">既定のメッセージ ストアの検索パス</span><span class="sxs-lookup"><span data-stu-id="d3c8b-150">Default message store search path</span></span>
    
- <span data-ttu-id="d3c8b-151">既定のアドレス帳の検索パス</span><span class="sxs-lookup"><span data-stu-id="d3c8b-151">Default address book search path</span></span>
    
- <span data-ttu-id="d3c8b-152">トランスポート プロバイダーの順序</span><span class="sxs-lookup"><span data-stu-id="d3c8b-152">Transport provider order</span></span>
    
<span data-ttu-id="d3c8b-153">MAPI では、STATUS_DEFAULT_STORE フラグの既定のストアができることを示す、 **PR_RESOURCE_FLAGS** ([PidTagResourceFlags](pidtagresourceflags-canonical-property.md)) プロパティに設定するプロファイルの最初のメッセージ ストアを使用する既定のメッセージ ストアを設定します。</span><span class="sxs-lookup"><span data-stu-id="d3c8b-153">MAPI sets the default message store to be the first message store in the profile that has the STATUS_DEFAULT_STORE flag set in its **PR_RESOURCE_FLAGS** ([PidTagResourceFlags](pidtagresourceflags-canonical-property.md)) property, which indicates that it can be the default store.</span></span> <span data-ttu-id="d3c8b-154">クライアントは、 **IMAPISession::SetDefaultStore**を呼び出すことによってこの設定を上書きすることができます。</span><span class="sxs-lookup"><span data-stu-id="d3c8b-154">Clients can override this setting by calling **IMAPISession::SetDefaultStore**.</span></span> <span data-ttu-id="d3c8b-155">詳細については、 [IMAPISession::SetDefaultStore](imapisession-setdefaultstore.md)を参照してください。</span><span class="sxs-lookup"><span data-stu-id="d3c8b-155">For more information, see [IMAPISession::SetDefaultStore](imapisession-setdefaultstore.md).</span></span>
  
<span data-ttu-id="d3c8b-156">MAPI は、送信および受信メッセージを処理するためのトランスポートの順番を作成します。</span><span class="sxs-lookup"><span data-stu-id="d3c8b-156">MAPI creates a transport order for handling outgoing and incoming messages.</span></span> <span data-ttu-id="d3c8b-157">特定の種類のメッセージの 2 つ以上のトランスポート プロバイダーが登録されると、MAPI はこの順序を使用して、どのプロバイダーがメッセージを処理する必要がありますを決定します。</span><span class="sxs-lookup"><span data-stu-id="d3c8b-157">When more than one transport provider has registered for a message of a particular type, MAPI uses this order to determine which provider should handle the message.</span></span> <span data-ttu-id="d3c8b-158">MAPI でトランスポート プロバイダーは、1 つの例外 - 輸送船の**PR_RESOURCE_FLAGS**プロパティに STATUS_XP_PREFER_LAST フラグを設定するプロファイルに追加されたが、順序で配置最後の順序を使用するトランスポートの順番を設定します。</span><span class="sxs-lookup"><span data-stu-id="d3c8b-158">MAPI sets the transport order to be the order in which the transport providers were added to the profile with one exception--the transports that set the STATUS_XP_PREFER_LAST flag in their **PR_RESOURCE_FLAGS** property are positioned last in the order.</span></span> <span data-ttu-id="d3c8b-159">クライアントは、 **IMsgServiceAdmin::MsgServiceTransportOrder**を呼び出すことによって、トランスポートの順番を設定できます。</span><span class="sxs-lookup"><span data-stu-id="d3c8b-159">Clients can set the transport order by calling **IMsgServiceAdmin::MsgServiceTransportOrder**.</span></span> <span data-ttu-id="d3c8b-160">詳細については、 [IMsgServiceAdmin::MsgServiceTransportOrder](imsgserviceadmin-msgservicetransportorder.md)を参照してください。</span><span class="sxs-lookup"><span data-stu-id="d3c8b-160">For more information, see [IMsgServiceAdmin::MsgServiceTransportOrder](imsgserviceadmin-msgservicetransportorder.md).</span></span>
  
<span data-ttu-id="d3c8b-161">サービス プロバイダーおよびメッセージ サービスを注文するためのガイドラインも競合しています。</span><span class="sxs-lookup"><span data-stu-id="d3c8b-161">These guidelines for ordering service providers and message services might sometimes conflict.</span></span> <span data-ttu-id="d3c8b-162">競合がある場合、コードは競合を解決する必要があります。</span><span class="sxs-lookup"><span data-stu-id="d3c8b-162">If there is a conflict, your code should resolve the conflict.</span></span> <span data-ttu-id="d3c8b-163">メール コントロール パネルのプログラムを使用すると、期待どおりに、プロバイダーが構成されているかどうかを判断するのには作成したプロファイルを検査します。</span><span class="sxs-lookup"><span data-stu-id="d3c8b-163">You can use the Mail Control Panel program to inspect a profile that you have created to determine whether the providers have been configured as expected.</span></span>
  

