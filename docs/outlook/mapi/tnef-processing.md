---
title: TNEF 処理
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 4d324fb3-d917-4502-b3a4-179c479deb79
description: '�ŏI�X�V��: 2012�N7��5��'
ms.openlocfilehash: 066ad3dfb64161e326b92fef7774d5b3b9461d8a
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/23/2019
ms.locfileid: "32339600"
---
# <a name="tnef-processing"></a>TNEF 処理

  
  
**適用対象**: Outlook 2013 | Outlook 2016 
  
次の一連のアクションは、トランスポートが TNEF メソッドを使用して送信および受信メッセージを処理する方法を示しています。
  
 **TNEF ストリームを含むメッセージを送信するには**
  
1. メッセージングシステムでサポートされているメッセージのプロパティを処理します。
    
2. メッセージに特定の方法でマークを付けて、受信側トランスポートプロバイダーがメッセージに TNEF 処理を必要とするかどうかを判断できるようにします。 たとえば、tnef トランスポートプロバイダーが SMTP メッセージングシステムに送信すると、メッセージに tnef データが含まれていることを示すために、"X-CONTAINS-TNEF" などのカスタムヘッダーフィールドが追加されることがあります。
    
3. tnef オブジェクトを取得し、それを使用して、メッセージングシステムでサポートされていないメッセージプロパティを tnef ストリームにカプセル化します。
    
4. メッセージングシステムの添付モデルを使用して、TNEF ストリームをエンコードします。 たとえば、基になる添付ファイルモデルが uuencode の添付ファイルを対象としていて、メッセージテキストに追加されている場合、トランスポートプロバイダーは、別の添付ファイルに TNEF ストリームを uuencode する必要があります。 トランスポートプロバイダーは、メッセージを受信するときに、エンコードされた TNEF ストリームを含む添付ファイルを認識するためのメソッドも実装する必要があります。 この添付ファイルにマークを付ける標準的な方法は、添付ファイルのファイル名を「winmail.dat」にすることです。DAT "。 トランスポートプロバイダーがこれを行う場合、この規則に従う他の TNEF 対応のトランスポートプロバイダーは、これと相互運用することができます。
    
5. [ITnef: IUnknown](itnefiunknown.md)インターフェイスメソッドを使用して、メッセージの添付ファイルの位置を示すタグをメッセージテキストに挿入します。 
    
6. [IStream](https://msdn.microsoft.com/library/aa380034%28VS.85%29.aspx)メソッドを使用してタグ付きメッセージテキストにアクセスし、メッセージングシステムに送信します。 
    
 **カプセル化されたプロパティを取得するには**
  
1. メッセージングシステムによってサポートされるプロパティを新しいメッセージに書き込みます。これには、カプセル化されたプロパティを含むタグ付きメッセージテキストが含まれます。
    
2. 適切な添付ファイルから TNEF ストリームをデコードします。
    
3. 他の添付ファイルをデコードし、メッセージの新しい MAPI 添付ファイルに書き込みます。
    
4. [OpenTnefStreamEx](opentnefstreamex.md)関数を使用してデコードするために TNEF ストリームを開きます。 
    
5. TNEF ストリームをデコードし、カプセル化されたプロパティを新しいメッセージに書き込むには、 [ITnef:: ExtractProps](itnef-extractprops.md)メソッドを使用します。 エンコードされていないプロパティと重複しているエンコード済みのプロパティは、エンコードされたプロパティがデコードされるときに、エンコードされていないプロパティを上書きします。 
    
6. [ITnef:: OpenTaggedBody](itnef-opentaggedbody.md)メソッドを使用して、メッセージテキストを解析し、メッセージテキストのタグから添付ファイルの位置を復元します。 
    

