---
title: TNEF 処理
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 4d324fb3-d917-4502-b3a4-179c479deb79
description: '�ŏI�X�V��: 2012�N7��5��'
ms.openlocfilehash: 066ad3dfb64161e326b92fef7774d5b3b9461d8a
ms.sourcegitcommit: ef717c65d8dd41ababffb01eafc443c79950aed4
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 10/04/2018
ms.locfileid: "25399571"
---
# <a name="tnef-processing"></a>TNEF 処理

  
  
**適用対象**: Outlook 2013 | Outlook 2016 
  
次の一連のアクションでは、送信および受信メッセージを処理するトランスポートが TNEF のメソッドを使用する方法について説明します。
  
 **TNEF ストリームを含むメッセージを送信するのには**
  
1. メッセージング システムでサポートされているメッセージのプロパティを処理します。
    
2. メッセージを開封済みの実装で特定方法ため、受信側のトランスポート プロバイダーを判断できますメッセージが TNEF の処理を必要とします。 たとえば、SMTP メッセージング システムに送信する TNEF の転送プロバイダーは、"X-が含まれています-TNEF"メッセージで TNEF データが含まれていることを示すようにカスタム ヘッダー フィールドを追加できます。
    
3. TNEF オブジェクトを取得して、TNEF ストリームに、メッセージング システムでサポートされていないメッセージのプロパティをカプセル化します。
    
4. メッセージング システムの添付ファイルのモデルを使用して、TNEF ストリームをエンコードします。 などのアタッチメント モデルを基になる uuencode の添付ファイルには、それらをメッセージのテキストに追加し、トランスポート プロバイダーは、必要があります uuencode TNEF ストリーム別の添付ファイルにします。 トランスポート プロバイダーでは、どの添付ファイルにエンコード済みの TNEF ストリームが含まれている場合メッセージを受信したときを認識するためメソッドも実装する必要があります。 この添付ファイルをマークするための標準的な方法が"WINMAIL の添付ファイルの名前を指定するには。DAT"です。 トランスポート プロバイダーは、この規則に従っている他の TNEF を有効にしたトランスポート プロバイダーはこれと相互運用することになります。
    
5. 使用[ITnef: IUnknown](itnefiunknown.md)インターフェイスのメソッドはメッセージのテキストでのメッセージの添付ファイルの位置を記述するタグを挿入します。 
    
6. [IStream](https://msdn.microsoft.com/library/aa380034%28VS.85%29.aspx)の方法でタグ付けされたメッセージのテキストにアクセスし、メッセージング システムに送信します。 
    
 **カプセル化されたプロパティを取得するには**
  
1. カプセル化されたプロパティが含まれるタグ付きのメッセージのテキストを含む、新しいメッセージにメッセージング システムによってサポートされるプロパティを記述します。
    
2. 適切な添付ファイルの TNEF ストリームをデコードします。
    
3. 他のすべての添付ファイルをデコードし、新しい MAPI 添付ファイルにメッセージを書き込みます。
    
4. [OpenTnefStreamEx](opentnefstreamex.md)関数を使用してデコードの TNEF ストリームを開きます。 
    
5. TNEF ストリームをデコードし、新しいメッセージにカプセル化されたプロパティを書き込むには、 [ITnef::ExtractProps](itnef-extractprops.md)メソッドを使用します。 エンコードのプロパティは、デコードすると nonencoded プロパティを nonencoded プロパティの重複するエンコード済みのプロパティが上書きされます。 
    
6. [ITnef::OpenTaggedBody](itnef-opentaggedbody.md)メソッドを使用すると、メッセージのテキスト内のタグからの添付ファイルの位置を復元するのにメッセージのテキストを解析します。 
    

