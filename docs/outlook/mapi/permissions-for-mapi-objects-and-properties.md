---
title: MAPI のオブジェクトおよびプロパティのアクセス許可
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 32669cbe-5460-4043-99cc-c609608f48da
description: '最終更新日: 2011 年 7 月 23 日'
ms.openlocfilehash: 4efa9cd1596cffe19a19a62059f81fa553343d77
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/23/2019
ms.locfileid: "32348595"
---
# <a name="permissions-for-mapi-objects-and-properties"></a>MAPI のオブジェクトおよびプロパティのアクセス許可

  
  
**適用対象**: Outlook 2013 | Outlook 2016 
  
アクセス許可、または permissable 操作のセットは、MAPI オブジェクトと、それらのオブジェクトによってサポートされる個々のプロパティの特性になることがあります。 オブジェクトアクセスは、オブジェクトの親によって決定されます。 メッセージの場合、フォルダーはアクセス許可を決定します。 メッセージングユーザーまたは配布リストのアドレス帳コンテナーは、この判断を行います。 メッセージなどのオブジェクトが2つのフォルダーに存在する場合、そのオブジェクトの2つのコピーに対するアクセス許可が異なる場合があります。 
  
これらのオブジェクトを使用しているクライアントは、 [imapisession:: openentry](imapisession-openentry.md)呼び出しで MAPI_BEST_ACCESS フラグを設定することにより、オブジェクトに対して許可されている最高レベルのアクセス権を要求できます。 オブジェクトを実装するサービスプロバイダーによっては、クライアントに必要なアクセス許可レベルが付与されていない場合があります。 クライアントは、オブジェクトの**GetProps**メソッドを呼び出して**PR_ACCESS** ([PidTagAccess](pidtagaccess-canonical-property.md)) プロパティを取得することによって、付与されたアクセスのレベルを判断できます。 ただし、サービスプロバイダーはこのプロパティの値を動的に生成する必要があるため、クライアントは必要な場合にのみ取得することをお勧めします。 
  
フォルダー、アドレス帳コンテナー、配布リストなどのコンテナーが変更できるかどうかを確認するには、 **GetProps**メソッドを呼び出して**PR_ACCESS_LEVEL** ([PidTagAccessLevel](pidtagaccesslevel-canonical-property.md)) プロパティを取得します。 コンテナーレベルのアクセスは、クライアントがユーザーインターフェイスを表示する方法に基づいて影響を受けます。 また、コンテナー内のオブジェクトの実装には、ユーザーインターフェイスの表示とその一般的な実装の観点からも影響します。 
  
特定のプロパティへのアクセスは、プロパティを所有するオブジェクトの MAPI によって設定されたプロパティスキーマによって決まります。 プロパティスキーマは、オブジェクトの必須およびオプションのプロパティのセットとそのアクセス許可を指定します。 オブジェクトの親によって決定されるオブジェクトアクセスとは異なり、プロパティアクセスはグローバルになります。 オブジェクトの親のアクセス要件に関係なく、すべてのオブジェクトには、スキーマで決定されたプロパティに対して同じアクセス許可があります。
  
プロパティが読み取り専用の場合は、常に**GetProps**または**openproperty**呼び出しで使用できます。 ただし、プロパティをサポートしているオブジェクトの実装によっては、次の2つの結果があります。この場合、 **setprops**メソッドはプロパティを変更し、削除するために**deleteprops**メソッドを使用します。 
  
- Fail および return MAPI_E_NO_ACCESS
    
- 操作を実行せずに成功する
    
プロパティとオブジェクトへのアクセスは、 **imapiprop**インターフェイスから継承する[ipropdata](ipropdataimapiprop.md)インターフェイスを使用して取得または設定することもできます。 MAPI では、メモリ内のデータに基づく**ipropdata**の実装が提供されます。 サービスプロバイダーは、状態オブジェクトの場合や、組み込みトランザクションを持たないデータベースを使用している場合など、特定の状況で**imapiprop**を実装するために**ipropdata**を使用できます。 **ipropdata**はメモリ内でのみ動作するため、データをロックおよびロック解除する必要はありません。 
  
## <a name="see-also"></a>関連項目



[MAPI のプロパティの概要](mapi-property-overview.md)

