---
title: 新しい MAPI プロパティの定義
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 1a2325ea-ddfa-480f-b65f-f5b20471fb40
description: '最終更新日: 2011 年 7 月 23 日'
ms.openlocfilehash: 666ee413319765e39e25d586208f764afc93ae6b
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/28/2019
ms.locfileid: "33425016"
---
# <a name="defining-new-mapi-properties"></a>新しい MAPI プロパティの定義

  
  
**適用対象**: Outlook 2013 | Outlook 2016 
  
mapi によってクライアントおよびサービスプロバイダーで使用されるプロパティが豊富になっているにもかかわらず、mapi では、必要に応じて新しいプロパティを作成することができます。 新しいパブリックプロパティを定義するための有効なシナリオには、新しいメッセージクラスをサポートするためのプロパティを作成するクライアントと、一意のメッセージングシステム機能を公開するための新しいプロパティを作成するサービスプロバイダーがあります。
  
通常、サービスプロバイダーは、既存の MAPI オブジェクトまたはメッセージクラスの新しいプロパティを定義するのには無効です。 MAPI を使用する主な利点の1つは、多数のメッセージングシステム要素の標準の識別子と形式が設定されているため、ユーザーがサービスプロバイダーをシームレスに組み合わせて使用できるようになることです。 非標準プロパティを使用しているサービスプロバイダーは、他のサービスプロバイダーと同様に機能しません。 
  
クライアントは、次の方法で新しいメッセージクラスのコンテンツプロパティを作成できます。
  
- メッセージクラス固有のコンテンツプロパティに指定された範囲内でプロパティ識別子を使用します。
    
    - や
    
- 名前付きプロパティを使用します。 
    
すべてのサービスプロバイダーが名前付きプロパティをサポートするわけではないため、最初のオプションが推奨されます。 MAPI は、クライアントが新しいメッセージクラス固有のコンテンツプロパティに使用する2つの異なる範囲を定義します。
  
- 0x6800 から 0x7bff (の場合) のプロパティ
    
- ノン非対称テーブルプロパティの0x7C00
    
さまざまなベンダーまたはユーザーによって定義されたプロパティ間の競合を防止するため、プロパティ識別子は事前定義された範囲に分類する必要があります。 ただし、これらの範囲内のプロパティのユーザーは、プロパティの動作についての仮定を設定できません。 新しい message クラスを作成するすべてのクライアントは、これらの範囲にアクセスできます。識別子が_xxxx_のプロパティは、1つのメッセージクラスと別のメッセージクラスに対する別の動作の1つの動作を意味します。 
  
名前付きプロパティは、特定のプロパティがメッセージクラスに対して一意であることを保証するために使用されます。 名前付きプロパティの識別子は、0x8000 の範囲で始まります。 クライアントは1つ以上の名前を定義し、メッセージストアの[imapiprop:: getidsfromnames](imapiprop-getidsfromnames.md)メソッドを呼び出して、識別子を各名前に関連付けます。 名前付きプロパティは、オブジェクトの所有者が名前付きプロパティをサポートしている場合にのみ、任意のオブジェクトの新しいプロパティを定義するために、クライアントまたはサービスプロバイダーが使用できます。 これらのプロパティのユーザーは、 **getidsfromnames**と、関連する**imapiprop**メソッド[GetNamesFromIDs](imapiprop-getnamesfromids.md)を呼び出して、名前とその識別子の間のマッピングを行います。
  
新規または既存のすべてのプロパティは、あらかじめ定義されたプロパティの種類のセットを使用する必要があります。 新しいプロパティの種類を追加することはできません。また、既存の種類を変更または削除することはできません。 単純な小さなプロパティ (単一文字または16ビット整数プロパティなど) は、適切な型に格納できます。 たとえば、整数を**ULONG**として格納し、文字列を**PT_STRING8**として格納することができます。 
  
**PT_BINARY** type を使用して、カウントされたバイト配列を示します。 このプロパティの種類は、オブジェクトに格納できるデータの種類を拡張する場合に便利です。 バイトは順に転送され、データの意味については仮定されません。 クライアントアプリケーションがこのようなプロパティからデータを読み取る場合、データは格納された方法から変更されません。 クライアントは、cpu 間でデータを移動するときに、必要なバイト交換を実行する必要があります。 
  
## <a name="see-also"></a>関連項目



[MAPI のプロパティの概要](mapi-property-overview.md)

