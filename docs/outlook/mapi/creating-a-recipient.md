---
title: 受信者の作成
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 586c901f-d9f9-44f2-a328-051775a81265
description: '最終更新日: 2015 年 3 月 9 日'
ms.openlocfilehash: e14430d1539b90e089a9dabe1315384050f3dd5e
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/28/2019
ms.locfileid: "33429587"
---
# <a name="creating-a-recipient"></a><span data-ttu-id="5e629-103">受信者の作成</span><span class="sxs-lookup"><span data-stu-id="5e629-103">Creating a Recipient</span></span>

  
  
<span data-ttu-id="5e629-104">**適用対象**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="5e629-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="5e629-105">クライアントは、メッセージへのアドレス指定時、および変更可能なアドレス帳コンテナーにエントリを追加するときに受信者を作成します。</span><span class="sxs-lookup"><span data-stu-id="5e629-105">Clients create recipients when they are addressing messages and when they are adding entries to modifiable address book containers.</span></span> <span data-ttu-id="5e629-106">MAPI には、受信者を作成するための 3 つの方法があります。</span><span class="sxs-lookup"><span data-stu-id="5e629-106">MAPI provides three methods for creating recipients:</span></span>
  
- [<span data-ttu-id="5e629-107">IAddrBook::CreateOneOff</span><span class="sxs-lookup"><span data-stu-id="5e629-107">IAddrBook::CreateOneOff</span></span>](iaddrbook-createoneoff.md)
    
- [<span data-ttu-id="5e629-108">IAddrBook::NewEntry</span><span class="sxs-lookup"><span data-stu-id="5e629-108">IAddrBook::NewEntry</span></span>](iaddrbook-newentry.md)
    
- [<span data-ttu-id="5e629-109">IABContainer::CreateEntry</span><span class="sxs-lookup"><span data-stu-id="5e629-109">IABContainer::CreateEntry</span></span>](iabcontainer-createentry.md)
    
<span data-ttu-id="5e629-110">メッセージ **のアドレス指定に使用する受信者を作成するときに、IAddrBook::CreateOneOff** を呼び出します。</span><span class="sxs-lookup"><span data-stu-id="5e629-110">Call **IAddrBook::CreateOneOff** when you are creating recipients to be used to address messages.</span></span> <span data-ttu-id="5e629-111">**CreateOneOff** は、特定のアドレスの種類のアドレスに関連付けられる、特別に書式設定された 1 回限定のエントリ識別子を作成します。</span><span class="sxs-lookup"><span data-stu-id="5e629-111">**CreateOneOff** creates a specially formatted one-off entry identifier to be associated with an address of a particular address type.</span></span> <span data-ttu-id="5e629-112">1 回きりと 1 回のエントリ識別子の詳細については [、「One-Off Addresses](one-off-addresses.md) and [One-Off Entry IDENTIFIERs」を参照してください](one-off-entry-identifiers.md)。</span><span class="sxs-lookup"><span data-stu-id="5e629-112">For more information about one-offs and one-off entry identifiers, see [One-Off Addresses](one-off-addresses.md) and [One-Off Entry Identifiers](one-off-entry-identifiers.md).</span></span>
  
<span data-ttu-id="5e629-113">メッセージのアドレス指定またはコンテナーへの追加に使用する受信者を作成する場合は **、IAddrBook::NewEntry** を呼び出します。</span><span class="sxs-lookup"><span data-stu-id="5e629-113">Call **IAddrBook::NewEntry** when you are creating recipients to be used either to address messages or to add to a container.</span></span> <span data-ttu-id="5e629-114">**NewEntry には** 、エントリ識別子を含む 3 組のパラメーターがあります。</span><span class="sxs-lookup"><span data-stu-id="5e629-114">**NewEntry** has three pairs of parameters that contain entry identifiers.</span></span> <span data-ttu-id="5e629-115">これらのパラメーターについては、次のように説明します。</span><span class="sxs-lookup"><span data-stu-id="5e629-115">These parameters are described as follows:</span></span> 
  
|<span data-ttu-id="5e629-116">**パラメーターのペア**</span><span class="sxs-lookup"><span data-stu-id="5e629-116">**Parameter pair**</span></span>|<span data-ttu-id="5e629-117">**説明**</span><span class="sxs-lookup"><span data-stu-id="5e629-117">**Description**</span></span>|
|:-----|:-----|
| <span data-ttu-id="5e629-118">_cbEidContainer と_  _lpEidContainer_</span><span class="sxs-lookup"><span data-stu-id="5e629-118">_cbEidContainer_ and  _lpEidContainer_</span></span> <br/> |<span data-ttu-id="5e629-119">新しいエントリを配置するコンテナーのエントリ識別子。</span><span class="sxs-lookup"><span data-stu-id="5e629-119">Entry identifier for the container into which the new entry should be placed.</span></span>  <br/> |
| <span data-ttu-id="5e629-120">_cbEidNewEntryTpl と_  _lpEidNewEntryTpl_</span><span class="sxs-lookup"><span data-stu-id="5e629-120">_cbEidNewEntryTpl_ and  _lpEidNewEntryTpl_</span></span> <br/> |<span data-ttu-id="5e629-121">新しいエントリの作成に使用するテンプレートのエントリ識別子。</span><span class="sxs-lookup"><span data-stu-id="5e629-121">Entry identifier for the template to be used to create the new entry.</span></span>  <br/> |
| <span data-ttu-id="5e629-122">_lpcbEidNewEntry と_  _lppEidNewEntry_</span><span class="sxs-lookup"><span data-stu-id="5e629-122">_lpcbEidNewEntry_ and  _lppEidNewEntry_</span></span> <br/> |<span data-ttu-id="5e629-123">新しいエントリのエントリ識別子。</span><span class="sxs-lookup"><span data-stu-id="5e629-123">Entry identifier for the new entry.</span></span>  <br/> |
   
<span data-ttu-id="5e629-124">送信メッセージの受信者を作成するには  _、cbEidContainer_ を 0 に  _、lpEidContainer_ を NULL に設定します。</span><span class="sxs-lookup"><span data-stu-id="5e629-124">To create a recipient for an outgoing message, set  _cbEidContainer_ to zero and  _lpEidContainer_ to NULL.</span></span> <span data-ttu-id="5e629-125">**NewEntry は\*\*\*\*、IAddrBook::CreateOneOff** の呼び出しによって生成される受信者と同じ種類の 1 回の形式に準拠するエントリ識別子を持つ受信者を作成します。</span><span class="sxs-lookup"><span data-stu-id="5e629-125">**NewEntry** creates a recipient with an entry identifier that conforms to the one-off format, the same type of recipient that is produced by a call to **IAddrBook::CreateOneOff**.</span></span> 
  
<span data-ttu-id="5e629-126">特定のコンテナーに挿入する受信者を作成するには  _、lpEidContainer_ をコンテナーのエントリ識別子に  _、cbEidContainer_ をコンテナーのエントリ識別子のバイト数に設定します。</span><span class="sxs-lookup"><span data-stu-id="5e629-126">To create a recipient to be inserted into a particular container, set  _lpEidContainer_ to the container's entry identifier and  _cbEidContainer_ to the number of bytes in the container's entry identifier.</span></span> 
  
<span data-ttu-id="5e629-127">テンプレートを使用して受信者を作成するには  _、lpEidNewEntryTpl_ を使用するテンプレートのエントリ識別子  _、cbEidNewEntryTpl_ をこのエントリ識別子のバイト数に設定します。</span><span class="sxs-lookup"><span data-stu-id="5e629-127">To use a template to create a recipient, set  _lpEidNewEntryTpl_ to the entry identifier of the template to be used and  _cbEidNewEntryTpl_ to the count of bytes in this entry identifier.</span></span> <span data-ttu-id="5e629-128">ほとんどの変更可能なアドレス帳コンテナーは、特定の種類のエントリを作成するための 1 つ以上のテンプレートをサポートします。</span><span class="sxs-lookup"><span data-stu-id="5e629-128">Most modifiable address book containers support one or more templates for creating entries of a particular type.</span></span> <span data-ttu-id="5e629-129">通常、1 回限りテンプレートはダイアログ ボックスですが、必ずしもそうではありません。</span><span class="sxs-lookup"><span data-stu-id="5e629-129">One-off templates are typically, but not always, dialog boxes.</span></span> <span data-ttu-id="5e629-130">テンプレートに情報を入力すると、型の形式が正しいアドレスを持つ受信者が生成されます。</span><span class="sxs-lookup"><span data-stu-id="5e629-130">Entering information into the template produces a recipient with an address that is correctly formatted for the type.</span></span> 
  
<span data-ttu-id="5e629-131">次のいずれかの方法でテンプレートエントリ識別子を取得します。</span><span class="sxs-lookup"><span data-stu-id="5e629-131">Obtain the template entry identifier from either:</span></span>
  
- <span data-ttu-id="5e629-132">コンテナー **の 1** 回限りテーブルの **PR_ENTRYID** ([PidTagEntryId)](pidtagentryid-canonical-property.md)列は、コンテナーの [IMAPIProp::OpenProperty](imapiprop-openproperty.md)メソッドを呼び出し、PR_CREATE_TEMPLATES ([PidTagCreateTemplates](pidtagcreatetemplates-canonical-property.md)) をプロパティ タグとして、IID_IMAPITable をインターフェイス識別子として指定してアクセスします。</span><span class="sxs-lookup"><span data-stu-id="5e629-132">The **PR_ENTRYID** ([PidTagEntryId](pidtagentryid-canonical-property.md)) column in the container's one-off table, accessed by calling the container's [IMAPIProp::OpenProperty](imapiprop-openproperty.md) method and specifying **PR_CREATE_TEMPLATES** ([PidTagCreateTemplates](pidtagcreatetemplates-canonical-property.md)) as the property tag and IID_IMAPITable as the interface identifier.</span></span> 
    
- <span data-ttu-id="5e629-133">プロバイダーのメッセージング ユーザー オブジェクトおよび配布リスト テンプレートのエントリ識別子を保持するアドレス帳プロバイダーの **PR_DEF_CREATE_MAILUSER** ([PidTagDefCreateMailuser](pidtagdefcreatemailuser-canonical-property.md)) プロパティと **PR_DEF_CREATE_DL** ([PidTagDefCreateDl](pidtagdefcreatedl-canonical-property.md)) プロパティ。</span><span class="sxs-lookup"><span data-stu-id="5e629-133">An address book provider's **PR_DEF_CREATE_MAILUSER** ([PidTagDefCreateMailuser](pidtagdefcreatemailuser-canonical-property.md)) and **PR_DEF_CREATE_DL** ([PidTagDefCreateDl](pidtagdefcreatedl-canonical-property.md)) properties which hold the entry identifiers for the provider's messaging user object and distribution list templates.</span></span> 
    
> [!NOTE]
> <span data-ttu-id="5e629-134">新しいエントリ テンプレートのエントリ識別子と、テンプレート識別子と呼ばれる別の種類のエントリ識別子を混同しない。</span><span class="sxs-lookup"><span data-stu-id="5e629-134">Do not confuse a new entry template's entry identifier with a different type of entry identifier called a template identifier.</span></span> <span data-ttu-id="5e629-135">テンプレート識別子は、他のプロバイダーからコピーされたエントリを維持するためにプロバイダーによってのみ使用されます。クライアントでは使用されません。新しいエントリの作成には使用されません。</span><span class="sxs-lookup"><span data-stu-id="5e629-135">A template identifier is used only by providers to maintain entries copied from other providers; it is never used by clients and it is not used to create new entries.</span></span> 
  
<span data-ttu-id="5e629-136">ユーザーが作成するエントリの種類を決定するには  _、cbEidNewEntryTpl に 0、lpEidNewEntryTpl_ に NULL を  _渡します_。</span><span class="sxs-lookup"><span data-stu-id="5e629-136">To enable the user to determine the type of entry to be created, pass zero for  _cbEidNewEntryTpl_ and NULL for  _lpEidNewEntryTpl_.</span></span> <span data-ttu-id="5e629-137">この場合 **、NewEntry** は MAPI の一時テーブルから構築された共通のダイアログ ボックスを表示します。プロファイル内の各アドレス帳プロバイダーでサポートされるテンプレートの階層リストです。</span><span class="sxs-lookup"><span data-stu-id="5e629-137">When this occurs, **NewEntry** displays a common dialog box built from MAPI's one-off table — a hierarchical list of all of the templates supported by each address book provider in the profile.</span></span> 
  
<span data-ttu-id="5e629-138">アドレスの種類が決定された場合は  _、lpEidNewEntryTpl_ パラメーターの設定、または一時テーブル表示からのユーザーによる選択のいずれかによって **、NewEntry** は対応するテンプレートを表示テーブルを使用して表示します。</span><span class="sxs-lookup"><span data-stu-id="5e629-138">When an address type has been determined, either through the setting of the  _lpEidNewEntryTpl_ parameter or a selection by the user from the one-off table display, **NewEntry** displays the corresponding template using its display table.</span></span> <span data-ttu-id="5e629-139">すべての新しいエントリ テンプレートは **、PR_DETAILS_TABLE** ([PidTagDetailsTable](pidtagdetailstable-canonical-property.md)) プロパティをサポートします。</span><span class="sxs-lookup"><span data-stu-id="5e629-139">All new entry templates support the **PR_DETAILS_TABLE** ([PidTagDetailsTable](pidtagdetailstable-canonical-property.md)) property.</span></span> 
  
<span data-ttu-id="5e629-140">**NewEntry** に作成されたエントリのエントリ識別子を返す場合は _、lpcbEidNewEntry_ パラメーターと _lppEidNewEntry_ パラメーターの有効なアドレスを渡します。</span><span class="sxs-lookup"><span data-stu-id="5e629-140">To have **NewEntry** return the entry identifier of the created entry, pass a valid address for the  _lpcbEidNewEntry_ and  _lppEidNewEntry_ parameters.</span></span> <span data-ttu-id="5e629-141">MAPI は  _、lppEidNewEntry_ が指すアドレスに新しいエントリ識別子を、新しいエントリ識別子のバイト 数を  _lpcbEidNewEntry_ が指すアドレスに格納します。</span><span class="sxs-lookup"><span data-stu-id="5e629-141">MAPI places the new entry identifier at the address pointed to by  _lppEidNewEntry_ and the byte count of the new entry identifier at the address pointed to by  _lpcbEidNewEntry_.</span></span>
  
<span data-ttu-id="5e629-142">[IABContainer::CreateEntry](iabcontainer-createentry.md)を呼び出して受信者を作成し、それを特定のアドレス帳コンテナーに保存します。</span><span class="sxs-lookup"><span data-stu-id="5e629-142">Call [IABContainer::CreateEntry](iabcontainer-createentry.md) to create a recipient and save it into a particular address book container.</span></span> <span data-ttu-id="5e629-143">このメソッドは、PR_CONTAINER_FLAGS **(** [PidTagContainerFlags](pidtagcontainerflags-canonical-property.md)) プロパティに AB_MODIFIABLE フラグが設定されている変更可能なコンテナーでのみ使用できます。</span><span class="sxs-lookup"><span data-stu-id="5e629-143">You can use this method only with modifiable containers — containers that have the AB_MODIFIABLE flag set in their **PR_CONTAINER_FLAGS** ([PidTagContainerFlags](pidtagcontainerflags-canonical-property.md)) property.</span></span> <span data-ttu-id="5e629-144">変更できないコンテナーを持つアドレス帳プロバイダーでは、このメソッドはサポートされていません。</span><span class="sxs-lookup"><span data-stu-id="5e629-144">Address book providers with nonmodifiable containers do not support this method.</span></span> <span data-ttu-id="5e629-145">_lpEntryID_ パラメーターに目的の型のエントリを作成するためのテンプレートのエントリ識別子を指定します。</span><span class="sxs-lookup"><span data-stu-id="5e629-145">Specify the entry identifier of the template for creating an entry of the desired type in the  _lpEntryID_ parameter.</span></span> 
  
<span data-ttu-id="5e629-146">_ulCreateFlags_ パラメーターで、必要な重複エントリチェックの種類と、新しいエントリが既存のエントリを置き換えるかどうかを指定します。</span><span class="sxs-lookup"><span data-stu-id="5e629-146">In the  _ulCreateFlags_ parameter, specify the type of duplicate entry checking required and whether or not new entries should replace existing ones.</span></span> <span data-ttu-id="5e629-147">**CreateEntry が** プロバイダーによって課せられた重複するエントリチェックのために新しいオブジェクトを作成できない場合は、エラーまたは警告が返されるのを期待しません。</span><span class="sxs-lookup"><span data-stu-id="5e629-147">If **CreateEntry** fails to create a new object because of the duplicate entry checking imposed by the provider, do not expect to see an error or warning returned.</span></span> <span data-ttu-id="5e629-148">これらの条件では、プロバイダーは成功コードを返します。</span><span class="sxs-lookup"><span data-stu-id="5e629-148">Under these conditions, providers return a success code.</span></span> 
  
<span data-ttu-id="5e629-149">コンテナーを直接操作し、コンテナーが作成できるアドレスの種類を正確に把握している場合は **、IABContainer::CreateEntry** を呼び出して、適切なテンプレートのエントリ識別子を渡します。</span><span class="sxs-lookup"><span data-stu-id="5e629-149">If you are working directly with a container and you know exactly the types of addresses that the container can create, you can call **IABContainer::CreateEntry** and pass the entry identifier for the appropriate template.</span></span> <span data-ttu-id="5e629-150">アドレス帳プロバイダーは、初期の既定のプロパティを設定します。 **SetProps を呼び出して他** のユーザーを設定できます。</span><span class="sxs-lookup"><span data-stu-id="5e629-150">The address book provider sets some initial default properties; you can call **SetProps** to set others.</span></span> <span data-ttu-id="5e629-151">ユーザーは関与しない。</span><span class="sxs-lookup"><span data-stu-id="5e629-151">The user is never involved.</span></span> 
  

