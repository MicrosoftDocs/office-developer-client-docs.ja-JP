---
title: フォームビューアーの実装
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: a567185c-bd72-4307-928c-08cac5494c1a
description: '最終更新日: 2011 年 7 月 23 日'
ms.openlocfilehash: bbd0792b0e3e3f274797fabd7f5d5eb49cfc73fd
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/23/2019
ms.locfileid: "32332894"
---
# <a name="implementing-a-form-viewer"></a>フォームビューアーの実装

  
  
**適用対象**: Outlook 2013 | Outlook 2016 
  
フォームビューアーには、メッセージサイト、ビューアドバイズシンク、ビューコンテキストという3つのオブジェクトが含まれています。 これらの各オブジェクトを使用すると、フォームサーバーとそのフォームを操作できます。
  
メッセージサイトは、 [IMAPIMessageSite: IUnknown](imapimessagesiteiunknown.md)インターフェイスを実装し、メッセージの移動、保存、削除、新しいメッセージの作成、新しいフォームサーバーの起動などのタスクをフォームサーバーに対して支援するオブジェクトです。 メッセージサイトは、さまざまなサービスプロバイダーに関して、クライアントの状態に関する情報を取得するためにフォームによって使用されます。 たとえば、フォームでメッセージサイトを使用して、現在のメッセージストア、メッセージ、またはフォルダーへのポインターを取得することができます。 
  
**IMAPIMessageSite**インターフェイスには、次の2種類のメソッドがあります。 
  
- フォームオブジェクトに情報を提供するメソッド。
    
- メッセージを操作するメソッド。
    
フォームオブジェクトに情報を提供するメソッドは、簡単に実装できます。 [IMAPIMessageSite:: getsitestatus](imapimessagesite-getsitestatus.md)を除くすべての場合に、各メソッドで必要な情報が既に提供されているはずです。
  
メッセージを操作するメソッドは、通常のユーザーインターフェイスを使用してトリガーされた場合と同じように動作する必要があります。 たとえば、form オブジェクトが[IMAPIMessageSite:: newmessage](imapimessagesite-newmessage.md)メソッドを呼び出す場合は、ユーザーが通常のユーザーインターフェイスで新しいカスタムメッセージを作成することを選択した場合と同じように動作します。 通常、この動作を生成するコマンドには、**新規作成**、**オープン**、**返信**、**すべての受信者への返信**、**転送**があります。 
  
ビューコンテキストは、 [imapiviewcontext: IUnknown](imapiviewcontextiunknown.md)インターフェイスを実装するオブジェクトで、現在のメッセージのコンテキストを備えたフォームサーバーを提供します。これにより、サーバーは、フォルダー内の次または前のメッセージに簡単に切り替えることができます。 フォームは、情報の共有にビューコンテキストを使用します。 ビューコンテキストオブジェクトを使用すると、フォームは次のことができます。 
  
- 通知のためにクライアントに登録します。
    
- フォルダー内の次または前のメッセージをアクティブにします。
    
- 印刷情報を取得します。
    
- クライアントの状態を取得します。
    
- メッセージのテキストバージョンを保存するために使用できるストリームを取得します。
    
[IMAPIMessageSite: IUnknown](imapimessagesiteiunknown.md)インターフェイスのメソッドと同様に、 **imapiviewcontext**のメソッドは、ビューコンテキストに関連するユーザー操作とクライアント機能に関連付けられています。 たとえば、ビューコンテキストは、次または前のメッセージをアクティブにし、フォルダーの内容を並べ替え、フォルダーのコンテンツをフィルター処理するために使用されます。 
  
ユーザーがこれらの機能をアクティブにするためにどのようなメカニズムを提供するかは重要ではありませんが、これらの機能のセマンティックが**imapiviewcontext**インターフェイスのメソッドに適切にマップされていることが重要です。 
  
view アドバイズシンクは、 [IMAPIViewAdviseSink: IUnknown](imapiviewadvisesinkiunknown.md)インターフェイスを実装し、閲覧者に影響するフォームサーバーからの通知を処理し、共同作業を行うためのヘルプフォームおよびフォームビューアーを処理するオブジェクトです。 詳細については、「[フォーム通知の送信と受信](sending-and-receiving-form-notifications.md)」を参照してください。 
  

