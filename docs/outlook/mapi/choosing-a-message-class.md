---
title: メッセージクラスの選択
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 5ca8edd2-41b7-40e2-b755-b28eecb49786
description: '最終更新日: 2011 年 7 月 23 日'
ms.openlocfilehash: 279df7f07c8c8b66347488c6224d04f70292e968
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/23/2019
ms.locfileid: "32285259"
---
# <a name="choosing-a-message-class"></a>メッセージクラスの選択

  
  
**適用対象**: Outlook 2013 | Outlook 2016 
  
「 [MAPI メッセージクラス](mapi-message-classes.md)」で説明されているように、メッセージクラスは、カスタムメッセージの種類とフォームサーバーの間の関係を確立する上で重要です。 さいわい、メッセージクラスの文字列を選択するのは非常に簡単です。 メッセージクラスのメッセージクラスの文字列は任意の文字列ですが、次の規則を使用する必要があります。
  
- 文字列は、 **PR_MESSAGE_CLASS** ([PidTagMessageClass](pidtagmessageclass-canonical-property.md)) プロパティのドキュメントで説明されているすべての規則を満たしている必要があります。 重要なのは、文字列が ANSI 文字で構成されていて、長さが256文字未満であることです。
    
- フォームサーバーが既存のフォームサーバーから派生している場合、または既存のフォームサーバーの拡張機能である場合、メッセージクラスの文字列は、フォームの基になっているフォームサーバーのメッセージクラスの文字列にピリオドと別の単語を追加して作成する必要があります。 たとえば、会議を再スケジュールするためのフォームを実装し、フォームが会議をスケジュールするための既存のフォームに基づいているとします。 会議スケジュールフォームのメッセージクラスの文字列が "IPM.会議 "、メッセージクラス文字列は" IPM.会議の再スケジュール "。
    
- フォームが既存のフォームに基づいていない場合でも、メッセージクラスの文字列は "IPM." で始まっている必要があります。 または "IPC." プレフィックス。フォームが個人または他のアプリケーションによって受信されることを意図しているかどうかによって決まります。 "IPM." ユーザーの受信トレイで通常は終了する、個人間メッセージを指定します。 通常、ユーザーの受信トレイに配信されないプロセス間通信メッセージを指定します。
    
- メッセージクラスが人間に判読可能であることを意図している場合、メッセージクラスの文字列は "IPM." で始まる必要があります。 通常、メッセージクラスは、プレーンテキスト、HTML、またはリッチテキスト形式 (RTF) のデータを含むプロパティを使用している場合は、人間が判読可能であると見なされます。 フォームで**PR_BODY** ([PidTagBody](pidtagbody-canonical-property.md)) プロパティを使用している場合は、ほとんどの場合、"IPM." を使用する必要があります。 メッセージクラスの文字列。 たとえば、発注書用のフォームを実装していて、組織でその注文書が上司に承認されることを要求している場合、メッセージクラスの文字列は "IPM.Purchase_Order "。 一般に、パブリックフォルダーまたはパブリックフォルダーアプリケーションで使用するように設計されているフォームは、人物の電子メールアドレスに実際にアドレス指定されていない場合でも、ユーザーによって読み取られるため、個人外と見なされます。 パブリックフォルダーのメッセージクラスの一般的なプレフィックスは、"IPM.Post "。 
    
- メッセージクラスが、ユーザーではなく、別のアプリケーションによって受信されることを意図している場合、メッセージクラスの文字列は "IPC." で始まる必要があります。 たとえば、ユーザーが自動的にメーリングリストを購読できるようにするフォームを実装する場合、メッセージクラスの文字列は "IPC" にすることができます。Subscribe "。
    
- メッセージクラスの文字列の末尾にピリオドを使用することはできません。
    
メッセージクラスの文字列は、次のように、 **messageclass**エントリのフォーム構成ファイルの **[Description]** セクションに配置する必要があります。 
  
 `MessageClass=IPM.Meeting.Reschedule`
  
適切なメッセージクラスの文字列を選択したら、その文字列のクラス識別子を生成する必要があります。 クラス識別子は、Visual Studio に含まれる**Create GUID**コマンドを使用して生成できます。 クラス識別子は、次のように、フォーム構成ファイルの**CLSID**エントリおよび**messageclass**エントリに配置する必要があります。 
  
 `CLSID={88FFF551-B8C5-11ce-8DE0-00AA0060D242}`
  
もちろん、クラス識別子はほぼ確実に異なるものです。 詳細については、「[フォーム構成ファイルを作成](creating-a-form-configuration-file.md)する」を参照してください。
  
ユーザーのコンピューターにフォームがインストールされている場合、インストールプロセス (セットアッププログラムであるかどうかにかかわらず) は、クラス識別子のレジストリの **HKEY_CLASSES_ROOT\CLSID\* *セクションにレジストリエントリを作成する必要があります。 このエントリは、メッセージクラスの文字列に設定する必要があります。 たとえば、上記のクラス識別子の例については、次のようなレジストリエントリを作成します。 
  
 `HKEY_CLASSES_ROOT\CLSID\{88FFF551-B8C5-11ce-8DE0-00AA0060D242}="IPM.Meeting.Reschedule"`
  
詳細については、「[ライブラリへのフォームのインストール](installing-a-form-into-a-library.md)」を参照してください。
  
## <a name="see-also"></a>関連項目



[MAPI フォームサーバーの開発](developing-mapi-form-servers.md)

