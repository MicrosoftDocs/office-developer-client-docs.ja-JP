---
title: MAPI スプーラーの概要
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 5866b202-883e-454e-aeb1-61526c43dae9
description: '最終更新日: 2011 年 7 月 23 日'
ms.openlocfilehash: 162957ea17b5a82d4da68340e971d328c85cd9f7
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/23/2019
ms.locfileid: "32309582"
---
# <a name="mapi-spooler-overview"></a>MAPI スプーラーの概要
  
**適用対象**: Outlook 2013 | Outlook 2016 
  
MAPI スプーラーは、メッセージングシステムとの間でメッセージの送受信を行う Microsoft Office Outlook プロセスの機能です。 MAPI スプーラーは、メッセージの受信と配信で重要な役割を果たします。 メッセージングシステムが使用できなくなると、MAPI スプーラーはメッセージを保存し、後で自動的に転送します。 必要に応じてデータを保持または送信できるようにする機能は、「ストアアンドフォワード」と呼ばれていますが、リモート接続が共通でネットワークトラフィックが多い環境で重要な機能です。 MAPI スプーラーは、Outlook 内でバックグラウンドスレッドとして実行されます。
  
MAPI スプーラーには、メッセージの配布に関連する追加の責任があります。 これらの追加の職務には、次のようなものがあります。
  
- 特定のトランスポートプロバイダーによって処理される受信者の種類を追跡します。
    
- 新しいメッセージが配信されたときに、クライアントアプリケーションに通知します。
    
- メッセージ前処理と後処理を呼び出します。
    
- メッセージ配信が発生したことを示すレポートを生成します。
    
- 処理された受信者の状態を維持します。
    
次の図は、メッセージがクライアントからメッセージングシステムに送られる方法の概要を示しています。
  
**出力メッセージ フロー**
  
![送信メッセージフロー](media/amapi_46.gif "送信メッセージフロー")
  
クライアントアプリケーションのユーザーが1人以上の受信者にメッセージを送信します。 メッセージストアプロバイダーが送信プロセスを開始し、送信に必要な追加情報をメッセージに書式設定します。
  
MAPI スプーラーは、次のいずれかの状況が発生した場合に処理するメッセージを受信します。
  
- メッセージストアプロバイダーがトランスポートプロバイダーと密接に結合されていません。
    
- メッセージには前処理が必要です。
    
- メッセージストアとトランスポートプロバイダーは密接に結合されていますが、メッセージの宛先になっているすべての受信者を処理することはできません。
    
MAPI スプーラーは、メッセージを受信すると、必要な前処理を実行し、適切なトランスポートプロバイダーにメッセージを配信します。 トランスポートプロバイダーは、メッセージをメッセージングシステムに渡します。メッセージは、目的の受信者に送信されます。
  
受信メッセージの場合、フローは取り消されます。 トランスポートプロバイダーは、メッセージングシステムからメッセージを受信し、MAPI スプーラーに通知します。 スプーラーは必要な後処理を実行し、新しいメッセージが到着したことをメッセージストアプロバイダーに通知します。 この通知により、クライアントはメッセージの表示を更新し、ユーザーが新しいメッセージを読むことができるようになります。
  
## <a name="see-also"></a>関連項目

- [MAPI の機能とアーキテクチャ](mapi-features-and-architecture.md)

