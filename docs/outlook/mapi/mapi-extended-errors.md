---
title: MAPI �g���G���[
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: b0a9fc55-f4ab-45d8-98cc-b040f9ef6aa4
description: '�ŏI�X�V��: 2011�N7��23��'
ms.openlocfilehash: e5bffa0753e3d8c86e737a96cfd303be7bcd97f3
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/28/2019
ms.locfileid: "33405612"
---
# <a name="mapi-extended-errors"></a><span data-ttu-id="64902-103">MAPI �g���G���[</span><span class="sxs-lookup"><span data-stu-id="64902-103">MAPI Extended Errors</span></span>

  
  
<span data-ttu-id="64902-104">**適用対象**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="64902-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="64902-p101">Implementers of interface methods can choose to simply return success (S_OK) and failure (MAPI_E_CALL_FAILED) or differentiate between error conditions, returning as many error values as make sense for the situation. Most situations can use one of the error values defined by MAPI in the MAPICODE.H header file. However, for situations that are not covered by a predefined value, the value MAPI_E_EXTENDED_ERROR can be used. MAPI_E_EXTENDED_ERROR indicates to the caller that more information about the error is available. The caller retrieves the additional information by calling the **GetLastError** method on the same object that returned MAPI_E_EXTENDED_ERROR.</span><span class="sxs-lookup"><span data-stu-id="64902-p101">Implementers of interface methods can choose to simply return success (S_OK) and failure (MAPI_E_CALL_FAILED) or differentiate between error conditions, returning as many error values as make sense for the situation. Most situations can use one of the error values defined by MAPI in the MAPICODE.H header file. However, for situations that are not covered by a predefined value, the value MAPI_E_EXTENDED_ERROR can be used. MAPI_E_EXTENDED_ERROR indicates to the caller that more information about the error is available. The caller retrieves the additional information by calling the **GetLastError** method on the same object that returned MAPI_E_EXTENDED_ERROR.</span></span> 
  
 <span data-ttu-id="64902-p102">**GetLastError** can be called to retrieve information about any error code, not only MAPI_E_EXTENDED_ERROR. Many MAPI objects implement interfaces that include the **GetLastError** method. **GetLastError** returns a single **MAPIERROR** structure that, in theory, includes a concatenation of all the errors generated by the previous method call. For more information, see [MAPIERROR](mapierror.md). As a caller, it is wise not to depend on having this extra error information available because object implementers are not required to provide it. However, it is strongly recommended that whenever implementers return MAPI_E_EXTENDED_ERROR, they make it possible for callers to retrieve a **MAPIERROR** structure with useful information about the error.</span><span class="sxs-lookup"><span data-stu-id="64902-p102">**GetLastError** can be called to retrieve information about any error code, not only MAPI_E_EXTENDED_ERROR. Many MAPI objects implement interfaces that include the **GetLastError** method. **GetLastError** returns a single **MAPIERROR** structure that, in theory, includes a concatenation of all the errors generated by the previous method call. For more information, see [MAPIERROR](mapierror.md). As a caller, it is wise not to depend on having this extra error information available because object implementers are not required to provide it. However, it is strongly recommended that whenever implementers return MAPI_E_EXTENDED_ERROR, they make it possible for callers to retrieve a **MAPIERROR** structure with useful information about the error.</span></span> 
  
<span data-ttu-id="64902-p103">Because **GetLastError** is also an API function that is part of the Windows SDK, it can be easy to forget that in MAPI, **GetLastError** is an interface method and can only be called on MAPI objects. Another easy mistake to make is calling **GetLastError** on the wrong object. **GetLastError** must be called on the object that generated the error. For example, if your client makes a session call, and MAPI forwards the call to a service provider to do the work, your client should not call **GetLastError** on the service provider object. **IMAPISession::GetLastError** is the correct call; **GetLastError** should be invoked on the session object. For more information, see [IMAPISession::GetLastError](imapisession-getlasterror.md).</span><span class="sxs-lookup"><span data-stu-id="64902-p103">Because **GetLastError** is also an API function that is part of the Windows SDK, it can be easy to forget that in MAPI, **GetLastError** is an interface method and can only be called on MAPI objects. Another easy mistake to make is calling **GetLastError** on the wrong object. **GetLastError** must be called on the object that generated the error. For example, if your client makes a session call, and MAPI forwards the call to a service provider to do the work, your client should not call **GetLastError** on the service provider object. **IMAPISession::GetLastError** is the correct call; **GetLastError** should be invoked on the session object. For more information, see [IMAPISession::GetLastError](imapisession-getlasterror.md).</span></span>
  

