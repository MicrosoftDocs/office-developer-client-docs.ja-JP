---
title: MAPI �g���G���[
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: b0a9fc55-f4ab-45d8-98cc-b040f9ef6aa4
description: '�ŏI�X�V��: 2011�N7��23��'
ms.openlocfilehash: 38e9418d5d9559b67bd79536635359ffaa3f724d
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 06/11/2018
ms.locfileid: "19801345"
---
# <a name="mapi-extended-errors"></a><span data-ttu-id="3408a-103">MAPI �g���G���[</span><span class="sxs-lookup"><span data-stu-id="3408a-103">MAPI Extended Errors</span></span>

  
  
<span data-ttu-id="3408a-104">**適用対象**: Outlook</span><span class="sxs-lookup"><span data-stu-id="3408a-104">**Applies to**: Outlook</span></span> 
  
<span data-ttu-id="3408a-105">(S_OK) の成功と失敗 (MAPI_E_CALL_FAILED) を単に返すか、エラー条件、状況に適した、多くのエラー値を返すことの間で区別するためにインターフェイス メソッドの実装を選択できます。</span><span class="sxs-lookup"><span data-stu-id="3408a-105">Implementers of interface methods can choose to simply return success (S_OK) and failure (MAPI_E_CALL_FAILED) or differentiate between error conditions, returning as many error values as make sense for the situation.</span></span> <span data-ttu-id="3408a-106">ほとんどの場合に、MAPICODE では、MAPI によって定義されているエラー値のいずれかを使用できます。H ヘッダー ファイルです。</span><span class="sxs-lookup"><span data-stu-id="3408a-106">Most situations can use one of the error values defined by MAPI in the MAPICODE.H header file.</span></span> <span data-ttu-id="3408a-107">ただし、状況のことは説明しませんで定義済みの値、値の MAPI_E_EXTENDED_ERROR を使用することができます。</span><span class="sxs-lookup"><span data-stu-id="3408a-107">However, for situations that are not covered by a predefined value, the value MAPI_E_EXTENDED_ERROR can be used.</span></span> <span data-ttu-id="3408a-108">MAPI_E_EXTENDED_ERROR は、呼び出し元に、エラーに関する詳細情報があることを示します。</span><span class="sxs-lookup"><span data-stu-id="3408a-108">MAPI_E_EXTENDED_ERROR indicates to the caller that more information about the error is available.</span></span> <span data-ttu-id="3408a-109">呼び出し元は、MAPI_E_EXTENDED_ERROR が返されますが同じオブジェクトを**返します**メソッドを呼び出して、追加情報を取得します。</span><span class="sxs-lookup"><span data-stu-id="3408a-109">The caller retrieves the additional information by calling the **GetLastError** method on the same object that returned MAPI_E_EXTENDED_ERROR.</span></span> 
  
 <span data-ttu-id="3408a-110">MAPI_E_EXTENDED_ERROR だけでなく、すべてのエラー コードに関する情報を取得するのには、 **GetLastError**を呼び出すことができます。</span><span class="sxs-lookup"><span data-stu-id="3408a-110">**GetLastError** can be called to retrieve information about any error code, not only MAPI_E_EXTENDED_ERROR.</span></span> <span data-ttu-id="3408a-111">MAPI オブジェクトの多くは、 **GetLastError**メソッドを含むインターフェイスを実装します。</span><span class="sxs-lookup"><span data-stu-id="3408a-111">Many MAPI objects implement interfaces that include the **GetLastError** method.</span></span> <span data-ttu-id="3408a-112">**GetLastError**を含んだ、理論的には、連結前のメソッドの呼び出しによって生成されたすべてのエラーの 1 つ**MAPIERROR**構造体を返します。</span><span class="sxs-lookup"><span data-stu-id="3408a-112">**GetLastError** returns a single **MAPIERROR** structure that, in theory, includes a concatenation of all the errors generated by the previous method call.</span></span> <span data-ttu-id="3408a-113">詳細については、 [MAPIERROR](mapierror.md)を参照してください。</span><span class="sxs-lookup"><span data-stu-id="3408a-113">For more information, see [MAPIERROR](mapierror.md).</span></span> <span data-ttu-id="3408a-114">、呼び出し元としては、オブジェクトの実装側が提供することを必須ではありませんのでこの追加のエラー情報を利用することに依存することをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="3408a-114">As a caller, it is wise not to depend on having this extra error information available because object implementers are not required to provide it.</span></span> <span data-ttu-id="3408a-115">ただし、実装者は、MAPI_E_EXTENDED_ERROR を返すときにできるため、エラーに関する有用な情報を含む**MAPIERROR**構造体を取得する呼び出し元を強くお勧めします。</span><span class="sxs-lookup"><span data-stu-id="3408a-115">However, it is strongly recommended that whenever implementers return MAPI_E_EXTENDED_ERROR, they make it possible for callers to retrieve a **MAPIERROR** structure with useful information about the error.</span></span> 
  
<span data-ttu-id="3408a-116">**GetLastError**は Windows SDK の一部である API 関数でもあるので、忘れ、MAPI の**GetLastError**インターフェイス メソッドでは、MAPI オブジェクトにのみと呼ばれることができますができます。</span><span class="sxs-lookup"><span data-stu-id="3408a-116">Because **GetLastError** is also an API function that is part of the Windows SDK, it can be easy to forget that in MAPI, **GetLastError** is an interface method and can only be called on MAPI objects.</span></span> <span data-ttu-id="3408a-117">別の簡単なミス、不適切なオブジェクトに**GetLastError**を呼び出しています。</span><span class="sxs-lookup"><span data-stu-id="3408a-117">Another easy mistake to make is calling **GetLastError** on the wrong object.</span></span> <span data-ttu-id="3408a-118">エラーを生成したオブジェクトには、 **GetLastError**を呼び出す必要があります。</span><span class="sxs-lookup"><span data-stu-id="3408a-118">**GetLastError** must be called on the object that generated the error.</span></span> <span data-ttu-id="3408a-119">などを呼び出すと、セッションで、クライアントは、MAPI 処理のためには、サービス プロバイダーへの呼び出しを転送する場合は、クライアント呼び出さないでください。 **GetLastError**サービス プロバイダー オブジェクト。</span><span class="sxs-lookup"><span data-stu-id="3408a-119">For example, if your client makes a session call, and MAPI forwards the call to a service provider to do the work, your client should not call **GetLastError** on the service provider object.</span></span> <span data-ttu-id="3408a-120">**IMAPISession::GetLastError**は、適切な呼び出しです。セッション オブジェクトの**GetLastError**を呼び出す必要があります。</span><span class="sxs-lookup"><span data-stu-id="3408a-120">**IMAPISession::GetLastError** is the correct call; **GetLastError** should be invoked on the session object.</span></span> <span data-ttu-id="3408a-121">詳細については、 [IMAPISession::GetLastError](imapisession-getlasterror.md)を参照してください。</span><span class="sxs-lookup"><span data-stu-id="3408a-121">For more information, see [IMAPISession::GetLastError](imapisession-getlasterror.md).</span></span>
  

