---
title: アドバイズ シンク オブジェクトを実装します。
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 7461c4f6-7030-4ba2-ada4-26ebfbbfa001
description: '�ŏI�X�V��: 2015�N3��9��'
ms.openlocfilehash: a95222f8ec75c519558636cf54111f28cbe14066
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 06/11/2018
ms.locfileid: "19800928"
---
# <a name="implementing-an-advise-sink-object"></a>アドバイズ シンク オブジェクトを実装します。

  
  
**適用されます**: Outlook 
  
クライアント独自のアドバイズ シンク オブジェクトを実装するか、 [HrAllocAdviseSink](hrallocadvisesink.md)のユーティリティ関数を使用します。 **HrAllocAdviseSink**は、コールバック関数を呼び出す**OnNotify**の実装とアドバイズ シンク オブジェクトを作成します。 
  
**HrAllocAdviseSink**を使用してに長所と短所があります。 作業を保存することができますが、参照カウントのアドバイズ シンク オブジェクトを作成する上でのコントロールが用意されていません。 したがって、クライアントがアドバイズ シンクのリリースを慎重に制御する必要があるか、アドバイズ シンクと別のクライアント オブジェクトとの間の相互依存関係があるが**IMAPIAdviseSink**の独自の実装を構築し、**を使用しないようにする必要があります。HrAllocAdviseSink**完全です。 
  
クライアント独自のアドバイズ シンクを実装する必要がありますように独立したオブジェクトに関連するまたはその他のオブジェクトの参照カウントと、オブジェクトのリリースでの潜在的な複雑な問題をなくすために依存しません。 ただし場合は、別のオブジェクトの一部として、アドバイズ シンクを実装する必要がありますかデータ メンバーとして別のオブジェクトへのバック ポインターを含めると、お勧め 2 つの個別の参照カウントを維持する: アドバイズ シンクとのいずれかによって参照されるオブジェクトのいずれか、シンクをアドバイスします。 
  
参照されるオブジェクトの参照カウントがゼロに達する、そのメソッドのすべてが失敗することができますとその vtable を破棄することができます、ですがアドバイズ シンク用のメモリ必要がありますまままで、参照カウントがゼロになるも後です。 つまり、アドバイズ シンクの**Release**メソッドが、参照カウントをデクリメントして完了、その数が 0 になったときに、オブジェクトを破棄する必要があります。 2 つの個別の参照カウントは変更されない、外側にあるオブジェクトの**リリース**プロセスの一環としてアドバイズ シンクを誤って破棄するのには簡単になります。 
  
アドバイズ シンクを実装するために**HrAllocAdviseSink**を使用するクライアントは、アドバイズ シンク オブジェクトを別の方法として、コールバック関数を含める必要はありません同じように注意が必要である必要があります。 C++ クライアントの場合は、することは避けてこの操作を行うし、_この_ポインターをパラメーターとして渡します。 これは、クライアントは、その参照カウントがゼロになると、通常オブジェクトを解放するために危険な戦略です。 アドバイズ シンク オブジェクトのメモリの解放が無効になる_この_ポインター。 
  
**OnNotify**メソッドは、イベントやアドバイスのソースの種類に応じて、さまざまな方法でのイベントを処理できます。 次の表は、標準のイベントを処理する方法のご提案を提供します。 
  
|**イベントの種類**|**OnNotify での処理**|
|:-----|:-----|
|オブジェクトの移動  <br/> |移動したオブジェクトの元の親が新しい親に関連付けられている場合は、フォルダーまたはアドレス帳の階層の最上位のコンテナーでビューの先頭を更新します。 2 つの親コンテナーが関連する場合は、そのビューの両方を更新します。  <br/> |
|新しいメッセージ  <br/> |1 つまたは複数の新しいメッセージの到着をユーザーに通知するユーザー インターフェイスを変更します。 受信フォルダーを現在のビューに配置します。  <br/> |
|エラー  <br/> |セッションを除くすべてのオブジェクト、必要であれば戻り値エラーをログに記録します。 セッション オブジェクトでは、ログオフ可能な場合です。  <br/> |
|検索が完了しました  <br/> |処理は必要ありません。  <br/> |
   
> [!NOTE]
> 通知ハンドラーは再入可能でなければなりません。 
  

