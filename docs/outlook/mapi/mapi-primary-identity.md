---
title: MAPI プライマリ id
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 8787a873-6752-4b17-8ea3-8fed793e1371
description: '最終更新日時: 2015 年 3 月 9 日'
ms.openlocfilehash: 5bf88de280b012c54d4caaac6bdfe877f476ac37
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/23/2019
ms.locfileid: "32345796"
---
# <a name="mapi-primary-identity"></a><span data-ttu-id="3d4da-103">MAPI プライマリ id</span><span class="sxs-lookup"><span data-stu-id="3d4da-103">MAPI Primary Identity</span></span>

  
  
<span data-ttu-id="3d4da-104">**適用対象**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="3d4da-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="3d4da-105">ほとんどの MAPI セッションには、セッションのプライマリ id を提供する特定のサービスプロバイダーがあります。</span><span class="sxs-lookup"><span data-stu-id="3d4da-105">Most MAPI sessions have a particular service provider that supplies the primary identity for the session.</span></span> <span data-ttu-id="3d4da-106">通常、アドレス帳プロバイダーは、メッセージングユーザーオブジェクトまたは配布リストのいずれかを使用して id を提供します。</span><span class="sxs-lookup"><span data-stu-id="3d4da-106">Typically, it is an address book provider, which supplies identity through one of its messaging user objects or distribution lists.</span></span> <span data-ttu-id="3d4da-107">実際に、MAPI では、アドレス帳プロバイダーを含むメッセージサービスがプライマリ id に対してオブジェクトの1つを使用することをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="3d4da-107">In fact, MAPI recommends that message services that include an address book provider use one of its objects for the primary identity.</span></span> <span data-ttu-id="3d4da-108">メッセージサービスに属するサービスプロバイダーがプライマリ id を提供すると、メッセージサービス内の他のすべてのサービスプロバイダーがこの id を共有します。</span><span class="sxs-lookup"><span data-stu-id="3d4da-108">When a service provider that belongs to a message service supplies the primary identity, all of the other service providers in the message service share this identity.</span></span>
  
<span data-ttu-id="3d4da-109">mapisvc.inf。INF 構成ファイルには、メッセージサービスとサービスプロバイダーレベルの両方で id に関連するエントリがあります。</span><span class="sxs-lookup"><span data-stu-id="3d4da-109">The MAPISVC.INF configuration file has entries relating to identity at both the message service and service provider level.</span></span> <span data-ttu-id="3d4da-110">メッセージサービスセクションには、サービスがプライマリ id を提供できるかどうかを示すエントリを含める必要があります。サービスプロバイダーのセクションには、プロバイダーが id を提供できる場合にのみ、同様のエントリが含まれます。</span><span class="sxs-lookup"><span data-stu-id="3d4da-110">Message service sections must include an entry that states whether or not the service can supply the primary identity; service provider sections include a similar entry only when the provider can supply an identity.</span></span>
  
<span data-ttu-id="3d4da-111">次の表に、mapisvc.inf のメッセージサービスおよびサービスプロバイダーのセクションに表示されるエントリを示します。INF ファイル</span><span class="sxs-lookup"><span data-stu-id="3d4da-111">The following table lists the entries that appear in the message service and service provider sections in the MAPISVC.INF file.</span></span>
  
|<span data-ttu-id="3d4da-112">**プライマリ id サプライヤー**</span><span class="sxs-lookup"><span data-stu-id="3d4da-112">**Primary identity supplier**</span></span>|<span data-ttu-id="3d4da-113">**PR_RESOURCE_FLAGS 設定**</span><span class="sxs-lookup"><span data-stu-id="3d4da-113">**PR_RESOURCE_FLAGS setting**</span></span>|
|:-----|:-----|
|<span data-ttu-id="3d4da-114">メッセージサービス</span><span class="sxs-lookup"><span data-stu-id="3d4da-114">Message service</span></span>  <br/> | `SERVICE_PRIMARY_IDENTITY` <br/> |
|<span data-ttu-id="3d4da-115">メッセージサービスではありません</span><span class="sxs-lookup"><span data-stu-id="3d4da-115">Not the message service</span></span>  <br/> | `SERVICE_NO_PRIMARY_IDENTITY` <br/> |
|<span data-ttu-id="3d4da-116">サービスプロバイダー</span><span class="sxs-lookup"><span data-stu-id="3d4da-116">Service provider</span></span>  <br/> | `STATUS_PRIMARY_IDENTITY` <br/> |
   
<span data-ttu-id="3d4da-117">複数のメッセージサービスは、セッションのプライマリ id を提供する機能を宣言できますが、そのために選択されているメッセージサービスは1つだけです。</span><span class="sxs-lookup"><span data-stu-id="3d4da-117">Although multiple message services can declare their ability to provide a session's primary identity, only one message service is selected to do so.</span></span> <span data-ttu-id="3d4da-118">次の選択が可能です。</span><span class="sxs-lookup"><span data-stu-id="3d4da-118">This selection can occur:</span></span>
  
- <span data-ttu-id="3d4da-119">プロファイルが作成されたとき。</span><span class="sxs-lookup"><span data-stu-id="3d4da-119">When a profile is created.</span></span>
    
- <span data-ttu-id="3d4da-120">クライアントが**IMsgServiceAdmin:: setprimaryidentity**を呼び出して、特定のメッセージサービスをセッション id のプロバイダーとして明示的に確立するとき。</span><span class="sxs-lookup"><span data-stu-id="3d4da-120">When a client calls **IMsgServiceAdmin::SetPrimaryIdentity** to explicitly establish a particular message service as the provider of the session identity.</span></span> <span data-ttu-id="3d4da-121">を参照してください。</span><span class="sxs-lookup"><span data-stu-id="3d4da-121">For more information.</span></span> <span data-ttu-id="3d4da-122">「 [IMsgServiceAdmin:: setprimaryidentity](imsgserviceadmin-setprimaryidentity.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="3d4da-122">See [IMsgServiceAdmin::SetPrimaryIdentity](imsgserviceadmin-setprimaryidentity.md).</span></span>
    
<span data-ttu-id="3d4da-123">プロファイルが作成されると、MAPI は、STATUS_PRIMARY_IDENTITY フラグを**PR_RESOURCE_FLAGS** ([PidTagResourceFlags](pidtagresourceflags-canonical-property.md)) プロパティに設定してプライマリ id を指定したプロバイダーを含む、構成する最初のメッセージサービスを指定します。.</span><span class="sxs-lookup"><span data-stu-id="3d4da-123">When a profile is created, MAPI designates the first message service to be configured that includes a provider with the STATUS_PRIMARY_IDENTITY flag set in its **PR_RESOURCE_FLAGS** ([PidTagResourceFlags](pidtagresourceflags-canonical-property.md)) property to supply the primary identity.</span></span> <span data-ttu-id="3d4da-124">指定したメッセージサービス内で、このリソースフラグセットを使用して構成する最初のプロバイダーが、サービスの id を提供するために選択されます。</span><span class="sxs-lookup"><span data-stu-id="3d4da-124">Within the designated message service, the first provider to be configured with this resource flag set is chosen to provide the identity for the service.</span></span> <span data-ttu-id="3d4da-125">STATUS_PRIMARY_IDENTITY フラグは、指定されたサービス内の他のすべてのプロバイダーと、プロファイル内の他のメッセージサービスに対してクリアされます。</span><span class="sxs-lookup"><span data-stu-id="3d4da-125">The STATUS_PRIMARY_IDENTITY flag is cleared for all other providers in the designated service and other message services in the profile.</span></span> <span data-ttu-id="3d4da-126">プライマリ id を提供するプロバイダーがプロファイルから削除されるたびに、MAPI は、id を提供できる次のプロバイダーに役割を割り当てます。</span><span class="sxs-lookup"><span data-stu-id="3d4da-126">If at any time the provider supplying primary identity is removed from the profile, MAPI assigns the role to the next provider to be configured that can supply identity.</span></span> <span data-ttu-id="3d4da-127">これは、mapisvc.inf のプロバイダーのセクション`PR_RESOURCE_FLAGS=STATUS_PRIMARY_IDENTITY`にあるエントリの外観によって決まります。</span><span class="sxs-lookup"><span data-stu-id="3d4da-127">This is determined by the appearance of the  `PR_RESOURCE_FLAGS=STATUS_PRIMARY_IDENTITY` entry in the provider's section in MAPISVC.INF.</span></span> 
  
<span data-ttu-id="3d4da-128">クライアントは、message service の**IMsgServiceAdmin:: setprimaryidentity**メソッドを呼び出すときに、ターゲットサービス内のサービスプロバイダーの MAPIUID を指定します。</span><span class="sxs-lookup"><span data-stu-id="3d4da-128">When a client calls a message service's **IMsgServiceAdmin::SetPrimaryIdentity** method, it specifies the MAPIUID for a service provider within the target service.</span></span> <span data-ttu-id="3d4da-129">詳細については、「 [MAPIUID](mapiuid.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="3d4da-129">For more information, see [MAPIUID](mapiuid.md).</span></span> <span data-ttu-id="3d4da-130">**MAPIUID**によって表されるサービスプロバイダーは、メッセージサービスとセッションのプライマリ id を指定するために割り当てられ、サービス内の他のすべてのプロバイダーがこの id を共有します。</span><span class="sxs-lookup"><span data-stu-id="3d4da-130">The service provider represented by the **MAPIUID** is assigned to supply the primary identity for the message service and for the session, and all of the other providers in the service will share this identity.</span></span> 
  
<span data-ttu-id="3d4da-131">プライマリ id の指定を担当するメッセージサービスのすべてのプロバイダーは、次のプロパティを含むように状態テーブルの行を更新します。</span><span class="sxs-lookup"><span data-stu-id="3d4da-131">Every provider in the message service responsible for supplying the primary identity updates its row in the status table to include the following properties.</span></span>
  
|<span data-ttu-id="3d4da-132">**プライマリ id プロパティ**</span><span class="sxs-lookup"><span data-stu-id="3d4da-132">**Primary identity property**</span></span>|<span data-ttu-id="3d4da-133">**設定値**</span><span class="sxs-lookup"><span data-stu-id="3d4da-133">**Set to**</span></span>|
|:-----|:-----|
|<span data-ttu-id="3d4da-134">**PR_IDENTITY_DISPLAY**([PidTagIdentityDisplay](pidtagidentitydisplay-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="3d4da-134">**PR_IDENTITY_DISPLAY** ([PidTagIdentityDisplay](pidtagidentitydisplay-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="3d4da-135">プライマリ id を提供するオブジェクトの表示名。</span><span class="sxs-lookup"><span data-stu-id="3d4da-135">Display name of the object supplying the primary identity.</span></span>  <br/> |
|<span data-ttu-id="3d4da-136">**PR_IDENTITY_SEARCH_KEY**([PidTagIdentitySearchKey](pidtagidentitysearchkey-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="3d4da-136">**PR_IDENTITY_SEARCH_KEY** ([PidTagIdentitySearchKey](pidtagidentitysearchkey-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="3d4da-137">プライマリ id を提供するオブジェクトの検索キー。</span><span class="sxs-lookup"><span data-stu-id="3d4da-137">Search key for the object supplying the primary identity.</span></span>  <br/> |
|<span data-ttu-id="3d4da-138">**PR_IDENTITY_ENTRYID**([PidTagIdentityEntryId](pidtagidentityentryid-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="3d4da-138">**PR_IDENTITY_ENTRYID** ([PidTagIdentityEntryId](pidtagidentityentryid-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="3d4da-139">プライマリ id を提供するオブジェクトのエントリ識別子。</span><span class="sxs-lookup"><span data-stu-id="3d4da-139">Entry identifier for the object supplying the primary identity.</span></span>  <br/> |
   
 <span data-ttu-id="3d4da-140">**プライマリ id を提供するオブジェクトのエントリ識別子を取得するには**</span><span class="sxs-lookup"><span data-stu-id="3d4da-140">**To retrieve the entry identifier for the object supplying the primary identity**</span></span>
  
- <span data-ttu-id="3d4da-141">**imapisession:: queryidentity**メソッドを呼び出します。</span><span class="sxs-lookup"><span data-stu-id="3d4da-141">Call the **IMAPISession::QueryIdentity** method.</span></span> <span data-ttu-id="3d4da-142">詳細については、「 [imapisession:: queryidentity](imapisession-queryidentity.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="3d4da-142">For more information, see [IMAPISession::QueryIdentity](imapisession-queryidentity.md).</span></span> <span data-ttu-id="3d4da-143">**queryidentity**は、 **PR_RESOURCE_FLAGS**列の値 STATUS_PRIMARY_IDENTITY が含まれている行の状態テーブルを検索し、プライマリのエントリ識別子として対応する**PR_IDENTITY_ENTRYID**を返します。独自性.</span><span class="sxs-lookup"><span data-stu-id="3d4da-143">**QueryIdentity** searches the status table for the row that contains the value STATUS_PRIMARY_IDENTITY in its **PR_RESOURCE_FLAGS** column and returns the corresponding **PR_IDENTITY_ENTRYID** as the entry identifier for the primary identity.</span></span> 
    

