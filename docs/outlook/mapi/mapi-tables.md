---
title: MAPI テーブル
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 7974cae1-10f1-42e9-8be4-c02f2bd86714
description: '最終更新日: 2015 年 3 月 9 日'
ms.openlocfilehash: 840c34a64cd0478be8f208799653b9916f50079d
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/28/2019
ms.locfileid: "33437085"
---
# <a name="mapi-tables"></a><span data-ttu-id="c4971-103">MAPI テーブル</span><span class="sxs-lookup"><span data-stu-id="c4971-103">MAPI tables</span></span>
  
<span data-ttu-id="c4971-104">**適用対象**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="c4971-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="c4971-105">mapi テーブルは mapi オブジェクトで、特定の種類の他の MAPI オブジェクトに属するプロパティのコレクションを表示するために使用されます。</span><span class="sxs-lookup"><span data-stu-id="c4971-105">A MAPI table is a MAPI object that is used to view a collection of properties belonging to other MAPI objects of a particular type.</span></span> <span data-ttu-id="c4971-106">MAPI テーブルは、行と列の書式で構造化されています。各行には、オブジェクトと、オブジェクトのプロパティを表す各列が含まれます。</span><span class="sxs-lookup"><span data-stu-id="c4971-106">MAPI tables are structured in a row and column format with each row representing an object and each column representing a property of the object.</span></span> <span data-ttu-id="c4971-107">通常、各行に含まれているプロパティの1つは、 **PR_ENTRYID** ([PidTagEntryId](pidtagentryid-canonical-property.md)) プロパティで、オブジェクトを開いて変更するために使用できる識別子です。</span><span class="sxs-lookup"><span data-stu-id="c4971-107">One of the properties usually included in each row is the **PR_ENTRYID** ([PidTagEntryId](pidtagentryid-canonical-property.md)) property, an identifier that can be used to open and modify the object.</span></span> 
  
<span data-ttu-id="c4971-108">行にはプロパティ値が含まれているため、テーブルからの行の取得は、その行が表すオブジェクトからプロパティのセットを直接取得するのと似ています。</span><span class="sxs-lookup"><span data-stu-id="c4971-108">Because rows contain property values, retrieving a row from a table is similar to getting a set of properties directly from the object that the row represents.</span></span> <span data-ttu-id="c4971-109">両方の操作によって、プロパティ値配列が取得されます。</span><span class="sxs-lookup"><span data-stu-id="c4971-109">Both operations result in the retrieval of a property value array.</span></span> <span data-ttu-id="c4971-110">主な違いは、長い文字列とバイナリプロパティの処理です。</span><span class="sxs-lookup"><span data-stu-id="c4971-110">The main difference is in the handling of long string and binary properties.</span></span> <span data-ttu-id="c4971-111">テーブルに含めるために、一部の表実装者は、これらのプロパティを255バイトに切り詰めます。</span><span class="sxs-lookup"><span data-stu-id="c4971-111">For inclusion in a table, some table implementers truncate these properties to 255 bytes.</span></span> <span data-ttu-id="c4971-112">オブジェクトから直接取得した場合、完全な値は常に使用可能です。</span><span class="sxs-lookup"><span data-stu-id="c4971-112">When retrieved directly from the object, the full value is always available.</span></span>
  
<span data-ttu-id="c4971-113">テーブルとその中のオブジェクトの種類に応じて、アドレス帳、メッセージストアプロバイダー、および MAPI によって、テーブルが実装されます。</span><span class="sxs-lookup"><span data-stu-id="c4971-113">Tables are implemented by address book and message store providers and by MAPI, depending on the type of table and the objects within it.</span></span> <span data-ttu-id="c4971-114">メッセージストアプロバイダーは、フォルダー内のメッセージに関する情報を含むフォルダーと contents テーブルを実装します。</span><span class="sxs-lookup"><span data-stu-id="c4971-114">A message store provider implements folders and a contents table for each folder that includes information about the messages in the folder.</span></span> <span data-ttu-id="c4971-115">アドレス帳プロバイダーは、アドレス帳コンテナーと、その組織を示す階層テーブルを実装します。</span><span class="sxs-lookup"><span data-stu-id="c4971-115">An address book provider implements address book containers and a hierarchy table that shows their organization.</span></span> <span data-ttu-id="c4971-116">MAPI は、いくつかの異なるテーブルを実装します。一部はクライアントアプリケーションで使用するため、いくつかはサービスプロバイダーで使用するため、いくつかは両方で使用します。</span><span class="sxs-lookup"><span data-stu-id="c4971-116">MAPI implements several different tables, some for use by client applications, some for use by service providers, and some for use by both.</span></span> <span data-ttu-id="c4971-117">状態テーブルは、最終的にはそのテーブルが提供されますが、行は mapi に加えて、すべての種類のサービスプロバイダーからの貢献で構成されています。</span><span class="sxs-lookup"><span data-stu-id="c4971-117">The status table is unique in that MAPI ultimately supplies the table, but the rows are comprised of contributions from all types of service providers in addition to MAPI.</span></span> 
  
<span data-ttu-id="c4971-118">次の図は、MAPI で頻繁に使用される表の1つを示しています。フォルダーの内容を表示します。</span><span class="sxs-lookup"><span data-stu-id="c4971-118">The following illustration shows one of the frequent uses of a table in MAPI: to display the contents of a folder.</span></span> <span data-ttu-id="c4971-119">右側には、一般的なメッセージングクライアントアプリケーションに表示される2つのメッセージが表示されます。</span><span class="sxs-lookup"><span data-stu-id="c4971-119">On the right is a display of two messages as might appear in a typical messaging client application.</span></span> <span data-ttu-id="c4971-120">表示には、送信者、受信者、件名、メッセージテキストの4つの情報が含まれています。</span><span class="sxs-lookup"><span data-stu-id="c4971-120">The display contains four pieces of information about each message: the sender, the recipient, the subject, and the message text.</span></span> <span data-ttu-id="c4971-121">情報の各部分は、メッセージのプロパティに対応します。</span><span class="sxs-lookup"><span data-stu-id="c4971-121">Each piece of information corresponds to a property of the message.</span></span>
  
<span data-ttu-id="c4971-122">左側には、これら2つのメッセージを含む目次表のビューがあります。</span><span class="sxs-lookup"><span data-stu-id="c4971-122">On the left is a view of the contents table that includes these two messages.</span></span> <span data-ttu-id="c4971-123">このフォルダーには10個のメッセージがあり、各行には3つの列が含まれているため、この特定のビューは2行3列に制限されるので、contents テーブルには10行が含まれることがあります。</span><span class="sxs-lookup"><span data-stu-id="c4971-123">Whereas the contents table may have ten rows because the folder has ten messages, with each row containing many more than three columns, this particular view is limited to only two rows and three columns.</span></span>
  
<span data-ttu-id="c4971-124">次の表は、テーブルビューの列セットを構成するプロパティを示しています。</span><span class="sxs-lookup"><span data-stu-id="c4971-124">The following table shows the properties that make up the column set for the table view.</span></span>
  
|<span data-ttu-id="c4971-125">**プロパティ**</span><span class="sxs-lookup"><span data-stu-id="c4971-125">**Property**</span></span>|<span data-ttu-id="c4971-126">**説明**</span><span class="sxs-lookup"><span data-stu-id="c4971-126">**Description**</span></span>|
|:-----|:-----|
|<span data-ttu-id="c4971-127">**PR_SENDER_NAME**([PidTagSenderName](pidtagsendername-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="c4971-127">**PR_SENDER_NAME** ([PidTagSenderName](pidtagsendername-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="c4971-128">送信者名</span><span class="sxs-lookup"><span data-stu-id="c4971-128">Sender name</span></span>  <br/> |
|<span data-ttu-id="c4971-129">**PR_ORIGINAL_DELIVERY_TIME**([PidTagOriginalDeliveryTime](pidtagoriginaldeliverytime-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="c4971-129">**PR_ORIGINAL_DELIVERY_TIME** ([PidTagOriginalDeliveryTime](pidtagoriginaldeliverytime-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="c4971-130">メッセージが送信された日付と時刻</span><span class="sxs-lookup"><span data-stu-id="c4971-130">Date and time when the message was sent</span></span>  <br/> |
|<span data-ttu-id="c4971-131">**PR_SUBJECT**([PidTagSubject](pidtagsubject-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="c4971-131">**PR_SUBJECT** ([PidTagSubject](pidtagsubject-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="c4971-132">メッセージの件名行</span><span class="sxs-lookup"><span data-stu-id="c4971-132">Message subject line</span></span>  <br/> |
   
<span data-ttu-id="c4971-133">メッセージに表示されるプロパティのセットは、表に表示されている列のセットと同じではないことに注意してください。</span><span class="sxs-lookup"><span data-stu-id="c4971-133">Notice that the set of properties displayed in the message are not the same as the set of columns displayed in the table.</span></span> <span data-ttu-id="c4971-134">表の実装者 (この場合はメッセージストアプロバイダー) は既定の順序で列の既定のセットを提供します。</span><span class="sxs-lookup"><span data-stu-id="c4971-134">The implementer of the table, in this case a message store provider, supplies a default set of columns in a default order.</span></span> <span data-ttu-id="c4971-135">クライアントは、この列セットを変更したり、追加の列を要求したり、既定の列を拒否したり、特定の方法で並べ替えられるように要求したりできます。</span><span class="sxs-lookup"><span data-stu-id="c4971-135">The client can modify this column set, requesting additional columns or rejecting default ones, and ask that they be ordered in a specific way.</span></span> <span data-ttu-id="c4971-136">クライアントは、1つ以上の列の値に従って行の順序を指定することもできます。</span><span class="sxs-lookup"><span data-stu-id="c4971-136">The client can also order the rows, sorting them according to the value of one or more columns.</span></span>
  
<span data-ttu-id="c4971-137">**テーブルを使用してフォルダーの内容を表示**</span><span class="sxs-lookup"><span data-stu-id="c4971-137">**Using a table to display folder contents**</span></span>
  
<span data-ttu-id="c4971-138">![表を使用してフォルダーの内容を表示する](media/amapi_54.gif "表を使用してフォルダーの内容を表示する")</span><span class="sxs-lookup"><span data-stu-id="c4971-138">![Using a table to display folder contents](media/amapi_54.gif "Using a table to display folder contents")</span></span>
  
<span data-ttu-id="c4971-139">テーブルを処理するには、次の2つのインターフェイスがあります。</span><span class="sxs-lookup"><span data-stu-id="c4971-139">There are two interfaces for working with tables:</span></span>
  
- <span data-ttu-id="c4971-140">[IMAPITable: IUnknown](imapitableiunknown.md)は、クライアントとサービスプロバイダーに、テーブルの基になるデータの読み取り専用のビューを提供します。これにより、プレゼンテーションを表示および変更できるようになります。</span><span class="sxs-lookup"><span data-stu-id="c4971-140">[IMAPITable : IUnknown](imapitableiunknown.md) gives clients and service providers a read-only view of the underlying data of the table, allowing them to view and change only the presentation.</span></span> <span data-ttu-id="c4971-141">複数のユーザーが、 **IMAPITable**を使用して同じデータに同時にアクセスすることができます。</span><span class="sxs-lookup"><span data-stu-id="c4971-141">Multiple users can access the same data concurrently with **IMAPITable**.</span></span> <span data-ttu-id="c4971-142">**IMAPITable**は MAPI およびサービスプロバイダーによって実装されています。</span><span class="sxs-lookup"><span data-stu-id="c4971-142">**IMAPITable** is implemented by MAPI and by service providers.</span></span> 
    
- <span data-ttu-id="c4971-143">[itabledata: IUnknown](itabledataiunknown.md)を使用すると、クライアントとサービスプロバイダーは、テーブルの基になるデータに対して読み取り/書き込みアクセス権を付与し、永続的な変更を行うことができます。</span><span class="sxs-lookup"><span data-stu-id="c4971-143">[ITableData : IUnknown](itabledataiunknown.md) gives clients and service providers read/write access to the underlying data of the table, allowing them to make permanent changes.</span></span> <span data-ttu-id="c4971-144">**IMAPITable**は MAPI で実装されており、主に、 [CreateTable](createtable.md)関数を呼び出すことによってアクセスするサービスプロバイダーによって使用されます。</span><span class="sxs-lookup"><span data-stu-id="c4971-144">**IMAPITable** is implemented by MAPI and used primarily by service providers who access it by calling the [CreateTable](createtable.md) function.</span></span> <span data-ttu-id="c4971-145">**itabledata**実装は、テーブルのすべてのデータ、およびメモリ内の関連付けられたすべての制限を保持して、非常に大きなテーブルで使用するのに適していません。</span><span class="sxs-lookup"><span data-stu-id="c4971-145">The **ITableData** implementation holds all the data for the table and any associated restrictions in memory, making it unsuitable for use with very large tables.</span></span> <span data-ttu-id="c4971-146">複合制限や分類などの複雑な操作はサポートされていません。</span><span class="sxs-lookup"><span data-stu-id="c4971-146">Compound restrictions and complex operations such as categorization are unsupported.</span></span> 
    
## <a name="see-also"></a><span data-ttu-id="c4971-147">関連項目</span><span class="sxs-lookup"><span data-stu-id="c4971-147">See also</span></span>

- [<span data-ttu-id="c4971-148">MAPI の概念</span><span class="sxs-lookup"><span data-stu-id="c4971-148">MAPI Concepts</span></span>](mapi-concepts.md)

