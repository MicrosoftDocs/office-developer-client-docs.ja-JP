---
title: MAPI テーブル
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 7974cae1-10f1-42e9-8be4-c02f2bd86714
description: '最終更新日: 2015 年 3 月 9 日'
ms.openlocfilehash: 840c34a64cd0478be8f208799653b9916f50079d
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/28/2019
ms.locfileid: "33437085"
---
# <a name="mapi-tables"></a>MAPI テーブル
  
**適用対象**: Outlook 2013 | Outlook 2016 
  
mapi テーブルは mapi オブジェクトで、特定の種類の他の MAPI オブジェクトに属するプロパティのコレクションを表示するために使用されます。 MAPI テーブルは、行と列の書式で構造化されています。各行には、オブジェクトと、オブジェクトのプロパティを表す各列が含まれます。 通常、各行に含まれているプロパティの1つは、 **PR_ENTRYID** ([PidTagEntryId](pidtagentryid-canonical-property.md)) プロパティで、オブジェクトを開いて変更するために使用できる識別子です。 
  
行にはプロパティ値が含まれているため、テーブルからの行の取得は、その行が表すオブジェクトからプロパティのセットを直接取得するのと似ています。 両方の操作によって、プロパティ値配列が取得されます。 主な違いは、長い文字列とバイナリプロパティの処理です。 テーブルに含めるために、一部の表実装者は、これらのプロパティを255バイトに切り詰めます。 オブジェクトから直接取得した場合、完全な値は常に使用可能です。
  
テーブルとその中のオブジェクトの種類に応じて、アドレス帳、メッセージストアプロバイダー、および MAPI によって、テーブルが実装されます。 メッセージストアプロバイダーは、フォルダー内のメッセージに関する情報を含むフォルダーと contents テーブルを実装します。 アドレス帳プロバイダーは、アドレス帳コンテナーと、その組織を示す階層テーブルを実装します。 MAPI は、いくつかの異なるテーブルを実装します。一部はクライアントアプリケーションで使用するため、いくつかはサービスプロバイダーで使用するため、いくつかは両方で使用します。 状態テーブルは、最終的にはそのテーブルが提供されますが、行は mapi に加えて、すべての種類のサービスプロバイダーからの貢献で構成されています。 
  
次の図は、MAPI で頻繁に使用される表の1つを示しています。フォルダーの内容を表示します。 右側には、一般的なメッセージングクライアントアプリケーションに表示される2つのメッセージが表示されます。 表示には、送信者、受信者、件名、メッセージテキストの4つの情報が含まれています。 情報の各部分は、メッセージのプロパティに対応します。
  
左側には、これら2つのメッセージを含む目次表のビューがあります。 このフォルダーには10個のメッセージがあり、各行には3つの列が含まれているため、この特定のビューは2行3列に制限されるので、contents テーブルには10行が含まれることがあります。
  
次の表は、テーブルビューの列セットを構成するプロパティを示しています。
  
|**プロパティ**|**説明**|
|:-----|:-----|
|**PR_SENDER_NAME**([PidTagSenderName](pidtagsendername-canonical-property.md))  <br/> |送信者名  <br/> |
|**PR_ORIGINAL_DELIVERY_TIME**([PidTagOriginalDeliveryTime](pidtagoriginaldeliverytime-canonical-property.md))  <br/> |メッセージが送信された日付と時刻  <br/> |
|**PR_SUBJECT**([PidTagSubject](pidtagsubject-canonical-property.md))  <br/> |メッセージの件名行  <br/> |
   
メッセージに表示されるプロパティのセットは、表に表示されている列のセットと同じではないことに注意してください。 表の実装者 (この場合はメッセージストアプロバイダー) は既定の順序で列の既定のセットを提供します。 クライアントは、この列セットを変更したり、追加の列を要求したり、既定の列を拒否したり、特定の方法で並べ替えられるように要求したりできます。 クライアントは、1つ以上の列の値に従って行の順序を指定することもできます。
  
**テーブルを使用してフォルダーの内容を表示**
  
![表を使用してフォルダーの内容を表示する](media/amapi_54.gif "表を使用してフォルダーの内容を表示する")
  
テーブルを処理するには、次の2つのインターフェイスがあります。
  
- [IMAPITable: IUnknown](imapitableiunknown.md)は、クライアントとサービスプロバイダーに、テーブルの基になるデータの読み取り専用のビューを提供します。これにより、プレゼンテーションを表示および変更できるようになります。 複数のユーザーが、 **IMAPITable**を使用して同じデータに同時にアクセスすることができます。 **IMAPITable**は MAPI およびサービスプロバイダーによって実装されています。 
    
- [itabledata: IUnknown](itabledataiunknown.md)を使用すると、クライアントとサービスプロバイダーは、テーブルの基になるデータに対して読み取り/書き込みアクセス権を付与し、永続的な変更を行うことができます。 **IMAPITable**は MAPI で実装されており、主に、 [CreateTable](createtable.md)関数を呼び出すことによってアクセスするサービスプロバイダーによって使用されます。 **itabledata**実装は、テーブルのすべてのデータ、およびメモリ内の関連付けられたすべての制限を保持して、非常に大きなテーブルで使用するのに適していません。 複合制限や分類などの複雑な操作はサポートされていません。 
    
## <a name="see-also"></a>関連項目

- [MAPI の概念](mapi-concepts.md)

