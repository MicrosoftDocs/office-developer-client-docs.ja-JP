---
title: MAPI テーブル
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 7974cae1-10f1-42e9-8be4-c02f2bd86714
description: '最終更新日: 2015 年 3 月 9 日'
ms.openlocfilehash: 840c34a64cd0478be8f208799653b9916f50079d
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/28/2019
ms.locfileid: "33437085"
---
# <a name="mapi-tables"></a><span data-ttu-id="02100-103">MAPI テーブル</span><span class="sxs-lookup"><span data-stu-id="02100-103">MAPI tables</span></span>
  
<span data-ttu-id="02100-104">**適用対象**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="02100-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="02100-105">MAPI テーブルは、特定の種類の他の MAPI オブジェクトに属するプロパティのコレクションを表示するために使用される MAPI オブジェクトです。</span><span class="sxs-lookup"><span data-stu-id="02100-105">A MAPI table is a MAPI object that is used to view a collection of properties belonging to other MAPI objects of a particular type.</span></span> <span data-ttu-id="02100-106">MAPI テーブルは、各行がオブジェクトを表し、各列がオブジェクトのプロパティを表す行と列形式で構成されます。</span><span class="sxs-lookup"><span data-stu-id="02100-106">MAPI tables are structured in a row and column format with each row representing an object and each column representing a property of the object.</span></span> <span data-ttu-id="02100-107">通常、各行に含まれるプロパティの **1** つは、PR_ENTRYID ([PidTagEntryId](pidtagentryid-canonical-property.md)) プロパティです。オブジェクトを開いて変更するために使用できる識別子です。</span><span class="sxs-lookup"><span data-stu-id="02100-107">One of the properties usually included in each row is the **PR_ENTRYID** ([PidTagEntryId](pidtagentryid-canonical-property.md)) property, an identifier that can be used to open and modify the object.</span></span> 
  
<span data-ttu-id="02100-108">行にはプロパティ値が含まれるため、テーブルから行を取得すると、その行が表すオブジェクトから一連のプロパティを直接取得するのと似ています。</span><span class="sxs-lookup"><span data-stu-id="02100-108">Because rows contain property values, retrieving a row from a table is similar to getting a set of properties directly from the object that the row represents.</span></span> <span data-ttu-id="02100-109">どちらの操作でも、プロパティ値配列が取得されます。</span><span class="sxs-lookup"><span data-stu-id="02100-109">Both operations result in the retrieval of a property value array.</span></span> <span data-ttu-id="02100-110">主な違いは、長い文字列プロパティとバイナリ プロパティの処理です。</span><span class="sxs-lookup"><span data-stu-id="02100-110">The main difference is in the handling of long string and binary properties.</span></span> <span data-ttu-id="02100-111">テーブルに含める場合、一部のテーブル実装者は、これらのプロパティを 255 バイトに切り詰めます。</span><span class="sxs-lookup"><span data-stu-id="02100-111">For inclusion in a table, some table implementers truncate these properties to 255 bytes.</span></span> <span data-ttu-id="02100-112">オブジェクトから直接取得すると、常に完全な値を使用できます。</span><span class="sxs-lookup"><span data-stu-id="02100-112">When retrieved directly from the object, the full value is always available.</span></span>
  
<span data-ttu-id="02100-113">テーブルは、テーブルの種類と、その中のオブジェクトに応じて、アドレス帳とメッセージ ストア プロバイダー、MAPI によって実装されます。</span><span class="sxs-lookup"><span data-stu-id="02100-113">Tables are implemented by address book and message store providers and by MAPI, depending on the type of table and the objects within it.</span></span> <span data-ttu-id="02100-114">メッセージ ストア プロバイダーは、フォルダー内のメッセージに関する情報を含む各フォルダーのフォルダーとコンテンツ テーブルを実装します。</span><span class="sxs-lookup"><span data-stu-id="02100-114">A message store provider implements folders and a contents table for each folder that includes information about the messages in the folder.</span></span> <span data-ttu-id="02100-115">アドレス帳プロバイダーは、アドレス帳コンテナーと、その組織を示す階層テーブルを実装します。</span><span class="sxs-lookup"><span data-stu-id="02100-115">An address book provider implements address book containers and a hierarchy table that shows their organization.</span></span> <span data-ttu-id="02100-116">MAPI では、いくつかの異なるテーブルが実装されています。一部はクライアント アプリケーションで使用するために、いくつかはサービス プロバイダーによって使用され、一部は両方で使用されます。</span><span class="sxs-lookup"><span data-stu-id="02100-116">MAPI implements several different tables, some for use by client applications, some for use by service providers, and some for use by both.</span></span> <span data-ttu-id="02100-117">状態テーブルは、MAPI が最終的にテーブルを提供する一意ですが、行は MAPI に加えて、すべての種類のサービス プロバイダーからの投稿で構成されます。</span><span class="sxs-lookup"><span data-stu-id="02100-117">The status table is unique in that MAPI ultimately supplies the table, but the rows are comprised of contributions from all types of service providers in addition to MAPI.</span></span> 
  
<span data-ttu-id="02100-118">次の図は、MAPI で頻繁に使用されるテーブルの 1 つを示しています。フォルダーの内容を表示します。</span><span class="sxs-lookup"><span data-stu-id="02100-118">The following illustration shows one of the frequent uses of a table in MAPI: to display the contents of a folder.</span></span> <span data-ttu-id="02100-119">右側には、一般的なメッセージング クライアント アプリケーションに表示される可能性がある 2 つのメッセージが表示されます。</span><span class="sxs-lookup"><span data-stu-id="02100-119">On the right is a display of two messages as might appear in a typical messaging client application.</span></span> <span data-ttu-id="02100-120">この表示には、各メッセージに関する 4 つの情報 (送信者、受信者、件名、メッセージ テキスト) が含まれる。</span><span class="sxs-lookup"><span data-stu-id="02100-120">The display contains four pieces of information about each message: the sender, the recipient, the subject, and the message text.</span></span> <span data-ttu-id="02100-121">各情報は、メッセージのプロパティに対応します。</span><span class="sxs-lookup"><span data-stu-id="02100-121">Each piece of information corresponds to a property of the message.</span></span>
  
<span data-ttu-id="02100-122">左側には、これら 2 つのメッセージを含むコンテンツ テーブルのビューがあります。</span><span class="sxs-lookup"><span data-stu-id="02100-122">On the left is a view of the contents table that includes these two messages.</span></span> <span data-ttu-id="02100-123">フォルダーには 10 個のメッセージがあり、各行には 3 つ以上の列が含まれているため、コンテンツ テーブルには 10 行が含まれる場合があります。この特定のビューは 2 行と 3 列に制限されます。</span><span class="sxs-lookup"><span data-stu-id="02100-123">Whereas the contents table may have ten rows because the folder has ten messages, with each row containing many more than three columns, this particular view is limited to only two rows and three columns.</span></span>
  
<span data-ttu-id="02100-124">次の表に、テーブル ビューの列セットを構成するプロパティを示します。</span><span class="sxs-lookup"><span data-stu-id="02100-124">The following table shows the properties that make up the column set for the table view.</span></span>
  
|<span data-ttu-id="02100-125">**Property**</span><span class="sxs-lookup"><span data-stu-id="02100-125">**Property**</span></span>|<span data-ttu-id="02100-126">**説明**</span><span class="sxs-lookup"><span data-stu-id="02100-126">**Description**</span></span>|
|:-----|:-----|
|<span data-ttu-id="02100-127">**PR_SENDER_NAME** ([PidTagSenderName](pidtagsendername-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="02100-127">**PR_SENDER_NAME** ([PidTagSenderName](pidtagsendername-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="02100-128">送信者名</span><span class="sxs-lookup"><span data-stu-id="02100-128">Sender name</span></span>  <br/> |
|<span data-ttu-id="02100-129">**PR_ORIGINAL_DELIVERY_TIME** ([PidTagOriginalDeliveryTime](pidtagoriginaldeliverytime-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="02100-129">**PR_ORIGINAL_DELIVERY_TIME** ([PidTagOriginalDeliveryTime](pidtagoriginaldeliverytime-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="02100-130">メッセージが送信された日時</span><span class="sxs-lookup"><span data-stu-id="02100-130">Date and time when the message was sent</span></span>  <br/> |
|<span data-ttu-id="02100-131">**PR_SUBJECT** ([PidTagSubject](pidtagsubject-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="02100-131">**PR_SUBJECT** ([PidTagSubject](pidtagsubject-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="02100-132">メッセージの件名</span><span class="sxs-lookup"><span data-stu-id="02100-132">Message subject line</span></span>  <br/> |
   
<span data-ttu-id="02100-133">メッセージに表示されるプロパティのセットは、テーブルに表示される列のセットと同じではありません。</span><span class="sxs-lookup"><span data-stu-id="02100-133">Notice that the set of properties displayed in the message are not the same as the set of columns displayed in the table.</span></span> <span data-ttu-id="02100-134">テーブルの実装者 (この場合はメッセージ ストア プロバイダー) は、既定の列セットを既定の順序で提供します。</span><span class="sxs-lookup"><span data-stu-id="02100-134">The implementer of the table, in this case a message store provider, supplies a default set of columns in a default order.</span></span> <span data-ttu-id="02100-135">クライアントは、この列セットを変更したり、追加の列を要求したり、既定の列を拒否したりして、特定の方法で順序付けを要求できます。</span><span class="sxs-lookup"><span data-stu-id="02100-135">The client can modify this column set, requesting additional columns or rejecting default ones, and ask that they be ordered in a specific way.</span></span> <span data-ttu-id="02100-136">クライアントは行を並べ替え、1 つ以上の列の値に従って並べ替えすることもできます。</span><span class="sxs-lookup"><span data-stu-id="02100-136">The client can also order the rows, sorting them according to the value of one or more columns.</span></span>
  
<span data-ttu-id="02100-137">**テーブルを使用してフォルダーの内容を表示**</span><span class="sxs-lookup"><span data-stu-id="02100-137">**Using a table to display folder contents**</span></span>
  
<span data-ttu-id="02100-138">![テーブルを使用してフォルダーの内容を表示する](media/amapi_54.gif "テーブルを使用してフォルダーの内容を表示する")</span><span class="sxs-lookup"><span data-stu-id="02100-138">![Using a table to display folder contents](media/amapi_54.gif "Using a table to display folder contents")</span></span>
  
<span data-ttu-id="02100-139">テーブルを操作するには、次の 2 つのインターフェイスがあります。</span><span class="sxs-lookup"><span data-stu-id="02100-139">There are two interfaces for working with tables:</span></span>
  
- <span data-ttu-id="02100-140">[IMAPITable : IUnknown](imapitableiunknown.md) は、クライアントとサービス プロバイダーにテーブルの基になるデータの読み取り専用ビューを提供し、プレゼンテーションのみを表示および変更できます。</span><span class="sxs-lookup"><span data-stu-id="02100-140">[IMAPITable : IUnknown](imapitableiunknown.md) gives clients and service providers a read-only view of the underlying data of the table, allowing them to view and change only the presentation.</span></span> <span data-ttu-id="02100-141">複数のユーザーが IMAPITable と同時に同じ **データにアクセスできます**。</span><span class="sxs-lookup"><span data-stu-id="02100-141">Multiple users can access the same data concurrently with **IMAPITable**.</span></span> <span data-ttu-id="02100-142">**IMAPITable** は、MAPI およびサービス プロバイダーによって実装されます。</span><span class="sxs-lookup"><span data-stu-id="02100-142">**IMAPITable** is implemented by MAPI and by service providers.</span></span> 
    
- <span data-ttu-id="02100-143">[ITableData : IUnknown](itabledataiunknown.md) は、クライアントとサービス プロバイダーにテーブルの基になるデータへの読み取り/書き込みアクセス権を与え、永続的な変更を行えます。</span><span class="sxs-lookup"><span data-stu-id="02100-143">[ITableData : IUnknown](itabledataiunknown.md) gives clients and service providers read/write access to the underlying data of the table, allowing them to make permanent changes.</span></span> <span data-ttu-id="02100-144">**IMAPITable は** MAPI によって実装され、主に CreateTable 関数を呼び出してアクセスする [サービス プロバイダーによって使用](createtable.md) されます。</span><span class="sxs-lookup"><span data-stu-id="02100-144">**IMAPITable** is implemented by MAPI and used primarily by service providers who access it by calling the [CreateTable](createtable.md) function.</span></span> <span data-ttu-id="02100-145">**ITableData 実装では**、テーブルのすべてのデータとメモリ内の関連付けられた制限が保持され、非常に大きなテーブルでの使用には適しくなっています。</span><span class="sxs-lookup"><span data-stu-id="02100-145">The **ITableData** implementation holds all the data for the table and any associated restrictions in memory, making it unsuitable for use with very large tables.</span></span> <span data-ttu-id="02100-146">複合的な制限と、分類などの複雑な操作はサポートされていません。</span><span class="sxs-lookup"><span data-stu-id="02100-146">Compound restrictions and complex operations such as categorization are unsupported.</span></span> 
    
## <a name="see-also"></a><span data-ttu-id="02100-147">関連項目</span><span class="sxs-lookup"><span data-stu-id="02100-147">See also</span></span>

- [<span data-ttu-id="02100-148">MAPI の概念</span><span class="sxs-lookup"><span data-stu-id="02100-148">MAPI Concepts</span></span>](mapi-concepts.md)

