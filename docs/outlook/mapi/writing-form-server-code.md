---
title: フォーム サーバー コードの記述
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: ff33badc-ceed-4364-b99c-8af3af83ceb6
description: '最終更新日時: 2015 年 3 月 9 日'
ms.openlocfilehash: a93e53261d56e452f38e38da427585cecccba405
ms.sourcegitcommit: ef717c65d8dd41ababffb01eafc443c79950aed4
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 10/04/2018
ms.locfileid: "25384081"
---
# <a name="writing-form-server-code"></a><span data-ttu-id="c6c78-103">フォーム サーバー コードの記述</span><span class="sxs-lookup"><span data-stu-id="c6c78-103">Writing Form Server Code</span></span>

  
  
<span data-ttu-id="c6c78-104">**適用対象**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="c6c78-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="c6c78-105">フォーム サーバーとして、次の考えることができます。</span><span class="sxs-lookup"><span data-stu-id="c6c78-105">You can think of a form server as the following:</span></span> 
  
- <span data-ttu-id="c6c78-106">インタ フェースを表示し、標準の Windows メッセージ ポンプの機構を使用して windows メッセージを処理する Win32 プログラムです。</span><span class="sxs-lookup"><span data-stu-id="c6c78-106">A Win32 program that displays an interface and handles windows messages by way of the standard Windows message pump mechanisms.</span></span>
    
- <span data-ttu-id="c6c78-107">クラス ファクトリを OLE に登録し、OLE オートメーションのメソッドがアクティブにするオブジェクト。</span><span class="sxs-lookup"><span data-stu-id="c6c78-107">An object that registers its class factory with OLE and is activated by OLE automation methods.</span></span>
    
- <span data-ttu-id="c6c78-108">他の MAPI コンポーネントとの相互作用の MAPI の規則に従っている MAPI オブジェクトを返します。</span><span class="sxs-lookup"><span data-stu-id="c6c78-108">A MAPI object that follows the MAPI rules for interactions with other MAPI components.</span></span>
    
 <span data-ttu-id="c6c78-109">コード内に、これらの広範な要件の 3 つすべてを同時に処理します。</span><span class="sxs-lookup"><span data-stu-id="c6c78-109">Your code has to handle all three of those broad requirements simultaneously.</span></span> 
  
<span data-ttu-id="c6c78-110">詳細については、フォーム サーバーのクラス ファクトリの登録に関する Windows SDK の COM および ActiveX オブジェクト サービスのセクションを参照してください。</span><span class="sxs-lookup"><span data-stu-id="c6c78-110">See the COM and ActiveX Object Services section in the Windows SDK for details about registering your form server's class factory.</span></span> <span data-ttu-id="c6c78-111">Windows メッセージを処理して、インターフェイスを表示するは、MAPI フォームに関して特別な要件がない標準的な Windows プログラミング手法です。</span><span class="sxs-lookup"><span data-stu-id="c6c78-111">Handling windows messages and displaying an interface are standard Windows programming techniques that do not have any special requirements with respect to MAPI forms.</span></span> <span data-ttu-id="c6c78-112">もう一度、Windows SDK では、Windows プログラミングに関する詳細情報があります。</span><span class="sxs-lookup"><span data-stu-id="c6c78-112">Again, the Windows SDK has details about Windows programming.</span></span> <span data-ttu-id="c6c78-113">このドキュメントには、必須および省略可能な MAPI フォームのインタ フェースを実装して、他の MAPI コンポーネントとの相互作用の MAPI 規則に従っているようにするために知っておくべき-MAPI では主にマネージャーとメッセージング クライアント アプリケーションを形成します。</span><span class="sxs-lookup"><span data-stu-id="c6c78-113">This document contains what you need to know to implement the required and optional MAPI form interfaces so that they follow the MAPI rules for interactions with other MAPI components — primarily the MAPI form manager and messaging client applications.</span></span>
  
<span data-ttu-id="c6c78-114">すべてのフォームのサーバーを実装する際に使用できるインターフェイスは、派生-直接または間接的に、OLE からは、基本クラスの[IUnknown](https://msdn.microsoft.com/library/33f1d79a-33fc-4ce5-a372-e08bda378332%28Office.15%29.aspx)。</span><span class="sxs-lookup"><span data-stu-id="c6c78-114">All of the interfaces that you can use when you implement form servers are derived — either directly or indirectly — from the OLE base class [IUnknown](https://msdn.microsoft.com/library/33f1d79a-33fc-4ce5-a372-e08bda378332%28Office.15%29.aspx).</span></span> <span data-ttu-id="c6c78-115">これは、すべてのこれらのインターフェイスの実装は、 **QueryInterface**、 **AddRef**、および**Release**メソッドを持っている必要があることを意味します。</span><span class="sxs-lookup"><span data-stu-id="c6c78-115">This means that all your implementations of these interfaces will need to have **QueryInterface**, **AddRef**, and **Release** methods.</span></span> <span data-ttu-id="c6c78-116">使用するすべてのインタ フェースが必要な**IUnknown**のメソッドの 1 つの実装を共有できるように、独自の新しいクラスの 1 つですべての必要なインターフェイスを実装するために複数の継承を使用する場合、多くの作業が保存できます。</span><span class="sxs-lookup"><span data-stu-id="c6c78-116">You can save yourself a lot of work if you use multiple inheritance to implement all of the required interfaces in one new class of your own, so that all the interfaces you use can share a single implementation of the required **IUnknown** methods.</span></span> <span data-ttu-id="c6c78-117">詳細については、 [IUnknown::AddRef](https://msdn.microsoft.com/library/b4316efd-73d4-4995-b898-8025a316ba63%28Office.15%29.aspx)、 [IUnknown::QueryInterface](https://msdn.microsoft.com/library/54d5ff80-18db-43f2-b636-f93ac053146d%28Office.15%29.aspx)、および[リ ス](https://msdn.microsoft.com/library/4b494c6f-f0ee-4c35-ae45-ed956f40dc7a%28Office.15%29.aspx)のメソッドを参照してください。</span><span class="sxs-lookup"><span data-stu-id="c6c78-117">For more information, see the [IUnknown::AddRef](https://msdn.microsoft.com/library/b4316efd-73d4-4995-b898-8025a316ba63%28Office.15%29.aspx), [IUnknown::QueryInterface](https://msdn.microsoft.com/library/54d5ff80-18db-43f2-b636-f93ac053146d%28Office.15%29.aspx), and [IUnknown::Release](https://msdn.microsoft.com/library/4b494c6f-f0ee-4c35-ae45-ed956f40dc7a%28Office.15%29.aspx) methods.</span></span> <span data-ttu-id="c6c78-118">これらのメソッドには、MAPI フォームのサーバーに対する特別な考慮事項はありません。</span><span class="sxs-lookup"><span data-stu-id="c6c78-118">There are no special considerations with respect to MAPI form servers for these methods.</span></span> 
  
<span data-ttu-id="c6c78-119">MAPI フォームのインタ フェースのすべてのフォームのすべてのサーバーでは必須ですが、任意の指定されたインターフェイスのメソッドは必須です。</span><span class="sxs-lookup"><span data-stu-id="c6c78-119">While not all of the MAPI form interfaces are mandatory for all form servers, the methods in any given interface are mandatory.</span></span> <span data-ttu-id="c6c78-120">特定のインタ フェースを実装する場合は、必要がありますを実装するすべてのメソッドのインターフェイスで。</span><span class="sxs-lookup"><span data-stu-id="c6c78-120">That is, if you choose to implement a particular interface, you must implement all of the methods in the interface.</span></span> <span data-ttu-id="c6c78-121">これは、メッセージ トランスポートなどの他の MAPI コンポーネントの場合とは異なります。</span><span class="sxs-lookup"><span data-stu-id="c6c78-121">This is different from the situation with some other MAPI components, such as message transports.</span></span> <span data-ttu-id="c6c78-122">幸いなことに、MAPI フォームのインタ フェース内のメソッドは比較的単純ですが、それらのすべてを実装することも、大きな負担の開発者のためです。</span><span class="sxs-lookup"><span data-stu-id="c6c78-122">Fortunately, the methods in the MAPI form interfaces are relatively straightforward, so implementing all of them does not put a great burden on developers.</span></span>
  
<span data-ttu-id="c6c78-123">MAPI フォームのインタ フェースは、フォームのサーバーを作成するために使用する開発ツールの種類に依存しません。</span><span class="sxs-lookup"><span data-stu-id="c6c78-123">The MAPI form interfaces are independent of the type of development tool used to create a form server.</span></span> <span data-ttu-id="c6c78-124">これにより、さまざまな開発ツールを使用して作成するフォームです。</span><span class="sxs-lookup"><span data-stu-id="c6c78-124">This allows forms to be created by using different development tools.</span></span> <span data-ttu-id="c6c78-125">唯一の要件は、フォームのすべてのサーバーが必要な MAPI フォームのインタ フェースをサポートする必要があります。</span><span class="sxs-lookup"><span data-stu-id="c6c78-125">The only requirement is that all form servers must support the required MAPI form interfaces.</span></span>
  
<span data-ttu-id="c6c78-126">フォームのすべてのサーバーですべてのフォームに関連する MAPI インターフェイスが必要です。</span><span class="sxs-lookup"><span data-stu-id="c6c78-126">Not all of the MAPI interfaces that relate to forms are required by all form servers.</span></span> <span data-ttu-id="c6c78-127">省略可能なインターフェイスを使用すると、フォームのほとんどのサーバーを必要としませんが一部の高度なフォーム機能を実装できます。</span><span class="sxs-lookup"><span data-stu-id="c6c78-127">The optional interfaces allow you to implement some advanced form functions that are not needed by most form servers.</span></span> <span data-ttu-id="c6c78-128">次の表は、インタ フェース、それらは何をしてかどうか実装する必要があります。</span><span class="sxs-lookup"><span data-stu-id="c6c78-128">The following table lists the interfaces, what they are for, and whether you must implement them.</span></span>
  
|<span data-ttu-id="c6c78-129">**インターフェイス**</span><span class="sxs-lookup"><span data-stu-id="c6c78-129">**Interface**</span></span>|<span data-ttu-id="c6c78-130">**説明**</span><span class="sxs-lookup"><span data-stu-id="c6c78-130">**Description**</span></span>|<span data-ttu-id="c6c78-131">**Status**</span><span class="sxs-lookup"><span data-stu-id="c6c78-131">**Status**</span></span>|
|:-----|:-----|:-----|
|[<span data-ttu-id="c6c78-132">IMAPIForm : IUnknown</span><span class="sxs-lookup"><span data-stu-id="c6c78-132">IMAPIForm : IUnknown</span></span>](imapiformiunknown.md) <br/> |<span data-ttu-id="c6c78-133">クライアント フォームのサーバーの読み込みに使用する主要なインターフェイスは、フォームの動詞を実行し、フォームのサーバーをシャット ダウンします。</span><span class="sxs-lookup"><span data-stu-id="c6c78-133">The primary interface that clients use to load form servers, execute form verbs, and shut down form servers.</span></span> <span data-ttu-id="c6c78-134">これは、フォーム オブジェクトが実装するインターフェイスについては、他の OLE コンポーネントを通知するために使用される OLE **IUnknown**から派生するインターフェイス。</span><span class="sxs-lookup"><span data-stu-id="c6c78-134">This is also the interface derived from the OLE **IUnknown** that is used to inform other OLE components regarding what interfaces a form object implements.</span></span>  <br/> |<span data-ttu-id="c6c78-135">必須</span><span class="sxs-lookup"><span data-stu-id="c6c78-135">Required</span></span>  <br/> |
|[<span data-ttu-id="c6c78-136">IPersistMessage : IUnknown</span><span class="sxs-lookup"><span data-stu-id="c6c78-136">IPersistMessage : IUnknown</span></span>](ipersistmessageiunknown.md) <br/> |<span data-ttu-id="c6c78-137">フォーム オブジェクトからのメッセージの保存との間にメッセージを読み込むときに使用します。</span><span class="sxs-lookup"><span data-stu-id="c6c78-137">Used when loading messages into and saving messages from form objects.</span></span>  <br/> |<span data-ttu-id="c6c78-138">必須</span><span class="sxs-lookup"><span data-stu-id="c6c78-138">Required</span></span>  <br/> |
|[<span data-ttu-id="c6c78-139">IMAPIFormAdviseSink : IUnknown</span><span class="sxs-lookup"><span data-stu-id="c6c78-139">IMAPIFormAdviseSink : IUnknown</span></span>](imapiformadvisesinkiunknown.md) <br/> |<span data-ttu-id="c6c78-140">メッセージング クライアントのステータスを追跡して、フォーム オブジェクトがフォルダー内の次または前のメッセージを表示できるかどうかを確認するのには、フォーム オブジェクトによって使用されます。</span><span class="sxs-lookup"><span data-stu-id="c6c78-140">Used by form objects to keep track of messaging client status and to find out whether the form object is capable of displaying the next or previous message in a folder.</span></span>  <br/> |<span data-ttu-id="c6c78-141">省略可能</span><span class="sxs-lookup"><span data-stu-id="c6c78-141">Optional</span></span>  <br/> |
|[<span data-ttu-id="c6c78-142">IClassFactory</span><span class="sxs-lookup"><span data-stu-id="c6c78-142">IClassFactory</span></span>](https://msdn.microsoft.com/library/f624f833-2b69-43bc-92cd-c4ecbe6051c5%28Office.15%29.aspx) <br/> |<span data-ttu-id="c6c78-143">OLE クラス ファクトリのメカニズムに準拠するために、フォーム オブジェクトによって使用される OLE クラス ファクトリ インターフェイスです。</span><span class="sxs-lookup"><span data-stu-id="c6c78-143">The OLE class factory interface used by form objects for compliance with the OLE class factory mechanism.</span></span>  <br/> |<span data-ttu-id="c6c78-144">必須</span><span class="sxs-lookup"><span data-stu-id="c6c78-144">Required</span></span>  <br/> |
|[<span data-ttu-id="c6c78-145">IMAPIFormFactory : IUnknown</span><span class="sxs-lookup"><span data-stu-id="c6c78-145">IMAPIFormFactory : IUnknown</span></span>](imapiformfactoryiunknown.md) <br/> |<span data-ttu-id="c6c78-146">フォーム サーバーが複数の種類のフォームをサポートしている場合に使用されます。</span><span class="sxs-lookup"><span data-stu-id="c6c78-146">Used if your form server supports more than one type of form.</span></span> <span data-ttu-id="c6c78-147">この例では、 **IMAPIFormFactory**インターフェイスを使用 (フォーム サーバーがサポートするフォームの種類ごとに 1 つ) 複数の**IClassFactory**インターフェイスにアクセスするクライアント アプリケーション、フォームのサーバーを実装する必要がありますもことです。</span><span class="sxs-lookup"><span data-stu-id="c6c78-147">In this case, the **IMAPIFormFactory** interface allows client applications to access the multiple **IClassFactory** interfaces (one per type of form that your form server supports) that your form server must also implement.</span></span>  <br/> |<span data-ttu-id="c6c78-148">省略可能</span><span class="sxs-lookup"><span data-stu-id="c6c78-148">Optional</span></span>  <br/> |
   
## <a name="see-also"></a><span data-ttu-id="c6c78-149">関連項目</span><span class="sxs-lookup"><span data-stu-id="c6c78-149">See also</span></span>



[<span data-ttu-id="c6c78-150">MAPI フォーム サーバーの開発</span><span class="sxs-lookup"><span data-stu-id="c6c78-150">Developing MAPI Form Servers</span></span>](developing-mapi-form-servers.md)

