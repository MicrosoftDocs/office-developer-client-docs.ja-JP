---
title: IXPProviderTransportLogon
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
ms.topic: reference
ms.prod: office-online-server
localization_priority: Normal
api_name:
- IXPProvider.TransportLogon
api_type:
- COM
ms.assetid: 534929f2-36a2-463d-8c4c-d86060cde127
description: '�ŏI�X�V��: 2011�N7��23��'
ms.openlocfilehash: 96e81442125ae49e0c2856a1cf3a97a16d3453cf
ms.sourcegitcommit: 0cf39e5382b8c6f236c8a63c6036849ed3527ded
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/23/2018
ms.locfileid: "22583338"
---
# <a name="ixpprovidertransportlogon"></a><span data-ttu-id="d4be9-103">IXPProvider::TransportLogon</span><span class="sxs-lookup"><span data-stu-id="d4be9-103">IXPProvider::TransportLogon</span></span>

<span data-ttu-id="d4be9-104">**適用されます**: Outlook 2013 |Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="d4be9-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="d4be9-105">クライアント アプリケーションへのログオンに、トランスポート プロバイダーのセッションを確立します。</span><span class="sxs-lookup"><span data-stu-id="d4be9-105">Establishes a session in which a client application logs on to a transport provider.</span></span> 
  
```cpp
HRESULT TransportLogon(
  LPMAPISUP lpMAPISup,
  ULONG_PTR ulUIParam,
  LPSTR lpszProfileName,
  ULONG FAR * lpulFlags,
  LPMAPIERROR FAR * lppMAPIError,
  LPXPLOGON FAR * lppXPLogon
);
```

## <a name="parameters"></a><span data-ttu-id="d4be9-106">パラメーター</span><span class="sxs-lookup"><span data-stu-id="d4be9-106">Parameters</span></span>

<span data-ttu-id="d4be9-107">_lpMAPISup_: [in] コールバック関数は、このセッションの MAPI 内のトランスポート プロバイダーのサポートのオブジェクトへのポインター。</span><span class="sxs-lookup"><span data-stu-id="d4be9-107">_lpMAPISup_: [in] Pointer to the transport provider's support object for callback functions within MAPI for this session.</span></span> <span data-ttu-id="d4be9-108">このオブジェクトは、トランスポート プロバイダーは、それを解放するまで、有効なままになります。</span><span class="sxs-lookup"><span data-stu-id="d4be9-108">This object remains valid until the transport provider releases it.</span></span>
    
<span data-ttu-id="d4be9-109">_ulUIParam_: [入力] ダイアログ ボックスの親ウィンドウまたは windows のこのメソッドは、表示へのハンドルです。</span><span class="sxs-lookup"><span data-stu-id="d4be9-109">_ulUIParam_: [in] Handle to the parent window of any dialog boxes or windows this method displays.</span></span> <span data-ttu-id="d4be9-110">_UlUIParam_パラメーターは null 以外であることができます、たとえば、 _lpulFlags_パラメーターに設定されて、LOGON_SETUP フラグを設定するとします。</span><span class="sxs-lookup"><span data-stu-id="d4be9-110">The  _ulUIParam_ parameter can be non-null, for example when the LOGON_SETUP flag is set in the  _lpulFlags_ parameter.</span></span> 
    
<span data-ttu-id="d4be9-111">_lpszProfileName_: [in] ユーザーのプロファイルの名前へのポインター。</span><span class="sxs-lookup"><span data-stu-id="d4be9-111">_lpszProfileName_: [in] Pointer to the profile name of the user.</span></span> <span data-ttu-id="d4be9-112">_LpszProfileName_パラメーターは、ダイアログ ボックスを表示する必要があるときに主に使用します。</span><span class="sxs-lookup"><span data-stu-id="d4be9-112">The  _lpszProfileName_ parameter is primarily used when a dialog box must be presented.</span></span> 
    
<span data-ttu-id="d4be9-113">_lpulFlags_: [で, out] ログオン セッションが確立される方法を制御するフラグのビットマスクです。</span><span class="sxs-lookup"><span data-stu-id="d4be9-113">_lpulFlags_: [in, out] Bitmask of flags that controls how the logon session is established.</span></span> <span data-ttu-id="d4be9-114">MAPI スプーラーによって、入力時に次のフラグを設定できます。</span><span class="sxs-lookup"><span data-stu-id="d4be9-114">The following flags can be set on input by the MAPI spooler:</span></span>
    
  - <span data-ttu-id="d4be9-115">LOGON_NO_CONNECT: ユーザー アカウントにログオンしているメッセージの送受信以外の目的では、このトランスポート プロバイダー。</span><span class="sxs-lookup"><span data-stu-id="d4be9-115">LOGON_NO_CONNECT: The user account is logging on to this transport provider for purposes other than transmission and reception of messages.</span></span> <span data-ttu-id="d4be9-116">トランスポート プロバイダーは、他のメッセージング システムへの接続を確認するのにはしないようにします。</span><span class="sxs-lookup"><span data-stu-id="d4be9-116">The transport provider should not attempt to make any connections to other messaging systems.</span></span>
        
  - <span data-ttu-id="d4be9-117">LOGON_NO_DIALOG:] ダイアログ ボックスする必要があります表示しない場合でも、現在保存されているユーザーの資格情報が無効であるか、またはログオンの不足のためには。</span><span class="sxs-lookup"><span data-stu-id="d4be9-117">LOGON_NO_DIALOG: No dialog box should be displayed even if the currently saved user credentials are invalid or insufficient for logon.</span></span>
        
  - <span data-ttu-id="d4be9-118">LOGON_NO_INBOUND: トランスポート プロバイダーは、受信メッセージのために初期化する必要はありませんし、着信メッセージを受け付けませんする必要があります。</span><span class="sxs-lookup"><span data-stu-id="d4be9-118">LOGON_NO_INBOUND: The transport provider does not have to initialize for reception of messages and should not accept incoming messages.</span></span> <span data-ttu-id="d4be9-119">MAPI スプーラーは、着信メッセージの処理を有効にするのにトランスポート プロバイダーを通知するのに[IXPLogon::TransportNotify](ixplogon-transportnotify.md)メソッドを後で使用できます。</span><span class="sxs-lookup"><span data-stu-id="d4be9-119">The MAPI spooler can use the [IXPLogon::TransportNotify](ixplogon-transportnotify.md) method later to signal the transport provider to enable incoming message processing.</span></span> 
        
  - <span data-ttu-id="d4be9-120">LOGON_NO_OUTBOUND: MAPI スプーラーがいずれかを指定しないため、メッセージを送信するために初期化するために、トランスポート プロバイダーがありませんでした。</span><span class="sxs-lookup"><span data-stu-id="d4be9-120">LOGON_NO_OUTBOUND: The transport provider does not have to initialize for sending messages, as the MAPI spooler does not provide any.</span></span> <span data-ttu-id="d4be9-121">クライアント アプリケーションは、 [IXPLogon::AddressTypes](ixplogon-addresstypes.md)メソッドの呼び出しを行うことができるように、メッセージの構成時にリモートのプロバイダーへの接続を必要とするトランスポート プロバイダーは接続を確立する必要があります。</span><span class="sxs-lookup"><span data-stu-id="d4be9-121">If a client application requires a connection to a remote provider during the composition of a message so that it can make [IXPLogon::AddressTypes](ixplogon-addresstypes.md) method calls, the transport provider should make the connection.</span></span> <span data-ttu-id="d4be9-122">MAPI スプーラーは、送信操作を開始できる場合、トランスポート プロバイダーを通知するのに**TransportNotify**を使用できます。</span><span class="sxs-lookup"><span data-stu-id="d4be9-122">The MAPI spooler can use **TransportNotify** to signal the transport provider when outgoing operations can begin.</span></span> 
      
  - <span data-ttu-id="d4be9-123">MAPI_UNICODE: プロファイル名に渡された文字列は Unicode 形式で表示します。</span><span class="sxs-lookup"><span data-stu-id="d4be9-123">MAPI_UNICODE: The passed-in string for the profile name is in Unicode format.</span></span> <span data-ttu-id="d4be9-124">場合、MAPI\_ユニコード フラグが設定されていない、文字列が ANSI 形式では。</span><span class="sxs-lookup"><span data-stu-id="d4be9-124">If the MAPI\_UNICODE flag is not set, the string is in ANSI format.</span></span>
      
    <span data-ttu-id="d4be9-125">トランスポート プロバイダーによって、出力に次のフラグを設定できます。</span><span class="sxs-lookup"><span data-stu-id="d4be9-125">The following flags can be set on output by the transport provider:</span></span>
      
  - <span data-ttu-id="d4be9-126">LOGON_SP_IDLE: 要求は、MAPI スプーラーは、アイドル時の処理のトランスポート プロバイダーの[IXPLogon::Idle](ixplogon-idle.md)メソッドを頻繁に呼び出します。</span><span class="sxs-lookup"><span data-stu-id="d4be9-126">LOGON_SP_IDLE: Requests that the MAPI spooler frequently call the transport provider's [IXPLogon::Idle](ixplogon-idle.md) method for idle-time processing.</span></span> 
      
  - <span data-ttu-id="d4be9-127">LOGON_SP_POLL: MAPI スプーラー頻繁にメソッドを呼び出す[IXPLogon::Poll](ixplogon-poll.md)を確認する返されるログオン オブジェクトで新しいメッセージを要求します。</span><span class="sxs-lookup"><span data-stu-id="d4be9-127">LOGON_SP_POLL: Requests that the MAPI spooler frequently call the [IXPLogon::Poll](ixplogon-poll.md) method on the returned logon object to check for new messages.</span></span> <span data-ttu-id="d4be9-128">このフラグが設定されていない場合、MAPI スプーラーのみ新着メッセージをチェック トランスポート プロバイダーでは、 [IMAPISupport::SpoolerNotify](imapisupport-spoolernotify.md)メソッドを使用して、処理する新しいメッセージがあることをスプーラーに通知するとします。</span><span class="sxs-lookup"><span data-stu-id="d4be9-128">If this flag is not set, the MAPI spooler only checks for new messages when the transport provider uses the [IMAPISupport::SpoolerNotify](imapisupport-spoolernotify.md) method to notify the spooler that there are new messages to process.</span></span> <span data-ttu-id="d4be9-129">トランスポート プロバイダー効果的になり、送信専用でこのフラグを設定していないメッセージの受信確認の MAPI スプーラーに通知しません。</span><span class="sxs-lookup"><span data-stu-id="d4be9-129">A transport provider effectively becomes send-only by not setting this flag and by not notifying the MAPI spooler of message receipt.</span></span> 
      
  - <span data-ttu-id="d4be9-130">LOGON_SP_RESOLVE: 要求を解決するには、MAPI スプーラーを完全にこのトランスポート プロバイダーによっては、受信者のすべてのメッセージのアドレスがサポートされていないアドレスです。</span><span class="sxs-lookup"><span data-stu-id="d4be9-130">LOGON_SP_RESOLVE: Requests that the MAPI spooler resolve to full addresses all message addresses for recipients not supported by this transport provider.</span></span> <span data-ttu-id="d4be9-131">したがってトランスポート プロバイダーがすべての受信者の返信パスを作成できます。</span><span class="sxs-lookup"><span data-stu-id="d4be9-131">Therefore that the transport provider can construct a reply path for all recipients.</span></span>
      
  - <span data-ttu-id="d4be9-132">MAPI_UNICODE: [MAPIERROR](mapierror.md)構造体で返される文字列存在する場合、Unicode 形式です。</span><span class="sxs-lookup"><span data-stu-id="d4be9-132">MAPI_UNICODE: The returned strings in the [MAPIERROR](mapierror.md) structure, if any, are in Unicode format.</span></span> <span data-ttu-id="d4be9-133">MAPI_UNICODE フラグが設定されていない場合は、ANSI 形式の文字列です。</span><span class="sxs-lookup"><span data-stu-id="d4be9-133">If the MAPI_UNICODE flag is not set, the strings are in ANSI format.</span></span> 
    
<span data-ttu-id="d4be9-134">_lppMAPIError_: [出力] 返された**MAPIERROR**構造体へのポインターへのポインター、存在する場合、情報が含まれるバージョン、コンポーネント、およびコンテキスト、エラーが発生します。</span><span class="sxs-lookup"><span data-stu-id="d4be9-134">_lppMAPIError_: [out] Pointer to a pointer to the returned **MAPIERROR** structure, if any, that contains version, component, and context information for the error.</span></span> <span data-ttu-id="d4be9-135">取得する**MAPIERROR**構造体がない場合、 _lppMAPIError_パラメーターを NULL に設定できます。</span><span class="sxs-lookup"><span data-stu-id="d4be9-135">The  _lppMAPIError_ parameter can be set to NULL if there is no **MAPIERROR** structure to return.</span></span> 
    
<span data-ttu-id="d4be9-136">_lppXPLogon_: [出力] 返されたトランスポート プロバイダー ログオン オブジェクトへのポインターへのポインター。</span><span class="sxs-lookup"><span data-stu-id="d4be9-136">_lppXPLogon_: [out] Pointer to the pointer to the returned transport provider logon object.</span></span>
    
## <a name="return-value"></a><span data-ttu-id="d4be9-137">戻り値</span><span class="sxs-lookup"><span data-stu-id="d4be9-137">Return value</span></span>

<span data-ttu-id="d4be9-138">S_OK: 呼び出しが成功し、予期される値または値が返されました。</span><span class="sxs-lookup"><span data-stu-id="d4be9-138">S_OK: The call succeeded and has returned the expected value or values.</span></span>
    
<span data-ttu-id="d4be9-139">MAPI_E_FAILONEPROVIDER: このプロバイダーは、ログオンできませんが、このエラーには、サービスが無効にする必要があります。</span><span class="sxs-lookup"><span data-stu-id="d4be9-139">MAPI_E_FAILONEPROVIDER: This provider cannot log on, but this error should not disable the service.</span></span> 
    
<span data-ttu-id="d4be9-140">MAPI_E_UNCONFIGURED: プロファイルへのログオンを完了するのに十分な情報がありません。</span><span class="sxs-lookup"><span data-stu-id="d4be9-140">MAPI_E_UNCONFIGURED: The profile does not contain enough information for the logon to be completed.</span></span> <span data-ttu-id="d4be9-141">MAPI は、プロバイダーのメッセージ サービスのエントリ ポイント関数が呼び出されます。</span><span class="sxs-lookup"><span data-stu-id="d4be9-141">MAPI calls the provider's message service entry point function.</span></span>
    
<span data-ttu-id="d4be9-142">MAPI_E_UNKNOWN_CPID: プロバイダーは、クライアントのコード ページをサポートすることはできません。</span><span class="sxs-lookup"><span data-stu-id="d4be9-142">MAPI_E_UNKNOWN_CPID: The provider cannot support the client's code page.</span></span>
    
<span data-ttu-id="d4be9-143">MAPI_E_UNKNOWN_LCID: プロバイダーは、クライアントのロケール情報をサポートすることはできません。</span><span class="sxs-lookup"><span data-stu-id="d4be9-143">MAPI_E_UNKNOWN_LCID: The provider cannot support the client's locale information.</span></span>
    
<span data-ttu-id="d4be9-144">MAPI_E_USER_CANCEL: ユーザー操作がキャンセルされました、通常ダイアログ ボックスで [**キャンセル**] ボタンをクリックするとします。</span><span class="sxs-lookup"><span data-stu-id="d4be9-144">MAPI_E_USER_CANCEL: The user canceled the operation, typically by clicking the **Cancel** button in a dialog box.</span></span> 
    
## <a name="remarks"></a><span data-ttu-id="d4be9-145">注釈</span><span class="sxs-lookup"><span data-stu-id="d4be9-145">Remarks</span></span>

<span data-ttu-id="d4be9-146">MAPI スプーラーでは、ユーザーのログオン セッションを確立するために**IXPProvider::TransportLogon**メソッドを呼び出します。</span><span class="sxs-lookup"><span data-stu-id="d4be9-146">The MAPI spooler calls the **IXPProvider::TransportLogon** method to establish a logon session for a user.</span></span> 
  
<span data-ttu-id="d4be9-147">ほとんどのトランスポート プロバイダーは、保存し、ユーザー識別情報、サーバーのアドレス、および資格情報を取得するための_lpMAPISup_パラメーターで指定されたサポート オブジェクトに用意されている[IMAPISupport::OpenProfileSection](imapisupport-openprofilesection.md)メソッドを使用します。</span><span class="sxs-lookup"><span data-stu-id="d4be9-147">Most transport providers use the [IMAPISupport::OpenProfileSection](imapisupport-openprofilesection.md) method provided with the support object pointed to by the  _lpMAPISup_ parameter for saving and retrieving user identity information, server addresses, and credentials.</span></span> <span data-ttu-id="d4be9-148">**OpenProfileSection**を使用すると、トランスポート プロバイダーは任意の情報を保存し、特定のリソースへのログオンに関連付けることできます。</span><span class="sxs-lookup"><span data-stu-id="d4be9-148">By using **OpenProfileSection**, a transport provider can save arbitrary information and associate it with a logon to a particular resource.</span></span> <span data-ttu-id="d4be9-149">たとえば、プロバイダーは、アカウント名とパスワードが特定のセッションとすべてのサーバー名またはその他の必要な情報は、そのセッションでのリソースへのアクセスに必要な関連付けを保存するのには**OpenProfileSection**を使用できます。</span><span class="sxs-lookup"><span data-stu-id="d4be9-149">For example, a provider can use **OpenProfileSection** to save the account name and password associated with a particular session and any server names or other necessary information that are required to access resources for that session.</span></span> <span data-ttu-id="d4be9-150">MAPI には、外部アクセスからリソースに関連付けられている情報が非表示にします。</span><span class="sxs-lookup"><span data-stu-id="d4be9-150">MAPI hides information associated with a resource from outside access.</span></span> <span data-ttu-id="d4be9-151">_LpMAPISup_を介して利用可能にするプロファイルのセクションは、このユーザーのコンテキストに関連するデータが他のコンテキストのデータから分離されているために、MAPI スプーラーによって管理されます。</span><span class="sxs-lookup"><span data-stu-id="d4be9-151">The profile section made available through  _lpMAPISup_ is managed by the MAPI spooler so data related to this user context is separated from data for other contexts.</span></span> 
  
<span data-ttu-id="d4be9-152">トランスポート プロバイダーは、サポート オブジェクトの**IUnknown::AddRef**メソッドを呼び出すし、プロバイダー ログオン オブジェクトの一部としてこのオブジェクトへのポインターのコピーを保持する必要があります。</span><span class="sxs-lookup"><span data-stu-id="d4be9-152">The transport provider must call the **IUnknown::AddRef** method on the support object and keep a copy of the pointer to this object as part of the provider logon object.</span></span> 
  
<span data-ttu-id="d4be9-153">トランスポート プロバイダーを使用するとエラー メッセージまたはログオン] ダイアログ ボックスで使用できるように、 _lpszProfileName_でのプロファイルの表示名が用意されています。</span><span class="sxs-lookup"><span data-stu-id="d4be9-153">The profile display name in  _lpszProfileName_ is provided so the transport provider can use it in error messages or logon dialog boxes.</span></span> <span data-ttu-id="d4be9-154">プロバイダーは、この名前を保持している場合は、プロバイダーによって割り当てられた記憶域にコピーする必要があります。</span><span class="sxs-lookup"><span data-stu-id="d4be9-154">If the provider retains this name, it must be copied to storage allocated by the provider.</span></span> 
  
<span data-ttu-id="d4be9-155">その他のサービス ・ プロバイダーと密に結合したトランスポート プロバイダーは、コンパニオン プロバイダー間での操作に必要な適切な資格情報を確立するのにはログオン時に追加の作業を行う必要があります。</span><span class="sxs-lookup"><span data-stu-id="d4be9-155">Transport providers that are tightly coupled with other service providers may have to do additional work at logon to establish the good credentials required for operations between companion providers.</span></span>
  
<span data-ttu-id="d4be9-156">通常、トランスポート プロバイダーは、ユーザーがプロファイルを最初にログオンしたときに開かれます。</span><span class="sxs-lookup"><span data-stu-id="d4be9-156">Usually, transport providers are opened when the user first logs on to a profile.</span></span> <span data-ttu-id="d4be9-157">最初のログオン プロファイルにそのためは、通常はログオンする前に、メッセージ ・ ストアにため、MAPI スプーラーは通常、 **TransportLogon**を LOGON_NO_INBOUND と LOGON_NO_OUTBOUND の両方のフラグを_lpulFlags_に設定して呼び出します。</span><span class="sxs-lookup"><span data-stu-id="d4be9-157">Because the first logon to a profile therefore generally comes before logon to any message store, the MAPI spooler usually calls **TransportLogon** with both the LOGON_NO_INBOUND and LOGON_NO_OUTBOUND flags set in  _lpulFlags_.</span></span> <span data-ttu-id="d4be9-158">以降では、適切なメッセージ ・ ストアがプロファイル セッションで使用できる場合は、MAPI スプーラーは、トランスポート プロバイダーの受信および送信の操作を開始するのには**TransportNotify**を呼び出します。</span><span class="sxs-lookup"><span data-stu-id="d4be9-158">Later, when the appropriate message stores are available in the profile session, the MAPI spooler calls **TransportNotify** to initiate incoming and outgoing operations for the transport provider.</span></span> 
  
<span data-ttu-id="d4be9-159">トランスポート プロバイダーのオフライン操作は、 _lpulFlags_信号で LOGON_NO_CONNECT フラグを渡します。</span><span class="sxs-lookup"><span data-stu-id="d4be9-159">Passing the LOGON_NO_CONNECT flag in  _lpulFlags_ signals offline operation of the transport provider.</span></span> <span data-ttu-id="d4be9-160">このフラグを示します外部接続は行われません。トランスポート プロバイダーが外部接続を使用せず、セッションを確立できない場合は、ログオンのエラー値を返します。</span><span class="sxs-lookup"><span data-stu-id="d4be9-160">This flag indicates no external connections should be made; if the transport provider cannot establish a session without an external connection, it should return an error value for the logon.</span></span> 
  
<span data-ttu-id="d4be9-161">トランスポート プロバイダーする必要がありますフラグを設定 LOGON_SP_IDLE _lpulFlags_で初期化時にそれ以外のシステムが消費する時間を使用することが目的の場合アイドル。</span><span class="sxs-lookup"><span data-stu-id="d4be9-161">A transport provider should set the LOGON_SP_IDLE flag in  _lpulFlags_ at initialization time if it is designed to use time that the system otherwise spends idle.</span></span> <span data-ttu-id="d4be9-162">このような時間は、ダウンロードすると、メッセージの自動タイムアウトのメッセージをダウンロードするメッセージの送信のタイムアウトなど、自動操作を処理するためによく使用されます。</span><span class="sxs-lookup"><span data-stu-id="d4be9-162">Such time is often used to handle automatic operations, such as automatic message downloading, timed message downloading, or timed message submission.</span></span> <span data-ttu-id="d4be9-163">このフラグが設定されている場合、MAPI スプーラーは、このような操作を開始するのにはシステムのアイドル時間が発生したとき**アイドル**を呼び出します。</span><span class="sxs-lookup"><span data-stu-id="d4be9-163">If this flag is set, the MAPI spooler calls **Idle** when system idle time occurs to initiate such operations.</span></span> <span data-ttu-id="d4be9-164">MAPI スプーラーを無効に設定した間隔で**アイドル**を呼び出しません代わりに、真のアイドル時間中にのみ呼び出されます。</span><span class="sxs-lookup"><span data-stu-id="d4be9-164">The MAPI spooler does not call **Idle** at set intervals; rather, it is called only during true idle time.</span></span> <span data-ttu-id="d4be9-165">したがって、プロバイダーは必要があります、 **Idle**メソッドが呼び出される頻度について何らかの仮定では動作しません。</span><span class="sxs-lookup"><span data-stu-id="d4be9-165">Therefore, providers should not work on any assumption about how frequently their **Idle** methods will be called.</span></span> <span data-ttu-id="d4be9-166">アイドル時の操作をサポートするプロバイダーを指定の構成のユーザー インターフェイスの [プロバイダー] プロパティ シートでは、します。</span><span class="sxs-lookup"><span data-stu-id="d4be9-166">Providers that support idle-time operations should supply a configuration user interface for it in their provider property sheet.</span></span> 
  
<span data-ttu-id="d4be9-167">トランスポート プロバイダーへのログオンが成功すると、プロバイダーする必要がありますポインターを返す_lppXPLogon_パラメーターでログオン オブジェクトにします。</span><span class="sxs-lookup"><span data-stu-id="d4be9-167">If the transport provider logon succeeds, the provider should return in the  _lppXPLogon_ parameter a pointer to a logon object.</span></span> <span data-ttu-id="d4be9-168">MAPI スプーラーはその他のプロバイダーのアクセスをこのオブジェクトを使用します。</span><span class="sxs-lookup"><span data-stu-id="d4be9-168">The MAPI spooler will use this object for additional provider access.</span></span> <span data-ttu-id="d4be9-169">**TransportLogon**は、ログオン ダイアログ ボックスを表示し、ユーザー ログオン通常ダイアログ ボックスで [**キャンセル**] ボタンをクリックすると、プロバイダーは MAPI_E_USER_CANCEL を返す必要があります。</span><span class="sxs-lookup"><span data-stu-id="d4be9-169">If **TransportLogon** displays a logon dialog box and the user cancels logon typically by clicking the **Cancel** button in the dialog box the provider should return MAPI_E_USER_CANCEL.</span></span> 
  
<span data-ttu-id="d4be9-170">**TransportLogon**から返されるエラー値のほとんどを MAPI には、プロバイダーが所属するメッセージ サービスが無効になります。</span><span class="sxs-lookup"><span data-stu-id="d4be9-170">For most error values returned from **TransportLogon**, MAPI disables the message services to which the provider belongs.</span></span> <span data-ttu-id="d4be9-171">MAPI 呼び出しの MAPI セッションの残りの部分には、そのサービスに属するすべてのプロバイダーは使用されません。</span><span class="sxs-lookup"><span data-stu-id="d4be9-171">MAPI will not call any providers that belong to that service for the rest of the MAPI session.</span></span> <span data-ttu-id="d4be9-172">対照的に、そのログオンから**TransportLogon**が MAPI_E_FAILONEPROVIDER のエラー値を返すと、MAPI は無効メッセージ サービス プロバイダーが所属します。</span><span class="sxs-lookup"><span data-stu-id="d4be9-172">In contrast, when **TransportLogon** returns the MAPI_E_FAILONEPROVIDER error value from its logon, MAPI does not disable the message service to which the provider belongs.</span></span> <span data-ttu-id="d4be9-173">セッションの残りの部分のサービスを無効にすることを保証しないというエラーが発生した場合、 **TransportLogon**は MAPI_E_FAILONEPROVIDER を返す必要があります。</span><span class="sxs-lookup"><span data-stu-id="d4be9-173">**TransportLogon** should return MAPI_E_FAILONEPROVIDER if it encounters an error that does not warrant disabling the service for the rest of the session.</span></span> 
  
<span data-ttu-id="d4be9-174">プロバイダーは、そのログオンから MAPI_E_UNCONFIGURED を返します、MAPI は、プロバイダーのメッセージ サービスのエントリ関数を呼び出し、ログオンを再試行してください。</span><span class="sxs-lookup"><span data-stu-id="d4be9-174">If a provider returns MAPI_E_UNCONFIGURED from its logon, MAPI will call the provider's message service entry function and then retry the logon.</span></span> <span data-ttu-id="d4be9-175">MAPI では、サービス自体を設定する機会を提供するのには、コンテキストとして MSG_SERVICE_CONFIGURE を渡します。</span><span class="sxs-lookup"><span data-stu-id="d4be9-175">MAPI passes MSG_SERVICE_CONFIGURE as the context, to give the service a chance to configure itself.</span></span> <span data-ttu-id="d4be9-176">ログオン時にユーザー インターフェイスを許可するクライアントを選択すると、構成情報を入力できるように、サービスは、[設定] プロパティ シートを表示できます。</span><span class="sxs-lookup"><span data-stu-id="d4be9-176">If the client has chosen to allow a user interface on the logon, the service can present its configuration property sheet so that the user can enter configuration information.</span></span> 
  
<span data-ttu-id="d4be9-177">プロバイダーが検出された場合に必要な情報が、プロファイルに含まれないすべて、MAPI プロバイダーのメッセージ サービスのエントリ ポイント関数を呼び出すように、MAPI_E_UNCONFIGURED を返す必要があります。</span><span class="sxs-lookup"><span data-stu-id="d4be9-177">If the provider finds that all the required information is not in the profile, it should return MAPI_E_UNCONFIGURED so that MAPI calls the provider's message service entry point function.</span></span> 
  
## <a name="see-also"></a><span data-ttu-id="d4be9-178">関連項目</span><span class="sxs-lookup"><span data-stu-id="d4be9-178">See also</span></span>

- [<span data-ttu-id="d4be9-179">IXPProvider : IUnknown</span><span class="sxs-lookup"><span data-stu-id="d4be9-179">IXPProvider : IUnknown</span></span>](ixpprovideriunknown.md)  
- [<span data-ttu-id="d4be9-180">IMAPISupport::OpenProfileSection</span><span class="sxs-lookup"><span data-stu-id="d4be9-180">IMAPISupport::OpenProfileSection</span></span>](imapisupport-openprofilesection.md)  
- [<span data-ttu-id="d4be9-181">IMAPISupport::SpoolerNotify</span><span class="sxs-lookup"><span data-stu-id="d4be9-181">IMAPISupport::SpoolerNotify</span></span>](imapisupport-spoolernotify.md)  
- [<span data-ttu-id="d4be9-182">IXPLogon::AddressTypes</span><span class="sxs-lookup"><span data-stu-id="d4be9-182">IXPLogon::AddressTypes</span></span>](ixplogon-addresstypes.md)  
- [<span data-ttu-id="d4be9-183">IXPLogon::Idle</span><span class="sxs-lookup"><span data-stu-id="d4be9-183">IXPLogon::Idle</span></span>](ixplogon-idle.md)  
- [<span data-ttu-id="d4be9-184">IXPLogon::Poll</span><span class="sxs-lookup"><span data-stu-id="d4be9-184">IXPLogon::Poll</span></span>](ixplogon-poll.md)  
- [<span data-ttu-id="d4be9-185">IXPLogon::TransportNotify</span><span class="sxs-lookup"><span data-stu-id="d4be9-185">IXPLogon::TransportNotify</span></span>](ixplogon-transportnotify.md) 
- [<span data-ttu-id="d4be9-186">MAPIERROR</span><span class="sxs-lookup"><span data-stu-id="d4be9-186">MAPIERROR</span></span>](mapierror.md)

