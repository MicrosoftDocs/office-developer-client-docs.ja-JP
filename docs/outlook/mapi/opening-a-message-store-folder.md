---
title: メッセージ ストアのフォルダーを開く
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: d858e4fe-822e-4330-9ed3-4b7d22fa51dc
description: '最終更新日時: 2015 年 3 月 9 日'
ms.openlocfilehash: 2ac4a30d6afc7e5245441bfe2d501169dd3a9447
ms.sourcegitcommit: 0cf39e5382b8c6f236c8a63c6036849ed3527ded
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/23/2018
ms.locfileid: "22586124"
---
# <a name="opening-a-message-store-folder"></a><span data-ttu-id="6fb0c-103">メッセージ ストアのフォルダーを開く</span><span class="sxs-lookup"><span data-stu-id="6fb0c-103">Opening a message store folder</span></span>

<span data-ttu-id="6fb0c-104">**適用されます**: Outlook 2013 |Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="6fb0c-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="6fb0c-105">任意のフォルダーを開くには、そのエントリの識別子が利用できなければなりません。</span><span class="sxs-lookup"><span data-stu-id="6fb0c-105">Before any folder can be opened, its entry identifier must be available.</span></span> <span data-ttu-id="6fb0c-106">ほとんどのフォルダーの**PR_ENTRYID**プロパティの取得を意味します。</span><span class="sxs-lookup"><span data-stu-id="6fb0c-106">For most folders, this means retrieving their **PR_ENTRYID** properties.</span></span> <span data-ttu-id="6fb0c-107">IPM サブツリー フォルダーおよびその他のルート フォルダーの一部などの特別なフォルダーには、MAPI は、メッセージ ストアの**IMAPIProp::GetProps**メソッドを呼び出すことによってアクセス可能な特別なエントリの識別子のプロパティを定義します。</span><span class="sxs-lookup"><span data-stu-id="6fb0c-107">For special folders, such as some of the IPM subtree folders and other root folders, MAPI defines special entry identifier properties that are accessible by calling the message store's **IMAPIProp::GetProps** method.</span></span> <span data-ttu-id="6fb0c-108">これらのエントリの識別子は常に長期的なありです。</span><span class="sxs-lookup"><span data-stu-id="6fb0c-108">These entry identifiers are always long-term and are named as follows:</span></span> 
  
|<span data-ttu-id="6fb0c-109">**Folder**</span><span class="sxs-lookup"><span data-stu-id="6fb0c-109">**Folder**</span></span>|<span data-ttu-id="6fb0c-110">**エントリの識別子のプロパティ**</span><span class="sxs-lookup"><span data-stu-id="6fb0c-110">**Entry identifier property**</span></span>|
|:-----|:-----|
|<span data-ttu-id="6fb0c-111">���M�g���C] �̃t�H���_�[</span><span class="sxs-lookup"><span data-stu-id="6fb0c-111">Outbox folder</span></span>  <br/> |<span data-ttu-id="6fb0c-112">**PR_IPM_OUTBOX_ENTRYID**([PidTagIpmOutboxEntryId](pidtagipmoutboxentryid-canonical-property.md))(IPM メッセージ クラスのみ)</span><span class="sxs-lookup"><span data-stu-id="6fb0c-112">**PR_IPM_OUTBOX_ENTRYID** ([PidTagIpmOutboxEntryId](pidtagipmoutboxentryid-canonical-property.md)) (IPM message class only)</span></span>  <br/> |
|<span data-ttu-id="6fb0c-113">�폜�ς݃A�C�e�� �t�H���_�[</span><span class="sxs-lookup"><span data-stu-id="6fb0c-113">Deleted Items folder</span></span>  <br/> |<span data-ttu-id="6fb0c-114">**PR_IPM_WASTEBASKET_ENTRYID**([PidTagIpmWastebasketEntryId](pidtagipmwastebasketentryid-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="6fb0c-114">**PR_IPM_WASTEBASKET_ENTRYID** ([PidTagIpmWastebasketEntryId](pidtagipmwastebasketentryid-canonical-property.md))</span></span>  <br/> |
|<span data-ttu-id="6fb0c-115">���M�ς݃A�C�e��] �t�H���_�[</span><span class="sxs-lookup"><span data-stu-id="6fb0c-115">Sent Items folder</span></span>  <br/> |<span data-ttu-id="6fb0c-116">**PR_IPM_SENTMAIL_ENTRYID**([PidTagIpmSentMailEntryId](pidtagipmsentmailentryid-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="6fb0c-116">**PR_IPM_SENTMAIL_ENTRYID** ([PidTagIpmSentMailEntryId](pidtagipmsentmailentryid-canonical-property.md))</span></span>  <br/> |
|<span data-ttu-id="6fb0c-117">IPM ���[�g �t�H���_�[</span><span class="sxs-lookup"><span data-stu-id="6fb0c-117">IPM root folder</span></span>  <br/> |<span data-ttu-id="6fb0c-118">**PR_IPM_SUBTREE_ENTRYID**([PidTagIpmSubtreeEntryId](pidtagipmsubtreeentryid-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="6fb0c-118">**PR_IPM_SUBTREE_ENTRYID** ([PidTagIpmSubtreeEntryId](pidtagipmsubtreeentryid-canonical-property.md))</span></span>  <br/> |
|<span data-ttu-id="6fb0c-119">�������ʂ̃��[�g �t�H���_�[</span><span class="sxs-lookup"><span data-stu-id="6fb0c-119">Search-results root folder</span></span>  <br/> |<span data-ttu-id="6fb0c-120">**PR_FINDER_ENTRYID**([PidTagFinderEntryId](pidtagfinderentryid-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="6fb0c-120">**PR_FINDER_ENTRYID** ([PidTagFinderEntryId](pidtagfinderentryid-canonical-property.md))</span></span>  <br/> |
|<span data-ttu-id="6fb0c-121">共通ビューのルート フォルダー</span><span class="sxs-lookup"><span data-stu-id="6fb0c-121">Common views root folder</span></span>  <br/> |<span data-ttu-id="6fb0c-122">**PR_COMMON_VIEWS_ENTRYID**([PidTagCommonViewsEntryId](pidtagcommonviewsentryid-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="6fb0c-122">**PR_COMMON_VIEWS_ENTRYID** ([PidTagCommonViewsEntryId](pidtagcommonviewsentryid-canonical-property.md))</span></span>  <br/> |
|<span data-ttu-id="6fb0c-123">個人用ビューのルート フォルダー</span><span class="sxs-lookup"><span data-stu-id="6fb0c-123">Personal views root folder</span></span>  <br/> |<span data-ttu-id="6fb0c-124">**PR_VIEWS_ENTRYID**([PidTagViewsEntryId](pidtagviewsentryid-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="6fb0c-124">**PR_VIEWS_ENTRYID** ([PidTagViewsEntryId](pidtagviewsentryid-canonical-property.md))</span></span>  <br/> |
|<span data-ttu-id="6fb0c-125">ルート フォルダーの連絡先</span><span class="sxs-lookup"><span data-stu-id="6fb0c-125">Contacts root folder</span></span>  <br/> |<span data-ttu-id="6fb0c-126">**PR_IPM_CONTACT_ENTRYID**([PidTagIpmContactEntryId](pidtagipmcontactentryid-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="6fb0c-126">**PR_IPM_CONTACT_ENTRYID** ([PidTagIpmContactEntryId](pidtagipmcontactentryid-canonical-property.md))</span></span>  <br/> |
|<span data-ttu-id="6fb0c-127">[下書き] フォルダーをルートします。</span><span class="sxs-lookup"><span data-stu-id="6fb0c-127">Drafts root folder</span></span>  <br/> |<span data-ttu-id="6fb0c-128">**PR_IPM_DRAFTS_ENTRYID**([PidTagIpmDraftsEntryId](pidtagipmdraftsentryid-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="6fb0c-128">**PR_IPM_DRAFTS_ENTRYID** ([PidTagIpmDraftsEntryId](pidtagipmdraftsentryid-canonical-property.md))</span></span>  <br/> |
|<span data-ttu-id="6fb0c-129">仕訳帳のルート フォルダー</span><span class="sxs-lookup"><span data-stu-id="6fb0c-129">Journal root folder</span></span>  <br/> |<span data-ttu-id="6fb0c-130">**PR_IPM_JOURNAL_ENTRYID**([PidTagIpmJournalEntryId](pidtagipmjournalentryid-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="6fb0c-130">**PR_IPM_JOURNAL_ENTRYID** ([PidTagIpmJournalEntryId](pidtagipmjournalentryid-canonical-property.md))</span></span>  <br/> |
|<span data-ttu-id="6fb0c-131">ルート フォルダーの予定表</span><span class="sxs-lookup"><span data-stu-id="6fb0c-131">Calendar root folder</span></span>  <br/> |<span data-ttu-id="6fb0c-132">**PR_IPM_APPOINTMENT_ENTRYID**([PidTagIpmAppointmentEntryId](pidtagipmappointmententryid-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="6fb0c-132">**PR_IPM_APPOINTMENT_ENTRYID** ([PidTagIpmAppointmentEntryId](pidtagipmappointmententryid-canonical-property.md))</span></span>  <br/> |
|<span data-ttu-id="6fb0c-133">メモ ルート フォルダー</span><span class="sxs-lookup"><span data-stu-id="6fb0c-133">Notes root folder</span></span>  <br/> |<span data-ttu-id="6fb0c-134">**PR_IPM_NOTE_ENTRYID**([PidTagIpmNoteEntryId](pidtagipmnoteentryid-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="6fb0c-134">**PR_IPM_NOTE_ENTRYID** ([PidTagIpmNoteEntryId](pidtagipmnoteentryid-canonical-property.md))</span></span>  <br/> |
|<span data-ttu-id="6fb0c-135">タスクのルート フォルダー</span><span class="sxs-lookup"><span data-stu-id="6fb0c-135">Tasks root folder</span></span>  <br/> |<span data-ttu-id="6fb0c-136">**PR_IPM_TASK_ENTRYID**([PidTagIpmTaskEntryId](pidtagipmtaskentryid-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="6fb0c-136">**PR_IPM_TASK_ENTRYID** ([PidTagIpmTaskEntryId](pidtagipmtaskentryid-canonical-property.md))</span></span>  <br/> |
   
<span data-ttu-id="6fb0c-137">これらの特別なエントリ id のいずれかを取得しようとすると、前に取得、 **PR\_VALID_FOLDER_MASK**メッセージ ストアのプロパティを ([PidTagValidFolderMask](pidtagvalidfoldermask-canonical-property.md))。</span><span class="sxs-lookup"><span data-stu-id="6fb0c-137">Before you try to retrieve one of these special entry identifiers, retrieve the **PR\_VALID_FOLDER_MASK** ([PidTagValidFolderMask](pidtagvalidfoldermask-canonical-property.md)) property of the message store.</span></span> <span data-ttu-id="6fb0c-138">**PR\_VALID_FOLDER_MASK**は、特別なエントリの識別子が存在するを識別するビットマスクです。</span><span class="sxs-lookup"><span data-stu-id="6fb0c-138">**PR\_VALID_FOLDER_MASK** is a bitmask that identifies which of the special entry identifiers exist.</span></span> <span data-ttu-id="6fb0c-139">それぞれの特別なフォルダーの 1 つのビットがあります。</span><span class="sxs-lookup"><span data-stu-id="6fb0c-139">There is one bit for each of the special folders.</span></span> <span data-ttu-id="6fb0c-140">ビットが設定されている場合の対応するフォルダーがサポートされて、エントリの有効な識別子が含まれていることを示します。</span><span class="sxs-lookup"><span data-stu-id="6fb0c-140">If the bit is set, it indicates that the corresponding folder is supported and has a valid entry identifier.</span></span> <span data-ttu-id="6fb0c-141">たとえば、削除済みアイテム フォルダーが存在し、有効なエントリの識別子では、フォルダーには\_ **PR_VALID_FOLDER_MASK**で IPM_WASTEBASKET_VALID ビットが設定されます。</span><span class="sxs-lookup"><span data-stu-id="6fb0c-141">For example, if the Deleted Items folder exists and has a valid entry identifier, the FOLDER\_IPM_WASTEBASKET_VALID bit will be set in **PR_VALID_FOLDER_MASK**.</span></span> 
  
## <a name="open-the-folder-where-all-incoming-messages-of-a-particular-class-are-placed"></a><span data-ttu-id="6fb0c-142">特定のクラスのすべての受信メッセージが配置されているフォルダーを開きます</span><span class="sxs-lookup"><span data-stu-id="6fb0c-142">Open the folder where all incoming messages of a particular class are placed</span></span>
  
1. <span data-ttu-id="6fb0c-143">そのエントリ id、メッセージ クラスを識別する文字列を指すように_lpszMessageClass_パラメーターの設定を取得するために[IMsgStore::GetReceiveFolder](imsgstore-getreceivefolder.md)を呼び出します。</span><span class="sxs-lookup"><span data-stu-id="6fb0c-143">Call [IMsgStore::GetReceiveFolder](imsgstore-getreceivefolder.md) to retrieve its entry identifier, setting the  _lpszMessageClass_ parameter to point to a character string identifying the message class.</span></span> <span data-ttu-id="6fb0c-144">など、IPM サブツリーの受信トレイを開く場合は、IPM に_lpszMessageClass_をポイントします。</span><span class="sxs-lookup"><span data-stu-id="6fb0c-144">For example, if you want to open the Inbox for your IPM subtree, point  _lpszMessageClass_ to IPM.</span></span> <span data-ttu-id="6fb0c-145">IPC メッセージの受信フォルダーを開く場合は、IPC を指すように設定します。</span><span class="sxs-lookup"><span data-stu-id="6fb0c-145">If you want to open the receive folder for IPC messages, set it to point to IPC.</span></span> 

   <span data-ttu-id="6fb0c-146">メッセージ クラスに登録されている受信フォルダーがない場合、 **GetReceiveFolder**は、渡された関連するメッセージ クラスがメッセージ クラスの使用可能な最長のプレフィックスに一致する受信フォルダーを選択します。</span><span class="sxs-lookup"><span data-stu-id="6fb0c-146">If there is no registered receive folder for the message class, **GetReceiveFolder** chooses the receive folder whose associated message class matches the longest possible prefix of the message class passed in.</span></span> <span data-ttu-id="6fb0c-147">詳細については、 [MAPI が表示されるフォルダー](mapi-receive-folders.md)を参照してください。</span><span class="sxs-lookup"><span data-stu-id="6fb0c-147">For more information, see [MAPI Receive Folders](mapi-receive-folders.md).</span></span> 
   
   <span data-ttu-id="6fb0c-148">**PR_IPM_OUTBOX_ENTRYID**プロパティを使用すると、IPM メッセージに対してのみ、[送信トレイ] フォルダーを開くことに注意してください。</span><span class="sxs-lookup"><span data-stu-id="6fb0c-148">Note that the **PR_IPM_OUTBOX_ENTRYID** property is used to open the Outbox folder only for IPM messages.</span></span> <span data-ttu-id="6fb0c-149">IPC メッセージを送信トレイを開く場合のエントリの識別子を使用代わりにそのフォルダーが表示されます。</span><span class="sxs-lookup"><span data-stu-id="6fb0c-149">If you are opening the Outbox for IPC messages, use instead the entry identifier for its receive folder.</span></span> <span data-ttu-id="6fb0c-150">IPC メッセージの受信と送信の両方は、受信フォルダーに配置されます。</span><span class="sxs-lookup"><span data-stu-id="6fb0c-150">Both incoming and outgoing IPC messages are placed in the receive folder.</span></span> 
    
2. <span data-ttu-id="6fb0c-151">フォルダーを開き、それにアクセスするために使用できるインターフェイス ポインターを返すに 4 つの**OpenEntry**メソッドのいずれかを呼び出します。</span><span class="sxs-lookup"><span data-stu-id="6fb0c-151">Call one of four **OpenEntry** methods to open the folder and return an interface pointer that you can use to access it.</span></span> <span data-ttu-id="6fb0c-152">フォルダーを開くには、次の方法のいずれかを呼び出すことができます。</span><span class="sxs-lookup"><span data-stu-id="6fb0c-152">You can call any one of the following methods to open a folder:</span></span> 
    
   - [<span data-ttu-id="6fb0c-153">IMAPISession::OpenEntry</span><span class="sxs-lookup"><span data-stu-id="6fb0c-153">IMAPISession::OpenEntry</span></span>](imapisession-openentry.md)
    
   - [<span data-ttu-id="6fb0c-154">IMSLogon::OpenEntry</span><span class="sxs-lookup"><span data-stu-id="6fb0c-154">IMSLogon::OpenEntry</span></span>](imslogon-openentry.md)
    
   - [<span data-ttu-id="6fb0c-155">IMsgStore::OpenEntry</span><span class="sxs-lookup"><span data-stu-id="6fb0c-155">IMsgStore::OpenEntry</span></span>](imsgstore-openentry.md)
    
   - [<span data-ttu-id="6fb0c-156">IMAPIContainer::OpenEntry</span><span class="sxs-lookup"><span data-stu-id="6fb0c-156">IMAPIContainer::OpenEntry</span></span>](imapicontainer-openentry.md)
    
   <span data-ttu-id="6fb0c-157">選択した特定のメソッドは、フォルダーを開くことができませんし、時に使用可能なオブジェクトによって異なります。</span><span class="sxs-lookup"><span data-stu-id="6fb0c-157">The specific method that you choose depends on the folder to be opened and the objects that are available at the time.</span></span> <span data-ttu-id="6fb0c-158">**IMAPISession**メソッドは、現在のプロファイルで任意のメッセージ ストアの任意のフォルダーを開くことができます、ため、フォルダーを開くことについては何もわからないとき、この**OpenEntry**を呼び出します。</span><span class="sxs-lookup"><span data-stu-id="6fb0c-158">Because the **IMAPISession** method can open any folder for any message store in the current profile, call this **OpenEntry** when you do not know anything about the folder to be opened.</span></span> <span data-ttu-id="6fb0c-159">メッセージ ・ ストアは、フォルダーを所有していることがわかって、メッセージ ・ ストアへのポインターがある場合は、 **IMsgStore::OpenEntry**を呼び出します。</span><span class="sxs-lookup"><span data-stu-id="6fb0c-159">If you know which message store owns the folder and you have a pointer to the message store, call **IMsgStore::OpenEntry**.</span></span> 
    
   <span data-ttu-id="6fb0c-160">などの**IMsgStore**メソッドを使用して、受信フォルダーを開きます。</span><span class="sxs-lookup"><span data-stu-id="6fb0c-160">For example, use the **IMsgStore** method to open a receive folder.</span></span> <span data-ttu-id="6fb0c-161">メッセージ ストア プロバイダーのログオン オブジェクトへのポインターを使っている場合は、 **IMSLogon::OpenEntry**を呼び出します。</span><span class="sxs-lookup"><span data-stu-id="6fb0c-161">If you have a pointer to the message store provider's logon object, call **IMSLogon::OpenEntry**.</span></span> <span data-ttu-id="6fb0c-162">これらの呼び出しは、MAPI 経由ではなく、メッセージ ストア プロバイダーに直接移動、ため処理が速くなります。</span><span class="sxs-lookup"><span data-stu-id="6fb0c-162">Because these calls go directly to the message store provider rather than through MAPI, processing is faster.</span></span> <span data-ttu-id="6fb0c-163">フォルダーを開いている場合は、既にあることを開き、開いているフォルダーの**IMAPIContainer::OpenEntry**メソッドを呼び出して、フォルダーのサブフォルダーです。</span><span class="sxs-lookup"><span data-stu-id="6fb0c-163">If the folder you are opening is a subfolder of a folder that you already have open, call the open folder's **IMAPIContainer::OpenEntry** method.</span></span> <span data-ttu-id="6fb0c-164">**IMAPIContainer**メソッドでは、現在開いているフォルダーのサブフォルダーのみが開き、短期的なエントリの識別子を使用する唯一の方法が保証します。</span><span class="sxs-lookup"><span data-stu-id="6fb0c-164">The **IMAPIContainer** method only opens subfolders of a currently opened folder and is the only method guaranteed to work with short-term entry identifiers.</span></span> 
    
3. <span data-ttu-id="6fb0c-165">開かれるフォルダーに変更を加えることができる場合は、アクセス レベルを指定するには、いずれかの MAPI\_ベスト\_アクセスまたは MAPI\_の**OpenEntry**呼び出しのフラグを変更します。</span><span class="sxs-lookup"><span data-stu-id="6fb0c-165">If you want to be able to make changes to the folder to be opened, specify an access level by setting either the MAPI\_BEST\_ACCESS or MAPI\_MODIFY flag in the **OpenEntry** call.</span></span> <span data-ttu-id="6fb0c-166">これらのフラグは、MAPI の最上位のレベルのアクセスを許可するメッセージ ストア プロバイダーへのご提案\_ベスト\_へのアクセスまたは読み取り/書き込みアクセスは、MAPI の\_を変更するフォルダーを開くとき。</span><span class="sxs-lookup"><span data-stu-id="6fb0c-166">These flags are suggestions to the message store provider to grant the highest level of access, for MAPI\_BEST\_ACCESS, or read/write access, for MAPI\_MODIFY, when opening the folder.</span></span> 

   <span data-ttu-id="6fb0c-167">これらのフラグは提案のみであるため、フォルダー可能性がありますか、期待どおりのアクセス レベルで開くことができません可能性があります。</span><span class="sxs-lookup"><span data-stu-id="6fb0c-167">Because these flags are only suggestions, the folder may or may not be opened with the access level you expect.</span></span> <span data-ttu-id="6fb0c-168">**PR_ACCESS** ([PidTagAccess](pidtagaccess-canonical-property.md)) プロパティを取得するには、開いているフォルダーで実行できる操作の範囲を指定できます。</span><span class="sxs-lookup"><span data-stu-id="6fb0c-168">By retrieving the **PR_ACCESS** ([PidTagAccess](pidtagaccess-canonical-property.md)) property, you can determine the range of operations that can be performed on the open folder.</span></span> 
    
   <span data-ttu-id="6fb0c-169">ただし、メッセージ ストア プロバイダーの多くは、フォルダーのプロパティ、または、階層テーブル内の列としてサポートしているのではなく、要求時にこのプロパティの値を計算するための取得は、時間がかかる。</span><span class="sxs-lookup"><span data-stu-id="6fb0c-169">However, because many message store providers calculate the value for this property on demand rather than supporting it as a folder property or as a column in their hierarchy table, retrieving it can be time-consuming.</span></span> <span data-ttu-id="6fb0c-170">別の方法では、どのような操作を実行し、必要な場合にエラーを返す必要があります。</span><span class="sxs-lookup"><span data-stu-id="6fb0c-170">An alternate strategy is to attempt whatever operation you need to perform and return an error if necessary.</span></span>
    
## <a name="see-also"></a><span data-ttu-id="6fb0c-171">関連項目</span><span class="sxs-lookup"><span data-stu-id="6fb0c-171">See also</span></span>

- [<span data-ttu-id="6fb0c-172">PidTagEntryId 標準プロパティ</span><span class="sxs-lookup"><span data-stu-id="6fb0c-172">PidTagEntryId Canonical Property</span></span>](pidtagentryid-canonical-property.md) 
- [<span data-ttu-id="6fb0c-173">IMAPIProp::GetProps</span><span class="sxs-lookup"><span data-stu-id="6fb0c-173">IMAPIProp::GetProps</span></span>](imapiprop-getprops.md)

