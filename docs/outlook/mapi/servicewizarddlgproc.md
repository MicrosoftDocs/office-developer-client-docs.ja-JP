---
title: SERVICEWIZARDDLGPROC
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
ms.topic: reference
ms.prod: office-online-server
localization_priority: Normal
api_name:
- MAPI.SERVICEWIZARDDLGPROC
api_type:
- COM
ms.assetid: 3e2d5190-e67a-470d-8177-0f0ba20c7b82
description: '最終更新日時: 2015 年 3 月 9 日'
ms.openlocfilehash: e43a1d7c57668ba930b4c4af7194bd298971e6ba
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/23/2019
ms.locfileid: "32356414"
---
# <a name="servicewizarddlgproc"></a>SERVICEWIZARDDLGPROC
 
**適用対象**: Outlook 2013 | Outlook 2016 
  
プロバイダーのプロパティシートまたはページが表示されているときに、サービスプロバイダーがユーザーイベントに反応できるようにするために、プロファイルウィザードによって呼び出されるコールバック関数を定義します。 
  
|||
|:-----|:-----|
|ヘッダー ファイル:  <br/> |Mapiwz  <br/> |
|定義された関数の実装:  <br/> |サービス プロバイダー  <br/> |
|によって呼び出された定義済み関数:  <br/> |MAPI プロファイルウィザード  <br/> |
   
```cpp
BOOL SERVICEWIZARDDLGPROC(
  HWND hDlg,
  UINT wMsgID,
  WPARAM wParam,
  LPARAM lParam
);
```

## <a name="parameters"></a>パラメーター

_hdlg_
  
> 順番[プロファイルウィザード] ダイアログボックスへのウィンドウハンドル。 
    
_wMsgID_
  
> 順番処理するウィンドウメッセージを指定します。 モーダルダイアログボックスで想定される通常のウィンドウメッセージに加えて、次のメッセージを受信できます。
    
WM_CLOSE 
  
> プロファイルウィザードが完了しました。 サービスプロバイダーは、動的に割り当てられたメモリを解放するなど、必要なすべてのクリーンアップを実行する必要があります。 
    
WM_COMMAND 
  
> プロバイダーのコントロールのいずれかが選択されているか、 **[次へ**] または [**戻る**] ボタンがクリックされました。 _wParam_パラメーターの値は、これらのユーザーイベントが発生したことを示します。 
    
WM_INITDIALOG 
  
> ユーザーは、ダイアログボックスを初期化する必要がある別のプロパティページに移動しました。 プロバイダーは、プロファイルウィザードによってダイアログボックスに追加されたコントロールを初期化する必要があります。 
    
WIZ_QUERYNUMPAGES 
  
> プロファイルウィザードは、プロバイダーが表示する必要があるページ数の入力を求めます。 プロバイダーは、TRUE または FALSE ではなく、ページの数を返す必要があります。 たとえば、次の return ステートメントを使用して、3つのページが表示されるように指定します。
    
   ```cpp
return (BOOL)3;

   ```

_wParam_
  
> 順番ウィンドウメッセージに関連付けられている32ビットパラメーター。 使用可能な値は、 _wMsgID_パラメーターで指定されたメッセージによって異なります。 モーダルダイアログボックスの通常のウィンドウメッセージに必要な値に加えて、次の値を受け取ることができます。 
    
WIZ_NEXT 
  
> _wMsgID_に WM_COMMAND が含まれている場合、ユーザーは **[次へ**] ボタンをクリックしています。 
    
WIZ_PREV 
  
> _wMsgID_に WM_COMMAND が含まれている場合、ユーザーは [**戻る**] ボタンをクリックしています。 
    
_lParam_
  
> 順番ウィンドウメッセージに関連付けられている32ビットパラメーター。 使用可能な値は、 _wMsgID_パラメーターで指定されたメッセージによって異なります。 
    
## <a name="return-value"></a>戻り値

**servicewizarddlgproc**に基づく関数によって返される値は、受信したウィンドウメッセージによって異なります。 特に、WIZ_QUERYNUMPAGES メッセージの例外的な戻り値に注意してください。 通常の戻り値は次のとおりです。 
  
TRUE 
  
> サービスプロバイダーが受信したウィンドウメッセージを処理しました。 
    
FALSE 
  
> サービスプロバイダーが受信したウィンドウメッセージを処理していません。
    
## <a name="remarks"></a>解説

ユーザーがあるプロパティページから別のページに移動すると、プロバイダーは古いページのコントロールを非表示にし、次または前のページのコントロールを表示します。 ユーザーが **[次へ**] ボタンをクリックすると、WIZ_NEXT パラメーターで、WM_COMMAND メッセージとを使用して__ **servicewizarddlgproc**ベースの関数が呼び出されます。 次の手順では、ユーザーが **[次へ**] をクリックしてから最初のプロバイダーの構成ページが表示されるまでの時間について説明します。 
  
1. プロファイルウィザードは、ウィンドウにあるコントロールを非表示にします。 
    
2. プロファイルウィザードによって、プロバイダーの隠しコントロールがページに追加されます。 
    
3. プロファイルウィザードは、WM_INITDIALOG メッセージを送信して**servicewizarddlgproc**を呼び出して、プロバイダーがコントロールを初期化できるようにします。 
    
4. プロファイルウィザードは、 **servicewizarddlgproc**を呼び出して、WIZ_QUERYNUMPAGES メッセージを送信します。 プロバイダーは、表示されるページ数を返します。 
    
5. プロファイルウィザードは、 **servicewizarddlgproc**を呼び出し、 _wParam_パラメーターが WIZ_NEXT または WIZ_PREV のいずれかに設定された WM_COMMAND メッセージを送信します。 この時点で、プロバイダーは FALSE {error} を返すか、またはそのコントロールを調べ、TRUE {success} を返します。 プロファイルウィザードが ID_NEXT に合格すると、プロバイダーの最初のページが表示されます。 ID_PREV が渡された場合は、最後のページが表示されます。 
    
6. プロファイルウィザードは、プロバイダーの**servicewizarddlgproc**関数を呼び出し、 _wParam_パラメーターが WIZ_NEXT または WIZ_PREV (ユーザーがクリックしたボタンに応じて) に設定された WM_COMMAND メッセージを送信します。 プロバイダーは、そのコントロールを表示または非表示にし、そのデータをプロファイルウィザードに渡された**imapiprop**に書き込んでページの順序をステップ実行します。 プロバイダーは、次のページまたは前のページが正常に表示された場合は TRUE を返し、次のページまたは前のページが表示されない場合は FALSE を返します。 プロバイダーは、ページのシーケンス外でのステップ実行時に認識し、コントロールを非表示にして、プロファイルにデータを書き込むことによって適切に応答する必要があります。 
    
7. ユーザーがプロバイダーのページ範囲外で手順を実行すると、プロファイルウィザードはプロバイダーの非表示のコントロールをダイアログボックスから削除し、次のプロバイダーがある場合は次のページを表示します。 
    

