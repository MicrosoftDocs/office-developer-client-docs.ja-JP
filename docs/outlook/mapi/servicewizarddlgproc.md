---
title: SERVICEWIZARDDLGPROC
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
ms.topic: reference
ms.prod: office-online-server
localization_priority: Normal
api_name:
- MAPI.SERVICEWIZARDDLGPROC
api_type:
- COM
ms.assetid: 3e2d5190-e67a-470d-8177-0f0ba20c7b82
description: '最終更新日時: 2015 年 3 月 9 日'
ms.openlocfilehash: fdd5d01b96c9ea756ee64f113ccb5119a9693668
ms.sourcegitcommit: 0cf39e5382b8c6f236c8a63c6036849ed3527ded
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/23/2018
ms.locfileid: "22594468"
---
# <a name="servicewizarddlgproc"></a>SERVICEWIZARDDLGPROC
 
**適用されます**: Outlook 2013 |Outlook 2016 
  
プロバイダーのプロパティ シートまたはページが表示されているときに、ユーザー イベントに応答するサービス プロバイダーを使用してプロファイル ウィザードによって呼び出されるコールバック関数を定義します。 
  
|||
|:-----|:-----|
|ヘッダー ファイル:  <br/> |Mapiwz.h  <br/> |
|によって実装される関数の定義:  <br/> |サービス プロバイダー  <br/> |
|によって呼び出される関数を定義します。  <br/> |MAPI プロファイル ウィザード  <br/> |
   
```cpp
BOOL SERVICEWIZARDDLGPROC(
  HWND hDlg,
  UINT wMsgID,
  WPARAM wParam,
  LPARAM lParam
);
```

## <a name="parameters"></a>パラメーター

_hDlg_
  
> [in]プロファイル ウィザード] ダイアログ ボックスのウィンドウ ハンドルです。 
    
_wMsgID_
  
> [in]ウィンドウ メッセージを処理します。 モーダル ダイアログ ボックスで、通常のウィンドウ メッセージの他、次のメッセージを受信できます。
    
WM_CLOSE 
  
> プロファイル ウィザードが完了しました。 サービス プロバイダーは、割り当てられたメモリのいずれかを動的に割り当て解除など、すべての必要なクリーンアップを行います。 
    
WM_COMMAND 
  
> プロバイダーのコントロールのいずれかが選択されているか、[**次へ**] または [**戻る**] ボタンがクリックしてされました。 _WParam_パラメーターの値は、これらのユーザー イベントが発生したを示します。 
    
WM_INITDIALOG 
  
> ユーザーは、ダイアログ ボックスを初期化する必要があります別のプロパティ ページに移動します。 プロバイダーは、プロファイル ウィザード、ダイアログ ボックスに追加したコントロールを初期化する必要があります。 
    
WIZ_QUERYNUMPAGES 
  
> プロファイル ウィザードはページを表示する必要のあるプロバイダーの数のメッセージを表示します。 プロバイダーには、TRUE または FALSE の代わりにページ数を返す必要があります。 たとえば、3 つのページを表示する必要があることを示すために次の return ステートメントを使用します。
    
   ```cpp
return (BOOL)3;

   ```

_wParam_
  
> [in]ウィンドウのメッセージに関連付けられている 32 ビットのパラメーター。 使用可能な値は、 _wMsgID_パラメーターで指定されたメッセージに依存します。 値に加え、モーダル ダイアログ ボックスの通常のウィンドウ メッセージが期待どおり、次の値を受け取ることができます。 
    
WIZ_NEXT 
  
> _WMsgID_に WM_COMMAND が含まれている場合、[**次へ**] ボタンをクリックします。 
    
WIZ_PREV 
  
> _WMsgID_に WM_COMMAND が含まれている場合、[**戻る**] ボタンをクリックします。 
    
_lParam_
  
> [in]ウィンドウのメッセージに関連付けられている 32 ビットのパラメーター。 使用可能な値は、 _wMsgID_パラメーターで指定されたメッセージに依存します。 
    
## <a name="return-value"></a>戻り値

**SERVICEWIZARDDLGPROC**ベースの関数によって返される値は、ウィンドウ メッセージを受信しました。 比類のない WIZ_QUERYNUMPAGES メッセージの値を返すに特に注意してください。 通常の戻り値は次のとおりです。 
  
TRUE 
  
> サービス プロバイダーが、受信ウィンドウ メッセージを処理します。 
    
FALSE 
  
> サービス プロバイダーは、受信されたウィンドウ メッセージを処理していません。
    
## <a name="remarks"></a>注釈

ユーザーを移動する 1 つのプロパティ ページから、ときに、プロバイダーは、次または前のページのコントロールの表示と古いページのコントロールを非表示にします。 ユーザーは、[**次へ**] をクリックすると、 **SERVICEWIZARDDLGPROC**ベースの機能、 _wParam_パラメーターに WM_COMMAND メッセージと WIZ_NEXT で呼び出されます。 次の手順では、最初のプロバイダーの構成ページが表示される時間と、ユーザーは**次**をクリックすると時間の間で行われる処理について説明します。 
  
1. プロファイル ウィザードでは、ウィンドウ上にあるすべてのコントロールを非表示にします。 
    
2. プロファイル ウィザードでは、プロバイダーの非表示のコントロールをページに追加します。 
    
3. プロファイル ウィザードでは、 **SERVICEWIZARDDLGPROC**プロバイダーは、コントロールを初期化できるように、WM_INITDIALOG メッセージの送信を呼び出します。 
    
4. プロファイル ウィザードでは、 **SERVICEWIZARDDLGPROC**、WIZ_QUERYNUMPAGES メッセージを送信を呼び出します。 プロバイダーは、表示されるページの数を返します。 
    
5. プロファイル ウィザードでは、 **SERVICEWIZARDDLGPROC**、WIZ_NEXT または WIZ_PREV のいずれかに設定、 _wParam_パラメーターを持つ WM_COMMAND メッセージを送信を呼び出します。 この時点では、プロバイダーか、{エラー} の FALSE を返しますまたはそのコントロールが表示し、{成功} は TRUE を返します。 プロファイル ウィザードは、ID_NEXT に合格した場合は、プロバイダーの最初のページが表示されます。 ID_PREV が渡されると、最後のページが表示されます。 
    
6. プロファイル ウィザードでは、WIZ_NEXT または (ボタンによって、ユーザーがクリックした) WIZ_PREV のいずれかに設定、 _wParam_パラメーターを持つ WM_COMMAND メッセージを送信するプロバイダーの**SERVICEWIZARDDLGPROC**関数を呼び出します。 プロバイダーは、そのコントロールを非表示のページのシーケンスをステップ実行するにはプロファイル ウィザードに渡される**IMAPIProp**にそのデータを記述します. プロバイダーする必要があります TRUE を返す場合は、次または前のページが正常に表示すると、次または前のページもない場合に FALSE が表示される可能性があります。 プロバイダーは、その一連のページの外部でステップ実行するのに注意してくださいし、そのコントロールを非表示し、プロファイル データの書き込みが適切に応答する必要があります。 
    
7. プロバイダーの範囲のページの手順は、ユーザー、プロファイル ウィザード] ダイアログ ボックスからプロバイダーの非表示のコントロールを削除し、次のプロバイダーを呼び出してか最後のプロバイダーをされている場合、次のページが表示されます。 
    

