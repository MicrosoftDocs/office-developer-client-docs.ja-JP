---
title: セッションを使用してオブジェクトにアクセスする
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: ecada707-2960-41ec-be7e-619cad257c57
description: '最終更新日: 2015 年 3 月 9 日'
ms.openlocfilehash: a76397b74642aedf9ad5c9704735d869f61db7e3
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/28/2019
ms.locfileid: "33410540"
---
# <a name="accessing-objects-by-using-the-session"></a><span data-ttu-id="8bcb7-103">セッションを使用してオブジェクトにアクセスする</span><span class="sxs-lookup"><span data-stu-id="8bcb7-103">Accessing Objects by Using the Session</span></span>

  
  
<span data-ttu-id="8bcb7-104">**適用対象**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="8bcb7-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="8bcb7-105">[MAPILogonEx](mapilogonex.md)の呼び出しから受け取ったセッションポインターを使用して、さまざまなオブジェクトにアクセスできます。</span><span class="sxs-lookup"><span data-stu-id="8bcb7-105">The session pointer that you receive from your call to [MAPILogonEx](mapilogonex.md) can be used to access a wide variety of objects.</span></span> <span data-ttu-id="8bcb7-106">次の表に、さまざまなオブジェクトへのアクセスに使用されるメソッドを示します。</span><span class="sxs-lookup"><span data-stu-id="8bcb7-106">The following table lists the methods that are used to access various objects:</span></span> 
  
|<span data-ttu-id="8bcb7-107">**Object**</span><span class="sxs-lookup"><span data-stu-id="8bcb7-107">**Object**</span></span>|<span data-ttu-id="8bcb7-108">**Session メソッド**</span><span class="sxs-lookup"><span data-stu-id="8bcb7-108">**Session method**</span></span>|
|:-----|:-----|
|<span data-ttu-id="8bcb7-109">プロファイルセクション</span><span class="sxs-lookup"><span data-stu-id="8bcb7-109">Profile section</span></span>  <br/> |[<span data-ttu-id="8bcb7-110">IMAPISession::OpenProfileSection</span><span class="sxs-lookup"><span data-stu-id="8bcb7-110">IMAPISession::OpenProfileSection</span></span>](imapisession-openprofilesection.md) <br/> |
|<span data-ttu-id="8bcb7-111">メッセージストア</span><span class="sxs-lookup"><span data-stu-id="8bcb7-111">Message store</span></span>  <br/> |[<span data-ttu-id="8bcb7-112">IMAPISession::OpenMsgStore</span><span class="sxs-lookup"><span data-stu-id="8bcb7-112">IMAPISession::OpenMsgStore</span></span>](imapisession-openmsgstore.md) <br/> |
|<span data-ttu-id="8bcb7-113">アドレス帳</span><span class="sxs-lookup"><span data-stu-id="8bcb7-113">Address book</span></span>  <br/> |[<span data-ttu-id="8bcb7-114">IMAPISession::OpenAddressBook</span><span class="sxs-lookup"><span data-stu-id="8bcb7-114">IMAPISession::OpenAddressBook</span></span>](imapisession-openaddressbook.md) <br/> |
|<span data-ttu-id="8bcb7-115">メッセージサービスの管理オブジェクト</span><span class="sxs-lookup"><span data-stu-id="8bcb7-115">Message service administration object</span></span>  <br/> |[<span data-ttu-id="8bcb7-116">IMAPISession::AdminServices</span><span class="sxs-lookup"><span data-stu-id="8bcb7-116">IMAPISession::AdminServices</span></span>](imapisession-adminservices.md) <br/> |
|<span data-ttu-id="8bcb7-117">フォルダー、メッセージ、アドレス帳コンテナー、配布リスト、またはメッセージングユーザー</span><span class="sxs-lookup"><span data-stu-id="8bcb7-117">Folder, message, address book container, distribution list, or messaging user</span></span>  <br/> |[<span data-ttu-id="8bcb7-118">IMAPISession::OpenEntry</span><span class="sxs-lookup"><span data-stu-id="8bcb7-118">IMAPISession::OpenEntry</span></span>](imapisession-openentry.md) <br/> |
   
<span data-ttu-id="8bcb7-119">**openentry**メソッドと有効なエントリ識別子を使用すると、任意のアドレス帳またはメッセージストアプロバイダーオブジェクトを開くことができます。</span><span class="sxs-lookup"><span data-stu-id="8bcb7-119">With the **OpenEntry** method and a valid entry identifier, you can open any address book or message store provider object.</span></span> <span data-ttu-id="8bcb7-120">**imapisession**メソッドに加えて、MAPI には、他にも**openentry**メソッドがあります。</span><span class="sxs-lookup"><span data-stu-id="8bcb7-120">There are other **OpenEntry** methods in MAPI, in addition to the **IMAPISession** method.</span></span> <span data-ttu-id="8bcb7-121">**openentry**は、次のオブジェクトに実装されています。</span><span class="sxs-lookup"><span data-stu-id="8bcb7-121">**OpenEntry** is implemented in the following objects:</span></span> 
  
|<span data-ttu-id="8bcb7-122">**Object**</span><span class="sxs-lookup"><span data-stu-id="8bcb7-122">**Object**</span></span>|<span data-ttu-id="8bcb7-123">**メソッド**</span><span class="sxs-lookup"><span data-stu-id="8bcb7-123">**Method**</span></span>|
|:-----|:-----|
|<span data-ttu-id="8bcb7-124">アドレス帳プロバイダーのログオンオブジェクト</span><span class="sxs-lookup"><span data-stu-id="8bcb7-124">Address book provider's logon object</span></span>  <br/> |[<span data-ttu-id="8bcb7-125">IABLogon::OpenEntry</span><span class="sxs-lookup"><span data-stu-id="8bcb7-125">IABLogon::OpenEntry</span></span>](iablogon-openentry.md) <br/> |
|<span data-ttu-id="8bcb7-126">アドレス帳</span><span class="sxs-lookup"><span data-stu-id="8bcb7-126">Address book</span></span>  <br/> |[<span data-ttu-id="8bcb7-127">IAddrBook::OpenEntry</span><span class="sxs-lookup"><span data-stu-id="8bcb7-127">IAddrBook::OpenEntry</span></span>](iaddrbook-openentry.md) <br/> |
|<span data-ttu-id="8bcb7-128">アドレス帳コンテナー</span><span class="sxs-lookup"><span data-stu-id="8bcb7-128">Address book container</span></span>  <br/> |[<span data-ttu-id="8bcb7-129">IMAPIContainer::OpenEntry</span><span class="sxs-lookup"><span data-stu-id="8bcb7-129">IMAPIContainer::OpenEntry</span></span>](imapicontainer-openentry.md) <br/> |
|<span data-ttu-id="8bcb7-130">Session</span><span class="sxs-lookup"><span data-stu-id="8bcb7-130">Session</span></span>  <br/> |[<span data-ttu-id="8bcb7-131">IMAPISession::OpenEntry</span><span class="sxs-lookup"><span data-stu-id="8bcb7-131">IMAPISession::OpenEntry</span></span>](imapisession-openentry.md) <br/> |
|<span data-ttu-id="8bcb7-132">メッセージストア</span><span class="sxs-lookup"><span data-stu-id="8bcb7-132">Message store</span></span>  <br/> |[<span data-ttu-id="8bcb7-133">IMsgStore::OpenEntry</span><span class="sxs-lookup"><span data-stu-id="8bcb7-133">IMsgStore::OpenEntry</span></span>](imsgstore-openentry.md) <br/> |
|<span data-ttu-id="8bcb7-134">メッセージストアプロバイダーのログオンオブジェクト</span><span class="sxs-lookup"><span data-stu-id="8bcb7-134">Message store provider's logon object</span></span>  <br/> |[<span data-ttu-id="8bcb7-135">IMSLogon::OpenEntry</span><span class="sxs-lookup"><span data-stu-id="8bcb7-135">IMSLogon::OpenEntry</span></span>](imslogon-openentry.md) <br/> |
|<span data-ttu-id="8bcb7-136">フォルダー</span><span class="sxs-lookup"><span data-stu-id="8bcb7-136">Folder</span></span>  <br/> |[<span data-ttu-id="8bcb7-137">IMAPIContainer::OpenEntry</span><span class="sxs-lookup"><span data-stu-id="8bcb7-137">IMAPIContainer::OpenEntry</span></span>](imapicontainer-openentry.md) <br/> |
|<span data-ttu-id="8bcb7-138">サポートオブジェクト</span><span class="sxs-lookup"><span data-stu-id="8bcb7-138">Support object</span></span>  <br/> |[<span data-ttu-id="8bcb7-139">IMAPISupport::OpenEntry</span><span class="sxs-lookup"><span data-stu-id="8bcb7-139">IMAPISupport::OpenEntry</span></span>](imapisupport-openentry.md) <br/> |
   
<span data-ttu-id="8bcb7-140">一部の**openentry**メソッドは、 **imapisession:: openentry**のように、開くオブジェクトのエントリ識別子を必要とします。その他のメソッドを使用すると、NULL を指定できます。</span><span class="sxs-lookup"><span data-stu-id="8bcb7-140">Some **OpenEntry** methods require an entry identifier of the object to be opened, as does **IMAPISession::OpenEntry**; other methods allow NULL to be specified.</span></span> <span data-ttu-id="8bcb7-141">NULL エントリ識別子は、オブジェクトに応じて異なる方法で解釈されます。</span><span class="sxs-lookup"><span data-stu-id="8bcb7-141">A NULL entry identifier is interpreted differently depending on the object.</span></span> <span data-ttu-id="8bcb7-142">たとえば、NULL エントリ識別子を持つ**IAddrBook:: openentry**を呼び出すと、MAPI はアドレス帳のルートコンテナーを開きます。</span><span class="sxs-lookup"><span data-stu-id="8bcb7-142">For example, when you call **IAddrBook::OpenEntry** with a NULL entry identifier, MAPI opens the root container of the address book.</span></span> <span data-ttu-id="8bcb7-143">メッセージストアの**openentry**メソッドは同じように動作します。メッセージストアのルートフォルダーを開きます。</span><span class="sxs-lookup"><span data-stu-id="8bcb7-143">The message store's **OpenEntry** method behaves similarly; it opens the root folder of the message store.</span></span> <span data-ttu-id="8bcb7-144">**IMAPIContainer:: openentry**は、フォルダーとアドレス帳コンテナーの両方で実装されている場合があります。実装に応じて、MAPI_E_INVALID_PARAMETER またはルートコンテナーが返される場合があります。</span><span class="sxs-lookup"><span data-stu-id="8bcb7-144">**IMAPIContainer::OpenEntry**, implemented by both folders and address book containers, might return MAPI_E_INVALID_PARAMETER or the root container, depending on the implementer.</span></span> 
  
<span data-ttu-id="8bcb7-145">エントリ識別子に NULL 値を使用しないことに加えて、セッションの**openentry**メソッドは、そのジョブがオブジェクトを開かないため、他の**openentry**メソッドとは異なります。</span><span class="sxs-lookup"><span data-stu-id="8bcb7-145">In addition to disallowing a NULL value for the entry identifier, the session's **OpenEntry** method differs from other **OpenEntry** methods because its job is not to open objects.</span></span> <span data-ttu-id="8bcb7-146">代わりに、エントリ id を調べて、適切なサービスプロバイダーによって実装されている別の**openentry**メソッドに呼び出しを転送します。</span><span class="sxs-lookup"><span data-stu-id="8bcb7-146">Instead, it examines the entry identifier and forwards the call to another **OpenEntry** method implemented by the appropriate service provider.</span></span> <span data-ttu-id="8bcb7-147">たとえば、メッセージのエントリ識別子を含む**imapisession:: openentry**を呼び出すと、MAPI はメッセージを処理するメッセージストアの**IMSLogon:: openentry**メソッドを呼び出します。</span><span class="sxs-lookup"><span data-stu-id="8bcb7-147">For example, if you call **IMAPISession::OpenEntry** with the entry identifier of a message, MAPI calls the **IMSLogon::OpenEntry** method of the message store responsible for the message.</span></span> 
  
<span data-ttu-id="8bcb7-148">クライアントは、セッションを使用してオブジェクトを開くだけでなく、それらを使用してオブジェクトを比較します。</span><span class="sxs-lookup"><span data-stu-id="8bcb7-148">In addition to using the session to open objects, clients use it to compare them.</span></span> <span data-ttu-id="8bcb7-149">[imapisession:: compareentryids](imapisession-compareentryids.md)メソッドは、エントリ識別子を比較してオブジェクトを比較します。</span><span class="sxs-lookup"><span data-stu-id="8bcb7-149">The [IMAPISession::CompareEntryIDs](imapisession-compareentryids.md) method compares objects by comparing their entry identifiers.</span></span> <span data-ttu-id="8bcb7-150">エントリ識別子に含まれている[MAPIUID](mapiuid.md)構造が同じサービスプロバイダーに属している場合、MAPI はそのプロバイダーに呼び出しを転送します。</span><span class="sxs-lookup"><span data-stu-id="8bcb7-150">If the [MAPIUID](mapiuid.md) structures contained within the entry identifiers belong to the same service provider, MAPI forwards the call to that provider.</span></span> <span data-ttu-id="8bcb7-151">**compareentryids**は、2つのエントリ識別子が一致しない場合にエラー値を返します。</span><span class="sxs-lookup"><span data-stu-id="8bcb7-151">**CompareEntryIDs** returns an error value when the two entry identifiers do not match.</span></span> <span data-ttu-id="8bcb7-152">このメソッドは、任意の種類のオブジェクトに属するエントリ識別子を比較できますが、 **compareentryids**は、メッセージストアやアドレス帳コンテナーなどの上位レベルのオブジェクトに最適です。</span><span class="sxs-lookup"><span data-stu-id="8bcb7-152">Although this method can compare entry identifiers that belong to any type of object, **CompareEntryIDs** works best for higher level objects such as message stores and address book containers.</span></span> <span data-ttu-id="8bcb7-153">下位レベルのオブジェクトを比較するには、オブジェクトの検索キー (**PR_SEARCH_KEY** ([PidTagSearchKey](pidtagsearchkey-canonical-property.md))) またはレコードキー (**PR_RECORD_KEY** ([PidTagRecordKey](pidtagrecordkey-canonical-property.md))) を直接比較します。</span><span class="sxs-lookup"><span data-stu-id="8bcb7-153">To compare lower level objects, compare directly the objects' search keys (**PR_SEARCH_KEY** ([PidTagSearchKey](pidtagsearchkey-canonical-property.md))) or record keys (**PR_RECORD_KEY** ([PidTagRecordKey](pidtagrecordkey-canonical-property.md))).</span></span> 
  
<span data-ttu-id="8bcb7-154">**openentry**と同様に、 **compareentryids**は複数のオブジェクトで実装されています。</span><span class="sxs-lookup"><span data-stu-id="8bcb7-154">Like **OpenEntry**, **CompareEntryIDs** is implemented by multiple objects.</span></span> <span data-ttu-id="8bcb7-155">開かれるか、または比較されるオブジェクトについての情報量に応じて、どの**openentry**および**compareentryid**メソッドを使用するかを選択します。</span><span class="sxs-lookup"><span data-stu-id="8bcb7-155">Choose which **OpenEntry** and **CompareEntryID** method to use according to the amount of information that you have about the object or objects to be opened or compared.</span></span> <span data-ttu-id="8bcb7-156">呼び出すインターフェイスメソッドを決定する際には、次のガイドラインを使用します。</span><span class="sxs-lookup"><span data-stu-id="8bcb7-156">Use the following guidelines when deciding which interface method to call:</span></span> 
  
- <span data-ttu-id="8bcb7-157">ターゲットオブジェクトに関する情報がない場合は、 [imapisession:: openentry](imapisession-openentry.md)または[imapisession:: compareentryids](imapisession-compareentryids.md)を呼び出します。</span><span class="sxs-lookup"><span data-stu-id="8bcb7-157">If you have no information about the target objects, call [IMAPISession::OpenEntry](imapisession-openentry.md) or [IMAPISession::CompareEntryIDs](imapisession-compareentryids.md).</span></span> <span data-ttu-id="8bcb7-158">この方法を使用すると、任意のオブジェクトにアクセスできますが、3つのうち最も低速です。</span><span class="sxs-lookup"><span data-stu-id="8bcb7-158">This approach enables access to any object, but is the slowest of the three.</span></span>
    
- <span data-ttu-id="8bcb7-159">ターゲットオブジェクトがフォルダーなどではなく、アドレス帳のエントリであることがわかっている場合は、 [IAddrBook:: openentry](iaddrbook-openentry.md)または[IAddrBook:: compareentryids](iaddrbook-compareentryids.md)メソッドを呼び出します。</span><span class="sxs-lookup"><span data-stu-id="8bcb7-159">If you know that the target objects are address book entries rather than, for example, folders, call the [IAddrBook::OpenEntry](iaddrbook-openentry.md) or [IAddrBook::CompareEntryIDs](iaddrbook-compareentryids.md) method.</span></span> <span data-ttu-id="8bcb7-160">**IAddrBook:: openentry**は、ターゲットオブジェクトとして NULL が指定されている場合に、アドレス帳のルートコンテナーを開きます。</span><span class="sxs-lookup"><span data-stu-id="8bcb7-160">**IAddrBook::OpenEntry** opens the root container of the address book when NULL is specified as the target object.</span></span> <span data-ttu-id="8bcb7-161">この方法を使用すると、アドレス帳オブジェクトへのアクセスが可能になり、 **imapisession**を使用するよりも高速になりますが、 **IMAPIContainer**を使用するよりも時間がかかります。</span><span class="sxs-lookup"><span data-stu-id="8bcb7-161">This approach enables access to any address book object and is faster than using **IMAPISession**, but slower than using **IMAPIContainer**.</span></span>
    
- <span data-ttu-id="8bcb7-162">使用されているエントリ識別子が短い用語エントリ識別子である場合、または対象のオブジェクトが特定のアドレス帳のコンテナーまたはフォルダーに属していることがわかっている場合は、 [IMAPIContainer:: openentry](imapicontainer-openentry.md)メソッドを呼び出します。</span><span class="sxs-lookup"><span data-stu-id="8bcb7-162">If the entry identifier being used is a short-term entry identifier or if you know that the target objects belong to a particular address book container or folder, call the [IMAPIContainer::OpenEntry](imapicontainer-openentry.md) method.</span></span> <span data-ttu-id="8bcb7-163">この方法では、最速のパフォーマンスが得られますが、特定のコンテナーまたはフォルダー内のオブジェクトへのアクセスのみが可能になります。</span><span class="sxs-lookup"><span data-stu-id="8bcb7-163">This approach yields the fastest performance, but enables access only to objects in a specific container or folder.</span></span> 
    

