---
title: �ǂݎ���p�̃��b�Z�[�W�̕ۑ�
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 752ff2d6-ca64-4507-adf1-4c054c321203
description: '�ŏI�X�V��: 2011�N7��23��'
ms.openlocfilehash: f82c213b6e0737c27c4e979fc90109b38b0746f0
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 06/11/2018
ms.locfileid: "19803730"
---
# <a name="read-only-message-stores"></a><span data-ttu-id="fac79-103">�ǂݎ���p�̃��b�Z�[�W�̕ۑ�</span><span class="sxs-lookup"><span data-stu-id="fac79-103">Read-Only Message Stores</span></span>

  
  
<span data-ttu-id="fac79-104">**適用されます**: Outlook</span><span class="sxs-lookup"><span data-stu-id="fac79-104">**Applies to**: Outlook</span></span> 
  
<span data-ttu-id="fac79-105">読み取り専用のメッセージ ・ ストアはどちらも、MAPI クライアントも MAPI スプーラーを無効ことができますを作成、変更、またはメッセージ ・ ストア内のオブジェクトを削除します。</span><span class="sxs-lookup"><span data-stu-id="fac79-105">A read-only message store is one in which neither the MAPI client nor the MAPI spooler can create, modify, or delete the objects in the message store.</span></span> <span data-ttu-id="fac79-106">読み取り専用のメッセージ ストアを実装する理由の多くの理由があります。</span><span class="sxs-lookup"><span data-stu-id="fac79-106">There are many reasons why you might want to implement a read-only message store.</span></span> <span data-ttu-id="fac79-107">などのクレジット レポートの事務所を参照してくださいですが、個々 のクレジット レポートを変更するのにには、顧客や従業員を許可するのに読み取り専用ストアを使用する可能性があります。</span><span class="sxs-lookup"><span data-stu-id="fac79-107">For example, a credit reporting firm could use a read-only store to allow its customers or employees to see but not change individual credit reports.</span></span> <span data-ttu-id="fac79-108">読み取り専用のメッセージ ストアを作成するを選択すると、ストア プロバイダーの構造と、ストア自体への影響があります。</span><span class="sxs-lookup"><span data-stu-id="fac79-108">Choosing to make a read-only message store has implications for the structure of the store provider and for the store itself.</span></span> <span data-ttu-id="fac79-109">などのため、読み取り専用のメッセージ ・ ストアは送信トレイ フォルダーを持つことはできませんし、MAPI クライアントがそのフォルダーで、新しい送信メッセージを作成することを要求するとします。</span><span class="sxs-lookup"><span data-stu-id="fac79-109">For example, a read-only message store cannot have an Outbox folder, because then MAPI clients would request that new outgoing messages be created in that folder.</span></span> <span data-ttu-id="fac79-110">同様は、ストア プロバイダーの基になるストレージ ・ メカニズムの整合性を確保します。</span><span class="sxs-lookup"><span data-stu-id="fac79-110">Similarly, it is the store provider's responsibility to ensure the integrity of the underlying storage mechanism.</span></span>
  
<span data-ttu-id="fac79-111">3 つのフラグ メッセージ ストアの**PR_STORE_SUPPORT_MASK** ([PidTagStoreSupportMask](pidtagstoresupportmask-canonical-property.md)) のプロパティで設定できるさまざまなレベルの読み取り専用アクセスをサポートするにはあります。</span><span class="sxs-lookup"><span data-stu-id="fac79-111">There are three flags that can be set in the message store's **PR_STORE_SUPPORT_MASK** ([PidTagStoreSupportMask](pidtagstoresupportmask-canonical-property.md)) property that support different levels of read-only access.</span></span> <span data-ttu-id="fac79-112">STORE_READONLY フラグを指定するすべて[IMAPIProp: IUnknown](imapipropiunknown.md)メッセージ ・ ストア内のオブジェクト上のインターフェイスには、読み取り専用です。</span><span class="sxs-lookup"><span data-stu-id="fac79-112">The STORE_READONLY flag indicates that all [IMAPIProp : IUnknown](imapipropiunknown.md) interfaces on objects in the message store are read-only.</span></span> <span data-ttu-id="fac79-113">STORE_MODIFY_OK フラグは、メッセージ ・ ストア内の既存のメッセージを変更することがありますが、新しいフォルダーとメッセージを作成しない場合があることを示します。</span><span class="sxs-lookup"><span data-stu-id="fac79-113">The STORE_MODIFY_OK flag indicates that existing messages in the message store may be modified, but new folders and messages may not be created.</span></span> <span data-ttu-id="fac79-114">STORE_CREATE_OK フラグは、新しいメッセージおよびフォルダーを作成することがありますが何も既存のオブジェクトを変更することがあるかどうかを示すことを示します。</span><span class="sxs-lookup"><span data-stu-id="fac79-114">The STORE_CREATE_OK flag indicates that new messages and folders may be created, but indicates nothing about whether existing objects may be modified.</span></span> 
  
<span data-ttu-id="fac79-115">事実、MAPI クライアントと、MAPI スプーラーできないことがありますを作成、変更、またはメッセージ ・ ストア内のオブジェクトを削除するとは限りません、基になるストレージ機構の内容が変更されません。</span><span class="sxs-lookup"><span data-stu-id="fac79-115">The fact that MAPI clients and the MAPI spooler may not be able to create, modify, or delete objects in the message store does not mean that the contents of the underlying storage mechanism never change.</span></span> <span data-ttu-id="fac79-116">ストア プロバイダーは、必要はありません、基になるストレージ機構への書き込み権限を意味します。</span><span class="sxs-lookup"><span data-stu-id="fac79-116">Nor does it mean that your store provider never needs write permission to the underlying storage mechanism.</span></span> <span data-ttu-id="fac79-117">状況によってはこれら 2 つの条件を適用するが読み取り専用のメッセージの一般的なケースではなく保存します。</span><span class="sxs-lookup"><span data-stu-id="fac79-117">In some circumstances those two conditions may apply, but not in the general case of a read-only message store.</span></span> <span data-ttu-id="fac79-118">レベルのアクセスをストア プロバイダーを必要とし、ストア プロバイダーがこれまで、基になるストレージ機構のデータを変更するかどうかは、ストア プロバイダーの特定の性質に主に依存します。</span><span class="sxs-lookup"><span data-stu-id="fac79-118">The level of access that your store provider requires and whether or not your store provider ever changes data in the underlying storage mechanism depends mainly on the specific nature of your store provider.</span></span>
  
<span data-ttu-id="fac79-119">などの MAPI クライアントに CD-ROM デバイスに格納されているデータベースへのアクセスを許可するのには、ストア プロバイダーを作成している場合、基になるストレージ機構を変更することはできず、ストア プロバイダーは、読み取り専用権限を持つことができます。</span><span class="sxs-lookup"><span data-stu-id="fac79-119">For example, if you are writing a store provider to give MAPI clients access to a database stored on a CD-ROM device, the underlying storage mechanism cannot change and your store provider can have read-only permission for it.</span></span> <span data-ttu-id="fac79-120">ストア プロバイダーが新しいデータを書き込む必要がある場合、ただし、パブリック フォルダー データベースに読み取り専用アクセスの MAPI クライアントを提供するのには、ストア プロバイダーを作成しているが、ストア プロバイダーは、ユーザーごとにメッセージの開封/未開封状態を追跡する必要があります、基になるストレージ機構です。</span><span class="sxs-lookup"><span data-stu-id="fac79-120">If, however, you are writing a store provider to give MAPI clients read-only access to a public folder database, but the store provider needs to keep track of the read/unread status of messages for each user, the store provider will need to write new data to the underlying storage mechanism.</span></span> <span data-ttu-id="fac79-121">ただし、どちらの例ではストア プロバイダーがあるを作成、変更、またはフォルダーまたはメッセージを MAPI クライアントまたは MAPI スプーラーの要求で削除します。</span><span class="sxs-lookup"><span data-stu-id="fac79-121">However, in neither example does the store provider ever have to create, modify, or delete folders or messages at the request of MAPI clients or the MAPI spooler.</span></span>
  
<span data-ttu-id="fac79-122">�f�[�^���ɂȂ�X�g���[�W�@�\�͓ǂݎ���p�ɏ������ރX�g�A �v���o�C�_�[���K�v�ȗ��R�̊ȒP�ȃ��X�g�́A���̂Ƃ���ł��B</span><span class="sxs-lookup"><span data-stu-id="fac79-122">The short list of reasons that a store provider would need to write data to an underlying storage mechanism that is otherwise read-only is as follows:</span></span>
  
- <span data-ttu-id="fac79-123">���b�Z�[�W�̊J���܂��͖��J���̏�Ԃ�ۑ����܂��B</span><span class="sxs-lookup"><span data-stu-id="fac79-123">To store the read/unread status of messages.</span></span>
    
- <span data-ttu-id="fac79-124">�ǂݎ��/nonread �ʒm��������܂��B</span><span class="sxs-lookup"><span data-stu-id="fac79-124">To implement read/nonread notifications.</span></span> 
    
- <span data-ttu-id="fac79-125">�r���[��ۑ����܂��B</span><span class="sxs-lookup"><span data-stu-id="fac79-125">To store views.</span></span>
    
- <span data-ttu-id="fac79-126">���[�U�[��\`�̃t�H���_�[�̕��בւ������̉i���I�ȃC���f�b�N�X��L���b�V�����܂��B</span><span class="sxs-lookup"><span data-stu-id="fac79-126">To cache persistent indexes for user-defined folder sort orders.</span></span>
    
- <span data-ttu-id="fac79-127">( [IMAPIFolder::SaveContentsSort](imapifolder-savecontentssort.md)��T�|�[�g) �̃t�H���_�[�̓�e�̕��בւ�������ۑ����܂��B</span><span class="sxs-lookup"><span data-stu-id="fac79-127">To store the sort order of a folder's contents (supporting [IMAPIFolder::SaveContentsSort](imapifolder-savecontentssort.md)).</span></span>
    
- <span data-ttu-id="fac79-128">メッセージ ストア プロバイダーは、( [IMAPIContainer::SetSearchCriteria](imapicontainer-setsearchcriteria.md)のサポート) の検索をサポートしている場合の検索条件を保存するには、状態、および、結果を検索します。</span><span class="sxs-lookup"><span data-stu-id="fac79-128">To store search criteria, search state, and results, if the message store provider supports searches (supporting [IMAPIContainer::SetSearchCriteria](imapicontainer-setsearchcriteria.md)).</span></span>
    
<span data-ttu-id="fac79-129">メッセージ ストア プロバイダーは、基になるストレージ機構にデータを記述することができることはない場合、は、基になるストレージ機構の外部の別のストレージ メカニズムを使用してこれらの機能を実装する必要があります。</span><span class="sxs-lookup"><span data-stu-id="fac79-129">If your message store provider can never write data to the underlying storage mechanism, it will need to implement these features by using a separate storage mechanism outside of the underlying storage mechanism.</span></span> <span data-ttu-id="fac79-130">などの読み取り専用のメッセージ ストア プロバイダーは、ファイルがユーザーのコンピューター上のストアにメッセージの開封/未開封状態を格納する可能性があります。</span><span class="sxs-lookup"><span data-stu-id="fac79-130">For example, a read-only message store provider could store the read/unread status of messages in the store in a file on the user's computer.</span></span> <span data-ttu-id="fac79-131">この戦略は、他の問題を提示しますが、可能性があります読み取り専用のメッセージの唯一のほかの方法の一部の機能を実装するためにストア プロバイダーです。</span><span class="sxs-lookup"><span data-stu-id="fac79-131">This strategy presents additional difficulties but may be the only feasable way for read-only message store providers to implement some features.</span></span> <span data-ttu-id="fac79-132">メッセージ ・ ストア内のオブジェクトと同期して別のストレージ ・ メカニズムの内容を保持することはメッセージ ストア自体で直接読み取りまたは未読の状態を格納するよりもより困難になります。</span><span class="sxs-lookup"><span data-stu-id="fac79-132">For example, keeping the contents of the separate storage mechanism synchronized with the objects in the message store is more difficult than storing the read/unread status directly in the message store itself.</span></span>
  
<span data-ttu-id="fac79-133">検索すると、読み取り専用のメッセージ ストア プロバイダーのさらに複雑なが表示されます。</span><span class="sxs-lookup"><span data-stu-id="fac79-133">Searching presents an additional complication for read-only message store providers.</span></span> <span data-ttu-id="fac79-134">クライアントは、検索結果を得るためのフォルダーを検索するのにメッセージ ストア オブジェクトの**PR_FINDER_ENTRYID** ([PidTagFinderEntryId](pidtagfinderentryid-canonical-property.md)) のプロパティで指定したフォルダーを使用します。</span><span class="sxs-lookup"><span data-stu-id="fac79-134">Clients use the folder specified in the message store object's **PR_FINDER_ENTRYID** ([PidTagFinderEntryId](pidtagfinderentryid-canonical-property.md)) property to locate the folder used for search results.</span></span> <span data-ttu-id="fac79-135">多くの場合読み取り専用メッセージ ストア プロバイダーは、メッセージ ・ ストアに永続的な検索の結果フォルダーをインストールできません。</span><span class="sxs-lookup"><span data-stu-id="fac79-135">Read-only message store providers often cannot install a permanent search-results folder into the message store.</span></span> <span data-ttu-id="fac79-136">そのような場合は、メッセージ ストア プロバイダーがから 1 つの読み取りではなく、検索結果フォルダーを動的に作成することができるように、クライアントがフォルダーを開くときに認識する**PR_FINDER_ENTRYID**プロパティのエントリ識別子を格納します、。基になるストレージ機構です。</span><span class="sxs-lookup"><span data-stu-id="fac79-136">In that situation, the message store provider should store an entry identifier in the **PR_FINDER_ENTRYID** property that it can recognize when clients open folders so that it can dynamically create a search-results folder instead of reading one from the underlying storage mechanism.</span></span> <span data-ttu-id="fac79-137">ただし、多くの読み取り専用のメッセージ ストア プロバイダーは、すべてのフォルダーを動的に作成、ためこれは通常の負担が多すぎます。</span><span class="sxs-lookup"><span data-stu-id="fac79-137">However, because many read-only message store providers create all their folders dynamically, this is usually not too much of a burden.</span></span> 
  
<span data-ttu-id="fac79-138">ストア プロバイダー オブジェクトの**PR_STORE_SUPPORT_MASK**プロパティに、メッセージ ストア プロバイダーが読み取り専用であるという事実がアドバタイズされます。</span><span class="sxs-lookup"><span data-stu-id="fac79-138">The fact that your message store provider is read-only is advertised in the store provider object's **PR_STORE_SUPPORT_MASK** property.</span></span> <span data-ttu-id="fac79-139">ただし、そのプロパティを使用するクライアントにカウントされません。ストア プロバイダーのコードは、基になるストレージ機構の読み取り専用ステータスを適用する必要があります。</span><span class="sxs-lookup"><span data-stu-id="fac79-139">However, do not count on clients to respect that property; your store provider's code should enforce the read-only status of the underlying storage mechanism.</span></span> 
  
## <a name="see-also"></a><span data-ttu-id="fac79-140">�֘A����</span><span class="sxs-lookup"><span data-stu-id="fac79-140">See also</span></span>



<span data-ttu-id="fac79-141">[MAPI ���b�Z�[�W �X�g�A �v���o�C�_�[�̊J��](developing-a-mapi-message-store-provider.md)</span><span class="sxs-lookup"><span data-stu-id="fac79-141">[Developing a MAPI Message Store Provider](developing-a-mapi-message-store-provider.md)</span></span>

