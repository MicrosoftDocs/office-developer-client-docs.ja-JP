---
title: �ǂݎ���p�̃��b�Z�[�W�̕ۑ�
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 752ff2d6-ca64-4507-adf1-4c054c321203
description: '�ŏI�X�V��: 2011�N7��23��'
ms.openlocfilehash: f82c213b6e0737c27c4e979fc90109b38b0746f0
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 06/11/2018
ms.locfileid: "19803730"
---
# <a name="read-only-message-stores"></a>�ǂݎ���p�̃��b�Z�[�W�̕ۑ�

  
  
**適用されます**: Outlook 
  
読み取り専用のメッセージ ・ ストアはどちらも、MAPI クライアントも MAPI スプーラーを無効ことができますを作成、変更、またはメッセージ ・ ストア内のオブジェクトを削除します。 読み取り専用のメッセージ ストアを実装する理由の多くの理由があります。 などのクレジット レポートの事務所を参照してくださいですが、個々 のクレジット レポートを変更するのにには、顧客や従業員を許可するのに読み取り専用ストアを使用する可能性があります。 読み取り専用のメッセージ ストアを作成するを選択すると、ストア プロバイダーの構造と、ストア自体への影響があります。 などのため、読み取り専用のメッセージ ・ ストアは送信トレイ フォルダーを持つことはできませんし、MAPI クライアントがそのフォルダーで、新しい送信メッセージを作成することを要求するとします。 同様は、ストア プロバイダーの基になるストレージ ・ メカニズムの整合性を確保します。
  
3 つのフラグ メッセージ ストアの**PR_STORE_SUPPORT_MASK** ([PidTagStoreSupportMask](pidtagstoresupportmask-canonical-property.md)) のプロパティで設定できるさまざまなレベルの読み取り専用アクセスをサポートするにはあります。 STORE_READONLY フラグを指定するすべて[IMAPIProp: IUnknown](imapipropiunknown.md)メッセージ ・ ストア内のオブジェクト上のインターフェイスには、読み取り専用です。 STORE_MODIFY_OK フラグは、メッセージ ・ ストア内の既存のメッセージを変更することがありますが、新しいフォルダーとメッセージを作成しない場合があることを示します。 STORE_CREATE_OK フラグは、新しいメッセージおよびフォルダーを作成することがありますが何も既存のオブジェクトを変更することがあるかどうかを示すことを示します。 
  
事実、MAPI クライアントと、MAPI スプーラーできないことがありますを作成、変更、またはメッセージ ・ ストア内のオブジェクトを削除するとは限りません、基になるストレージ機構の内容が変更されません。 ストア プロバイダーは、必要はありません、基になるストレージ機構への書き込み権限を意味します。 状況によってはこれら 2 つの条件を適用するが読み取り専用のメッセージの一般的なケースではなく保存します。 レベルのアクセスをストア プロバイダーを必要とし、ストア プロバイダーがこれまで、基になるストレージ機構のデータを変更するかどうかは、ストア プロバイダーの特定の性質に主に依存します。
  
などの MAPI クライアントに CD-ROM デバイスに格納されているデータベースへのアクセスを許可するのには、ストア プロバイダーを作成している場合、基になるストレージ機構を変更することはできず、ストア プロバイダーは、読み取り専用権限を持つことができます。 ストア プロバイダーが新しいデータを書き込む必要がある場合、ただし、パブリック フォルダー データベースに読み取り専用アクセスの MAPI クライアントを提供するのには、ストア プロバイダーを作成しているが、ストア プロバイダーは、ユーザーごとにメッセージの開封/未開封状態を追跡する必要があります、基になるストレージ機構です。 ただし、どちらの例ではストア プロバイダーがあるを作成、変更、またはフォルダーまたはメッセージを MAPI クライアントまたは MAPI スプーラーの要求で削除します。
  
�f�[�^���ɂȂ�X�g���[�W�@�\�͓ǂݎ���p�ɏ������ރX�g�A �v���o�C�_�[���K�v�ȗ��R�̊ȒP�ȃ��X�g�́A���̂Ƃ���ł��B
  
- ���b�Z�[�W�̊J���܂��͖��J���̏�Ԃ�ۑ����܂��B
    
- �ǂݎ��/nonread �ʒm��������܂��B 
    
- �r���[��ۑ����܂��B
    
- ���[�U�[��`�̃t�H���_�[�̕��בւ������̉i���I�ȃC���f�b�N�X��L���b�V�����܂��B
    
- ( [IMAPIFolder::SaveContentsSort](imapifolder-savecontentssort.md)��T�|�[�g) �̃t�H���_�[�̓�e�̕��בւ�������ۑ����܂��B
    
- メッセージ ストア プロバイダーは、( [IMAPIContainer::SetSearchCriteria](imapicontainer-setsearchcriteria.md)のサポート) の検索をサポートしている場合の検索条件を保存するには、状態、および、結果を検索します。
    
メッセージ ストア プロバイダーは、基になるストレージ機構にデータを記述することができることはない場合、は、基になるストレージ機構の外部の別のストレージ メカニズムを使用してこれらの機能を実装する必要があります。 などの読み取り専用のメッセージ ストア プロバイダーは、ファイルがユーザーのコンピューター上のストアにメッセージの開封/未開封状態を格納する可能性があります。 この戦略は、他の問題を提示しますが、可能性があります読み取り専用のメッセージの唯一のほかの方法の一部の機能を実装するためにストア プロバイダーです。 メッセージ ・ ストア内のオブジェクトと同期して別のストレージ ・ メカニズムの内容を保持することはメッセージ ストア自体で直接読み取りまたは未読の状態を格納するよりもより困難になります。
  
検索すると、読み取り専用のメッセージ ストア プロバイダーのさらに複雑なが表示されます。 クライアントは、検索結果を得るためのフォルダーを検索するのにメッセージ ストア オブジェクトの**PR_FINDER_ENTRYID** ([PidTagFinderEntryId](pidtagfinderentryid-canonical-property.md)) のプロパティで指定したフォルダーを使用します。 多くの場合読み取り専用メッセージ ストア プロバイダーは、メッセージ ・ ストアに永続的な検索の結果フォルダーをインストールできません。 そのような場合は、メッセージ ストア プロバイダーがから 1 つの読み取りではなく、検索結果フォルダーを動的に作成することができるように、クライアントがフォルダーを開くときに認識する**PR_FINDER_ENTRYID**プロパティのエントリ識別子を格納します、。基になるストレージ機構です。 ただし、多くの読み取り専用のメッセージ ストア プロバイダーは、すべてのフォルダーを動的に作成、ためこれは通常の負担が多すぎます。 
  
ストア プロバイダー オブジェクトの**PR_STORE_SUPPORT_MASK**プロパティに、メッセージ ストア プロバイダーが読み取り専用であるという事実がアドバタイズされます。 ただし、そのプロパティを使用するクライアントにカウントされません。ストア プロバイダーのコードは、基になるストレージ機構の読み取り専用ステータスを適用する必要があります。 
  
## <a name="see-also"></a>�֘A����



[MAPI ���b�Z�[�W �X�g�A �v���o�C�_�[�̊J��](developing-a-mapi-message-store-provider.md)

