---
title: 通知の登録
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 45625387-dbd2-4ca8-926b-ef87998d01d7
description: '最終更新日: 2011 年 7 月 23 日'
ms.openlocfilehash: ccc2758b59a9227afbc50360102e793892bbdc52
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/23/2019
ms.locfileid: "32328407"
---
# <a name="registering-for-a-notification"></a>通知の登録

  
  
**適用対象**: Outlook 2013 | Outlook 2016 
  
クライアントは、初期化プロセスの一環として、アドレス帳またはメッセージストア通知の登録を行うことができます。
  
MAPI は、アドレス帳プロバイダーがサポートしているかどうかに関係なく、アドレス帳での通知をサポートします。 メッセージストアに対する通知のサポートは、特定のメッセージストアプロバイダーによって異なります。 特定のメッセージストアプロバイダーが通知をサポートしているかどうかを判断するには、その**PR_STORE_SUPPORT_MASK** ([PidTagStoreSupportMask](pidtagstoresupportmask-canonical-property.md)) プロパティを確認します。 メッセージストアが通知をサポートしている場合は、STORE_NOTIFY_OK ビットが設定されます。 
  
アドバイズソースオブジェクトの**アドバイズ**メソッドを呼び出して通知を登録します。 多くのオブジェクトは**アドバイズ**を実装し、クライアントはさまざまな方法でそれらのオブジェクトに登録できます。 
  
 **通知を登録するには**
  
1. MAPI アドバイズシンクオブジェクトを作成し、その参照カウントをインクリメントします。
    
2. 必要に応じて、 [HrThisThreadAdviseSink](hrthisthreadadvisesink.md)を呼び出して、元のアドバイズシンクをラップするアドバイズシンクオブジェクトを作成し、元の通知シンクを解放します。. 
    
3. 登録を完了するには、次のいずれかの**アドバイズ**メソッドを呼び出します。 
    
  - 呼び出し[imapisession::](imapisession-advise.md)セッション通知の登録またはアドレス帳またはメッセージストアオブジェクトの通知のための通知。 
    
  - Call [IAddrBook::](iaddrbook-advise.md)アドレス帳通知の登録、またはメッセージングユーザー、コンテナー、または配布リストでの通知についてアドバイスを行います。 
    
  - Call [IABLogon::](iablogon-advise.md)通知のユーザー、コンテナー、または配布リストに通知するために、アドレス帳プロバイダーに直接登録するようにアドバイスします。 
    
  - Call [IMsgStore::](imsgstore-advise.md)メッセージストア通知またはフォルダーまたはメッセージの通知を登録するようにアドバイスします。 
    
  - [IMSLogon:: アドバイス](imslogon-advise.md)を呼び出して、フォルダーまたはメッセージに通知するメッセージストアプロバイダーを直接登録します。 
    
  - 呼び出し[IMAPITable:: アドバイス](imapitable-advise.md)を表通知に登録します。 
    
4. Cache**アドバイズ**から返される接続番号をキャッシュします。
    
5. ラップされたアドバイズシンクを使用している場合は、それをリリースします。 ラップされたアドバイズシンクが登録されると、必要なくなります。
    
呼び出し * * imapisession:: Advise * * は、セッション全体または個々のオブジェクトに関するさまざまな通知に関する重大なエラー通知の登録を可能にします。 セッションは、共有セッションを使用している別のクライアントが[imapisession:: Logoff](imapisession-logoff.md)メソッドを呼び出すときに、共有セッションにログオンしているクライアントに重大なエラー通知を送信します。 セッション通知を登録するには、エントリ識別子パラメーターに NULL を渡します。 個々のオブジェクトの通知を登録するには、オブジェクトのエントリ識別子を渡します。 **imapisession**メソッドは、エントリ識別子の**MAPIUID**部分に基づいて、適切なサービスプロバイダーに呼び出しを転送します。 **imapisession:: アドバイス**をオブジェクト通知に登録することは、サービスプロバイダーの**アドバイズ**メソッドを呼び出すよりも簡単です。 
  
アドレス帳を使用して登録することは、セッションに登録するのと似ています。 アドレス帳から重大なエラー通知を登録するには、エントリ識別子に NULL を渡します。 特定のアドレス帳オブジェクトで通知を登録するには、適切なエントリ識別子とイベントを指定します。 多くのアドレス帳プロバイダーは、個々のオブジェクトに対する通知をサポートしていないことに注意してください。 その代わりに、コンテンツおよび階層テーブルのテーブル通知をサポートします。 
  
**アドバイズ**呼び出しから正常に復帰した直後に、 [HrAllocAdviseSink](hrallocadvisesink.md)で実装または作成したアドバイズシンクを解放することをお勧めします。 これは、サービスプロバイダーがアドバイズ呼び出しの後、アドバイズ中止呼び出しが行わ**** れる前に、アドバイズシンク**** を解放できるためです。 アドバイズソースがアドバイズシンクへのポインターを取得し、このアドバイズシンクで参照カウントがインクリメントされたら、長期に使用していない限り、リリースすることをお勧めします。 
  
> [!NOTE]
> 有効なアドバイザリの登録を表すすべての接続番号は、**アドバイズ**中止の呼び出しが行われるまで解放されません。 
  

