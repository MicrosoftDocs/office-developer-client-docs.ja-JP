---
title: One-Offテーブル
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 0f2040b7-9b6c-4eae-aa68-29c4f7b8bd76
description: '最終更新日: 2011 年 11 月 08 日'
ms.openlocfilehash: 8719536efa9bffb1226f8fb665b912eb872227f1
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/28/2019
ms.locfileid: "33439528"
---
# <a name="one-off-tables"></a><span data-ttu-id="6fc8c-103">One-Offテーブル</span><span class="sxs-lookup"><span data-stu-id="6fc8c-103">One-Off Tables</span></span>

<span data-ttu-id="6fc8c-104">**適用対象**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="6fc8c-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="6fc8c-105">1 回のテーブルには、アドレス帳プロバイダーが新しい受信者の作成にサポートするテンプレートに関する情報が含まれる。</span><span class="sxs-lookup"><span data-stu-id="6fc8c-105">A one-off table contains information about the templates that an address book provider supports for creating new recipients.</span></span> <span data-ttu-id="6fc8c-106">一時テーブルは、アドレス帳プロバイダー、個々のアドレス帳コンテナー、MAPI によって実装され、永続的または一時的な場合があります。</span><span class="sxs-lookup"><span data-stu-id="6fc8c-106">One-off tables are implemented by address book providers, individual address book containers, and by MAPI, and can be persistent or temporary.</span></span> 
  
> [!NOTE]
> <span data-ttu-id="6fc8c-107">一時テーブル内のテンプレートとテンプレート識別子を混同しない。目的は似ていますが、コード構造は似ていません。</span><span class="sxs-lookup"><span data-stu-id="6fc8c-107">Do not confuse the templates in one-off tables with template identifiers; while their purposes are similar, their code constructs are nothing alike.</span></span> <span data-ttu-id="6fc8c-108">テンプレートは、特定の種類の受信者を作成するために使用されます。一方、テンプレート識別子は、外部プロバイダーに属する別の受信者をサポートするコードを持つホスト プロバイダーに属する 1 つの受信者のデータをバインドするために使用されます。</span><span class="sxs-lookup"><span data-stu-id="6fc8c-108">Templates are used to create recipients of a particular type while template identifiers are used to bind the data of one recipient that belong to a host provider with code to support another recipient that belong to a foreign provider.</span></span> 
  
<span data-ttu-id="6fc8c-109">クライアントは新しい受信者を作成します。</span><span class="sxs-lookup"><span data-stu-id="6fc8c-109">Clients create new recipients:</span></span>
  
- <span data-ttu-id="6fc8c-110">送信メッセージの受信者リストに追加します。</span><span class="sxs-lookup"><span data-stu-id="6fc8c-110">To add to the recipient list of an outgoing message.</span></span>
    
- <span data-ttu-id="6fc8c-111">アドレス帳のコンテナーの 1 つに追加します。</span><span class="sxs-lookup"><span data-stu-id="6fc8c-111">To add to one of the containers in the address book.</span></span>
    
<span data-ttu-id="6fc8c-112">どちらのシナリオでも、アドレス帳プロバイダーは 1 回きりテーブルを返す必要があります。</span><span class="sxs-lookup"><span data-stu-id="6fc8c-112">In both scenarios, an address book provider is asked to return a one-off table.</span></span> <span data-ttu-id="6fc8c-113">アドレス帳プロバイダーは、両方の状況で使用する単一の 1 回表または状況ごとに一意の 1 回表を実装できます。</span><span class="sxs-lookup"><span data-stu-id="6fc8c-113">Address book providers can implement either a single one-off table to be used in both situations or a unique one-off table for each situation.</span></span> 
  
<span data-ttu-id="6fc8c-114">受信者が送信メッセージに含まれる場合、MAPI はアドレス帳プロバイダーの [IABLogon::GetOneOffTable](iablogon-getoneofftable.md) メソッドを呼び出して、一時テーブルを取得します。</span><span class="sxs-lookup"><span data-stu-id="6fc8c-114">When the recipient will be included with an outgoing message, MAPI calls the address book provider's [IABLogon::GetOneOffTable](iablogon-getoneofftable.md) method to retrieve its one-off table.</span></span> <span data-ttu-id="6fc8c-115">一時テーブルには、有効なアドレスを持つ受信者が作成される情報をユーザーが入力できるテンプレートが含まれています。</span><span class="sxs-lookup"><span data-stu-id="6fc8c-115">The one-off table includes templates which enable a user to enter information resulting in the creation of a recipient with a valid address.</span></span> <span data-ttu-id="6fc8c-116">MAPI は、変更をユーザーに反映できるよう、このテーブルの通知を開いた状態で登録します。</span><span class="sxs-lookup"><span data-stu-id="6fc8c-116">MAPI registers for notifications on this table, keeping it open so that changes can be reflected to the user.</span></span> <span data-ttu-id="6fc8c-117">MAPI は、サブシステムまたはアドレス帳の状態オブジェクトの [IMAPIStatus::ValidateState](imapistatus-validatestate.md) メソッドが呼び出された場合にのみ、テーブルを解放します。</span><span class="sxs-lookup"><span data-stu-id="6fc8c-117">MAPI releases the table only when its subsystem or address book status object's [IMAPIStatus::ValidateState](imapistatus-validatestate.md) method is called.</span></span> 
  
<span data-ttu-id="6fc8c-118">受信者がコンテナーに追加される場合、MAPI は別の呼び出しを行い、コンテナーの [IMAPIProp::OpenProperty](imapiprop-openproperty.md) メソッドを呼び出して、PR_CREATE_TEMPLATES **(** [PidTagCreateTemplates](pidtagcreatetemplates-canonical-property.md)) プロパティを取得します。</span><span class="sxs-lookup"><span data-stu-id="6fc8c-118">When the recipient will be added to a container, MAPI makes a different call, invoking the container's [IMAPIProp::OpenProperty](imapiprop-openproperty.md) method to retrieve its **PR_CREATE_TEMPLATES** ([PidTagCreateTemplates](pidtagcreatetemplates-canonical-property.md)) property.</span></span> <span data-ttu-id="6fc8c-119">この一時テーブルに含まれるテンプレートのセットは、コンテナーに追加できる受信者の種類を表します。</span><span class="sxs-lookup"><span data-stu-id="6fc8c-119">The set of templates included in this one-off table represents the types of recipients that can be added to the container.</span></span> <span data-ttu-id="6fc8c-120">たとえば、メール サーバーは多くの場合、インストールされているゲートウェイごとに 1 つのコンテナーを公開して、各コンテナーが対応するゲートウェイに固有のアドレスのみを保持します。</span><span class="sxs-lookup"><span data-stu-id="6fc8c-120">For example, mail servers often expose one container for every gateway that is installed so that each container only holds addresses specific to the corresponding gateway.</span></span>
  
<span data-ttu-id="6fc8c-121">MAPI には、セッション内の各アドレス帳プロバイダーのテンプレートと同様に、独自のテンプレートを含む 1 回限りのテーブルが用意されています。</span><span class="sxs-lookup"><span data-stu-id="6fc8c-121">MAPI provides a one-off table that includes its own templates as well as templates from each of the address book providers in the session.</span></span> <span data-ttu-id="6fc8c-122">MAPI は、ユーザーが形式を知っていると仮定して、任意のアドレスの種類の新しい受信者を作成するために使用できる汎用テンプレートを提供します。</span><span class="sxs-lookup"><span data-stu-id="6fc8c-122">MAPI provides a generic template that can be used to create a new recipient for any address type, assuming that the user knows its format.</span></span> <span data-ttu-id="6fc8c-123">アドレス帳プロバイダーは [、IMAPISupport::GetOneOffTable](imapisupport-getoneofftable.md)を呼び出すことによって、この一時テーブルを使用します。</span><span class="sxs-lookup"><span data-stu-id="6fc8c-123">Address book providers use this one-off table by calling [IMAPISupport::GetOneOffTable](imapisupport-getoneofftable.md).</span></span> <span data-ttu-id="6fc8c-124">MAPI の一時表に含まれる各テンプレートは、有効な受信者アドレスを持つ受信者を作成します。</span><span class="sxs-lookup"><span data-stu-id="6fc8c-124">Each of the templates included in the MAPI one-off table results in the creation of recipients with valid recipient addresses.</span></span>
  
<span data-ttu-id="6fc8c-125">アドレス帳プロバイダーは、通常、サポートするアドレスの種類ごとに 1 つのテンプレートを提供します。</span><span class="sxs-lookup"><span data-stu-id="6fc8c-125">Address book providers typically supply one template for every address type they support.</span></span> <span data-ttu-id="6fc8c-126">ただし、テンプレートのサポートは必要ありません。</span><span class="sxs-lookup"><span data-stu-id="6fc8c-126">However, support for templates is not required.</span></span> <span data-ttu-id="6fc8c-127">新しいアドレスの作成を許可しないアドレス帳プロバイダーは、MAPI が 1 回MAPI_E_NO_SUPPORT要求するときにアドレス帳を返す可能性があります。</span><span class="sxs-lookup"><span data-stu-id="6fc8c-127">Address book providers that do not allow the creation of new addresses can return MAPI_E_NO_SUPPORT when MAPI calls to request a one-off table.</span></span> <span data-ttu-id="6fc8c-128">新しいアドレスの作成を許可するが、テンプレートを指定しないアドレス帳プロバイダーは **、IMAPISupport::GetOneOffTable** を呼び出して、MAPI の一時テーブルに記載されているテンプレートを使用できます。</span><span class="sxs-lookup"><span data-stu-id="6fc8c-128">Address book providers that do allow new address creation but do not supply any templates can call **IMAPISupport::GetOneOffTable** to use the templates listed in the MAPI one-off table.</span></span> 
  
<span data-ttu-id="6fc8c-129">次のプロパティは、1 回のテーブルで必要な列セットを構成します。</span><span class="sxs-lookup"><span data-stu-id="6fc8c-129">The following properties make up the required column set in one-off tables:</span></span>
  
- <span data-ttu-id="6fc8c-130">**PR_ADDRTYPE** ([PidTagAddressType](pidtagaddresstype-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="6fc8c-130">**PR_ADDRTYPE** ([PidTagAddressType](pidtagaddresstype-canonical-property.md))</span></span>
    
- <span data-ttu-id="6fc8c-131">**PR_DEPTH** ([PidTagDepth](pidtagdepth-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="6fc8c-131">**PR_DEPTH** ([PidTagDepth](pidtagdepth-canonical-property.md))</span></span>
    
- <span data-ttu-id="6fc8c-132">**PR_DISPLAY_NAME** ([PidTagDisplayName](pidtagdisplayname-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="6fc8c-132">**PR_DISPLAY_NAME** ([PidTagDisplayName](pidtagdisplayname-canonical-property.md))</span></span>
    
- <span data-ttu-id="6fc8c-133">**PR_DISPLAY_TYPE** ([PidTagDisplayType](pidtagdisplaytype-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="6fc8c-133">**PR_DISPLAY_TYPE** ([PidTagDisplayType](pidtagdisplaytype-canonical-property.md))</span></span>
    
- <span data-ttu-id="6fc8c-134">**PR_ENTRYID** ([PidTagEntryId](pidtagentryid-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="6fc8c-134">**PR_ENTRYID** ([PidTagEntryId](pidtagentryid-canonical-property.md))</span></span>
    
- <span data-ttu-id="6fc8c-135">**PR_INSTANCE_KEY** ([PidTagInstanceKey](pidtaginstancekey-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="6fc8c-135">**PR_INSTANCE_KEY** ([PidTagInstanceKey](pidtaginstancekey-canonical-property.md))</span></span>
    
- <span data-ttu-id="6fc8c-136">**PR_SELECTABLE** ([PidTagSelectable](pidtagselectable-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="6fc8c-136">**PR_SELECTABLE** ([PidTagSelectable](pidtagselectable-canonical-property.md))</span></span>
    
 <span data-ttu-id="6fc8c-137">**PR_ADDRTYPE** テンプレートで作成された新しい受信者に関連付けられるアドレスの種類を示します。</span><span class="sxs-lookup"><span data-stu-id="6fc8c-137">**PR_ADDRTYPE** indicates the type of address that can be associated with the new recipient created with the template.</span></span> 
  
 <span data-ttu-id="6fc8c-138">**PR_DISPLAY_NAME\*\*\*\*とPR_DISPLAY_TYPE** を新しい受信者に関連付ける必要があります。</span><span class="sxs-lookup"><span data-stu-id="6fc8c-138">**PR_DISPLAY_NAME** and **PR_DISPLAY_TYPE** associate data with the new recipient.</span></span> <span data-ttu-id="6fc8c-139">**PR_DISPLAY_NAME** には、新しい受信者を識別する文字列が含まれます **。PR_DISPLAY_TYPE** には、行と一緒に表示するアイコンの種類を識別する定数が含まれます。</span><span class="sxs-lookup"><span data-stu-id="6fc8c-139">**PR_DISPLAY_NAME** contains a character string that identifies the new recipient and **PR_DISPLAY_TYPE** contains a constant that identifies the type of icon to be displayed with the row.</span></span> <span data-ttu-id="6fc8c-140">メッセージング ユーザー用のテンプレートには、PR_DISPLAY_TYPE **列が** 設定DT_MAILUSER。配布リストのテンプレートの列は **、PR_DISPLAY_TYPEに設定** DT_DISTLIST。</span><span class="sxs-lookup"><span data-stu-id="6fc8c-140">Templates for messaging users have their **PR_DISPLAY_TYPE** column set to DT_MAILUSER; templates for distribution lists have their **PR_DISPLAY_TYPE** column set to DT_DISTLIST.</span></span> 
  
 <span data-ttu-id="6fc8c-141">**PR_ENTRYID** は、新しい受信者の作成に使用するテンプレートのエントリ識別子です。</span><span class="sxs-lookup"><span data-stu-id="6fc8c-141">**PR_ENTRYID** is the entry identifier of the template to be used to create a new recipient.</span></span> <span data-ttu-id="6fc8c-142">このエントリ識別子は、将来の[IAddrBook::NewEntry、IAddrBook::OpenEntry、](iaddrbook-openentry.md)[および IABContainer::CreateEntry](iabcontainer-createentry.md)呼び出しに渡されます。 [](iaddrbook-newentry.md)</span><span class="sxs-lookup"><span data-stu-id="6fc8c-142">This entry identifier can be passed to future [IAddrBook::NewEntry](iaddrbook-newentry.md), [IAddrBook::OpenEntry](iaddrbook-openentry.md), and [IABContainer::CreateEntry](iabcontainer-createentry.md) calls.</span></span> <span data-ttu-id="6fc8c-143">コンテナーは、既定のメッセージング ユーザー テンプレートの行の **PR_ENTRYID** 列を **PR_DEF_CREATE_MAILUSER** ([PidTagDefCreateMailuser](pidtagdefcreatemailuser-canonical-property.md)) に設定し、既定の配布リスト テンプレートの行の **PR_ENTRYID** 列を **PR_DEF_CREATE_DL** ([PidTagDefCreateDl)](pidtagdefcreatedl-canonical-property.md)に設定します。</span><span class="sxs-lookup"><span data-stu-id="6fc8c-143">Containers set the **PR_ENTRYID** column of their row for the default messaging user template to **PR_DEF_CREATE_MAILUSER** ([PidTagDefCreateMailuser](pidtagdefcreatemailuser-canonical-property.md)) and the **PR_ENTRYID** column of their row for the default distribution list template to **PR_DEF_CREATE_DL** ([PidTagDefCreateDl](pidtagdefcreatedl-canonical-property.md)).</span></span> 
  
 <span data-ttu-id="6fc8c-144">**PR_DEPTH** は、テンプレートのインデントのレベルを示して、1 回のテーブル内のエントリの階層表示をサポートするために使用されます。</span><span class="sxs-lookup"><span data-stu-id="6fc8c-144">**PR_DEPTH** is used to support the hierarchical display of the entries in a one-off table by indicating the level of indentation for the template.</span></span> <span data-ttu-id="6fc8c-145">1 回限りテーブルはフラット リストまたは階層表示として表示することができますが、後者が望ましく、アドレス帳プロバイダーは行ごとに **PR_DEPTH** 列を適切に設定してサポートする必要があります。</span><span class="sxs-lookup"><span data-stu-id="6fc8c-145">Although one-off tables can be displayed either as a flat list or a hierarchical display, the latter is preferable and address book providers should support it by setting the **PR_DEPTH** column for each row appropriately.</span></span> <span data-ttu-id="6fc8c-146">**PR_DEPTH** はゼロベースです。列の値が 0 の **行PR_DEPTHインデント** されません。</span><span class="sxs-lookup"><span data-stu-id="6fc8c-146">**PR_DEPTH** is zero-based; rows with a value of 0 in their **PR_DEPTH** column are not indented.</span></span> <span data-ttu-id="6fc8c-147">値が大 **きいほどPR_DEPTH** 行がインデントされます。</span><span class="sxs-lookup"><span data-stu-id="6fc8c-147">The higher the value of **PR_DEPTH**, the more the row is indented.</span></span> <span data-ttu-id="6fc8c-148">たとえば、1 に設定 **PR_DEPTH** 行は 1 つのタブにインデントされ、3 に設定された行は 3 **つのタブPR_DEPTH** インデントされます。</span><span class="sxs-lookup"><span data-stu-id="6fc8c-148">For example, rows with **PR_DEPTH** set to 1 are indented one tab while rows with **PR_DEPTH** set to 3 are indented three tabs.</span></span> 
  
 <span data-ttu-id="6fc8c-149">**PR_SELECTABLE** は、テーブル内の行が、新しい受信者を作成するために選択して使用できるテンプレートを表すかどうかを示すために使用されます。</span><span class="sxs-lookup"><span data-stu-id="6fc8c-149">**PR_SELECTABLE** is used to indicate whether a row in the table represents a template that can be selected and used to create a new recipient.</span></span> <span data-ttu-id="6fc8c-150">1 回表のほとんどの行はテンプレートを表しますが、プロバイダーにはテンプレート以外の行を含めできます。</span><span class="sxs-lookup"><span data-stu-id="6fc8c-150">Although most rows in a one-off table do represent templates, providers can include non-template rows.</span></span> <span data-ttu-id="6fc8c-151">たとえば、プロバイダーは、表示に表示されるが受信者の作成には使用されないカテゴリ行を含む、テンプレートの種類別に 1 回のテーブルを整理できます。</span><span class="sxs-lookup"><span data-stu-id="6fc8c-151">For example, a provider might want to organize the one-off table by template type, including a category row that appears in the display but is not used for recipient creation.</span></span> 
  
## <a name="see-also"></a><span data-ttu-id="6fc8c-152">関連項目</span><span class="sxs-lookup"><span data-stu-id="6fc8c-152">See also</span></span>



[<span data-ttu-id="6fc8c-153">MAPI テーブル</span><span class="sxs-lookup"><span data-stu-id="6fc8c-153">MAPI Tables</span></span>](mapi-tables.md)

