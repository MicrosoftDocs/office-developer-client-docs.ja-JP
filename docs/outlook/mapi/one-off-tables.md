---
title: 一時テーブル
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 0f2040b7-9b6c-4eae-aa68-29c4f7b8bd76
description: '最終更新日: 2011 年 11 月 8 日'
ms.openlocfilehash: 3ad9141f2530e64664a2d0c75ece2b834cc6ad78
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 06/11/2018
ms.locfileid: "19801667"
---
# <a name="one-off-tables"></a><span data-ttu-id="8392a-103">一時テーブル</span><span class="sxs-lookup"><span data-stu-id="8392a-103">One-Off Tables</span></span>

<span data-ttu-id="8392a-104">**適用されます**: Outlook</span><span class="sxs-lookup"><span data-stu-id="8392a-104">**Applies to**: Outlook</span></span> 
  
<span data-ttu-id="8392a-105">一時テーブルには、新しい受信者を作成するため、アドレス帳プロバイダーがサポートしているテンプレートに関する情報が含まれています。</span><span class="sxs-lookup"><span data-stu-id="8392a-105">A one-off table contains information about the templates that an address book provider supports for creating new recipients.</span></span> <span data-ttu-id="8392a-106">一時テーブルは、アドレス帳プロバイダーは、個々 のアドレス帳コンテナーと MAPI によって実装され、永続的または一時的にすることができます。</span><span class="sxs-lookup"><span data-stu-id="8392a-106">One-off tables are implemented by address book providers, individual address book containers, and by MAPI, and can be persistent or temporary.</span></span> 
  
> [!NOTE]
> <span data-ttu-id="8392a-107">テンプレート識別子を持つ一時テーブルのテンプレートを混同しないでください。それぞれの目的は似ていますが、何も、コード コンス トラクターがいます。</span><span class="sxs-lookup"><span data-stu-id="8392a-107">Do not confuse the templates in one-off tables with template identifiers; while their purposes are similar, their code constructs are nothing alike.</span></span> <span data-ttu-id="8392a-108">テンプレートを使用して、テンプレートの識別子を使用してデータをバインドする 1 つの受信者の別の受信者をサポートするためにコードのホスト プロバイダーに属している外部のプロバイダーに属している特定の種類の受信者を作成します。</span><span class="sxs-lookup"><span data-stu-id="8392a-108">Templates are used to create recipients of a particular type while template identifiers are used to bind the data of one recipient that belong to a host provider with code to support another recipient that belong to a foreign provider.</span></span> 
  
<span data-ttu-id="8392a-109">クライアントは、新しい受信者を作成します。</span><span class="sxs-lookup"><span data-stu-id="8392a-109">Clients create new recipients:</span></span>
  
- <span data-ttu-id="8392a-110">送信メッセージの受信者の一覧に追加します。</span><span class="sxs-lookup"><span data-stu-id="8392a-110">To add to the recipient list of an outgoing message.</span></span>
    
- <span data-ttu-id="8392a-111">アドレス帳コンテナーの 1 つに追加します。</span><span class="sxs-lookup"><span data-stu-id="8392a-111">To add to one of the containers in the address book.</span></span>
    
<span data-ttu-id="8392a-112">どちらのシナリオでは、アドレス帳プロバイダーは一時テーブルを取得する要求します。</span><span class="sxs-lookup"><span data-stu-id="8392a-112">In both scenarios, an address book provider is asked to return a one-off table.</span></span> <span data-ttu-id="8392a-113">アドレス帳プロバイダーには、両方の状況で使用する 1 つの一時テーブルまたはそれぞれの状況に固有の一時テーブルのいずれかを実装できます。</span><span class="sxs-lookup"><span data-stu-id="8392a-113">Address book providers can implement either a single one-off table to be used in both situations or a unique one-off table for each situation.</span></span> 
  
<span data-ttu-id="8392a-114">送信メッセージに含まれる受信者の場合、MAPI は、一時テーブルを取得するために、アドレス帳プロバイダーの[IABLogon::GetOneOffTable](iablogon-getoneofftable.md)メソッドを呼び出します。</span><span class="sxs-lookup"><span data-stu-id="8392a-114">When the recipient will be included with an outgoing message, MAPI calls the address book provider's [IABLogon::GetOneOffTable](iablogon-getoneofftable.md) method to retrieve its one-off table.</span></span> <span data-ttu-id="8392a-115">一時テーブルには、有効なアドレスを持つ受信者の作成、情報を入力するユーザーを有効にするテンプレートが含まれています。</span><span class="sxs-lookup"><span data-stu-id="8392a-115">The one-off table includes templates which enable a user to enter information resulting in the creation of a recipient with a valid address.</span></span> <span data-ttu-id="8392a-116">MAPI レジスタを次の表は、常に通知を開いてユーザーに変更を反映することができますように。</span><span class="sxs-lookup"><span data-stu-id="8392a-116">MAPI registers for notifications on this table, keeping it open so that changes can be reflected to the user.</span></span> <span data-ttu-id="8392a-117">MAPI は、そのサブシステムまたはアドレス帳の状態オブジェクトの[IMAPIStatus::ValidateState](imapistatus-validatestate.md)メソッドが呼び出されたときにのみ、テーブルを解放します。</span><span class="sxs-lookup"><span data-stu-id="8392a-117">MAPI releases the table only when its subsystem or address book status object's [IMAPIStatus::ValidateState](imapistatus-validatestate.md) method is called.</span></span> 
  
<span data-ttu-id="8392a-118">受信者コンテナーに追加すると MAPI は、コンテナーの[IMAPIProp::OpenProperty](imapiprop-openproperty.md)メソッドを呼び出し、 **PR_CREATE_TEMPLATES** ([PidTagCreateTemplates](pidtagcreatetemplates-canonical-property.md)) のプロパティを取得するために別の呼び出しを作成します。</span><span class="sxs-lookup"><span data-stu-id="8392a-118">When the recipient will be added to a container, MAPI makes a different call, invoking the container's [IMAPIProp::OpenProperty](imapiprop-openproperty.md) method to retrieve its **PR_CREATE_TEMPLATES** ([PidTagCreateTemplates](pidtagcreatetemplates-canonical-property.md)) property.</span></span> <span data-ttu-id="8392a-119">この一時テーブルに含まれているテンプレートのセットは、コンテナーに追加できる受信者の種類を表します。</span><span class="sxs-lookup"><span data-stu-id="8392a-119">The set of templates included in this one-off table represents the types of recipients that can be added to the container.</span></span> <span data-ttu-id="8392a-120">たとえば、メール サーバーでは、多くの場合各コンテナーのみを保持するアドレス、対応するゲートウェイを特定するためにインストールされているすべてのゲートウェイの 1 つのコンテナーを公開します。</span><span class="sxs-lookup"><span data-stu-id="8392a-120">For example, mail servers often expose one container for every gateway that is installed so that each container only holds addresses specific to the corresponding gateway.</span></span>
  
<span data-ttu-id="8392a-121">MAPI は、セッションに独自のテンプレートと同様にそれぞれのアドレス帳プロバイダーからのテンプレートを含む一時テーブルを提供します。</span><span class="sxs-lookup"><span data-stu-id="8392a-121">MAPI provides a one-off table that includes its own templates as well as templates from each of the address book providers in the session.</span></span> <span data-ttu-id="8392a-122">MAPI には、ユーザーがその形式を知っていることを想定しているアドレスの種類の新しい受信者を作成するのに使用できる汎用的なテンプレートが用意されています。</span><span class="sxs-lookup"><span data-stu-id="8392a-122">MAPI provides a generic template that can be used to create a new recipient for any address type, assuming that the user knows its format.</span></span> <span data-ttu-id="8392a-123">アドレス帳プロバイダーは、 [IMAPISupport::GetOneOffTable](imapisupport-getoneofftable.md)を呼び出すことによって、この一時テーブルを使用します。</span><span class="sxs-lookup"><span data-stu-id="8392a-123">Address book providers use this one-off table by calling [IMAPISupport::GetOneOffTable](imapisupport-getoneofftable.md).</span></span> <span data-ttu-id="8392a-124">各有効な受信者のアドレスを持つ受信者の作成時に MAPI テーブルを 1 回限りの結果に含まれるテンプレートです。</span><span class="sxs-lookup"><span data-stu-id="8392a-124">Each of the templates included in the MAPI one-off table results in the creation of recipients with valid recipient addresses.</span></span>
  
<span data-ttu-id="8392a-125">アドレス帳プロバイダーは、通常 1 つのテンプレートをサポートしているすべてのアドレスの種類を指定します。</span><span class="sxs-lookup"><span data-stu-id="8392a-125">Address book providers typically supply one template for every address type they support.</span></span> <span data-ttu-id="8392a-126">ただし、テンプレートは必要ありませんサポートします。</span><span class="sxs-lookup"><span data-stu-id="8392a-126">However, support for templates is not required.</span></span> <span data-ttu-id="8392a-127">MAPI 呼び出しを 1 回限りのテーブルを要求すると、新しいアドレスの作成を許可しない、アドレス帳プロバイダーは MAPI_E_NO_SUPPORT を返すことができます。</span><span class="sxs-lookup"><span data-stu-id="8392a-127">Address book providers that do not allow the creation of new addresses can return MAPI_E_NO_SUPPORT when MAPI calls to request a one-off table.</span></span> <span data-ttu-id="8392a-128">新しいアドレスの作成を許可する操作を行いますが、任意のテンプレートを指定されていないアドレス帳プロバイダーには、MAPI の一時テーブルに記載されているテンプレートを使用する**IMAPISupport::GetOneOffTable**を呼び出すことができます。</span><span class="sxs-lookup"><span data-stu-id="8392a-128">Address book providers that do allow new address creation but do not supply any templates can call **IMAPISupport::GetOneOffTable** to use the templates listed in the MAPI one-off table.</span></span> 
  
<span data-ttu-id="8392a-129">次のプロパティは、必須の列を一時テーブルの設定を構成します。</span><span class="sxs-lookup"><span data-stu-id="8392a-129">The following properties make up the required column set in one-off tables:</span></span>
  
- <span data-ttu-id="8392a-130">**PR_ADDRTYPE**([PidTagAddressType](pidtagaddresstype-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="8392a-130">**PR_ADDRTYPE** ([PidTagAddressType](pidtagaddresstype-canonical-property.md))</span></span>
    
- <span data-ttu-id="8392a-131">**PR_DEPTH**([PidTagDepth](pidtagdepth-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="8392a-131">**PR_DEPTH** ([PidTagDepth](pidtagdepth-canonical-property.md))</span></span>
    
- <span data-ttu-id="8392a-132">**PR_DISPLAY_NAME**([PidTagDisplayName](pidtagdisplayname-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="8392a-132">**PR_DISPLAY_NAME** ([PidTagDisplayName](pidtagdisplayname-canonical-property.md))</span></span>
    
- <span data-ttu-id="8392a-133">**PR_DISPLAY_TYPE**([PidTagDisplayType](pidtagdisplaytype-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="8392a-133">**PR_DISPLAY_TYPE** ([PidTagDisplayType](pidtagdisplaytype-canonical-property.md))</span></span>
    
- <span data-ttu-id="8392a-134">**PR_ENTRYID**([PidTagEntryId](pidtagentryid-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="8392a-134">**PR_ENTRYID** ([PidTagEntryId](pidtagentryid-canonical-property.md))</span></span>
    
- <span data-ttu-id="8392a-135">**PR_INSTANCE_KEY**([PidTagInstanceKey](pidtaginstancekey-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="8392a-135">**PR_INSTANCE_KEY** ([PidTagInstanceKey](pidtaginstancekey-canonical-property.md))</span></span>
    
- <span data-ttu-id="8392a-136">**PR_SELECTABLE**([PidTagSelectable](pidtagselectable-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="8392a-136">**PR_SELECTABLE** ([PidTagSelectable](pidtagselectable-canonical-property.md))</span></span>
    
 <span data-ttu-id="8392a-137">**PR_ADDRTYPE**は、テンプレートで作成した新しい受信者と関連付けることができるアドレスの種類を示します。</span><span class="sxs-lookup"><span data-stu-id="8392a-137">**PR_ADDRTYPE** indicates the type of address that can be associated with the new recipient created with the template.</span></span> 
  
 <span data-ttu-id="8392a-138">**PR_DISPLAY_NAME**および**PR_DISPLAY_TYPE**は、新しい受信者にデータを関連付けます。</span><span class="sxs-lookup"><span data-stu-id="8392a-138">**PR_DISPLAY_NAME** and **PR_DISPLAY_TYPE** associate data with the new recipient.</span></span> <span data-ttu-id="8392a-139">**PR_DISPLAY_NAME**に新しい受信者を識別する文字列が含まれていて、 **PR_DISPLAY_TYPE**に行を表示するアイコンの種類を識別する定数が含まれています。</span><span class="sxs-lookup"><span data-stu-id="8392a-139">**PR_DISPLAY_NAME** contains a character string that identifies the new recipient and **PR_DISPLAY_TYPE** contains a constant that identifies the type of icon to be displayed with the row.</span></span> <span data-ttu-id="8392a-140">メッセージング ユーザーのテンプレートがある、 **PR_DISPLAY_TYPE**列には、DT_MAILUSER です。配布リスト用のテンプレートがある、 **PR_DISPLAY_TYPE**カラムを DT_DISTLIST に設定します。</span><span class="sxs-lookup"><span data-stu-id="8392a-140">Templates for messaging users have their **PR_DISPLAY_TYPE** column set to DT_MAILUSER; templates for distribution lists have their **PR_DISPLAY_TYPE** column set to DT_DISTLIST.</span></span> 
  
 <span data-ttu-id="8392a-141">**PR_ENTRYID**は、新しい受信者を作成するためのテンプレートのエントリの識別子です。</span><span class="sxs-lookup"><span data-stu-id="8392a-141">**PR_ENTRYID** is the entry identifier of the template to be used to create a new recipient.</span></span> <span data-ttu-id="8392a-142">このエントリ id は、将来の[IAddrBook::NewEntry](iaddrbook-newentry.md)、[アドレス帳コンテナー](iaddrbook-openentry.md)、および[IABContainer::CreateEntry](iabcontainer-createentry.md)の呼び出しに渡すことができます。</span><span class="sxs-lookup"><span data-stu-id="8392a-142">This entry identifier can be passed to future [IAddrBook::NewEntry](iaddrbook-newentry.md), [IAddrBook::OpenEntry](iaddrbook-openentry.md), and [IABContainer::CreateEntry](iabcontainer-createentry.md) calls.</span></span> <span data-ttu-id="8392a-143">コンテナーの既定の**PR_DEF_CREATE_MAILUSER** ([PidTagDefCreateMailuser](pidtagdefcreatemailuser-canonical-property.md)) に、ユーザー テンプレートと、 **PR_ENTRYID**の行の列の既定の配布リストにメッセージをその行の**PR_ENTRYID**列を設定します。**PR_DEF_CREATE_DL** ([PidTagDefCreateDl](pidtagdefcreatedl-canonical-property.md)) にテンプレートです。</span><span class="sxs-lookup"><span data-stu-id="8392a-143">Containers set the **PR_ENTRYID** column of their row for the default messaging user template to **PR_DEF_CREATE_MAILUSER** ([PidTagDefCreateMailuser](pidtagdefcreatemailuser-canonical-property.md)) and the **PR_ENTRYID** column of their row for the default distribution list template to **PR_DEF_CREATE_DL** ([PidTagDefCreateDl](pidtagdefcreatedl-canonical-property.md)).</span></span> 
  
 <span data-ttu-id="8392a-144">**PR_DEPTH**は、テンプレートのインデントのレベルを示すことにより、一時テーブルのエントリの階層表示をサポートするために使用されます。</span><span class="sxs-lookup"><span data-stu-id="8392a-144">**PR_DEPTH** is used to support the hierarchical display of the entries in a one-off table by indicating the level of indentation for the template.</span></span> <span data-ttu-id="8392a-145">単純なリストまたは階層の表示としては、一時テーブルを表示することができます、ですが、後者をお勧めし、アドレス帳プロバイダーを使用すると行ごとに [ **PR_DEPTH** ] 列を適切に設定することでサポートする必要があります。</span><span class="sxs-lookup"><span data-stu-id="8392a-145">Although one-off tables can be displayed either as a flat list or a hierarchical display, the latter is preferable and address book providers should support it by setting the **PR_DEPTH** column for each row appropriately.</span></span> <span data-ttu-id="8392a-146">**PR_DEPTH**は 0 から始まります。**PR_DEPTH**列の 0 の値を含む行がインデント付きではありません。</span><span class="sxs-lookup"><span data-stu-id="8392a-146">**PR_DEPTH** is zero-based; rows with a value of 0 in their **PR_DEPTH** column are not indented.</span></span> <span data-ttu-id="8392a-147">**PR_DEPTH**の値が大きいほど、複数の行はインデントではありません。</span><span class="sxs-lookup"><span data-stu-id="8392a-147">The higher the value of **PR_DEPTH**, the more the row is indented.</span></span> <span data-ttu-id="8392a-148">、 **PR_DEPTH**が 1 に設定を持つ行はインデントが設定された 1 つのタブ 3 に設定された**PR_DEPTH**の行にはインデントが設定された 3 つのタブです。</span><span class="sxs-lookup"><span data-stu-id="8392a-148">For example, rows with **PR_DEPTH** set to 1 are indented one tab while rows with **PR_DEPTH** set to 3 are indented three tabs.</span></span> 
  
 <span data-ttu-id="8392a-149">**PR_SELECTABLE**を使用すると、テーブル内の行が選択して新しい受信者を作成するために使用できるテンプレートを表すかどうかを指定します。</span><span class="sxs-lookup"><span data-stu-id="8392a-149">**PR_SELECTABLE** is used to indicate whether a row in the table represents a template that can be selected and used to create a new recipient.</span></span> <span data-ttu-id="8392a-150">一時テーブル内のほとんどの行は、テンプレートには、プロバイダーは、非テンプレートの行を含めることができます。</span><span class="sxs-lookup"><span data-stu-id="8392a-150">Although most rows in a one-off table do represent templates, providers can include non-template rows.</span></span> <span data-ttu-id="8392a-151">たとえば、プロバイダーはディスプレイに表示されますが、受信者の作成に使用されないカテゴリの行を含む、テンプレートの種類によって一時テーブルを整理することも。</span><span class="sxs-lookup"><span data-stu-id="8392a-151">For example, a provider might want to organize the one-off table by template type, including a category row that appears in the display but is not used for recipient creation.</span></span> 
  
## <a name="see-also"></a><span data-ttu-id="8392a-152">関連項目</span><span class="sxs-lookup"><span data-stu-id="8392a-152">See also</span></span>



[<span data-ttu-id="8392a-153">MAPI テーブル</span><span class="sxs-lookup"><span data-stu-id="8392a-153">MAPI Tables</span></span>](mapi-tables.md)

