---
title: プロパティ シートの実装
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: f3475206-0237-4b5b-8efd-abd5d5e0b6c3
description: '�ŏI�X�V��: 2011�N7��23��'
ms.openlocfilehash: 406451adac3cd73286feb787bd6b4d2f356aa283
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 06/11/2018
ms.locfileid: "19803702"
---
# <a name="property-sheet-implementation"></a>プロパティ シートの実装

  
  
**適用されます**: Outlook 
  
プロパティ シートは、オブジェクトのプロパティを表示するためのダイアログ ボックスです。 プロパティは、読み取り専用でのみ表示すること、ユーザーの有効化または変更するユーザーを有効にすると、読み取り/書き込み。 プロパティ シートには、ページと呼ばれる 1 つまたは複数の重複している子ウィンドウが含まれています。 各ページには、関連するプロパティのグループを設定するためのコントロールのウィンドウが含まれています。 ユーザーは、プロパティ シートの前景色に対応するページを表示するタブを選択してページを移動します。
  
サービス プロバイダーは、メッセージ サービスの構成に関連するプロパティの最小限のセットを表示するプロパティ シートを実装しなければなりません。 これらメッセージ サービスのプロパティを変更するを許可する場合を許可するかクライアントのユーザー アプリケーションでは、コントロール パネルで、変更またはプログラムを使用して変更を実装します。 表示および他の種類のプロパティを編集するプロパティ シートの実装は省略可能です。 
  
通常、次のような状況でプロパティ シートを表示する必要があります。
  
- クライアントは、状態オブジェクトの[IMAPIStatus::SettingsDialog](imapistatus-settingsdialog.md)メソッドを呼び出すとします。 
    
- MAPI は、プロバイダー オブジェクトのログオン メソッドを呼び出すとします。
    
- MAPI が、プロバイダーのメッセージ サービスのエントリ ポイント関数を呼び出すとします。
    
トランスポート プロバイダーは、メッセージのオプションに関連するプロパティを表示するプロパティ シートも実装し、アドレス帳プロバイダー実装のプロパティ シートを表示し、ユーザーと配布リスト、詳細検索のメッセージに関する詳細情報を編集するには抽出条件、および新しいユーザーを入力するためのテンプレートです。
  
プロパティ シートを作成するのにには、次の 3 つの手法の 1 つを使用します。
  
- 手動で、任意のダイアログ ボックスと同様です。
    
- Windows SDK で提供されているプロパティ シートの一般的なコントロールを使用します。
    
- MAPI を使用してテーブルを表示します。
    
プロバイダーは、最後のオプションを選択する必要があります (表示のテーブルを使用してプロパティ シートを作成する)。 これは、Windows のユーザー インターフェイスを使用する必要があるためにの最も簡単なオプションです。 
  
メッセージ サービスのプロパティの表示のテーブルから作成されたプロパティ シートを実装するには、次の手順を使用します。
  
1. 現在のプロファイルのセクションを開くには、 [IMAPISupport::OpenProfileSection](imapisupport-openprofilesection.md)を呼び出します。 プロバイダーのプロファイル セクションを開くには、 [MAPIUID](mapiuid.md)または NULL を渡します。 
    
2. プロパティのデータ オブジェクトを作成するのには[CreateIProp](createiprop.md)を呼び出します。 
    
3. プロパティのデータ オブジェクトへのすべてのセクションのプロパティをコピーするのには、プロファイルのセクションの[IMAPIProp::CopyTo](imapiprop-copyto.md)メソッドを呼び出します。 
    
4. プロパティ シートと、 [BuildDisplayTable](builddisplaytable.md)関数を呼び出すことで表示するコントロールを記述する 1 つまたは複数の[DTPAGE](dtpage.md)構造体を作成することによって、またはカスタム コードを実装することにより、表示された表を作成します。 
    
5. コピーしたプロパティを持つプロパティ シートを表示するのには[IMAPISupport::DoConfigPropsheet](imapisupport-doconfigpropsheet.md)を呼び出します。 _LpConfigData_パラメーターと、テーブルへのポインターの表示、 _lpDisplayTable_パラメーターとプロパティのデータ オブジェクトへのポインターを渡します。 このプロパティ シートの既定のアクセス モードをオーバーライドする場合、読み取り専用プロパティを表す表示された表の各コントロールの DT_EDITABLE フラグは設定しません。 
    
6. すべての変更を行ったとき、プロパティ シートで、変更されたプロパティを [プロファイル] セクションにコピーするのには、プロパティのデータ オブジェクトの**IMAPIProp::CopyTo**メソッドを呼び出します。 
    
テーブルの表示の概要については、[テーブルの表示](display-tables.md)を参照してください。 
  
テーブルの表示の詳細については、[テーブルの表示の実装](display-table-implementation.md)を参照してください。 
  
コントロールを実装する方法の詳細については、[コントロール オブジェクトの実装](control-object-implementation.md)を参照してください。
  
表示のテーブルのリスト ボックスでユーザーが選択するコントロールのインデックスを取得するには、ユーザーが **[ok]** または [**適用**] をクリックするまで待機します。 この時点で、選択したアイテムのエントリ id に書き込まれる、 [IMAPIProp: IUnknown](imapipropiunknown.md) [DTBLLBX](dtbllbx.md)構造体の**ulPRSetProperty**のメンバーによって指定されたプロパティの値としてのインタ フェースです。 
  
追加またはリスト ボックスから項目を削除できる場合は、表示のテーブルと、 [IMAPISupport::DoConfigPropsheet](imapisupport-doconfigpropsheet.md)メソッドを使用して動作しません。 代わりに、comdlg32.dll ファイルに含まれている Win32 のプロパティ シート API を使用してプロパティ シートを実装することを検討してください。 
  
## <a name="see-also"></a>関連項目



[MAPI サービス プロバイダー](mapi-service-providers.md)

