---
title: プロパティシートの実装
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: f3475206-0237-4b5b-8efd-abd5d5e0b6c3
description: '最終更新日: 2011 年 7 月 23 日'
ms.openlocfilehash: 3f1c6497a182231645691f669d8900d33b495503
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/23/2019
ms.locfileid: "32328526"
---
# <a name="property-sheet-implementation"></a>プロパティシートの実装

  
  
**適用対象**: Outlook 2013 | Outlook 2016 
  
プロパティシートは、オブジェクトのプロパティを表示するダイアログボックスです。 プロパティは読み取り専用であり、ユーザーに対してのみ表示、または読み取り/書き込みが可能であり、ユーザーが変更できるようになります。 プロパティシートには、ページと呼ばれる1つまたは複数の重なった子ウィンドウが含まれています。 各ページには、関連するプロパティのグループを設定するためのコントロールウィンドウが含まれています。 ユーザーがページ間を移動すると、対応するページがプロパティシートの前景になるタブが選択されます。
  
サービスプロバイダーは、メッセージサービスの構成に関連する最小限のプロパティセットを表示するプロパティシートを実装する必要があります。 これらのメッセージサービスのプロパティを変更できるようにする場合は、コントロールパネルなどのクライアントアプリケーションのユーザーに、変更を加えたり、プログラムによって変更を実装したりできるようにします。 プロパティシートを実装して、他の種類のプロパティを表示および編集することはオプションです。 
  
通常、次の状況では、プロパティシートを表示する必要があります。
  
- クライアントが status オブジェクトの[imapistatus:: settingsdialog](imapistatus-settingsdialog.md)メソッドを呼び出す場合。 
    
- MAPI がプロバイダーオブジェクトのログオン方法を呼び出したとき。
    
- MAPI がプロバイダーのメッセージサービスのエントリポイント関数を呼び出すとき。
    
また、トランスポートプロバイダーは、メッセージオプションに関連するプロパティを表示するためのプロパティシートを実装し、アドレス帳プロバイダーは、メッセージングユーザーおよび配布リストに関する詳細情報を表示および編集するためのプロパティシートを実装します。高度な検索新しいユーザーを入力するための基準とテンプレート。
  
プロパティシートを作成するには、次の3つの方法のいずれかを使用できます。
  
- ダイアログボックスの場合と同様に、手動で設定します。
    
- Windows SDK で提供されるプロパティシートコモンコントロールを使用します。
    
- MAPI 表示テーブルを使用します。
    
プロバイダーは最後のオプションを選択する必要があります (表示テーブルを使用してプロパティシートを作成します)。 これは、Windows ユーザーインターフェイスを操作する必要がなくなるため、最も簡単なオプションです。 
  
メッセージサービスのプロパティの表示テーブルから構築されたプロパティシートを実装するには、次の手順を使用します。
  
1. 現在のプロファイルのセクションを開くには、 [imapisupport:: openprofile](imapisupport-openprofilesection.md)セクションを呼び出します。 [MAPIUID](mapiuid.md)または NULL を渡して、プロバイダーのプロファイルセクションを開きます。 
    
2. プロパティデータオブジェクトを作成するには、 [createiprop](createiprop.md)を呼び出します。 
    
3. プロファイルセクションの[imapiprop:: CopyTo](imapiprop-copyto.md)メソッドを呼び出して、すべてのセクションのプロパティをプロパティデータオブジェクトにコピーします。 
    
4. 表示テーブルを作成するには、プロパティシートに表示されるコントロールを記述し、 [builddisplaytable](builddisplaytable.md)関数を呼び出すか、またはカスタムコードを実装して、1つまたは複数の[dtpage](dtpage.md)構造を作成します。 
    
5. 呼び出し[imapisupport::D oconfigpropsheet](imapisupport-doconfigpropsheet.md)は、コピーされたプロパティを持つプロパティシートを表示します。 _lpconfigdata_パラメーターとしてプロパティデータオブジェクトへのポインターを渡し、 _lpconfigdata_パラメーターとして表示テーブルへのポインターを渡します。 このプロパティシートの既定のアクセスモードを無効にする場合は、読み取り専用プロパティを表す表示テーブル内の各コントロールに対して DT_EDITABLE フラグを設定しないでください。 
    
6. プロパティシートですべての変更を行ったら、プロパティデータオブジェクトの**imapiprop:: CopyTo**メソッドを呼び出して、変更したプロパティをプロファイルセクションにコピーします。 
    
表示テーブルの概要については、「[テーブルの表示](display-tables.md)」を参照してください。 
  
表示テーブルの詳細については、「[表の実装](display-table-implementation.md)」を参照してください。 
  
コントロールの実装については、「[コントロールオブジェクトの実装](control-object-implementation.md)」を参照してください。
  
ユーザーが表示テーブルリストボックスで選択したコントロールのインデックスを取得するには、ユーザーが **[OK]** または [**適用**] をクリックするまで待機します。 この時点で、選択されているアイテムのエントリ id は、 [dtbllbx](dtbllbx.md)構造体の**ulprsetproperty**メンバーによって指定されたプロパティの値として、 [imapiprop: IUnknown](imapipropiunknown.md)インターフェイスに書き戻されます。 
  
リストボックスのアイテムを追加または削除できるようにする必要がある場合は、表示テーブルと[imapisupport::D oconfigpropsheet](imapisupport-doconfigpropsheet.md)メソッドは使用できません。 代わりに、comdlg32 ファイルに含まれている Win32 プロパティシート API を使用して、プロパティシートを実装することを検討してください。 
  
## <a name="see-also"></a>関連項目



[MAPI サービスプロバイダー](mapi-service-providers.md)

