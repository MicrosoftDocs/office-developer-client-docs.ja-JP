---
title: TNEF 対応のトランスポート プロバイダーの開発
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 7525eee1-4016-49b8-9509-5ebbe1db819f
description: '�ŏI�X�V��: 2011�N7��23��'
ms.openlocfilehash: 4d4f7ed75bb1144b7cd4a813b0d093246a30cca5
ms.sourcegitcommit: 0cf39e5382b8c6f236c8a63c6036849ed3527ded
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/23/2018
ms.locfileid: "22588350"
---
# <a name="developing-a-tnef-enabled-transport-provider"></a>TNEF 対応のトランスポート プロバイダーの開発

  
  
**適用されます**: Outlook 2013 |Outlook 2016 
  
MAPI の機能の別のセットをサポートするためのメッセージング システム間の相互運用性を昇格させるには、MAPI は、データを転送する標準の方法としてトランスポート ニュートラル カプセル化形式 (TNEF) を提供します。 この形式は、トランスポート プロバイダーは、それを送信するときのメッセージと共に転送されるバイナリ ストリームに、基になるメッセージング システムでサポートされていない MAPI プロパティをカプセル化します。 トランスポート プロバイダーは、メッセージを受信するは、元のメッセージのすべてのプロパティを取得し、クライアント アプリケーションに使用できるようにするバイナリ ストリームをデコードし、ことができます。 TNEF の運用モデルは、次のとおりです。
  
- メッセージング クライアントは、送信し、通常の方法で TNEF のトランスポートにメッセージを受信します。
    
- トランスポートの送信メッセージのプロパティを 2 つのカテゴリに分割する: 基になるメッセージ ・ システムをサポートしているとしていません。 基になるメッセージング システムでサポートされているプロパティの値は、必要な形式に変換されます。
    
- トランスポートでは、MAPI の TNEF メソッドを使用して、サポートされていないプロパティを単一のデータ ストリームにエンコードします。 次に、トランスポートは、メッセージを送信する前に、基になるメッセージング システムの添付ファイルのモデルを使用して、送信メッセージでの特別な添付ファイルにそのデータ ストリームをオンにします。
    
- このようなメッセージを受信する TNEF を有効になっているトランスポートは、2 つのことです。 最初に、受信メッセージのプロパティを変換-基になるメッセージ ・ システムでサポートされているもの: MAPI のプロパティにします。 2 つ目は、特別な添付ファイルが存在する場合は、メソッドを使って、TNEF の MAPI クライアント アプリケーションにメッセージを配信する前に添付ファイルから追加の MAPI プロパティを取得します。
    
TNEF のオブジェクトを操作する場合、MAPI は MAPI トランスポート プロバイダーが使用する**ITnef**インターフェイスの実装を提供します。 [OpenTnefStreamEx](opentnefstreamex.md)関数を使用して、TNEF のオブジェクトを作成し、メッセージに関連付けます。 TNEF ストリームは、OLE の**IStream**インターフェイスの上に構築されます。 
  
> [!NOTE]
> TNEF のオブジェクトを作成するのにには、 **OpenTnefStreamEx**を使用します。 古い**OpenTnefStream**関数は古いソース コードとの互換性のために存在しは推奨されていないすべての新しい。 
  
**ITnef**インターフェイスは、次のメソッドを提供します。 
  
- [AddProps](itnef-addprops.md)
    
- [EncodeRecips](itnef-encoderecips.md)
    
- [ExtractProps](itnef-extractprops.md)
    
- [Finish](itnef-finish.md)
    
- [FinishComponent](itnef-finishcomponent.md)
    
- [OpenTaggedBody](itnef-opentaggedbody.md)
    
- [SetProps](itnef-setprops.md)
    
MAPI TNEF の実装モデルをサポートしています。
  
- その他のメッセージのプロパティに影響を与えずにすべての MAPI プロパティです。 MAPI メッセージをメッセージング システムを介して転送を維持するためには、メッセージング システムのプロパティとしてエンコードすることはできませんのすべてのプロパティをカプセル化する必要があります。 カプセル化のスキームでメッセージング システムは MAPI メッセージ プロパティのみをエンコードするためにトランスポート プロバイダーは、そのほとんどありませんがわかっている時に、MAPI 準拠のクライアントにメッセージが表示されるかどうかにメッセージが送信されるためネイティブにサポートします。 つまり、TNEF を使用してメッセージが MAPI SMTP ベースの UNIX のように基づいていないメッセージング システムには「不透明」ではないこと、メッセージング システムです。 これらのシステムでは、何らかの方法で一般的な TNEF エンコードされたデータ ストリームとして受信、およびその他のプロパティをサポートしているプロパティが表示されます。 TNEF のトランスポート プロバイダーは、これら 2 つのプロパティ セットの違いを知ると、メッセージング システムの適切な方法でサポートされているセットを送信します。 TNEF には、メッセージング システムが提供するサポートのレベルについての前提条件はありません。 ただし、例では、TNEF の使用率がこのセクションに含まれている、ことを前提として行われるメッセージング システムがメッセージは別の単一の添付ファイルを 1 つ以上をサポートしています。 場合によっては、添付ファイルのみするエンコードされていないストリームをサポートできメッセージ テキストの一部として送信できます。 非常にまれな状況でのみ、メッセージング システムがメッセージのプロパティのほとんどのサポートが必要なその完全 TNEF エンコーディングのすべてのプロパティは。
    
- メカニズムを決定するため、メッセージを受信したメッセージで TNEF ストリームが属しているかどうかは、MAPI プロパティの**PR_TNEF_CORRELATION_KEY** ([PidTagTnefCorrelationKey](pidtagtnefcorrelationkey-canonical-property.md)) に基づいています。 TNEF ストリームと、適切なメッセージ ヘッダーの両方は、このプロパティを探す必要があります。 プロパティ、両方に同じ値を持つまたは見つからない場合にどちらの方法でも、TNEF ストリームは、メッセージに属していると見なされます。 それ以外の場合、TNEF ストリームは無視されます。 TNEF を有効になっているトランスポートは、送信メッセージにこのプロパティの値を選択して、適切なメッセージ ヘッダーにエンコードして (たとえば、メッセージの ID: SMTP メッセージのヘッダー) と TNEF ストリームで。
    

