---
title: 割り当てと、MAPI でのメモリの解放
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: e238f6bc-e9f6-4ea4-a2e4-ff5da2a04bd5
description: '最終更新日時: 2015 年 3 月 9 日'
ms.openlocfilehash: 2ec5c2604c72d41078aa467764463e2659c62e65
ms.sourcegitcommit: 0cf39e5382b8c6f236c8a63c6036849ed3527ded
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/23/2018
ms.locfileid: "22587944"
---
# <a name="allocating-and-freeing-memory-in-mapi"></a>割り当てと、MAPI でのメモリの解放

  
  
**適用されます**: Outlook 2013 |Outlook 2016 
  
ほかの割り当てし、メモリを解放する方法を指定するは、MAPI は、パブリック インターフェイスのメソッドと API 関数の呼び出しを解放する必要がありますとの間にメモリが渡された場合を把握するためのモデルを定義します。 モデルは、文字列、構造体へのポインターなどのインターフェイスへのポインターではないパラメーターに割り当てられたメモリにのみ適用されます。 インターフェイス ポインターは、参照カウント メカニズムを**IUnknown**を使用して実装を使用します。 割り当てと解放の非 MAPI クライアント アプリケーションまたはサービス プロバイダーの内部でメモリに関連する、意味をどのようなメカニズムを使用します。 
  
モデルでは、次の 3 種類の 1 つとしてパラメーターを定義します。 それらを入力パラメーターは、呼び出された関数またはメソッドが使用する情報を使用して呼び出し元による設定は、出力パラメーターと、呼び出された関数またはメソッドによって設定には、呼び出し元、または入出力パラメーター、2 つの種類の組み合わせが返されます。 出力パラメーターは、頻繁にデータへのポインターまたはデータへのポインターへのポインター。 呼び出された関数は、出力パラメーターのデータの割り当てを担当するが、呼び出し元は、ポインターのメモリを割り当てます。 
  
割り当てと、これらのパラメーターの種類のメモリを解放するための規則は、次の表で説明します。
  
|**型**|**メモリの割り当て**|**メモリのリリース**|
|:-----|:-----|:-----|
|入力  <br/> |呼び出し元は、責任し、任意の機構を使用することができます。  <br/> |呼び出し元は、責任し、任意の機構を使用することができます。  <br/> |
|出力  <br/> |呼び出された関数は、担当する**MAPIAllocateBuffer**を使用する必要があります。 詳細については、 [MAPIAllocateBuffer](mapiallocatebuffer.md)を参照してください。  <br/> |呼び出し元し、 **MAPIFreeBuffer**を使用する必要があります。 詳細については、 [MAPIFreeBuffer](mapifreebuffer.md)を参照してください。  <br/> |
|入力出力  <br/> |呼び出し元が呼び出された関数の初期の割り当てと割り当てを変更できます必要な場合の**MAPIAllocateBuffer**を使用します。  <br/> |呼び出された関数は、再割り当てが必要な場合に、初期の解放をします。 呼び出し元は、最終的な戻り値を解放する必要があります。  <br/> |
   
障害条件は、時にインターフェイス メソッドの実装を呼び出し元はそれらをクリーンアップする方法があるない一般にために、出力パラメーターと入出力パラメーターに注意を払う必要があります。 エラーが返された場合、各出力または入出力パラメーターする必要がありますかのままにして値は呼び出し元が初期化または呼び出し側の操作をしなくてもクリーンアップすることができる値に設定します。 たとえば、出力ポインターのパラメーターの`void ** ppv`は NULL に設定することができます、または入力されて、ままにする必要があります ( `*ppv = NULL`)。
  

