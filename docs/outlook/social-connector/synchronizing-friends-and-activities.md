---
title: 友だちとアクティビティの同期
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
ms.topic: overview
ms.prod: office-online-server
localization_priority: Normal
ms.assetid: 6e91b765-a207-4d8c-8763-5d643ca4d0c0
description: outlook Social Connector (.osc) は、ソーシャルネットワークからの情報の表示をサポートしています。連絡先カードまたは outlook のユーザーウィンドウのユーザーに関する情報を表示します。 sharepoint Server、sharepoint Workspace、Lync クライアント、およびプレゼンス情報をサポートするすべての Office クライアントアプリケーションは、連絡先カードをサポートします。
ms.openlocfilehash: 0d6881c5d596519422d01ca61a00b1a68e610f2c
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/23/2019
ms.locfileid: "32329202"
---
# <a name="synchronizing-friends-and-activities"></a>友だちとアクティビティの同期

outlook Social Connector (.osc) は、ソーシャルネットワークからの情報の表示をサポートしています。連絡先カードまたは outlook のユーザーウィンドウのユーザーに関する情報を表示します。 sharepoint Server、sharepoint Workspace、Lync クライアント、およびプレゼンス情報をサポートするすべての Office クライアントアプリケーションは、連絡先カードをサポートします。
  
Office アプリケーションのグループ作業のシナリオで連絡先カードを使用して、共同作業を行っている人の詳細を確認できます。 このようなシナリオの例としては、Outlook でのメッセージングと Word でのドキュメントの共同編集があります。 連絡先カードの [**新着**情報] タブをクリックすると、によってその人物に関する情報が表示されます。 
  
outlook の [ユーザー] ウィンドウには、選択した outlook アイテムの送信者または受信者になることができるユーザーに関する情報が表示されます。 他のユーザーを [people] ウィンドウや outlook エクスプローラーの別のアイテムで選択するか、またはインスペクターで outlook アイテムを開くと、outlook Social Connector (.osc) が [ユーザー] ウィンドウを更新します。 
  
連絡先カードまたは [ユーザー] ウィンドウで選択した人物の現在の情報を表示するために、.osc は、このような情報を、.osc プロバイダーと何らかの形式のキャッシュを通じて同期します。 この同期は、クライアントコンピューターにインストールされている .osc プロバイダー、.osc プロバイダーを経由してログオンしたソーシャルネットワーク、およびこれらのソーシャルネットワークの各各プロバイダーがサポートする同期モードに依存します。
  
詳細については、「キャッシュ同期」、「オンデマンド同期」、および「ハイブリッド同期」のさまざまな方法で、友人や友人以外の人に対して友人、非友人、および活動を同期することをサポートしています。 これらの同期モードの主な違いは、.osc がデータを格納する場所です (ユーザーの既定の Outlook ストア内のフォルダー内、またはユーザーのコンピューター上のメモリ内にあるかどうか)。 このトピックで説明したように、データが更新される前に、データがフォルダーまたはメモリに保持される既定の最小時間があります。 場合によっては、グループポリシーによって、最小限の時間をカスタマイズできます。 .osc の動作を制御するグループポリシーの詳細については、「[グループポリシーを使用して Outlook Social Connector を管理する方法](https://support.microsoft.com/default.aspx?scid=kb%3Ben-US%3B2020103)」を参照してください。
  
選択したユーザーがソーシャルネットワークのメンバーではない場合、その人物の個人情報やアクティビティ情報は、.osc の連絡先カードまたは [ユーザー] ウィンドウに表示されないことに注意してください。
  
## <a name="cached-synchronization"></a>キャッシュされた同期

.osc プロバイダーは、ソーシャルネットワーク上の友人に関する情報をユーザーの既定の Outlook ストアの特定のフォルダーに格納し、指定された期間が経過した後にそのキャッシュを定期的に更新することができます。 フォルダー内のキャッシュ情報には、ソーシャルネットワークへのトラフィックを削減できるという利点があります。
  
> [!NOTE]
> Outlook Social Connector 2013 以降、.osc はアクティビティのキャッシュ同期をサポートしなくなりました。 
  
### <a name="cached-synchronization-of-friends"></a>友人のキャッシュ同期

.osc プロバイダーが友人のキャッシュ同期をサポートしている場合、.osc はソーシャルネットワーク上のログオンユーザーのフレンドの情報をキャッシュします。 情報は、ユーザーの既定の outlook ストアにあるそのソーシャルネットワークに固有の outlook 連絡先フォルダーにキャッシュされます。 連絡先フォルダーの名前は、ソーシャルネットワークの名前に基づいています。この名前は、次に示す[よう](isocialprovider-socialnetworkname.md)に、iな形式のプロパティを使用して、.osc が取得します。 
  
キャッシュ同期では、.osc はログオンしているユーザーのフレンドだけの情報をソーシャルネットワークに格納します。 .osc は、友人以外の情報にはアクセスできません。
  
ソーシャルネットワークから友人の情報の連絡先フォルダーを更新するための .osc の既定の間隔は、1日に1回 (または1440分ごと) です。 この更新間隔は、このトピックの最初に説明するように、グループポリシーで設定することもできます。
  
更新中にエラーが発生した場合、.osc は、**機能**XML の**contactsyncrestartinterval**要素によって指定された間隔で再試行します。 この再試行間隔の既定値は30分で、グループポリシーによって設定することもできます。 
  
ユーザーが連絡先カードを開いて [最新**の情報**] タブを選択すると、[**新機能**] タブが更新されます。 同様に、outlook ユーザーが outlook でアイテムを再選択するか、[ユーザー] ウィンドウで個人を選択すると、[ユーザー] ウィンドウが更新されます。 キャッシュの更新間隔が期限切れになっていない場合、.osc は選択されたユーザーの情報を取得するためにキャッシュに送られます。 これにより、ソーシャルネットワークにアクセスするために、.osc プロバイダー拡張機能を使用するオーバーヘッドが回避されます。 更新間隔の期限が切れている場合、.osc は[iGetFriendsAndColleagues](isocialperson-getfriendsandcolleagues.md)メソッドを呼び出して、ログオンしているユーザーの現在のフレンド情報を取得し、連絡先フォルダーのキャッシュを更新します。 
  
.osc プロバイダーは、**機能**XML に次の要素を指定することによって、フレンドのキャッシュ同期をサポートしていることを、.osc に通知します。 
  
- **getfriends** = **true**
    
- **cacheFriends** = **true**
    
- **dynamicContactsLookup** = **false**
    
## <a name="on-demand-synchronization"></a>オンデマンド同期

ユーザーが連絡先カードの [**新着情報**] タブを選択するか、outlook の [ユーザー] ウィンドウで別の outlook アイテムまたは別のユーザーを選択すると、その連絡先カードまたは [ユーザー] ウィンドウがそれぞれ更新されます。 .osc プロバイダーが個人またはアクティビティのオンデマンド同期をサポートしている場合、.osc はメモリ内のキャッシュと同期し、連絡先カードまたはユーザーウィンドウの名前、タイトル、画像、アクティビティストリームなどの詳細を更新します。 キャッシュ同期とは異なり、オンデマンド同期では、その人物がソーシャルネットワーク上のログオンユーザーのフレンドまたはフレンドではないかどうかに関係なく、ユーザーの情報を更新しようとします。 
  
オンデマンドのユーザー (またはアクティビティ) のデータはメモリにのみ保存されます。 メモリ内のデータは、Office クライアントアプリケーションが終了するときにクリアされます。または、ユーザーが連絡先カードまたはユーザーウィンドウを更新し、データがメモリ内に残っている状態が更新間隔より長くなっています。 ソーシャルネットワークからの更新は、常にユーザーが連絡先カードまたはユーザーウィンドウを更新することによって開始されることに注意してください (たとえば、[ユーザー] ウィンドウで別のユーザーを選択するか、Outlook エクスプローラーウィンドウで別のアイテムを選択します)。 

ただし、[連絡先カード] または [ユーザー] ウィンドウを更新するたびにソーシャルネットワークからの更新が必要になるわけではありません。 ユーザーが連絡先カードまたはユーザーウィンドウを更新し、ユーザー (またはアクティビティ) データが更新間隔よりも長くメモリに残っている場合、.osc は[ISocialSession2:: GetPeopleDetails](isocialsession2-getpeopledetails.md) (または[ISocialSession2:: GetActivitiesEx](isocialsession2-getactivitiesex.md)) を呼び出して、ソーシャルネットワークからメモリの情報を更新します。 メモリ内のフレンド情報とフレンド以外の情報に許可されている期間は24時間で、アクティビティは30分です。 
  
キャッシュとオンデマンド同期の重要な違いの1つは、オンデマンド同期によって、ネットワーク上の友人と非友人の両方の個人とアクティビティ情報を取得できることです。 選択した人物がフレンドではない場合、次のいずれかの要件が満たされている場合、.osc はその人物の情報とアクティビティを更新します。 
  
- この人物はソーシャルネットワーク上のユーザーで、プロファイルとアクティビティ情報のパブリック表示を許可します。
    
- この人物は、そのソーシャルネットワーク上でログオンしているユーザーと同じネットワークにあります (たとえば、大学 alumni の同じネットワーク内)。
    
個人およびアクティビティのオンデマンド同期では、.osc コアエンジンからプロバイダーへの呼び出しの数が多くなります。 ソーシャルネットワークは、オンデマンド同期の拡張された帯域幅要件を処理できる必要があります。
  
### <a name="specifying-xml-elements-for-on-demand-synchronization"></a>オンデマンド同期の XML 要素を指定する

.osc プロバイダーは、**機能**XML に次の要素を指定することによって、フレンドと非友人のオンデマンド同期をサポートしていることを、.osc に通知します。 
  
- **getfriends** = **true**
    
- **cacheFriends** = **false**
    
- **dynamicContactsLookup** = **true**
    
.osc プロバイダーは、**機能**XML に次の要素を指定することによって、アクティビティのオンデマンド同期をサポートしていることを、.osc に通知します。 
  
- **getactivities** = **true**
    
- **cacheactivities** = **false**
    
- **dynamicActivitiesLookupEx** = **true**
    
## <a name="hybrid-synchronization"></a>ハイブリッド同期

.osc プロバイダーは、友人および友人以外のハイブリッド同期をサポートできます。 これにより、.osc コアエンジンと .osc プロバイダーとの間の呼び出し、友人のオンデマンド同期のためのソーシャルネットワークへの呼び出し、および友人のデータの通貨を最適化できます。 データをフォルダーまたはメモリ内に保持できる最小時間 (該当する場合) は、キャッシュまたはオンデマンド同期モードの制限と同じです。
  
> [!NOTE]
> Outlook Social Connector 2013 以降では、アクティビティのオンデマンド同期のみがサポートされ、アクティビティのハイブリッド同期はサポートされなくなりました。 
  
### <a name="hybrid-synchronization-of-friends-and-non-friends"></a>友人と友人以外のハイブリッド同期

.osc プロバイダーが友人と友人以外のハイブリッド同期をサポートしている場合、.osc は次の処理を行います。 
  
- .osc は、ログオンしているユーザーのフレンドの情報をソーシャルネットワーク固有の連絡先フォルダーに格納します。
    
- .osc は、ログインしているユーザーの友人以外の情報をメモリに格納します。
    
.osc プロバイダーは、**機能**XML に次の要素を指定することによって、友人と友人以外のハイブリッド同期をサポートしていることを、.osc に通知します。 
  
- **getfriends** = **true**
    
- **cacheFriends** = **true**
    
- **dynamicContactsLookup** = **true**
    
## <a name="synchronization-intervals"></a>同期間隔

次の表に、サポートされている同期モードに応じて、対応するキャッシュ (フォルダーまたはメモリ) とソーシャルネットワーク間の友人および友人以外の情報の同期間隔を示します。 ハイブリッド同期モードの場合は、フレンド用にキャッシュモードの行を参照し、非友人の場合は、オンデマンドモードの行を参照してください。
  
|**persons の同期モード**|**更新間隔を設定する場所**|**更新前の既定の最小時間**|**グループポリシーの上書き**|
|:-----|:-----|:-----|:-----|
|Cached  <br/> |.osc で設定  <br/> |1440分 (24 時間)  <br/> |Windows レジストリ値**netcontactsyncinterval** <br/> |
|Cached  <br/> |**機能**XML の**contactsyncrestartinterval**要素  <br/> |**contactsyncrestartinterval**が設定されていない場合は30分  <br/> |Windows レジストリ値**contactsyncrestartinterval** <br/> |
|オンデマンド  <br/> |.osc で設定  <br/> |1440分 (24 時間)  <br/> |Windows レジストリ値**OnlineSearchExpiryTime** <br/> |
   
次の表に、サポートされている同期モードに応じて、関連するキャッシュ (フォルダーまたはメモリ) とソーシャルネットワーク間の友人および友人以外のアクティビティの同期間隔をまとめます。 
  
|**アクティビティの同期モード**|**更新間隔を設定する場所**|**更新前の既定の最小時間**|**グループポリシーの上書き**|
|:-----|:-----|:-----|:-----|
|オンデマンド  <br/> |.osc で設定  <br/> |30 分  <br/> |Windows レジストリ値**OnlineSearchExpiryTime** <br/> |
   
次の情報は、2つの表に記載されている Windows レジストリ値に適用されます。
  
- 要点`HKEY_CURRENT_USER\Software\Policies\Microsoft\Office\Outlook\SocialConnector`
    
- 値: 1 ~ 10080 の範囲の DWORD 値
    
## <a name="see-also"></a>関連項目

- [機能 XML の例](capabilities-xml-example.md)  
- [機能の XML](xml-for-capabilities.md)
- [.osc XML スキーマを使用してプロバイダーを開発する](developing-a-provider-with-the-osc-xml-schema.md)  
- [グループポリシーを使用して Outlook Social Connector を管理する方法](https://support.microsoft.com/default.aspx?scid=kb%3Ben-US%3B2020103)

