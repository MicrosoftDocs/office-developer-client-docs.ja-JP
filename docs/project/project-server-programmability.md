---
title: Project Server プログラミング
manager: lindalu
ms.date: 12/03/2019
ms.audience: Developer
f1_keywords:
- events
- PDS
- PDS compatibility
- Project Server databases
- Project Server events
- Project Server Interface
- Project Server workflow
- Project workflow
- PSI
- PSI limitations
- PSI uses
- SharePoint Services
- WF
- workflow
- Workflow Foundation
- WSS
keywords:
- プロジェクト 2013、アーキテクチャとプログラミング、PSI、プロジェクト、バージョン、プログラミング、Project Server、PSI、制限、Project Server Interface、サポート対象外の機能、Project Server インターフェイス、PDS 互換性、Project Server Interface、汎用、Project Server、プロジェクトのバージョン、バージョン、プロジェクト、Project Server、データベース、Project 2013、プラットフォーム、Project Server Interface、シナリオの使用、Project Server、イベント、Project Server、Project Data Service、PSI との互換性、Project Server Interface
ms.assetid: a93d2153-5132-4289-af51-69350471e248
description: Project Server 2013 の主要なプログラミング機能について説明します。 この記事には、以前のバージョンの Project Server 用に構築されたアプリケーションの移植についての情報が含まれています。
localization_priority: Priority
ms.openlocfilehash: e6991712b87291e90c6b4f277db84686aab384e7
ms.sourcegitcommit: 31b0a7373ff74fe1d6383c30bc67d7675b73d283
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 02/05/2020
ms.locfileid: "41773730"
---
# <a name="project-server-programmability"></a><span data-ttu-id="407e2-105">Project Server のプログラミング</span><span class="sxs-lookup"><span data-stu-id="407e2-105">Project Server programmability</span></span>

<span data-ttu-id="407e2-106">Project Server 2013 の主要なプログラミング機能について説明します。</span><span class="sxs-lookup"><span data-stu-id="407e2-106">Learn about the major programmability features in Project Server 2013.</span></span> <span data-ttu-id="407e2-107">この記事には、以前のバージョンの Project Server 用に構築されたアプリケーションの移植についての情報が含まれています。</span><span class="sxs-lookup"><span data-stu-id="407e2-107">This article includes information about porting applications that were built for previous versions of Project Server.</span></span>

<span data-ttu-id="407e2-108">Project Server 2013 は、Project Server 2010 と複数のプラットフォームでは、アプリがアクセスできる場所両方オンラインおよびオンプレミスの Project Server のインストール用に新しいソリューションの開発されたほとんどのアプリケーションをサポートするよう設計されています。</span><span class="sxs-lookup"><span data-stu-id="407e2-108">Project Server 2013 is designed to support most applications that were developed for Project Server 2010 and new solutions for multiple platforms, where apps can access both online and on-premises Project Server installations.</span></span> <span data-ttu-id="407e2-109">Project Server 2003 以前用に開発されたアプリケーションと拡張機能は、クライアント側オブジェクト モデル (CSOM) または Project Server インターフェイス (PSI) を使用するように再設計する必要があります。</span><span class="sxs-lookup"><span data-stu-id="407e2-109">Applications and extensions that were developed for Project Server 2003 or earlier must be redesigned to use the client-side object model (CSOM) or the Project Server Interface (PSI).</span></span> <span data-ttu-id="407e2-110">Office Project Server 2007 または Project Server 2010 用に開発されたアプリケーションでは、PSI を使用するためにいくつかの変更と再コンパイルが必要になる場合があります。CSOM を使用するには、これらのアプリケーションに再設計が必要です。</span><span class="sxs-lookup"><span data-stu-id="407e2-110">Applications that were developed for Office Project Server 2007 or Project Server 2010 may require some changes and recompiling to use the PSI; to use the CSOM, those applications require a redesign.</span></span>
  
<span data-ttu-id="407e2-111">Project Server プラットフォームは、SharePoint Server 2013、.NET Framework 4、および OData プロトコル上に CSOM と共に構築することにより、プログラマの高レベルな生産性を実現します。</span><span class="sxs-lookup"><span data-stu-id="407e2-111">The Project Server platform enables high levels of programmer productivity by building on SharePoint Server 2013, .NET Framework 4, and the OData protocol with the CSOM.</span></span> <span data-ttu-id="407e2-112">開発者は、アプリ、アプリ パーツ、および Web パーツを使用して Project Web App を拡張し、SharePoint Designer 2013 を使用してワークフローを定義し、Project Server イベントのリモート イベント レシーバーを使用してビジネス ルールを適用することができます。</span><span class="sxs-lookup"><span data-stu-id="407e2-112">Developers can extend Project Web App with apps, app parts, and Web Parts, define workflows by using SharePoint Designer 2013, and enforce business rules by using remote event receivers for Project Server events.</span></span>
  
## <a name="project-server-and-sharepoint-server"></a><span data-ttu-id="407e2-113">Project Server と SharePoint Server</span><span class="sxs-lookup"><span data-stu-id="407e2-113">Project Server and SharePoint Server</span></span>
<span data-ttu-id="407e2-114"><a name="pj15_Programmability_MOSS"> </a></span><span class="sxs-lookup"><span data-stu-id="407e2-114"><a name="pj15_Programmability_MOSS"> </a></span></span>

<span data-ttu-id="407e2-115">Project Web App は SharePoint Server 2013 上に構築されます。マスター ページと Web パーツを使用すると、カスタム アプリと Project Web App ソリューションを簡単に構築できます。</span><span class="sxs-lookup"><span data-stu-id="407e2-115">Project Web App is built upon SharePoint Server 2013, and uses master pages and Web Parts to make it easier to build custom apps and Project Web App solutions.</span></span> <span data-ttu-id="407e2-116">Project Server 2013 は SharePoint Server 2013 と緊密に連携し、このプラットフォームの上にプロジェクト コラボレーション、レポート作成、サイト管理、セキュリティ、およびワークフロー管理を実現します。</span><span class="sxs-lookup"><span data-stu-id="407e2-116">Project Server 2013 integrates deeply with SharePoint Server 2013 as the platform for project collaboration, reporting, site administration, security, and workflow management.</span></span>
  
<span data-ttu-id="407e2-117">プロジェクト サイトには、チームのメンバーに向けた多くの情報と共同作業のオプションが含まれています。ここには、プロジェクトの概要、タイムラインの付いたタスク用の特殊な SharePoint リスト、問題の追跡、リスク、プロジェクト成果物、チームの予定表などの既定のアプリを、ドキュメント ライブラリおよびチーム ディスカッションと一緒に追加できます。</span><span class="sxs-lookup"><span data-stu-id="407e2-117">The project sites include more information and collaboration options for team members, where you can add default apps that include a project summary, specialized SharePoint lists for tasks with a timeline, tracking issues, risks, project deliverables, and the team calendar, along with the document library and team discussions.</span></span> <span data-ttu-id="407e2-118">Project Server 2013 のカスタム アプリでは、チームの共同作業のための拡張機能と柔軟性を提供します。</span><span class="sxs-lookup"><span data-stu-id="407e2-118">Custom apps for Project Server 2013 provide extensions and flexibility for team collaboration.</span></span> <span data-ttu-id="407e2-119">ページを編集するときに Web パーツを追加および編集するのと同じメカニズムを使用して、アプリをカスタマイズするためのアプリ パーツを追加することもできます。</span><span class="sxs-lookup"><span data-stu-id="407e2-119">You can also add app parts to customize an app, by using the same mechanism to add and edit Web Parts when you edit a page.</span></span> <span data-ttu-id="407e2-120">プロジェクト サイトは、Project Server がインストールされている SharePoint ファーム内の任意の場所に配置できます。</span><span class="sxs-lookup"><span data-stu-id="407e2-120">You can locate project sites anywhere within the SharePoint farm where Project Server is installed.</span></span> <span data-ttu-id="407e2-121">Excel Services や Enterprise Search など、SharePoint Server 2013 の他のコア サービスを使用するために、管理者はサービスを有効にして構成できます。</span><span class="sxs-lookup"><span data-stu-id="407e2-121">To use other core services of SharePoint Server 2013, such as Excel Services and Enterprise Search, an administrator can enable and configure the services.</span></span> 
  
<span data-ttu-id="407e2-122">Project Server 2013 のインストール時には、SharePoint Web サービス サイトの Project Service アプリケーションを準備します。</span><span class="sxs-lookup"><span data-stu-id="407e2-122">When you install Project Server 2013, you provision the Project Service Application in the SharePoint Web Services site.</span></span> <span data-ttu-id="407e2-123">Project Service アプリケーションには、PSI 用のローカルな Windows Communication Foundation (WCF) サービスや ASMX Web サービスが含まれます。</span><span class="sxs-lookup"><span data-stu-id="407e2-123">The Project Service Application includes the local Windows Communication Foundation (WCF) services and ASMX web services for the PSI.</span></span> <span data-ttu-id="407e2-124">他のサービス アプリケーションとしては、SharePoint 検索や SharePoint ドキュメント管理などがあります。</span><span class="sxs-lookup"><span data-stu-id="407e2-124">Other examples of service applications include SharePoint Search and SharePoint Document Management.</span></span> <span data-ttu-id="407e2-125">詳細については、SharePoint Server 2013 の開発者ドキュメントを参照してください。</span><span class="sxs-lookup"><span data-stu-id="407e2-125">For more information, see the SharePoint Server 2013 developer documentation.</span></span>
  
<span data-ttu-id="407e2-126">Project Service アプリケーションは、Project Web App の複数のインスタンスを管理できる論理的なサービス プロバイダーです。</span><span class="sxs-lookup"><span data-stu-id="407e2-126">The Project Service Application is a logical service provider that can manage multiple instances of Project Web App.</span></span> <span data-ttu-id="407e2-127">Project Server のプロビジョニングにより、SharePoint Web アプリケーション内に特定の Project Web App サイトが作成されます。</span><span class="sxs-lookup"><span data-stu-id="407e2-127">Project Server provisioning creates a specific Project Web App site within a SharePoint web application.</span></span> <span data-ttu-id="407e2-128">Project Web App のホーム ページには、レポート作成用のプロジェクト センター ページ、リソース センター ページ、およびビジネス インテリジェンス センター ページへのリンクと、その他の標準アプリの一覧が含まれているページへのリンクがあります。</span><span class="sxs-lookup"><span data-stu-id="407e2-128">The Home page of Project Web App contains links to the Project Center page, Resource Center page, and the Business Intelligence Center page for reporting, plus a page that contains a list of additional standard apps.</span></span> <span data-ttu-id="407e2-129">図 1 は、Project Web App のホーム ページの **[設定]** ドロップダウン リストにある **[ページの編集]** コマンドを示しています。これにより、Web パーツを追加または編集できます。</span><span class="sxs-lookup"><span data-stu-id="407e2-129">Figure 1 shows the **Edit Page** command in the **Setttings** drop-down list on the Home page of Project Web App, which allows you to add or edit Web Parts.</span></span> 
  
> [!NOTE]
> <span data-ttu-id="407e2-130">Project Web App の一部の管理用ページ (PWA 設定ページなど) は編集できず、**[ページの編集]** コマンドが表示されません。</span><span class="sxs-lookup"><span data-stu-id="407e2-130">Some administrative pages in Project Web App—such as the PWA Settings page—are not editable, and do not show the **Edit Page** command.</span></span> <span data-ttu-id="407e2-131">Project Web App では、SharePoint Designer 2013 を使用してページを編集することはできません。</span><span class="sxs-lookup"><span data-stu-id="407e2-131">Project Web App does not allow you to edit pages by using SharePoint Designer 2013.</span></span> <span data-ttu-id="407e2-132">SharePoint Designer 2013 を使用して、プロジェクト サイト ページを編集できます。</span><span class="sxs-lookup"><span data-stu-id="407e2-132">You can edit project site pages with SharePoint Designer 2013.</span></span> 
  
<span data-ttu-id="407e2-133">**図 1. Project Web App の [ページの編集] メニューを使用する**</span><span class="sxs-lookup"><span data-stu-id="407e2-133">**Figure 1. Using the Edit Page menu in Project Web App**</span></span>

<span data-ttu-id="407e2-134">![Project Web Access でのホーム ページの編集](media/pj15_Programmability_PWAHome.gif "Project Web Access でのホーム ページの編集")</span><span class="sxs-lookup"><span data-stu-id="407e2-134">![Editing the Home page in Project Web Access](media/pj15_Programmability_PWAHome.gif "Editing the Home page in Project Web Access")</span></span>
  
<span data-ttu-id="407e2-135">Project Web App の [サイトの設定] ページにアクセスするには、ページの右上隅にある **[設定]** アイコンをクリックします。</span><span class="sxs-lookup"><span data-stu-id="407e2-135">To access the Site Settings page in Project Web App, choose the **Settings** icon in the top-right corner of the page.</span></span> <span data-ttu-id="407e2-136">[サイト設定] ページ (  `https://ServerName/ProjectServerName/_layouts/15/settings.aspx`) では、ルック アンド フィールとサイトのテーマの変更、カスタム Web パーツの追加、およびプロジェクト サイトのマスター ページの変更または作成を行うことができます。</span><span class="sxs-lookup"><span data-stu-id="407e2-136">The Site Settings page (  `https://ServerName/ProjectServerName/_layouts/15/settings.aspx`) enables changing the look and feel and the site theme, adding custom Web Parts, and modifying or creating master pages for project sites.</span></span>
  
<span data-ttu-id="407e2-137">ASPX ページ内のコードのカスタマイズ、または SharePoint Designer 2013 を使用した Project Web App マスター ページのカスタマイズはサポートされていません。</span><span class="sxs-lookup"><span data-stu-id="407e2-137">Customization of the code in ASPX pages, or customization of Project Web App master pages with SharePoint Designer 2013, is not supported.</span></span> <span data-ttu-id="407e2-138">Project Web App ページ内のコードをカスタマイズすると、Project Server の更新プログラムやサービス パックで問題が生じることがあります。</span><span class="sxs-lookup"><span data-stu-id="407e2-138">Customization of the code in Project Web App pages can cause problems with Project Server updates and service packs.</span></span> 
  
### <a name="customization-of-project-web-app-with-sharepoint-packages"></a><span data-ttu-id="407e2-139">SharePoint パッケージを使用した Project Web App のカスタマイズ</span><span class="sxs-lookup"><span data-stu-id="407e2-139">Customization of Project Web App with SharePoint packages</span></span>
<span data-ttu-id="407e2-140"><a name="pj15_Programmability_CustomizationOfPWA"> </a></span><span class="sxs-lookup"><span data-stu-id="407e2-140"><a name="pj15_Programmability_CustomizationOfPWA"> </a></span></span>

<span data-ttu-id="407e2-141">Project Web App は SharePoint アプリケーションであり、プロジェクト サイトは SharePoint サイトであるため、カスタム アプリ、Web パーツ、イベント ハンドラー、ユーザー設定フィールドなどの機能を SharePoint パッケージ (.wsp ファイル) または SharePoint アプリ (.spapp ファイル) を使用して追加できます。</span><span class="sxs-lookup"><span data-stu-id="407e2-141">Because Project Web App is a SharePoint application, and project sites are SharePoint sites, you can add custom apps, Web Parts, event handlers, custom fields, and other features by using SharePoint packages (.wsp files) or SharePoint apps (.spapp files).</span></span> <span data-ttu-id="407e2-142">1 つの SharePoint パッケージまたはアプリ パッケージに複数の Project Server エンティティを含めることができ、エンティティ定義はパッケージ内の elements.xml ファイルで指定されます。</span><span class="sxs-lookup"><span data-stu-id="407e2-142">A SharePoint package or an app package can include multiple Project Server entities, where entity definitions are specified in an elements.xml file within the package.</span></span>
  
<span data-ttu-id="407e2-143">Project Online では Project Web App リボンにボタンを追加できます。ただし、既存の製品のボタンを削除したり、名前を変更することはできません。また、新しいリボン タブも作成できません。</span><span class="sxs-lookup"><span data-stu-id="407e2-143">For Project Online, you can add buttons to the Project Web App ribbon, but you can't remove or rename existing product buttons, and you can't create new ribbon tabs.</span></span> <span data-ttu-id="407e2-144">詳細については、「[カスタム アクションを作成して SharePoint のアプリで展開する](https://docs.microsoft.com/sharepoint/dev/sp-add-ins/create-custom-actions-to-deploy-with-sharepoint-add-ins)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="407e2-144">For more information, see [Create custom actions to deploy with apps for SharePoint](https://docs.microsoft.com/sharepoint/dev/sp-add-ins/create-custom-actions-to-deploy-with-sharepoint-add-ins).</span></span>
  
> [!CAUTION]
> <span data-ttu-id="407e2-145">SharePoint パッケージまたはアプリ パッケージのインストール時には、Project Server エンティティの種類が PSEntityProvision.xsd スキーマに指定された順序で出現する必要があります。そうでない場合、パッケージのスキーマ検証が失敗し、インストールは完了しません。</span><span class="sxs-lookup"><span data-stu-id="407e2-145">When you install a SharePoint package or an app package, the types of Project Server entities must appear in the order that the PSEntityProvision.xsd schema specifies or schema validation of the package fails and installation is not completed.</span></span> 
  
<span data-ttu-id="407e2-146">PSEntityProvision.xsd スキーマ ファイルは、Project 2013 SDK ダウンロード (`Documentation\Schemas\AppProvisioning` サブディレクトリ内) にあります。</span><span class="sxs-lookup"><span data-stu-id="407e2-146">The PSEntityProvision.xsd schema file is available in the Project 2013 SDK download, in the  `Documentation\Schemas\AppProvisioning` subdirectory.</span></span> <span data-ttu-id="407e2-147">図 2 は、**PSEntityProvision** スキーマの Visual Studio での XML スキーマ エクスプローラー ビューを示しています。ここでは **LookupTable** シーケンスが展開されています。</span><span class="sxs-lookup"><span data-stu-id="407e2-147">Figure 2 shows the XML Schema Explorer view in Visual Studio of the **PSEntityProvision** schema, where the **LookupTable** sequence is expanded.</span></span> 
  
<span data-ttu-id="407e2-148">**図 2. Project Server エンティティのプロビジョニング スキーマの Visual Studio ビュー**</span><span class="sxs-lookup"><span data-stu-id="407e2-148">**Figure 2. Visual Studio view of the Project Server entity provisioning schema**</span></span>

<span data-ttu-id="407e2-149">![Project Server エンティティ スキーマのビュー](media/pj15_Programmability_EntitySchema.gif "Project Server エンティティ スキーマのビュー")</span><span class="sxs-lookup"><span data-stu-id="407e2-149">![View of the Project Server entity schema](media/pj15_Programmability_EntitySchema.gif "View of the Project Server entity schema")</span></span>
  
<span data-ttu-id="407e2-150">Project Server の機能をインストールする SharePoint パッケージには、**PSEntityProvision** スキーマに従った elements.xml ファイルを 1 つまたは複数含めることができます。</span><span class="sxs-lookup"><span data-stu-id="407e2-150">SharePoint packages that install features for Project Server can contain one or more elements.xml files that follow the **PSEntityProvision** schema.</span></span> <span data-ttu-id="407e2-151">1 つの XML ファイル内の Project Server エンティティは、次の順序で出現する必要があります。</span><span class="sxs-lookup"><span data-stu-id="407e2-151">The Project Server entities in a single XML file must appear in the following order:</span></span> 
  
1. <span data-ttu-id="407e2-152">ワークフロー フェーズ</span><span class="sxs-lookup"><span data-stu-id="407e2-152">Workflow phases</span></span>
    
2. <span data-ttu-id="407e2-153">参照テーブル</span><span class="sxs-lookup"><span data-stu-id="407e2-153">Lookup tables</span></span>
    
3. <span data-ttu-id="407e2-154">カスタム フィールド</span><span class="sxs-lookup"><span data-stu-id="407e2-154">Custom fields</span></span>
    
4. <span data-ttu-id="407e2-155">ワークフロー ステージ</span><span class="sxs-lookup"><span data-stu-id="407e2-155">Workflow stages</span></span>
    
5. <span data-ttu-id="407e2-156">エンタープライズ プロジェクトの種類</span><span class="sxs-lookup"><span data-stu-id="407e2-156">Enterprise project types</span></span>
    
6. <span data-ttu-id="407e2-157">イベント ハンドラー</span><span class="sxs-lookup"><span data-stu-id="407e2-157">Event handlers</span></span>
    
<span data-ttu-id="407e2-p116">Project Server エンティティを含む SharePoint パッケージを作成するときに、複数の elements.xml ファイルにエンティティ定義を含めることができます。各 XML ファイルがスキーマ検証に合格しても、パッケージ全体ではエンティティの順序が正しくない可能性があります。たとえば、最初の XML ファイル内のユーザー設定フィールド エンティティが 2 番目の XML ファイル内の参照テーブルを参照している場合があります。インストール時には、参照テーブルがまだ作成されていないため、ユーザー設定フィールドを作成できません。</span><span class="sxs-lookup"><span data-stu-id="407e2-p116">When you create a SharePoint package that contains Project Server entities, it is possible to put the entity definitions in multiple elements.xml files. Each XML file could pass the schema validation, but the entities in the whole package might not be in the correct order. For example, a custom field entity in the first XML file could refer to a lookup table in the second XML file. During installation, the custom field cannot be created because the lookup table has not yet been created.</span></span>
  
<span data-ttu-id="407e2-162">パッケージのインストールに失敗した場合、作成されたオブジェクトは Project Web App に残りますが、パッケージは完全にはインストールされません。</span><span class="sxs-lookup"><span data-stu-id="407e2-162">If a package installation fails, objects that have been created remain in Project Web App, but the package does not install completely.</span></span> <span data-ttu-id="407e2-163">パッケージを再インストールすることはできますが、お客様にとって適切な方法ではありません。</span><span class="sxs-lookup"><span data-stu-id="407e2-163">Reinstalling the package can work, but that is not a good experience for customers.</span></span> <span data-ttu-id="407e2-164">エンティティ定義が複数の elements.xml ファイルにまたがる場合は、SharePoint パッケージ全体で Project Server エンティティを整理して、インストールが正しい順序に従っていることを確認します。</span><span class="sxs-lookup"><span data-stu-id="407e2-164">When the entity definitions span multiple elements.xml files, organize the Project Server entities in the entire SharePoint package to ensure that installation follows the correct order.</span></span> <span data-ttu-id="407e2-165">Project 2013 SDK ダウンロードの PSEntityProvision.xsd スキーマを使用すると、XML ファイル内のエンティティの規定の順序を確認するツールを開発できます。</span><span class="sxs-lookup"><span data-stu-id="407e2-165">With the PSEntityProvision.xsd schema in the Project 2013 SDK download, it is possible to develop a tool that checks for the prescribed order of entities in the XML files.</span></span>
  
## <a name="upgrading-applications-with-the-project-server-apis"></a><span data-ttu-id="407e2-166">Project Server API を使用してアプリケーションをアップグレードする</span><span class="sxs-lookup"><span data-stu-id="407e2-166">Upgrading applications with the Project Server APIs</span></span>
<span data-ttu-id="407e2-167"><a name="pj15_Programmability_APIs"> </a></span><span class="sxs-lookup"><span data-stu-id="407e2-167"><a name="pj15_Programmability_APIs"> </a></span></span>

<span data-ttu-id="407e2-168">前のバージョンの Project Server 向けに開発されたアプリケーションをアップグレードする場合は、プロジェクト エンティティの作成、読み取り、更新、および削除のためのメソッド (CRUD 操作) を含むプログラム インターフェイスとして CSOM と PSI のどちらを使用するかを選択できます。</span><span class="sxs-lookup"><span data-stu-id="407e2-168">When you upgrade an application that was developed for a previous version of Project Server, you can choose to use either the CSOM or the PSI for a programmatic interface that includes methods to create, read, update, and delete project entities (the CRUD operations).</span></span> <span data-ttu-id="407e2-169">CSOM は内部で PSI を呼び出しますが、すべての PSI メソッドに完全に代わるものではありません。</span><span class="sxs-lookup"><span data-stu-id="407e2-169">Although the CSOM internally calls the PSI, it does not fully replace all PSI methods.</span></span> <span data-ttu-id="407e2-170">PSI と CSOM のシナリオと制約については、「[What the PSI does and does not do](what-the-psi-does-and-does-not-do.md)」および「[What the CSOM does and does not do](what-the-csom-does-and-does-not-do.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="407e2-170">For scenarios and limitations of the PSI and of the CSOM, see [What the PSI does and does not do](what-the-psi-does-and-does-not-do.md) and [What the CSOM does and does not do](what-the-csom-does-and-does-not-do.md).</span></span>
  
> [!NOTE]
> <span data-ttu-id="407e2-171">CSOM に必要な機能が含まれている場合は、CSOM を使用するようにアプリケーションをアップグレードすることをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="407e2-171">If the CSOM includes the functionality you require, we recommend that you upgrade applications to use the CSOM.</span></span> <span data-ttu-id="407e2-172">CSOM を使用すると、アプリケーションをオンプレミスとオンラインの両方の Project Server 2013 インストールで使用できるようになります。</span><span class="sxs-lookup"><span data-stu-id="407e2-172">The CSOM enables applications to be used for both on-premises and online installations of Project Server 2013.</span></span> 
  
<span data-ttu-id="407e2-173">アプリケーションが主に Project Server からデータを読み取る場合は、社内のシナリオに Project Server データベースのレポート テーブルおよびビューを使用できます。</span><span class="sxs-lookup"><span data-stu-id="407e2-173">If your application primarily reads data from Project Server, you can use the reporting tables and views in the Project Server database for an on-premises scenario.</span></span> <span data-ttu-id="407e2-174">アプリケーションを Project Online と共に使用する場合は、レポート データへのオンプレミスとオンラインの両方のアクセスを提供する **ProjectData** サービス用の OData プロトコルを使用できます。</span><span class="sxs-lookup"><span data-stu-id="407e2-174">If you intend to use the application with Project Online, you can use the OData protocol for the **ProjectData** service, which provides both on-premises and online access to the reporting data.</span></span> <span data-ttu-id="407e2-175">詳細については、「[ProjectData - Project OData サービス参照](https://docs.microsoft.com/previous-versions/office/project-odata/jj163015(v=office.15))」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="407e2-175">For more information, see [ProjectData - Project OData service reference](https://docs.microsoft.com/previous-versions/office/project-odata/jj163015(v=office.15))</span></span>
  
### <a name="using-the-psi"></a><span data-ttu-id="407e2-176">PSI を使用する</span><span class="sxs-lookup"><span data-stu-id="407e2-176">Using the PSI</span></span>
<span data-ttu-id="407e2-177"><a name="pj15_Programmability_PSI"> </a></span><span class="sxs-lookup"><span data-stu-id="407e2-177"><a name="pj15_Programmability_PSI"> </a></span></span>

<span data-ttu-id="407e2-178">PSI は、Project Professional 2013、Project Web App、および LOB アプリケーションなどの完全信頼クライアント アプリケーションが SharePoint ファーム内で Project Server データにアクセスできるようにします。</span><span class="sxs-lookup"><span data-stu-id="407e2-178">The PSI enables full-trust client applications, including Project Professional 2013, Project Web App, and LOB applications, to access Project Server data within a SharePoint farm.</span></span> <span data-ttu-id="407e2-179">PSI は .NET Framework 4 と共に構築および使用され、組み込みセキュリティを備えた馴染みのある開発環境、エラー処理、ガベージ コレクションなどの利点を提供します。</span><span class="sxs-lookup"><span data-stu-id="407e2-179">The PSI is built and used with .NET Framework 4 and provides advantages such as a well-known development environment with built-in security, error handling, and garbage collection.</span></span>
  
<span data-ttu-id="407e2-180">PSI には、WCF サービスまたは ASMX Web サービスを通じてアクセスします。</span><span class="sxs-lookup"><span data-stu-id="407e2-180">The PSI is accessed through WCF services or ASMX web services.</span></span> <span data-ttu-id="407e2-181">ASMX インターフェイスは WCF に基づいています。</span><span class="sxs-lookup"><span data-stu-id="407e2-181">The ASMX interface is based on WCF.</span></span> <span data-ttu-id="407e2-182">各 PSI サービスには、通常、基本クラスと共に、そのクラス内のアイテム用の CRUD メソッドが含まれています。</span><span class="sxs-lookup"><span data-stu-id="407e2-182">Each PSI service typically contains a base class with CRUD methods for items within that class.</span></span> <span data-ttu-id="407e2-183">アイテムは、関連する **DataSet** クラスによって指定されます。</span><span class="sxs-lookup"><span data-stu-id="407e2-183">Items are specified by related **DataSet** classes.</span></span> <span data-ttu-id="407e2-184">たとえば、**CustomFields** サービスには、[CreateCustomFields2](https://docs.microsoft.com/previous-versions/office/ee767959(v=office.14)) などのメソッドを持つ **CustomFields** クラスが含まれています。</span><span class="sxs-lookup"><span data-stu-id="407e2-184">For example, the **CustomFields** service contains the **CustomFields** class with methods such as [CreateCustomFields2](https://docs.microsoft.com/previous-versions/office/ee767959(v=office.14)) .</span></span> <span data-ttu-id="407e2-185">1 つまたは複数のエンタープライズ カスタム フィールドのデータが **CustomFieldDataSet** に指定されています。</span><span class="sxs-lookup"><span data-stu-id="407e2-185">Data for one or more enterprise custom fields are specified in the **CustomFieldDataSet**.</span></span>
  
> [!NOTE]
> <span data-ttu-id="407e2-186">PSI の ASMX Web サービスのインターフェイスは、Project Server 2013 で廃止されました。</span><span class="sxs-lookup"><span data-stu-id="407e2-186">The ASMX web services interface of the PSI is deprecated in Project Server 2013.</span></span> <span data-ttu-id="407e2-187">ASMX インターフェイスは引き続き利用できますが、PSI を使用する新しいアプリケーションは WCF インターフェイスを使用する必要があります。可能であれば、新しいアプリケーションでは PSI の代わりに CSOM を使用してください。</span><span class="sxs-lookup"><span data-stu-id="407e2-187">Although the ASMX interface is still available, new applications that use the PSI should use the WCF interface, or if possible, new applications should use the CSOM instead of the PSI.</span></span> <span data-ttu-id="407e2-188">Project Server の将来のバージョンでは、PSI の WCF インターフェイスを使用する場合や CSOM を使用する場合に、既存の ASMX ベースのアプリケーションをアップグレードする必要があります。</span><span class="sxs-lookup"><span data-stu-id="407e2-188">Future versions of Project Server will require an upgrade of existing ASMX-based applications to use the WCF interface of the PSI or to use the CSOM.</span></span> 
  
<span data-ttu-id="407e2-189">文書化されたパブリック PSI サービスは 22 個あり、これらは WCF インターフェイスおよび ASMX インターフェイスに複製されています。</span><span class="sxs-lookup"><span data-stu-id="407e2-189">There are 22 public, documented PSI services, which are duplicated in the WCF interface and the ASMX interface.</span></span> <span data-ttu-id="407e2-190">また、PSI には文書化されていない 8 個のプライベート インターフェイスも含まれています。</span><span class="sxs-lookup"><span data-stu-id="407e2-190">The PSI also includes eight private, undocumented services.</span></span> <span data-ttu-id="407e2-191">Project Web App および Project Professional は、パブリック PSI サービスとプライベート PSI サービスを使用します。</span><span class="sxs-lookup"><span data-stu-id="407e2-191">Project Web App and Project Professional use the public PSI services and the private PSI services.</span></span> <span data-ttu-id="407e2-192">PSI は通常、ビジネス オブジェクトと一致するように組み込まれます。</span><span class="sxs-lookup"><span data-stu-id="407e2-192">The PSI is generally factored to match the business objects.</span></span> <span data-ttu-id="407e2-193">つまり、各 PSI メソッドは、**カレンダー**や**リソース**などのビジネス オブジェクトに関連付けられています。</span><span class="sxs-lookup"><span data-stu-id="407e2-193">That is, each PSI method is associated with a business object such as **Calendar** or **Resource**.</span></span> <span data-ttu-id="407e2-194">PSI は、ビジネス オブジェクトへのプライマリ インターフェイスです。</span><span class="sxs-lookup"><span data-stu-id="407e2-194">The PSI is the primary interface to the business objects.</span></span> <span data-ttu-id="407e2-195">ビジネス層によって再利用可能なビジネス ロジック コンポーネントが提供されるため、Project Server データを処理するさまざまなアプリケーションで同じビジネス ロジックが使用されます。</span><span class="sxs-lookup"><span data-stu-id="407e2-195">Because the business layer provides reusable business logic components, different applications that interact with Project Server data use the same business logic.</span></span>
  
<span data-ttu-id="407e2-196">Project Server と非同期で対話する PSI メソッドは、**Queue** で始まる名前を持ちます。</span><span class="sxs-lookup"><span data-stu-id="407e2-196">PSI methods that asynchronously interact with Project Server have names that begin with **Queue**.</span></span> <span data-ttu-id="407e2-197">各 PSI メソッドは、厳密に型指定されたデータを使用する独立したインターフェイスによって実装されます。</span><span class="sxs-lookup"><span data-stu-id="407e2-197">Each PSI method is implemented with a separate interface that uses strongly typed data.</span></span> <span data-ttu-id="407e2-198">たとえば、**Project** サービスの **QueueCreateProject** メソッドは、**ProjectDataSet** 型の _dataset_ パラメーターを受け取ります。</span><span class="sxs-lookup"><span data-stu-id="407e2-198">For example, the **QueueCreateProject** method in the **Project** service accepts the  _dataset_ parameter of type **ProjectDataSet**.</span></span> <span data-ttu-id="407e2-199">**ProjectDataSet** クラスは **DataSet** 型から派生しています。</span><span class="sxs-lookup"><span data-stu-id="407e2-199">The **ProjectDataSet** class is derived from the **DataSet** type.</span></span> <span data-ttu-id="407e2-200">.NET Framework の型チェックと Visual Studio の IntelliSense の完了は、PSI を使用した開発のエラーを減らすために役立ちます。</span><span class="sxs-lookup"><span data-stu-id="407e2-200">Type checking in the .NET Framework and IntelliSense completion in Visual Studio help to reduce errors in development with the PSI.</span></span> <span data-ttu-id="407e2-201">PSI の名前空間、クラス、メソッド、プロパティ、イベント、および関連アセンブリの詳細な参照の概要については、「[Project PSI リファレンスの概要](project-psi-reference-overview.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="407e2-201">For an introduction to the detailed reference for PSI namespaces, classes, methods, properties, events, and related assemblies, see [Project PSI reference overview](project-psi-reference-overview.md).</span></span>
  
<span data-ttu-id="407e2-202">Project Server 2013 は、.NET Framework の例外処理を使用します。</span><span class="sxs-lookup"><span data-stu-id="407e2-202">Project Server 2013 uses the exception handling of the .NET Framework.</span></span> <span data-ttu-id="407e2-203">すべてのエラーは PSI スタックの上部にあるサーバーに記録されます。</span><span class="sxs-lookup"><span data-stu-id="407e2-203">All errors are logged in the server, at the top of the PSI stack.</span></span> <span data-ttu-id="407e2-204">エラーの中には、ASMX インターフェイスの **SoapException** オブジェクトや WCF インターフェイスの **FaultException** オブジェクトのように、クライアントへ簡単なレポートとして送信されるものもあります。</span><span class="sxs-lookup"><span data-stu-id="407e2-204">Some errors send a simple report to the client, such as a **SoapException** object for the ASMX interface or a **FaultException** object for the WCF interface.</span></span> <span data-ttu-id="407e2-205">例外はアプリケーション イベント ログに記録することができ、一部のエラーでも、サーバーの統合ログ サービス (ULS) のトレース ログに詳細なレポートが記録されます。</span><span class="sxs-lookup"><span data-stu-id="407e2-205">Exceptions can be recorded in the application event log, and some errors also record a detailed report on the server in the Unified Logging Service (ULS) trace logs.</span></span> 
  
<span data-ttu-id="407e2-p127">ローカルの完全信頼アプリケーションに対しても、PSI は拡張性に優れています。サービスを含む .NET アセンブリを追加し、そこで新しい機能を提供し、同じ Project Server セキュリティ インフラストラクチャを使用し、他の PSI メソッドを呼び出したり PSI のクラスを継承したりできます。PSI 拡張機能では、新しい機能で必要とされるビジネス ロジックとデータベース アクセスも提供できます。</span><span class="sxs-lookup"><span data-stu-id="407e2-p127">For local full-trust applications, the PSI is also extensible. You can add a .NET assembly with a service that provides new functionality, uses the same Project Server security infrastructure, and calls other PSI methods or inherits from PSI classes. A PSI extension can also provide the business logic and database access required for new functionality.</span></span>
  
### <a name="using-the-csom"></a><span data-ttu-id="407e2-209">CSOM を使用する</span><span class="sxs-lookup"><span data-stu-id="407e2-209">Using the CSOM</span></span>
<span data-ttu-id="407e2-210"><a name="pj15_Programmability_CSOM"> </a></span><span class="sxs-lookup"><span data-stu-id="407e2-210"><a name="pj15_Programmability_CSOM"> </a></span></span>

<span data-ttu-id="407e2-211">CSOM を使用すると、Project Online またはオンプレミスの Project Server 2013 インストールにアクセスするアプリを開発できます。</span><span class="sxs-lookup"><span data-stu-id="407e2-211">With the CSOM, you can develop apps that access Project Online or an on-premises Project Server 2013 installation.</span></span> <span data-ttu-id="407e2-212">アプリはパブリックな Office ストアまたはプライベートなアプリ カタログで配布できます。</span><span class="sxs-lookup"><span data-stu-id="407e2-212">Apps can be distributed in a public Office Store or a private app catalog.</span></span> <span data-ttu-id="407e2-213">CSOM は、データセットを渡して _changeXml_ パラメーターまたは XML の _filter_ パラメーターを作成するのではなく、LINQ クエリを使用して名前でデータを直接使用または提供する使いやすい API として開発されています。</span><span class="sxs-lookup"><span data-stu-id="407e2-213">The CSOM is designed to be an easy-to-use API that directly consumes or provides data by name with LINQ queries, rather than by passing datasets and constructing  _changeXml_ parameters or XML  _filter_ parameters.</span></span> <span data-ttu-id="407e2-214">CSOM は、**Project**, **Task**、**EnterpriseResource**、**Assignment** といった主要エンティティ向けの Project Server Interface (PSI) の主な機能を実装しています。</span><span class="sxs-lookup"><span data-stu-id="407e2-214">The CSOM implements the main functionality of the Project Server Interface (PSI) for the primary entities such as **Project**, **Task**, **EnterpriseResource**, and **Assignment**.</span></span> <span data-ttu-id="407e2-215">CSOM には、他の一般的な Project Server 機能をサポートする、**CustomField**、**LookupTable**、**WorkflowActivities**、**EventHandler**、**QueueJob** などの追加エンティティも多数含まれます。</span><span class="sxs-lookup"><span data-stu-id="407e2-215">The CSOM includes many additional entities such as **CustomField**, **LookupTable**, **WorkflowActivities**, **EventHandler**, and **QueueJob**, which support other common Project Server functionality.</span></span>
  
<span data-ttu-id="407e2-216">CSOM は、次のリソースを開発用のローカル コンピューターにコピーすることによって使用できます。</span><span class="sxs-lookup"><span data-stu-id="407e2-216">The CSOM can be used by copying the following resources to your local development computer:</span></span>
  
- <span data-ttu-id="407e2-217">.NET Framework 4 開発の場合は、`%ProgramFiles%\Common Files\Microsoft Shared\Web Server Extensions\15\ISAPI\Microsoft.ProjectServer.Client.dll` アセンブリをコピーします。</span><span class="sxs-lookup"><span data-stu-id="407e2-217">For .NET Framework 4 development, copy the  `%ProgramFiles%\Common Files\Microsoft Shared\Web Server Extensions\15\ISAPI\Microsoft.ProjectServer.Client.dll` assembly.</span></span> 
    
  <span data-ttu-id="407e2-218">CSOM クラスおよびメンバーについては、[Microsoft.ProjectServer.Client](https://docs.microsoft.com/previous-versions/office/dn529530(v=office.15)) 名前空間のドキュメントを参照してください。</span><span class="sxs-lookup"><span data-stu-id="407e2-218">For documentation of the CSOM classes and members, see the [Microsoft.ProjectServer.Client](https://docs.microsoft.com/previous-versions/office/dn529530(v=office.15)) namespace.</span></span> <span data-ttu-id="407e2-219">サンプル アプリケーションについては、[「CSOM と .NET の作業を開始する」](getting-started-with-the-project-server-csom-and-net.md)を参照してください。</span><span class="sxs-lookup"><span data-stu-id="407e2-219">For an example application, see [Getting started with the CSOM and .NET](getting-started-with-the-project-server-csom-and-net.md).</span></span>
    
- <span data-ttu-id="407e2-220">Microsoft Silverlight の開発の場合は、`%ProgramFiles%\Common Files\Microsoft Shared\Web Server Extensions\15\TEMPLATE\LAYOUTS\ClientBin\Microsoft.ProjectServer.Client.Silverlight.dll` アセンブリをコピーします。</span><span class="sxs-lookup"><span data-stu-id="407e2-220">For Microsoft Silverlight development, copy the  `%ProgramFiles%\Common Files\Microsoft Shared\Web Server Extensions\15\TEMPLATE\LAYOUTS\ClientBin\Microsoft.ProjectServer.Client.Silverlight.dll` assembly.</span></span> 
    
- <span data-ttu-id="407e2-221">Windows Phone 8 用のアプリを開発するには、`%ProgramFiles%\Common Files\Microsoft Shared\Web Server Extensions\15\TEMPLATE\LAYOUTS\ClientBin\Microsoft.ProjectServer.Client.Phone.dll` アセンブリをコピーします。</span><span class="sxs-lookup"><span data-stu-id="407e2-221">To develop apps for Windows Phone 8, copy the  `%ProgramFiles%\Common Files\Microsoft Shared\Web Server Extensions\15\TEMPLATE\LAYOUTS\ClientBin\Microsoft.ProjectServer.Client.Phone.dll` assembly.</span></span> 
    
- <span data-ttu-id="407e2-222">JavaScript を使用して Web アプリやその他のデバイスのアプリを開発するには、`%ProgramFiles%\Common Files\Microsoft Shared\Web Server Extensions\15\TEMPLATE\LAYOUTS\PS.js` ファイルと `PS.debug.js` ファイルをコピーします。</span><span class="sxs-lookup"><span data-stu-id="407e2-222">To use JavaScript for developing web apps and apps for other devices, copy the  `%ProgramFiles%\Common Files\Microsoft Shared\Web Server Extensions\15\TEMPLATE\LAYOUTS\PS.js` file and the  `PS.debug.js` file.</span></span> <span data-ttu-id="407e2-223">サンプル Web アプリについては、「[Project Server 2013 JavaScript オブジェクト モデルの概要](getting-started-with-the-project-server-2013-javascript-object-model.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="407e2-223">For an example web app, see [Getting started with the Project Server 2013 JavaScript object model](getting-started-with-the-project-server-2013-javascript-object-model.md).</span></span>
    
<span data-ttu-id="407e2-224">CSOM は内部的に PSI を呼び出します。そのため、PSI がジョブを実行できない場合は CSOM もできません。</span><span class="sxs-lookup"><span data-stu-id="407e2-224">The CSOM internally calls the PSI; therefore, if the PSI cannot do a job, neither can the CSOM.</span></span> <span data-ttu-id="407e2-225">CSOM の制限については、「[CSOM ができること、できないこと](what-the-csom-does-and-does-not-do.md)」および「[PSI ができること、できないこと](what-the-psi-does-and-does-not-do.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="407e2-225">For limitations of the CSOM, see [What the CSOM does and does not do](what-the-csom-does-and-does-not-do.md) and [What the PSI does and does not do](what-the-psi-does-and-does-not-do.md).</span></span> <span data-ttu-id="407e2-226">CSOM を使用した開発の詳細については、「[Project 2013 での開発者向けの更新プログラム](updates-for-developers-in-project-2013.md)」および「[Project 2013 のクライアント側オブジェクト モデル (CSOM)](client-side-object-model-csom-for-project-2013.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="407e2-226">For more information about developing with the CSOM, see [Updates for developers in Project 2013](updates-for-developers-in-project-2013.md) and [Client-side object model (CSOM) for Project 2013](client-side-object-model-csom-for-project-2013.md).</span></span>
  
### <a name="porting-applications-built-for-project-server-2003"></a><span data-ttu-id="407e2-227">Project Server 2003 用に構築されたアプリケーションを移植する</span><span class="sxs-lookup"><span data-stu-id="407e2-227">Porting applications built for Project Server 2003</span></span>
<span data-ttu-id="407e2-228"><a name="pj15_Programmability_Porting2003"> </a></span><span class="sxs-lookup"><span data-stu-id="407e2-228"><a name="pj15_Programmability_Porting2003"> </a></span></span>

<span data-ttu-id="407e2-p132">Project Server 2003 では、データや機能を利用するためには、多くの場合、Project Professional 2003 を使用するか、データベースに直接アクセスするしかありませんでした。Project Server 2007 で導入された PSI では、こうした制約の多くが取り除かれています。Project Server 2003 の Project Data Service (PDS) と異なり、PSI および CSOM は Project Server のビジネス オブジェクトに対する包括的なインターフェイスを提供しています。</span><span class="sxs-lookup"><span data-stu-id="407e2-p132">In Project Server 2003, much data and functionality is available only with Project Professional 2003 or by direct database access. The PSI, introduced in Project Server 2007, removes much of that restriction. Unlike the Project Data Service (PDS) in Project Server 2003, the PSI and the CSOM provide comprehensive interfaces to business objects in Project Server.</span></span>
  
<span data-ttu-id="407e2-p133">PDS 用に開発されたアプリケーションは、それ以降のバージョンの Project Server と互換性がありません。CSOM および PSI は PDS と同等の機能を提供していますが、PDS のメソッドやパラメーターと完全には対応していません。</span><span class="sxs-lookup"><span data-stu-id="407e2-p133">Applications developed for the PDS are not compatible with later versions of Project Server. The CSOM and the PSI provide functional parity for the PDS, but do not match PDS methods or parameters.</span></span>
  
> [!NOTE]
> <span data-ttu-id="407e2-234">PDS アプリケーションは Project Server 2013 用に完全に再設計する必要があるため、CSOM の使用をお勧めします。</span><span class="sxs-lookup"><span data-stu-id="407e2-234">Because PDS applications must be completely redesigned for Project Server 2013, we recommend that you use the CSOM.</span></span> 
  
<span data-ttu-id="407e2-235">PDS の互換性と、PDS 拡張機能を PSI に移植するためのガイドラインの詳細については、「[PSI Web サービスでの PDS パリティー](https://docs.microsoft.com/previous-versions/office/developer/office-2007/ms197081(v=office.12))」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="407e2-235">For more information about PDS compatibility and guidelines for porting PDS extensions to the PSI, see [PDS Parity in PSI Web Services](https://docs.microsoft.com/previous-versions/office/developer/office-2007/ms197081(v=office.12)).</span></span>
  
### <a name="porting-applications-built-for-project-server-2007-and-project-server-2010"></a><span data-ttu-id="407e2-236">Project Server 2007 および Project Server 2010 用に構築されたアプリケーションを移植する</span><span class="sxs-lookup"><span data-stu-id="407e2-236">Porting applications built for Project Server 2007 and Project Server 2010</span></span>
<span data-ttu-id="407e2-237"><a name="pj15_Programmability_Porting2007"> </a></span><span class="sxs-lookup"><span data-stu-id="407e2-237"><a name="pj15_Programmability_Porting2007"> </a></span></span>

<span data-ttu-id="407e2-238">Project Server 2013 の PSI は、Office Project Server 2007 および Project Server 2010 の PSI オブジェクト モデルのスーパーセットです。</span><span class="sxs-lookup"><span data-stu-id="407e2-238">The PSI in Project Server 2013 is a superset of the PSI object model in Office Project Server 2007 and Project Server 2010.</span></span> <span data-ttu-id="407e2-239">これらの 2 つの前バージョンの Project Server 用に構築されたアプリケーションの多くは、ローカルの完全に信頼できる、オンプレミスの Project Server 2013 インストールでも引き続き使用できます。</span><span class="sxs-lookup"><span data-stu-id="407e2-239">Many applications built for the two previous versions of Project Server continue to work in local full-trust, on-premises installations of Project Server 2013.</span></span> <span data-ttu-id="407e2-240">ただし、次の種類のアプリケーションは更新または再設計が必要です。</span><span class="sxs-lookup"><span data-stu-id="407e2-240">However, the following kinds of applications require updates or redesign:</span></span>
  
- <span data-ttu-id="407e2-241">Project Online での使用に適応させたアプリケーションには、CSOM を使用します。</span><span class="sxs-lookup"><span data-stu-id="407e2-241">Use the CSOM for applications that are adapted for use with Project Online.</span></span>
    
- <span data-ttu-id="407e2-242">モバイル デバイスやタブレット コンピューターでの使用に適応させたアプリケーションには、CSOM を使用します。</span><span class="sxs-lookup"><span data-stu-id="407e2-242">Use the CSOM for applications that are adapted for use on mobile devices and tablet computers.</span></span>
    
- <span data-ttu-id="407e2-243">Office ストアまたはプライベートなアプリ カタログでアプリとして提供されるアプリケーションには、CSOM を使用します。</span><span class="sxs-lookup"><span data-stu-id="407e2-243">Use the CSOM for applications that are available as apps in the Office Store or a private app catalog.</span></span>
    
- <span data-ttu-id="407e2-244">プロジェクトのスケジュールを変更するアプリケーションの場合は、CSOM を使用するか、[QueueUpdateProject2](https://docs.microsoft.com/previous-versions/office/project-class/jj236245(v=office.15)) PSI メソッドを使用するようにアプリケーションを変更してください。</span><span class="sxs-lookup"><span data-stu-id="407e2-244">For applications that modify project scheduling, use the CSOM, or change the application to use the [QueueUpdateProject2](https://docs.microsoft.com/previous-versions/office/project-class/jj236245(v=office.15)) PSI method.</span></span> 
    
- <span data-ttu-id="407e2-245">ユーザーが Project Web App の複数のインスタンスにログオンするローカル アプリケーションまたは Web アプリケーションでは、CSOM または PSI の WCF エンドポイント用のプログラム設定を使用する必要があります。</span><span class="sxs-lookup"><span data-stu-id="407e2-245">Local or web applications that log on users to different instances of Project Web App should use programmatic settings for WCF endpoints of the CSOM or the PSI.</span></span> <span data-ttu-id="407e2-246">これらのメソッドは非推奨です。</span><span class="sxs-lookup"><span data-stu-id="407e2-246">The methods are deprecated.</span></span> <span data-ttu-id="407e2-247">アプリを Project Online で使用するには、フォーム認証の代わりに OAuth 認証を使用する必要があります。</span><span class="sxs-lookup"><span data-stu-id="407e2-247">Apps should use OAuth authentication in place of Forms authentication and for use with Project Online.</span></span> <span data-ttu-id="407e2-248">詳細については、「[SharePoint 2013 アプリの承認と認証](https://docs.microsoft.com/sharepoint/dev/sp-add-ins/authorization-and-authentication-of-sharepoint-add-ins)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="407e2-248">For more information, see [Authorization and authentication for apps in SharePoint 2013](https://docs.microsoft.com/sharepoint/dev/sp-add-ins/authorization-and-authentication-of-sharepoint-add-ins).</span></span>
    
- <span data-ttu-id="407e2-249">特定の Project Server セキュリティ設定に依存したり変更を加えたりするアプリケーション。</span><span class="sxs-lookup"><span data-stu-id="407e2-249">Applications that rely on or modify specific Project Server security settings.</span></span>
    
  > [!NOTE]
  > <span data-ttu-id="407e2-250">Project Server 2013 の既定のオンプレミスのインストールでは、SharePoint のアクセス許可モードが使用されます。ここでは、PSI から Project Server のセキュリティ設定にアクセスできません。</span><span class="sxs-lookup"><span data-stu-id="407e2-250">A default on-premises installation of Project Server 2013 uses the SharePoint permission mode, where Project Server security settings are not accessible through the PSI.</span></span> <span data-ttu-id="407e2-251">Project のアクセス許可モードに変更するには、「[Project Server 2013 の IT 担当者向け新機能](https://docs.microsoft.com/project/what-s-new-for-it-pros-in-project-server-2016)」の「*SharePoint のアクセス許可モード*」セクションを参照してください。</span><span class="sxs-lookup"><span data-stu-id="407e2-251">To change to the Project permission mode, see the  *SharePoint Permission Mode*  section in [What's new for IT pros in Project Server 2013](https://docs.microsoft.com/project/what-s-new-for-it-pros-in-project-server-2016).</span></span> 
  
- <span data-ttu-id="407e2-252">多くのカスタム Project Server ワークフローでは、SharePoint Designer 2013 を使用して宣言型ワークフローを作成できます。</span><span class="sxs-lookup"><span data-stu-id="407e2-252">For many custom Project Server workflows, you can use SharePoint Designer 2013 to create declarative workflows.</span></span> <span data-ttu-id="407e2-253">追加のプログラミングを必要とするカスタム ワークフローに対しては、**Microsoft.Office.Project.Server.Workflow** 名前空間内でクラスまたはメンバーを直接*使用しないでください*。</span><span class="sxs-lookup"><span data-stu-id="407e2-253">For custom workflows that require additional programming, you should  *not*  directly use classes or members in the **Microsoft.Office.Project.Server.Workflow** namespace.</span></span> <span data-ttu-id="407e2-254">その代わりに、CSOM で [Microsoft.ProjectServer.Client.WorkflowActivities](https://docs.microsoft.com/previous-versions/office/mt780562(v=office.15)) クラスを使用します。</span><span class="sxs-lookup"><span data-stu-id="407e2-254">Instead, use the [Microsoft.ProjectServer.Client.WorkflowActivities](https://docs.microsoft.com/previous-versions/office/mt780562(v=office.15)) class in the CSOM.</span></span> 
    
- <span data-ttu-id="407e2-255">一般に、偽装を使用するアプリケーションは、PSI の WCF インターフェイスを使用するように書き直す必要があります。</span><span class="sxs-lookup"><span data-stu-id="407e2-255">In general, applications that use impersonation should be rewritten to use the WCF interface of the PSI.</span></span> <span data-ttu-id="407e2-256">他のユーザーの単純なステータス更新を行うアプリケーションでは、偽装は必要ありません。</span><span class="sxs-lookup"><span data-stu-id="407e2-256">Applications that do simple status updates for other users do not require impersonation.</span></span> <span data-ttu-id="407e2-257">CSOM の [StatusAssignment.SubmitStatusUpdates](https://docs.microsoft.com/previous-versions/office/project-class/jj235883(v=office.15)) メソッド、または PSI の [Statusing.SubmitStatusForResource](https://docs.microsoft.com/previous-versions/office/ee755393(v=office.14)) メソッドを使用できます。</span><span class="sxs-lookup"><span data-stu-id="407e2-257">They can use the [StatusAssignment.SubmitStatusUpdates](https://docs.microsoft.com/previous-versions/office/project-class/jj235883(v=office.15)) method in the CSOM or the [Statusing.SubmitStatusForResource](https://docs.microsoft.com/previous-versions/office/ee755393(v=office.14)) method in the PSI.</span></span> 
    
- <span data-ttu-id="407e2-258">Project Server コンピューター上で実行されるミドルウェア コンポーネントは社内用としてのみインストールでき、PSI の WCF インターフェイスを使用する必要があります。</span><span class="sxs-lookup"><span data-stu-id="407e2-258">Middleware components that run on the Project Server computer can be installed only for on-premises use, and must use the WCF interface of the PSI.</span></span> <span data-ttu-id="407e2-259">たとえば、ASMX インターフェイスを使用してオンプレミスの Project Web App と外部のタイムシート アプリケーションの間のデータ交換を行うミドルウェア コンポーネントは、PSI の WCF インターフェイスを使用するように書き直す必要があります。</span><span class="sxs-lookup"><span data-stu-id="407e2-259">For example, a middleware component that uses the ASMX interface to exchange data between Project Web App on-premises and an external timesheet application would have to be rewritten to use the WCF interface of the PSI.</span></span> <span data-ttu-id="407e2-260">Project Online で使用するためには、コンポーネントをアプリとして再設計し、CSOM を使用する必要があります。</span><span class="sxs-lookup"><span data-stu-id="407e2-260">To work with Project Online, the component would have to be redesigned as an app and use the CSOM.</span></span>
    
### <a name="migration-and-compatibility-of-custom-solutions"></a><span data-ttu-id="407e2-261">カスタム ソリューションの移行と互換性</span><span class="sxs-lookup"><span data-stu-id="407e2-261">Migration and compatibility of custom solutions</span></span>
<span data-ttu-id="407e2-262"><a name="pj15_Programmability_CustomSolutions"> </a></span><span class="sxs-lookup"><span data-stu-id="407e2-262"><a name="pj15_Programmability_CustomSolutions"> </a></span></span>

<span data-ttu-id="407e2-263">PSI のパブリック ASMX と WCF インターフェイスのクラスとメンバーは同じです。</span><span class="sxs-lookup"><span data-stu-id="407e2-263">Classes and members in the public ASMX and WCF interfaces of the PSI are identical.</span></span> <span data-ttu-id="407e2-264">ただし、PSI メソッドで使用されたり返されたりするデータベースの列の数とサイズは、Project Server 2013 と 2 つの前バージョンの Project Server とで異なる場合があります。</span><span class="sxs-lookup"><span data-stu-id="407e2-264">But, the number of columns and size of datatables used or returned by PSI methods can be different between Project Server 2013 and the two previous Project Server versions.</span></span> <span data-ttu-id="407e2-265">以前のバージョンのレポート データベースと比べて、レポートのテーブルとビューにも違いがあります。</span><span class="sxs-lookup"><span data-stu-id="407e2-265">There are also differences in the reporting tables and views, compared with the Reporting database in previous versions.</span></span>
  
> [!IMPORTANT]
> <span data-ttu-id="407e2-266">運用サーバーに展開する前に、Project Server 2013 の非運用インストールでソリューション全体をテストすることを強くお勧めします。</span><span class="sxs-lookup"><span data-stu-id="407e2-266">We strongly recommend that you thoroughly test solutions on a non-production installation of Project Server 2013 before deploying them to a production server.</span></span> 
  
<span data-ttu-id="407e2-267">ソリューションを Project Server 2013 に移行する場合、またはソリューションが意図したとおりに動作しない場合は、少なくとも次のことを行う必要があります。</span><span class="sxs-lookup"><span data-stu-id="407e2-267">When you migrate a solution to Project Server 2013, or if a solution does not work as expected, you should at a minimum do the following:</span></span>
  
- <span data-ttu-id="407e2-268">Visual Studio 2012 で開くことにより、ソリューションを更新します。</span><span class="sxs-lookup"><span data-stu-id="407e2-268">Update the solution by opening it in Visual Studio 2012.</span></span> <span data-ttu-id="407e2-269">一部のソリューションでは、Visual Studio 2010 も使用できます。</span><span class="sxs-lookup"><span data-stu-id="407e2-269">Some solutions can also use Visual Studio 2010.</span></span>
    
- <span data-ttu-id="407e2-270">ターゲットを .NET Framework 4 に変更します。</span><span class="sxs-lookup"><span data-stu-id="407e2-270">Change the target to .NET Framework 4.</span></span>
    
- <span data-ttu-id="407e2-271">Microsoft.Office.Project.Server.Library.dll、Microsoft.Office.Project.Server.Events.Receivers.dll などの Project Server 2013 アセンブリを使用するように、アセンブリ参照を変更します。</span><span class="sxs-lookup"><span data-stu-id="407e2-271">Change assembly references to use the Project Server 2013 assemblies, such as Microsoft.Office.Project.Server.Library.dll and Microsoft.Office.Project.Server.Events.Receivers.dll.</span></span>
    
- <span data-ttu-id="407e2-272">ASMX Web 参照または WCF サービス参照と名前空間名の一覧を作成し、Project Server の参照を削除します。</span><span class="sxs-lookup"><span data-stu-id="407e2-272">Make a list of the ASMX web references or the WCF service references and namespace names, and then delete the Project Server references.</span></span>
    
- <span data-ttu-id="407e2-273">Project 2013 SDK ダウンロードで WCF プロキシのソース ファイルから構築できる ProjectServerServices.dll プロキシ アセンブリを追加するか、必要な WCF サービス用のプロキシのソース ファイルを追加します。</span><span class="sxs-lookup"><span data-stu-id="407e2-273">Add the ProjectServerServices.dll proxy assembly that you can build from the WCF proxy source files in the Project 2013 SDK download, or add the proxy source files for the required WCF services.</span></span> <span data-ttu-id="407e2-274">ASMX サービスの場合は、同じ名前空間名を使用して、フロントエンドの ASMX Web サービス参照を再度追加します。または、Project 2013 SDK ダウンロードの WSDL ソースから構築できる、ProjectServerServices.dll プロキシ アセンブリを追加します。</span><span class="sxs-lookup"><span data-stu-id="407e2-274">For ASMX services, add the front-end ASMX web service references again, by using the same namespace names; or add the ProjectServerServices.dll proxy assembly that you can build from the WSDL sources in the Project 2013 SDK download.</span></span>
    
  > [!NOTE]
  > <span data-ttu-id="407e2-275">Project 2013 SDK ダウンロードでは、プロキシ ソース ファイルの名前空間はすべて *Svc* で始まります。</span><span class="sxs-lookup"><span data-stu-id="407e2-275">In the Project 2013 SDK download, the namespaces in the proxy source files all start with  *Svc*  .</span></span> <span data-ttu-id="407e2-276">たとえば、WCF プロキシ ファイルおよび ASMX プロキシ ファイル内の **Resource** サービスの名前空間は、**SvcResource** になります。</span><span class="sxs-lookup"><span data-stu-id="407e2-276">For example, the **Resource** service namespace in the WCF proxy file and in the ASMX proxy file is **SvcResource**.</span></span> <span data-ttu-id="407e2-277">> 異なる名前空間名をアプリケーションで使用している場合は、その名前空間を使用するようにプロキシ アセンブリを再コンパイルするか、アプリケーションで PSI 名前空間を変更することができます。</span><span class="sxs-lookup"><span data-stu-id="407e2-277">> If your application uses different namespace names, you can either recompile the proxy assembly to use your namespaces, or change the PSI namespaces in your application.</span></span> <span data-ttu-id="407e2-278">たとえば、SDK ダウンロードの CompileWCFProxyAssembly.cmd スクリプトを変更し、プロキシ ソース ファイルから ProjectServerServices.dll を再コンパイルすることができます。</span><span class="sxs-lookup"><span data-stu-id="407e2-278">For example, you can modify the CompileWCFProxyAssembly.cmd script and recompile ProjectServerServices.dll from the proxy source files in the SDK download.</span></span> 
  
- <span data-ttu-id="407e2-279">PSI の ASMX インターフェイスから WCF インターフェイスを使用するように変更する場合は、プログラムによって、または app.config の WCF エンドポイントを使用して、クライアント クラスを初期化できます。プログラムによる初期化は、Project Web App の別のインスタンスにすばやく切り替える必要があるときや、PSI を使用する Web パーツを開発しているときに使用します。</span><span class="sxs-lookup"><span data-stu-id="407e2-279">If you change from using the ASMX interface of the PSI to the WCF interface, you can initialize the client classes either programmatically or by using WCF endpoints in app.config. Use programmatic initialization when you have to quickly switch to different instances of Project Web App, or when you are developing a web part that uses the PSI.</span></span>
    
- <span data-ttu-id="407e2-280">Project Server 2013 の PSI サービスには、いくつかの新しいメソッドとデータセットがあり、いくつかの **DataRow** クラスには新しいプロパティが含まれています。</span><span class="sxs-lookup"><span data-stu-id="407e2-280">There are several new methods and datasets in the PSI services in Project Server 2013 and some **DataRow** classes contain new properties.</span></span> <span data-ttu-id="407e2-281">たとえば、PSI の [QueueUpdateProject2](https://docs.microsoft.com/previous-versions/office/project-class/jj236245(v=office.15)) メソッドは、Project Server のスケジュール エンジンを使用して、Project Professional 2013 でプロジェクトを開かなくても、更新されたプロジェクトを再スケジュールします。また、同じ呼び出しでプロジェクト エンティティを追加または削除することもできます。</span><span class="sxs-lookup"><span data-stu-id="407e2-281">For example, the [QueueUpdateProject2](https://docs.microsoft.com/previous-versions/office/project-class/jj236245(v=office.15)) method in the PSI uses the Project Server scheduling engine to reschedule an updated project without you having to open the project in Project Professional 2013, and also allows adding or deleting project entities in the same call.</span></span> 
    
- <span data-ttu-id="407e2-282">ソリューションをコンパイルしてテストします。</span><span class="sxs-lookup"><span data-stu-id="407e2-282">Compile and test the solution.</span></span>
    
## <a name="project-scheduling-on-the-server"></a><span data-ttu-id="407e2-283">サーバー上でのプロジェクト スケジューリング</span><span class="sxs-lookup"><span data-stu-id="407e2-283">Project scheduling on the server</span></span>
<span data-ttu-id="407e2-284"><a name="pj15_Programmability_Scheduling"> </a></span><span class="sxs-lookup"><span data-stu-id="407e2-284"><a name="pj15_Programmability_Scheduling"> </a></span></span>

<span data-ttu-id="407e2-285">Project Server 2013 には 2 つのスケジューリング エンジンがあります。</span><span class="sxs-lookup"><span data-stu-id="407e2-285">Project Server 2013 has two scheduling engines.</span></span> <span data-ttu-id="407e2-286">新しい方のスケジューリング エンジンは、Project Professional 2013 のスケジューリング エンジンと同じです。</span><span class="sxs-lookup"><span data-stu-id="407e2-286">The newer scheduling engine is the same as the scheduling engine in Project Professional 2013.</span></span> <span data-ttu-id="407e2-287">Project Web App またはプロジェクト サイトの [スケジュール] Web パーツ ([プロジェクトの詳細] ページ) か CSOM を使用してスケジュールを変更し、その変更を発行した場合、日付、コスト、期間、残存作業時間、基準計画、およびスケジュールに関するその他の変更の計算は、Project Professional 2013 を使用して変更およびプロジェクトの発行を行った場合と同じになります。</span><span class="sxs-lookup"><span data-stu-id="407e2-287">When you make scheduling changes and publish the changes by using the Scheduling web part (Project Details page) in Project Web App or a project site, or by using the CSOM, the calculation of dates, costs, duration, remaining work, baselines, and other changes related to scheduling are the same as if you made the changes and published the project by using Project Professional 2013.</span></span> <span data-ttu-id="407e2-288">ただし、PSI メソッドは Project Server 2010 から移行された古いスケジューリング エンジンを使用します ([QueueUpdateProject2](https://docs.microsoft.com/previous-versions/office/project-class/jj236245(v=office.15)) メソッド以外)。</span><span class="sxs-lookup"><span data-stu-id="407e2-288">However, except for the [QueueUpdateProject2](https://docs.microsoft.com/previous-versions/office/project-class/jj236245(v=office.15)) method, PSI methods use the older scheduling engine that was migrated from Project Server 2010.</span></span> <span data-ttu-id="407e2-289">これは、従来のアプリケーションが Project Server 2013 でも以前と同じように動作するようにするためです。</span><span class="sxs-lookup"><span data-stu-id="407e2-289">The reason is to ensure that legacy applications behave the same in Project Server 2013 as they previously did.</span></span> 
  
> [!NOTE]
> <span data-ttu-id="407e2-290">更新されたスケジューリング エンジンを Project Server 2013 で使用するために、アプリケーションは CSOM を使用できます。</span><span class="sxs-lookup"><span data-stu-id="407e2-290">To use the updated scheduling engine in Project Server 2013, applications can use the CSOM.</span></span> 
  
<span data-ttu-id="407e2-291">新旧両方のスケジューリング エンジンには、以下の制限があります。</span><span class="sxs-lookup"><span data-stu-id="407e2-291">Both the older and the newer scheduling engines have the following limitations:</span></span>
  
- <span data-ttu-id="407e2-292">**1 つのプロジェクトのスケジューリングのみ** スケジューリングは、変更が PSI、CSOM、または Project Web App を使用して、タスク状態の更新を通じて行われたときに、現在のプロジェクトにのみ影響します。</span><span class="sxs-lookup"><span data-stu-id="407e2-292">**Single project scheduling only** Scheduling affects only the current project, when changes are made through task status updates with the PSI or the CSOM, or with Project Web App.</span></span> <span data-ttu-id="407e2-293">現在のプロジェクトに他のプロジェクト、サブプロジェクト、またはマスター プロジェクトへのリンクが存在する場合、リンクされたプロジェクトは変更されません。</span><span class="sxs-lookup"><span data-stu-id="407e2-293">If the current project has links to other projects, subprojects, or master projects, the linked projects are not changed.</span></span> 
    
- <span data-ttu-id="407e2-294">**サマリー タスク** 一般に、Project Server 上のサマリー タスクは読み取り専用です。</span><span class="sxs-lookup"><span data-stu-id="407e2-294">**Summary tasks** Summary tasks are generally read-only on Project Server.</span></span> <span data-ttu-id="407e2-295">たとえば、サマリー タスクに対する割り当てを作成したり、達成率を変更したりすることはできません。</span><span class="sxs-lookup"><span data-stu-id="407e2-295">For example, assignments for summary tasks cannot be created, and percent completion cannot be modified.</span></span> <span data-ttu-id="407e2-296">しかし、Project Server は手動でスケジュールされたサマリー タスクの日付や期間を編集することはサポートしています。</span><span class="sxs-lookup"><span data-stu-id="407e2-296">However, Project Server does support editing the dates and duration of manually scheduled summary tasks.</span></span> 
    
    <span data-ttu-id="407e2-p148">Project Server の実績作業時間がサマリー タスクの割り当てに自動的に追加されることはありません。それは Project Server の承認プロセスをバイパスすることになるからです。Project Professional では、サブタスクに追加した実績作業時間はサマリー タスクの割り当てにも追加されます。この動作の違いがユーザーを混乱させることがあります。</span><span class="sxs-lookup"><span data-stu-id="407e2-p148">Actuals on Project Server are not added automatically to a summary task assignment, because that would bypass the approval process in Project Server. In Project Professional, when you add actuals to a subtask, the actuals are also added for an assignment on the summary task. The difference in behavior can be confusing for a user.</span></span>
    
    <span data-ttu-id="407e2-300">Project Server は、サブタスクの期間が短縮されるか、終了日が変更された場合に、サマリー タスクの割り当ての実績作業時間を削除します。</span><span class="sxs-lookup"><span data-stu-id="407e2-300">Project Server deletes actuals on a summary task assignment if the subtask duration shortens or the finish date is changed.</span></span>
    
    > [!CAUTION]
    > <span data-ttu-id="407e2-301">Project Professional ではサマリー タスク上で割り当てを作成できますが、作成しないことをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="407e2-301">Although Project Professional can do it, we recommend that you do not make assignments on summary tasks.</span></span> 
  
<span data-ttu-id="407e2-302">古い Project Server スケジューリング エンジンでの PSI プログラミングの問題と制限事項は以下のとおりです。</span><span class="sxs-lookup"><span data-stu-id="407e2-302">Following are issues and limitations of PSI programming with the older Project Server scheduling engine:</span></span>
  
- <span data-ttu-id="407e2-303">**タスクのアクティブ ステータスを変更する** [QueueUpdateProject](https://docs.microsoft.com/previous-versions/office/ms471014(v=office.14)) メソッドを使用してタスクのアクティブ ステータスを変更する場合、_dataset_ パラメーターに関して **ProjectDataSet** オブジェクトに複数の変更があると、古い Project Server スケジューリング エンジンは矛盾した開始時間または終了時間を表示することがあります。</span><span class="sxs-lookup"><span data-stu-id="407e2-303">**Changing the active status of a task** The older Project Server scheduling engine can show inconsistent start or finish times when you use the [QueueUpdateProject](https://docs.microsoft.com/previous-versions/office/ms471014(v=office.14)) method to change the active status of a task, if there are multiple changes in the **ProjectDataSet** object for the  _dataset_ parameter.</span></span> <span data-ttu-id="407e2-304">**QueueUpdateProject** の _dataset_ パラメーターでの唯一の変更が **TASK_IS_ACTIVE** プロパティの場合は、プロジェクトを変更できます。</span><span class="sxs-lookup"><span data-stu-id="407e2-304">If the **TASK_IS_ACTIVE** property is the only change in the  _dataset_ parameter of **QueueUpdateProject**, you can update the project.</span></span>
    
    <span data-ttu-id="407e2-305">非アクティブなタスクおよび古いスケジューリング エンジンの詳細については、ブログ記事の「[Project 2010 の非アクティブ タスクについて](https://blogs.msdn.com/b/project/archive/2010/06/10/introducing-inactive-tasks-in-project-2010.aspx)」および「[Project Server 2010: Web、Web、PSI および Project Professional でのスケジュール設定](https://blogs.msdn.com/b/brismith/archive/2010/09/10/project-server-2010-scheduling-on-the-web-the-psi-and-project-professional.aspx?wa=wsignin1.0)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="407e2-305">For more information about inactive tasks and the older scheduling engine, see the blog articles [Introducing inactive tasks in Project 2010](https://blogs.msdn.com/b/project/archive/2010/06/10/introducing-inactive-tasks-in-project-2010.aspx) and [Project Server 2010: Scheduling on the web, the PSI and Project Professional](https://blogs.msdn.com/b/brismith/archive/2010/09/10/project-server-2010-scheduling-on-the-web-the-psi-and-project-professional.aspx?wa=wsignin1.0).</span></span> <span data-ttu-id="407e2-306">Project Professional 2010 と Project Web App の Project Server 2010 でのスケジューリングの比較については、「[Web ベースのスケジュール管理の比較](https://blogs.msdn.microsoft.com/brismith/2010/09/10/project-server-2010-scheduling-on-the-web-the-psi-and-project-professional/)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="407e2-306">For a comparison of scheduling in Project Professional 2010 and Project Web App in Project Server 2010, see [Web-based schedule management comparison](https://blogs.msdn.microsoft.com/brismith/2010/09/10/project-server-2010-scheduling-on-the-web-the-psi-and-project-professional/).</span></span>
    
- <span data-ttu-id="407e2-307">**達成額が計算されていない** 古いスケジューリング エンジンは、達成額フィールド (ACWP、BAC、BCWP、BCWS、CPI、CV、CV%、EAC、SPI、SV、SV%、TCPI、VAC、期間差異、開始日の差異、終了日の差異、コスト差異、および作業時間の差異) を計算しません。</span><span class="sxs-lookup"><span data-stu-id="407e2-307">**Earned value not calculated** The older scheduling engine does not calculate the earned value fields: ACWP, BAC, BCWP, BCWS, CPI, CV, CV%, EAC, SPI, SV, SV%, TCPI, VAC, Duration Variance, Start Variance, Finish Variance, Cost Variance, and Work Variance.</span></span> <span data-ttu-id="407e2-308">プロジェクトがこれらのフィールドに値を持ち、そのプロジェクトが **QueueUpdateProject** メソッドを使用して更新された場合、これらのフィールドの値は変更されません。</span><span class="sxs-lookup"><span data-stu-id="407e2-308">If a project has values for these fields and the project is updated by using the **QueueUpdateProject** method, the field values do not change.</span></span> <span data-ttu-id="407e2-309">問題を回避するには、**QueueUpdateProject2** メソッドを使用します。</span><span class="sxs-lookup"><span data-stu-id="407e2-309">To avoid the problem, use the **QueueUpdateProject2** method.</span></span> 
    
<span data-ttu-id="407e2-310">PSI のスケジューリングの制限事項には、以下の方法で対処できます。</span><span class="sxs-lookup"><span data-stu-id="407e2-310">You can handle the PSI scheduling limitations in the following ways:</span></span>
  
- <span data-ttu-id="407e2-311">アプリケーションで必要なメソッドが CSOM にある場合は、PSI ではなく CSOM を使用する。</span><span class="sxs-lookup"><span data-stu-id="407e2-311">If the CSOM has the methods the application requires, use the CSOM instead of the PSI.</span></span>
    
- <span data-ttu-id="407e2-312">Project Professional でプロジェクトを開き、Project Server に保存する。</span><span class="sxs-lookup"><span data-stu-id="407e2-312">Open projects in Project Professional and save them back to Project Server.</span></span>
    
- <span data-ttu-id="407e2-313">レポートに、PSI が更新しないフィールドは含めない。</span><span class="sxs-lookup"><span data-stu-id="407e2-313">In reports, do not include fields that the PSI does not update.</span></span>
    
- <span data-ttu-id="407e2-314">レポートに、データが古くなっている可能性があるという注意を記す。</span><span class="sxs-lookup"><span data-stu-id="407e2-314">Add a note in reports about data that may be stale.</span></span>
    
<span data-ttu-id="407e2-p152">レポート テーブルとキューブには、プロジェクト データの一部が更新されていないことを検出できるフラグがあります。MSP_EpmProject テーブルと MSP_EpmProject_UserView のレポート データには次のフィールドがあります。</span><span class="sxs-lookup"><span data-stu-id="407e2-p152">There are flags in the reporting tables and the cubes that help you detect when some project data is not updated. The reporting data in the MSP_EpmProject table and in MSP_EpmProject_UserView includes the following fields:</span></span> 
  
-  <span data-ttu-id="407e2-317">_ProjectWbsIsStale_ &ndash; 作業分割構造 (タスク アウトライン階層) が古いことを示します。</span><span class="sxs-lookup"><span data-stu-id="407e2-317">_ProjectWbsIsStale_ &ndash; Indicates whether the work breakdown structure (task outline hierarchy) is stale.</span></span> 
    
-  <span data-ttu-id="407e2-318">_ProjectEarnedValueIsStale_ &ndash; 達成額フィールドが古いことを示します。</span><span class="sxs-lookup"><span data-stu-id="407e2-318">_ProjectEarnedValueIsStale_ &ndash; Indicates the earned value fields are stale.</span></span> 
    
-  <span data-ttu-id="407e2-319">_ProjectRollupsAreStale_ &ndash; サブプロジェクトが下書きデータベースで更新されているのに、マスター プロジェクトが更新されていないことを示します。</span><span class="sxs-lookup"><span data-stu-id="407e2-319">_ProjectRollupsAreStale_ &ndash; Indicates that a subproject is updated in the draft database, but the master project is not updated.</span></span> <span data-ttu-id="407e2-320">サブプロジェクトからの重ね合わせた値が古くなっています。</span><span class="sxs-lookup"><span data-stu-id="407e2-320">The rolled-up values from the subproject are stale.</span></span> 
    
-  <span data-ttu-id="407e2-321">_ProjectHierarchyNotSynchronized_ &ndash; マスター プロジェクトがその子と同期されていません。</span><span class="sxs-lookup"><span data-stu-id="407e2-321">_ProjectHierarchyNotSynchronized_ &ndash; The master project is not synchronized with its children.</span></span> <span data-ttu-id="407e2-322">この状態は、子プロジェクトがマスター プロジェクトの発行の一部ではなく、明示的に発行されたときに発生します。</span><span class="sxs-lookup"><span data-stu-id="407e2-322">This happens when the child projects are published explicitly, not as part of the master project publishing.</span></span> 
    
-  <span data-ttu-id="407e2-323">_ProjectCalculationsAreStale_ &ndash; Project Professional がスケジュールを計算せずにプロジェクトを保存しました (つまり、**[Project のオプション]** ダイアログ ボックスの **[スケジュール]** タブで、計算モードが **[手動]** に設定されています)。</span><span class="sxs-lookup"><span data-stu-id="407e2-323">_ProjectCalculationsAreStale_ &ndash; Project Professional saved a project without calculating the schedule (that is, the calculation mode is set to **Manual** on the **Schedule** tab in the **Project Options** dialog box).</span></span> 
    
-  <span data-ttu-id="407e2-324">_ProjectGhostTaskAreStale_ &ndash; _ProjectHierarchyNotSynchronized_ と似ていますが、プロジェクト間のリンクのデータについて警告します。</span><span class="sxs-lookup"><span data-stu-id="407e2-324">_ProjectGhostTaskAreStale_ &ndash; Similar to  _ProjectHierarchyNotSynchronized_, but warns on cross-project link data.</span></span> <span data-ttu-id="407e2-325">マスター プロジェクトが存在しないのに、リンクの一方のプロジェクト データが他方よりも新しい可能性があります。</span><span class="sxs-lookup"><span data-stu-id="407e2-325">It is possible that no master project exists, but the project data on one side of the link is newer than on the other side.</span></span>
    
## <a name="about-accessing-the-project-server-database"></a><span data-ttu-id="407e2-326">Project Server データベースへのアクセスについて</span><span class="sxs-lookup"><span data-stu-id="407e2-326">About accessing the Project Server database</span></span>
<span data-ttu-id="407e2-327"><a name="pj15_Programmability_Databases"> </a></span><span class="sxs-lookup"><span data-stu-id="407e2-327"><a name="pj15_Programmability_Databases"> </a></span></span>

<span data-ttu-id="407e2-328">Microsoft SQL Server で Project Server データベースへのアクセス許可を持っている場合は、レポート テーブルとビューを読み取ることができます。</span><span class="sxs-lookup"><span data-stu-id="407e2-328">If you have permissions in Microsoft SQL Server to access the Project Server database, you can read the reporting tables and views.</span></span> <span data-ttu-id="407e2-329">必要な Project Server のアクセス許可を持っている場合は、OData クエリを使用して、レポート テーブルからデータを読み取ることもできます。</span><span class="sxs-lookup"><span data-stu-id="407e2-329">If you have the necessary Project Server permissions, you can also read data from the reporting tables by using OData queries.</span></span> <span data-ttu-id="407e2-330">開発者には、Project Server データベースで下書きテーブル、発行済みテーブル、またはアーカイブ テーブルに SQL Server のクエリを通じて直接アクセスしないことを強く推奨します。</span><span class="sxs-lookup"><span data-stu-id="407e2-330">Developers are strongly discouraged from directly accessing the draft, published, or archive tables through SQL Server queries in the Project Server database.</span></span> <span data-ttu-id="407e2-331">Project Server データベースでいずれかのテーブルに直接変更を加えると、参照整合性が損なわれたり、Project Server キュー サービスを通じたデータベース アクセスと干渉したりする可能性があります。</span><span class="sxs-lookup"><span data-stu-id="407e2-331">Making direct changes in any of the tables in the Project Server database can damage referential integrity and interfere with database access through the Project Server Queuing Service.</span></span>
  
> [!IMPORTANT]
> <span data-ttu-id="407e2-p157">プログラムによってデータベースに直接アクセスしてデータを更新することを能動的に妨げるものは存在しません。Project Professional キャッシュ、発行済みテーブル、およびレポート テーブルはすべてがキャッシュ同期プロトコルに依存しているので、直接データを編集すると同期が混乱する可能性があることに注意が必要です。直接アクセスしてデータを変更することによって、Project Server データベースや Project Professional クライアント側キャッシュが破損した場合、製品サポートは役に立てません。</span><span class="sxs-lookup"><span data-stu-id="407e2-p157">There is nothing to actively prevent you from using direct programmatic database access to update data. You should be aware that the Project Professional cache, the published tables, and the reporting tables all rely on a cache synchronization protocol that can be disrupted by direct data editing. If you damage your Project Server database or corrupt Project Professional client-side caches by using direct access to change data, be warned that product support won't be able to help!</span></span> 
  
<span data-ttu-id="407e2-335">下書きテーブル、発行済みテーブル、アーカイブ テーブル、およびビューに直接アクセスするアプリケーションは、データベース スキーマにも依存します。データベース スキーマは Project Server 2013 のサービス パックや将来のバージョンで変更される可能性があります。</span><span class="sxs-lookup"><span data-stu-id="407e2-335">Applications that directly access the draft, published, or archive tables and views are also dependent on the database schemas, which can change in service packs or later versions of Project Server 2013.</span></span> <span data-ttu-id="407e2-336">データベースに直接アクセスするアプリケーションも、組み込みの Project Server セキュリティ、共通ビジネス ロジック、追跡、監査、エラー チェック、レポート、ワークフローなどの機能を利用できません。</span><span class="sxs-lookup"><span data-stu-id="407e2-336">Applications that directly access the databases also lose the built-in Project Server security, common business logic, tracking, audits, error checking, reporting, workflow, and other features.</span></span> <span data-ttu-id="407e2-337">こうしたアプリケーションは、Project Server 2013 の更新後に書き換える必要性が高くなります。</span><span class="sxs-lookup"><span data-stu-id="407e2-337">You would likely have to rewrite such an application after Project Server 2013 updates.</span></span> 
  
<span data-ttu-id="407e2-338">以上の理由により、Project Professional と Project Web App は、下書きテーブル、発行済みテーブル、またはアーカイブ テーブルへの直接呼び出しを行いません。Project Server と統合される他のアプリケーションでも、そのような呼び出しは避ける必要があります。</span><span class="sxs-lookup"><span data-stu-id="407e2-338">For all of these reasons, Project Professional and Project Web App do not make direct calls to the draft, published, or archive tables; neither should any other application that integrates with Project Server.</span></span>
  
<span data-ttu-id="407e2-339">下書きテーブル、発行済みテーブル、およびアーカイブ テーブルのスキーマは文書化されていません。</span><span class="sxs-lookup"><span data-stu-id="407e2-339">The schemas for the draft, published, and archive tables are not documented.</span></span> <span data-ttu-id="407e2-340">レポートの生成を支援するために、レポート テーブルを使用できます。レポート テーブルとビューのスキーマは Project 2013 SDK ダウンロードで文書化されています。</span><span class="sxs-lookup"><span data-stu-id="407e2-340">You can use the reporting tables to help generate reports, and the schema for the reporting tables and views is documented in the Project 2013 SDK download.</span></span> <span data-ttu-id="407e2-341">レポート データの OData スキーマについては、「[ProjectData - Project OData サービス参照](https://docs.microsoft.com/previous-versions/office/project-odata/jj163015(v=office.15))」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="407e2-341">For the OData schema of the reporting data, see [ProjectData - Project OData service reference](https://docs.microsoft.com/previous-versions/office/project-odata/jj163015(v=office.15)).</span></span>
  
## <a name="see-also"></a><span data-ttu-id="407e2-342">関連項目</span><span class="sxs-lookup"><span data-stu-id="407e2-342">See also</span></span>

- [<span data-ttu-id="407e2-343">Project 2013 における開発者向けの更新内容</span><span class="sxs-lookup"><span data-stu-id="407e2-343">Updates for developers in Project 2013</span></span>](updates-for-developers-in-project-2013.md)    
- [<span data-ttu-id="407e2-344">Project Server 2013 のアーキテクチャ</span><span class="sxs-lookup"><span data-stu-id="407e2-344">Project Server 2013 architecture</span></span>](project-server-2013-architecture.md)    
- [<span data-ttu-id="407e2-345">PSI ができること、できないこと</span><span class="sxs-lookup"><span data-stu-id="407e2-345">What the PSI does and does not do</span></span>](what-the-psi-does-and-does-not-do.md)   
- [<span data-ttu-id="407e2-346">CSOM ができること、できないこと</span><span class="sxs-lookup"><span data-stu-id="407e2-346">What the CSOM does and does not do</span></span>](what-the-csom-does-and-does-not-do.md)    
- [<span data-ttu-id="407e2-347">Project 2013 のクライアント側オブジェクト モデル (CSOM)</span><span class="sxs-lookup"><span data-stu-id="407e2-347">Client-side object model (CSOM) for Project 2013</span></span>](client-side-object-model-csom-for-project-2013.md)    
- [<span data-ttu-id="407e2-348">Project Server ワークフロー開発の作業開始</span><span class="sxs-lookup"><span data-stu-id="407e2-348">Getting started developing Project Server workflows</span></span>](getting-started-developing-project-server-workflows.md)    
- [<span data-ttu-id="407e2-349">Project 2013 プログラミング リファレンス</span><span class="sxs-lookup"><span data-stu-id="407e2-349">Project 2013 programming references</span></span>](project-2013-programming-references.md)    
- [<span data-ttu-id="407e2-350">Project PSI リファレンスの概要</span><span class="sxs-lookup"><span data-stu-id="407e2-350">Project PSI reference overview</span></span>](project-psi-reference-overview.md)    
- [<span data-ttu-id="407e2-351">カスタム アクションを作成して SharePoint アプリで展開する</span><span class="sxs-lookup"><span data-stu-id="407e2-351">Create custom actions to deploy with apps for SharePoint</span></span>](https://docs.microsoft.com/sharepoint/dev/sp-add-ins/create-custom-actions-to-deploy-with-sharepoint-add-ins)    
- [<span data-ttu-id="407e2-352">Project 2010 の非アクティブなタスクの概要</span><span class="sxs-lookup"><span data-stu-id="407e2-352">Introducing Inactive Tasks in Project 2010</span></span>](https://blogs.msdn.com/b/project/archive/2010/06/10/introducing-inactive-tasks-in-project-2010.aspx)    
- [<span data-ttu-id="407e2-353">Project Server 2010: Web、PSI、および Project Professional でのスケジューリング</span><span class="sxs-lookup"><span data-stu-id="407e2-353">Project Server 2010: Scheduling on the Web, the PSI and Project Professional</span></span>](https://blogs.msdn.microsoft.com/brismith/2010/09/10/project-server-2010-scheduling-on-the-web-the-psi-and-project-professional/)

