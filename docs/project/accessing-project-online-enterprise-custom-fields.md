---
title: オンライン プロジェクトのエンタープライズ ユーザー設定フィールドにアクセスします。
manager: soliver
ms.date: 11/08/2016
ms.audience: Developer
localization_priority: Normal
ms.assetid: 25509631-fa14-49d8-b594-cfacf5355c38
description: オンラインのプロジェクトは、企業はビジネス ニーズに合わせて拡張可能な Office 365 サービスです。 1 つの拡張領域は、エンタープライズ ユーザー設定フィールド (ECFs) です。 ECFs は、プロジェクト、リソース、およびタスクに追加できる型指定された値フィールドです。 次の表では、プロジェクト、リソース、およびタスクに関連する ECFs を一覧表示し、その ECF のインスタンスの値の例が用意されています。
ms.openlocfilehash: d6c8f97ffc887b33e5d81af8e463cf10502845dd
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 06/11/2018
ms.locfileid: "19804552"
---
# <a name="accessing-project-online-enterprise-custom-fields"></a><span data-ttu-id="01789-106">オンライン プロジェクトのエンタープライズ ユーザー設定フィールドにアクセスします。</span><span class="sxs-lookup"><span data-stu-id="01789-106">Accessing Project Online enterprise custom fields</span></span>

<span data-ttu-id="01789-107">オンラインのプロジェクトは、企業はビジネス ニーズに合わせて拡張可能な Office 365 サービスです。</span><span class="sxs-lookup"><span data-stu-id="01789-107">Project Online is an Office 365 service that companies can extend to meet business needs.</span></span> <span data-ttu-id="01789-108">1 つの拡張領域は、エンタープライズ ユーザー設定フィールド (ECFs) です。</span><span class="sxs-lookup"><span data-stu-id="01789-108">One extension area is Enterprise Custom Fields (ECFs).</span></span> <span data-ttu-id="01789-109">ECFs は、プロジェクト、リソース、およびタスクに追加できる型指定された値フィールドです。</span><span class="sxs-lookup"><span data-stu-id="01789-109">ECFs are typed value fields that can be added to projects, resources, and tasks.</span></span> <span data-ttu-id="01789-110">次の表では、プロジェクト、リソース、およびタスクに関連する ECFs を一覧表示し、その ECF のインスタンスの値の例が用意されています。</span><span class="sxs-lookup"><span data-stu-id="01789-110">The following table lists ECFs that associate with projects, resources, and tasks, and provides an example of a value for an instance of that ECF:</span></span>
  
|<span data-ttu-id="01789-111">ECF 名</span><span class="sxs-lookup"><span data-stu-id="01789-111">ECF Name</span></span>|<span data-ttu-id="01789-112">ECF の種類</span><span class="sxs-lookup"><span data-stu-id="01789-112">ECF Type</span></span>|<span data-ttu-id="01789-113">関連付け</span><span class="sxs-lookup"><span data-stu-id="01789-113">Association</span></span>|<span data-ttu-id="01789-114">例の値</span><span class="sxs-lookup"><span data-stu-id="01789-114">Example Value</span></span>|
|:-----|:-----|:-----|:-----|
|<span data-ttu-id="01789-115">妥当性</span><span class="sxs-lookup"><span data-stu-id="01789-115">Justification</span></span>  <br/> |<span data-ttu-id="01789-116">TEXT</span><span class="sxs-lookup"><span data-stu-id="01789-116">TEXT</span></span>  <br/> |<span data-ttu-id="01789-117">Project</span><span class="sxs-lookup"><span data-stu-id="01789-117">Project</span></span>  <br/> |<span data-ttu-id="01789-118">エンド ・ ユーザーは、重要な統計のデータと状態データ、正常性評価と個別化されたアクションを含む検索結果を記録できる良好な状態の方に計画します。</span><span class="sxs-lookup"><span data-stu-id="01789-118">An end user can record vital statistics and health data, with results that include a health evaluation and an individualized action plan towards better health.</span></span>  <br/> |
|<span data-ttu-id="01789-119">リスクの評価</span><span class="sxs-lookup"><span data-stu-id="01789-119">Risk Rating</span></span>  <br/> |<span data-ttu-id="01789-120">TEXT</span><span class="sxs-lookup"><span data-stu-id="01789-120">TEXT</span></span>  <br/> |<span data-ttu-id="01789-121">Project</span><span class="sxs-lookup"><span data-stu-id="01789-121">Project</span></span>  <br/> |<span data-ttu-id="01789-122">低</span><span class="sxs-lookup"><span data-stu-id="01789-122">Low</span></span>  <br/> |
|<span data-ttu-id="01789-123">ROI</span><span class="sxs-lookup"><span data-stu-id="01789-123">ROI</span></span>  <br/> |<span data-ttu-id="01789-124">番号</span><span class="sxs-lookup"><span data-stu-id="01789-124">NUMBER</span></span>  <br/> |<span data-ttu-id="01789-125">Project</span><span class="sxs-lookup"><span data-stu-id="01789-125">Project</span></span>  <br/> |<span data-ttu-id="01789-126">2.10</span><span class="sxs-lookup"><span data-stu-id="01789-126">2.10</span></span>  <br/> |
|<span data-ttu-id="01789-127">総所有コスト</span><span class="sxs-lookup"><span data-stu-id="01789-127">Total Cost</span></span>  <br/> |<span data-ttu-id="01789-128">コスト</span><span class="sxs-lookup"><span data-stu-id="01789-128">COST</span></span>  <br/> |<span data-ttu-id="01789-129">Project</span><span class="sxs-lookup"><span data-stu-id="01789-129">Project</span></span>  <br/> |<span data-ttu-id="01789-130">1,031,514 ドル</span><span class="sxs-lookup"><span data-stu-id="01789-130">$1,031,514</span></span>  <br/> |
|<span data-ttu-id="01789-131">チームを起動します。</span><span class="sxs-lookup"><span data-stu-id="01789-131">Launch Team</span></span>  <br/> |<span data-ttu-id="01789-132">TEXT</span><span class="sxs-lookup"><span data-stu-id="01789-132">TEXT</span></span>  <br/> |<span data-ttu-id="01789-133">Resources</span><span class="sxs-lookup"><span data-stu-id="01789-133">Resources</span></span>  <br/> |<span data-ttu-id="01789-134">はい</span><span class="sxs-lookup"><span data-stu-id="01789-134">Yes</span></span>  <br/> |
|<span data-ttu-id="01789-135">位置の役割</span><span class="sxs-lookup"><span data-stu-id="01789-135">Position Role</span></span>  <br/> |<span data-ttu-id="01789-136">TEXT</span><span class="sxs-lookup"><span data-stu-id="01789-136">TEXT</span></span>  <br/> |<span data-ttu-id="01789-137">リソース</span><span class="sxs-lookup"><span data-stu-id="01789-137">Resources</span></span>  <br/> |<span data-ttu-id="01789-138">テスト担当者</span><span class="sxs-lookup"><span data-stu-id="01789-138">Tester</span></span>  <br/> |
|<span data-ttu-id="01789-139">フラグ</span><span class="sxs-lookup"><span data-stu-id="01789-139">Flag Status</span></span>  <br/> |<span data-ttu-id="01789-140">フラグ</span><span class="sxs-lookup"><span data-stu-id="01789-140">FLAG</span></span>  <br/> |<span data-ttu-id="01789-141">タスク</span><span class="sxs-lookup"><span data-stu-id="01789-141">Task</span></span>  <br/> |<span data-ttu-id="01789-142">いいえ</span><span class="sxs-lookup"><span data-stu-id="01789-142">No</span></span>  <br/> |
|<span data-ttu-id="01789-143">タスクの状況</span><span class="sxs-lookup"><span data-stu-id="01789-143">Health</span></span>  <br/> |<span data-ttu-id="01789-144">TEXT</span><span class="sxs-lookup"><span data-stu-id="01789-144">TEXT</span></span>  <br/> |<span data-ttu-id="01789-145">タスク</span><span class="sxs-lookup"><span data-stu-id="01789-145">Task</span></span>  <br/> |<span data-ttu-id="01789-146">指定されていません</span><span class="sxs-lookup"><span data-stu-id="01789-146">Not specified</span></span>  <br/> |
   
<span data-ttu-id="01789-147">ECFs は、プロジェクト Web アプリケーション (PWA) インスタンスでは、任意のプロジェクト、リソース、またはタスクから外部で定義されます。</span><span class="sxs-lookup"><span data-stu-id="01789-147">ECFs are defined at the Project Web Application (PWA) instance, external from any project, resource, or task.</span></span> <span data-ttu-id="01789-148">まだ、プロジェクト、リソース、またはタスクに関連付けられていることになります。</span><span class="sxs-lookup"><span data-stu-id="01789-148">Yet, they can become associated with a project, resource, or task.</span></span> <span data-ttu-id="01789-149">この資料では、サンプル アプリケーションを使用してユーザー設定のフィールドに必須の外観を提供し、ECF の値を取得するのに焦点を当てます。</span><span class="sxs-lookup"><span data-stu-id="01789-149">This article provides an introductory look at custom fields using a sample application and focuses on retrieving ECF values.</span></span> 
  
<span data-ttu-id="01789-150">完全なサンプルをダウンロードすることができますhttps://github.com/OfficeDev/Project-CSOM-Read-Enterprise-CustomFields。</span><span class="sxs-lookup"><span data-stu-id="01789-150">You can download the complete sample at https://github.com/OfficeDev/Project-CSOM-Read-Enterprise-CustomFields.</span></span>
  
<span data-ttu-id="01789-151">さらに、オンラインのプロジェクトをサポートしているローカル ユーザー設定フィールド、特定のプロジェクト、リソース、またはタスクに固有のエンティティを読み取り専用として。</span><span class="sxs-lookup"><span data-stu-id="01789-151">Additionally, Project Online supports local custom fields as read-only entities specific to the specific project, resource, or task.</span></span> <span data-ttu-id="01789-152">ローカル ユーザー設定フィールドの詳細については、サンプルを参照してくださいhttps://github.com/OfficeDev/Project-CSOM-Read-Local-CustomFields\。</span><span class="sxs-lookup"><span data-stu-id="01789-152">For more information on local custom fields, see the sample https://github.com/OfficeDev/Project-CSOM-Read-Local-CustomFields\.</span></span>
  
## <a name="background-materials"></a><span data-ttu-id="01789-153">背景資料</span><span class="sxs-lookup"><span data-stu-id="01789-153">Background materials</span></span>

<span data-ttu-id="01789-154">[クライアント側オブジェクト モデルを使用してプロジェクトのオンライン アプリケーションの開発](developing-a-project-online-application-using-the-client-side-object-model.md)を、前回の記事では、バック グラウンドと CSOM を使用してアプリケーションを開発するための最初の方向を提供します。</span><span class="sxs-lookup"><span data-stu-id="01789-154">A previous article, [Developing a Project Online application using the client-side object model](developing-a-project-online-application-using-the-client-side-object-model.md), provides background and the initial orientation for developing applications using CSOM.</span></span> <span data-ttu-id="01789-155">次の項目は、この資料を参照してください。</span><span class="sxs-lookup"><span data-stu-id="01789-155">Refer to this article for the following items:</span></span>
  
- <span data-ttu-id="01789-156">プロジェクト、およびクラウド ベースのスタンドアロン版についての基礎知識</span><span class="sxs-lookup"><span data-stu-id="01789-156">Background information about Project, stand-alone and cloud-based editions</span></span> 
    
- <span data-ttu-id="01789-157">開発環境 (Visual Studio のエディションおよびソフトウェア ライブラリ)</span><span class="sxs-lookup"><span data-stu-id="01789-157">Development environment (Visual Studio editions and software libraries)</span></span>
    
- <span data-ttu-id="01789-158">CSOM ライブラリを使用して .NET アプリケーション用の Visual Studio のプロジェクトの設定</span><span class="sxs-lookup"><span data-stu-id="01789-158">Visual Studio project setup for a .NET application using the CSOM library</span></span>
    
- <span data-ttu-id="01789-159">プロジェクトのオンライン サービスに接続します。</span><span class="sxs-lookup"><span data-stu-id="01789-159">Connecting to the Project Online service</span></span>
    
## <a name="preliminaries-class-level-declarations"></a><span data-ttu-id="01789-160">準備 (クラス レベルの宣言)</span><span class="sxs-lookup"><span data-stu-id="01789-160">Preliminaries (class-level declarations)</span></span>

<span data-ttu-id="01789-161">このアプリケーションのクラスは、2 つのデータ項目を定義します。 プロジェクト コンテキストと pwaECF の辞書です。</span><span class="sxs-lookup"><span data-stu-id="01789-161">The class for this application defines two data items: the project context and the pwaECF dictionary.</span></span>
  
<span data-ttu-id="01789-162">プロジェクト コンテキスト オブジェクトはプロジェクト CSOM の一部であるため、アプリケーション、PWA のインスタンスに接続します。</span><span class="sxs-lookup"><span data-stu-id="01789-162">The project context object is part of the Project CSOM, and connects the application and the PWA instance.</span></span> <span data-ttu-id="01789-163">サービスに対するすべての要求は、プロジェクトのコンテキストを使用します。</span><span class="sxs-lookup"><span data-stu-id="01789-163">All requests to the service use the project context.</span></span>
  
```cs
private static ProjectContext projContext = 
     new ProjectContext("https://Contoso216.sharepoint.com/sites/pwa");

```

<span data-ttu-id="01789-164">コンテキストには、接続のエンドポイントをアプリケーションでインスタンスを作成する必要があります。</span><span class="sxs-lookup"><span data-stu-id="01789-164">The context needs the connection endpoint to create an instance in an application.</span></span> <span data-ttu-id="01789-165">接続のエンドポイントは、PWA インスタンスの URL です。</span><span class="sxs-lookup"><span data-stu-id="01789-165">The connection endpoint is the URL of your PWA instance.</span></span> 
  
<span data-ttu-id="01789-166">PwaECF ディクショナリには、ECFs は、PWA のレベルで定義されているプロジェクトが格納されています。</span><span class="sxs-lookup"><span data-stu-id="01789-166">The pwaECF dictionary stores the project ECFs defined at the PWA level.</span></span> <span data-ttu-id="01789-167">ディクショナリは、ECF を使用します。キーと値としてのカスタム オブジェクトとして InternalName。</span><span class="sxs-lookup"><span data-stu-id="01789-167">The dictionary uses the ECF.InternalName as the key, and the CustomField object as the value.</span></span> <span data-ttu-id="01789-168">辞書は、ListPWACustomFields メソッドで作成され、Main メソッド内の参照として使用されます。</span><span class="sxs-lookup"><span data-stu-id="01789-168">The dictionary is populated in the ListPWACustomFields method, and then used as a reference in the Main method.</span></span> 
  
```cs
    //Dictionary of ECFs
        static Dictionary<String, CustomField> pwaECF = new Dictionary<string, CustomField>();

```

## <a name="main-method"></a><span data-ttu-id="01789-169">Main メソッド</span><span class="sxs-lookup"><span data-stu-id="01789-169">Main method</span></span>

<span data-ttu-id="01789-170">Main メソッドは、アプリケーションのフローを管理します。</span><span class="sxs-lookup"><span data-stu-id="01789-170">The Main method manages the application flow.</span></span> <span data-ttu-id="01789-171">として、プロジェクトのオンライン CSOM を使用する他のアプリケーションのメイン コンテキストを初期化プロジェクトです。</span><span class="sxs-lookup"><span data-stu-id="01789-171">As with other applications that use the Project Online CSOM, Main initializes the project context.</span></span> 
  
1. <span data-ttu-id="01789-172">取得し、プロジェクトのオンライン PWA で ECFs を一覧表示します。</span><span class="sxs-lookup"><span data-stu-id="01789-172">Retrieve and list the ECFs in the Project Online PWA.</span></span>
    
   <span data-ttu-id="01789-173">この機能は、ListPWACustomFields メソッドで実装されます。</span><span class="sxs-lookup"><span data-stu-id="01789-173">This functionality is implemented in the ListPWACustomFields method.</span></span>
    
2. <span data-ttu-id="01789-174">プロジェクト ユーザー設定フィールドと非カスタム フィールドを取得します。</span><span class="sxs-lookup"><span data-stu-id="01789-174">Retrieve projects with custom fields and non-custom fields.</span></span>
    
   <span data-ttu-id="01789-175">ECFs でプロジェクトを取得するとき、プロジェクトのオンライン サービスにクエリ要求を次の項目を含める必要があります。</span><span class="sxs-lookup"><span data-stu-id="01789-175">When retrieving projects with ECFs, the query request to the Project Online service needs to include the following items:</span></span> 
    
   - <span data-ttu-id="01789-176">**IncludeCustomFields**&ndash;は、この項目が公開されている各プロジェクトにユーザー設定フィールドをサポートしている拡張機能が含まれている PublishedProjects のコレクションを取得するサービスを要求します。</span><span class="sxs-lookup"><span data-stu-id="01789-176">**IncludeCustomFields** &ndash; This item requests the service to return a collection of PublishedProjects where each published project includes an extension that supports custom fields.</span></span> <span data-ttu-id="01789-177">この項目が指定されている場合を除き、オンラインのプロジェクト オブジェクトを返します PublishedProject カスタム フィールドのデータが含まれていません。</span><span class="sxs-lookup"><span data-stu-id="01789-177">Unless this item is specified, Project Online returns PublishedProject objects that do not include Custom Field data.</span></span>
    
   - <span data-ttu-id="01789-178">**IncludeCustomFields.CustomFields** &ndash;は、この項目名のデータを PublishedProject オブジェクトを作成するサービスを要求します。</span><span class="sxs-lookup"><span data-stu-id="01789-178">**IncludeCustomFields.CustomFields** &ndash; This item requests the service to populate the PublishedProject objects with CustomFields data.</span></span>
    
   <span data-ttu-id="01789-179">次のような要求は、プロジェクトの Id と、ユーザー設定フィールドのオブジェクトの拡張機能とユーザー設定フィールドの値を指定します。</span><span class="sxs-lookup"><span data-stu-id="01789-179">The following request specifies the project Id and Name, as well as the object extension for custom fields and the custom field values.</span></span>
    
   ```cs
        var projBlk = projContext.LoadQuery(
        projContext.Projects.Include(
            p => p.Id, 
            p => p.Name,
            p => p.IncludeCustomFields,
            p => p.IncludeCustomFields.CustomFields
        ));
    
   ```

3. <span data-ttu-id="01789-180">各プロジェクトを確認します。</span><span class="sxs-lookup"><span data-stu-id="01789-180">Examine each project.</span></span>
    
   <span data-ttu-id="01789-181">このアプリケーションで使用されているプロジェクトのオブジェクトは、値の取得および表示するための PublishedProject 型です。</span><span class="sxs-lookup"><span data-stu-id="01789-181">The project objects used in this application are the PublishedProject type because the values are retrieved and displayed.</span></span> 
    
   <span data-ttu-id="01789-182">1 つまたは複数のプロジェクト内のデータ値を更新する場合は、更新プログラムを実行中のプロジェクトをチェック アウト、およびアプリケーションでは、DraftProject オブジェクトを使用して値を取得し、プロジェクトを更新するのには。</span><span class="sxs-lookup"><span data-stu-id="01789-182">If you need to update data values in one or more projects, the project undergoing the update would be checked out and the application would use a DraftProject object to retrieve the values and update the project.</span></span>
    
4. <span data-ttu-id="01789-183">プロジェクトの ECF エントリへのアクセス</span><span class="sxs-lookup"><span data-stu-id="01789-183">Accessing the ECF entries for a project</span></span>
    
   <span data-ttu-id="01789-184">ECF ごとでは、ECF の情報の残りの部分からフィールドの値を区切ります。</span><span class="sxs-lookup"><span data-stu-id="01789-184">Each ECF instance separates the field value from the rest of the ECF information.</span></span> <span data-ttu-id="01789-185">フィールドの値は、キー/値のペアの一部として格納されます。</span><span class="sxs-lookup"><span data-stu-id="01789-185">The field value is stored as part of a key/value pair.</span></span> <span data-ttu-id="01789-186">情報の残りの部分は、カスタム オブジェクトに格納されます。</span><span class="sxs-lookup"><span data-stu-id="01789-186">The rest of the information is stored in a CustomField object.</span></span>
    
   <span data-ttu-id="01789-187">ECF の値にアクセスするプロジェクトは、2 つの部分で構成されます。</span><span class="sxs-lookup"><span data-stu-id="01789-187">Accessing ECF values in a project consists of two parts:</span></span>
    
   - <span data-ttu-id="01789-188">名のコレクションを循環させる</span><span class="sxs-lookup"><span data-stu-id="01789-188">Cycling through the CustomFields collection</span></span>
    
   - <span data-ttu-id="01789-189">2 つの構造を使用して、適切なエントリにアクセスします。</span><span class="sxs-lookup"><span data-stu-id="01789-189">Accessing the proper entry using two constructs.</span></span>
    
   <span data-ttu-id="01789-190">各プロジェクト名のコレクションは、列挙可能な 2 つの場所で ECF の関連するエントリを格納して、キーと値のペアの一部としてフィールドの値です。</span><span class="sxs-lookup"><span data-stu-id="01789-190">Each project stores associated ECF entries in two places, a CustomFields collection that is enumerable and and the field values as part of key/value pairs.</span></span> <span data-ttu-id="01789-191">、キー/値のペアで、internalName キーは、フィールドの値は、値です。</span><span class="sxs-lookup"><span data-stu-id="01789-191">In the key/value pairs, the internalName is the key and the field value is the value.</span></span> <span data-ttu-id="01789-192">保持し、フィールド値にアクセスするには、辞書を使用します。</span><span class="sxs-lookup"><span data-stu-id="01789-192">Use a dictionary to hold and access the field values.</span></span> 
    
   <span data-ttu-id="01789-193">ECF プロパティ、フィールドの値以外は、プロジェクトごとに 1 つのオブジェクトに、カスタム オブジェクトに格納されます。</span><span class="sxs-lookup"><span data-stu-id="01789-193">The ECF properties, other than the field values, are stored in CustomField objects, one object per project.</span></span> <span data-ttu-id="01789-194">個々 のプロジェクトに関連付けられている ECFs にアクセスするのにには、名のコレクションを使用します。</span><span class="sxs-lookup"><span data-stu-id="01789-194">Use a CustomFields collection to access the ECFs associated with an individual project.</span></span> 
    
5. <span data-ttu-id="01789-195">各プロジェクトでは、ECF の各エントリが、キー、ECF--と、ECF の値を保持するオブジェクトの内部名で構成されているコレクションに関連付けられている ECFs を格納します。</span><span class="sxs-lookup"><span data-stu-id="01789-195">Each project stores the associated ECFs in a collection where each ECF entry consists of a key--the internal name of the ECF--and an object that holds the value of the ECF.</span></span> <span data-ttu-id="01789-196">コレクションを個別のエントリにアクセスするための辞書に転送します。</span><span class="sxs-lookup"><span data-stu-id="01789-196">Transfer the collection to a dictionary to access individual entries.</span></span> <span data-ttu-id="01789-197">宣言に依存します。</span><span class="sxs-lookup"><span data-stu-id="01789-197">The declaration follows.</span></span>
    
   ```cs
    Dictionary<string, object> projDict = pubProj.IncludeCustomFields.FieldValues;
    
   ```

   <span data-ttu-id="01789-198">ディクショナリ エントリの値は、ECF のデータ型に対応しています。</span><span class="sxs-lookup"><span data-stu-id="01789-198">The value in a dictionary entry corresponds to the data type of the ECF.</span></span> <span data-ttu-id="01789-199">各 ECF のオブジェクトは、さまざまな種類の 1 つにマップします。</span><span class="sxs-lookup"><span data-stu-id="01789-199">The object for each ECF maps to one of a variety of types.</span></span> <span data-ttu-id="01789-200">ほとんどの ECFs は、標準的な変数に格納する単純型を使用します。</span><span class="sxs-lookup"><span data-stu-id="01789-200">Most ECFs use simple types that fit into standard variables.</span></span> <span data-ttu-id="01789-201">次のフラグメントは、いくつかの種類の最小限の処理が含まれていることを示しています。</span><span class="sxs-lookup"><span data-stu-id="01789-201">The following fragment shows that minimal processing is involved for several types:</span></span>
    
   ```cs
    switch (cf.FieldType)
    {
        case CustomFieldType.COST:
            decimal costValue = (decimal)oVal;
            Console.WriteLine("\tFieldType:\t{0}\n\tValue:\t{1}", cf.FieldType, 
                costValue.ToString("C"));
            break;
        case CustomFieldType.DATE:
            Console.WriteLine("\tFieldType:\t{0}\n\tValue:\t{1}", cf.FieldType, 
                oVal.ToString());
            break;
        case CustomFieldType.FINISHDATE:
            Console.WriteLine("\tFieldType:\t{0}\n\tValue:\t{1}", cf.FieldType, 
                oVal.ToString());
            break;
        case CustomFieldType.DURATION:
            Console.WriteLine("\tFieldType:\t{0}\n\tValue:\t{1}", cf.FieldType, 
                oVal.ToString());
            break;
        case CustomFieldType.FLAG:
            Console.WriteLine("\tFieldType:\t{0}\n\tValue:\t{1}", cf.FieldType, 
                oVal.ToString());
            break;
        case CustomFieldType.NUMBER:
            Console.WriteLine("\tFieldType:\t{0}\n\tValue:\t{1}", cf.FieldType, 
                oVal.ToString());
            break;
    
   ```

   <span data-ttu-id="01789-202">テキストの値のルックアップ テーブルには、ただし、追加の処理が必要です。</span><span class="sxs-lookup"><span data-stu-id="01789-202">The lookup table of TEXT values, however, requires additional processing.</span></span> <span data-ttu-id="01789-203">アプリケーションでは、サービスから適切な参照テーブルを取得し、参照テーブルを走査して、ECF のインスタンス (1 つまたは複数の値) を出力します。</span><span class="sxs-lookup"><span data-stu-id="01789-203">The application retrieves the appropriate lookup table from the service, and outputs the ECF instance (with single or multiple values) by traversing the lookup table.</span></span> <span data-ttu-id="01789-204">次のコードは、テキスト ECFs などの単純な値を持つルックアップ テーブルを使用してこれらの処理を示しています。</span><span class="sxs-lookup"><span data-stu-id="01789-204">The following code fragment shows processing of TEXT ECFs, including those with simple values and those using lookup tables:</span></span> 
    
   ```cs
    case CustomFieldType.TEXT:
        if (!cf.LookupTable.ServerObjectIsNull.HasValue ||
            (cf.LookupTable.ServerObjectIsNull.HasValue && 
            cf.LookupTable.ServerObjectIsNull.Value))
        { //No lookup table
            Console.WriteLine("\tFieldType:\t{0}\n\tText:\t{1}", cf.FieldType, 
                oVal.ToString());
        }
        else
        { //Lookup table
            Console.WriteLine("\tFieldType:\t{0} - using Lookup Table", cf.FieldType);
            String[] entries = (String[])oVal;
            foreach (String entry in entries)
            {
                var luEntry = projContext.LoadQuery(cf.LookupTable.Entries
                    .Where(e => e.InternalName == entry));
                projContext.ExecuteQuery();
                Console.WriteLine("\tLookup Value:\t{0}", luEntry.First().FullValue);  
            }
        }
        break;
    
   ```

   <span data-ttu-id="01789-205">このアプリケーションだけでは値を出力します。ただし、データ値の複数の意味を取得することができます。</span><span class="sxs-lookup"><span data-stu-id="01789-205">This application simply outputs the value(s); however, it is possible to get more meaning from the data value(s).</span></span>
    
## <a name="listpwacustomfields"></a><span data-ttu-id="01789-206">ListPWACustomFields</span><span class="sxs-lookup"><span data-stu-id="01789-206">ListPWACustomFields</span></span>

<span data-ttu-id="01789-207">ListPWACustomFields メソッドは、取得し、プロジェクトに関連付けられている ECFs を一覧表示します。</span><span class="sxs-lookup"><span data-stu-id="01789-207">The ListPWACustomFields method retrieves and lists the ECFs associated with projects.</span></span> <span data-ttu-id="01789-208">このメソッドは、個々 のプロジェクトに関連付けることができる PWA のインスタンスに登録されている ECFs を一覧表示します。</span><span class="sxs-lookup"><span data-stu-id="01789-208">This method lists the ECFs registered on the PWA instance that can be associated with individual projects.</span></span> <span data-ttu-id="01789-209">ECFs にアクセスするためのエントリ ポイントでは、クエリ要求を次のように、プロジェクトのコンテキストの要素名を使用します。</span><span class="sxs-lookup"><span data-stu-id="01789-209">The entry point for accessing the ECFs uses the CustomFields element of the project context, as in the following query request:</span></span>
  
```cs
// Project ECFs
    var allECFields = 
            projContext.LoadQuery(projContext.CustomFields.Include(
            qp => qp.InternalName,
            qp => qp.Name
        ));
    projContext.ExecuteQuery();

```

<span data-ttu-id="01789-210">メソッドは、プロジェクトが特定の ECF を使用するかどうかを確認するのにはチェックされません。</span><span class="sxs-lookup"><span data-stu-id="01789-210">The method does not check to see whether a project uses a specific ECF.</span></span>
  
## <a name="see-also"></a><span data-ttu-id="01789-211">関連項目</span><span class="sxs-lookup"><span data-stu-id="01789-211">See also</span></span>

- [<span data-ttu-id="01789-212">プロジェクト開発のポータル</span><span class="sxs-lookup"><span data-stu-id="01789-212">Project Development Portal</span></span>](http://dev.office.com/project.aspx)
- [<span data-ttu-id="01789-213">概要: エンタープライズ ユーザー設定フィールドと参照テーブル</span><span class="sxs-lookup"><span data-stu-id="01789-213">Overview: Enterprise custom fields and lookup tables</span></span>](https://support.office.com/en-us/article/overview-enterprise-custom-fields-and-lookup-tables-f99db553-0b33-4648-93c0-f6a74637d790?ui=en-us&rs=en-us&ad=us)
- <span data-ttu-id="01789-214">[ローカルとエンタープライズ ユーザー設定フィールド](https://msdn.microsoft.com/ja-jp/library/office/ms447495(v=office.14).aspx)</span><span class="sxs-lookup"><span data-stu-id="01789-214">[Local and Enterprise Custom Fields](https://msdn.microsoft.com/ja-jp/library/office/ms447495(v=office.14).aspx)</span></span>
- [<span data-ttu-id="01789-215">Project Server 2013 でのエンタープライズ ユーザー設定フィールドを追加または更新</span><span class="sxs-lookup"><span data-stu-id="01789-215">Add or edit enterprise custom fields in Project Server 2013</span></span>](https://docs.microsoft.com/en-us/project/add-or-edit-enterprise-custom-fields-in-project-server)
    

