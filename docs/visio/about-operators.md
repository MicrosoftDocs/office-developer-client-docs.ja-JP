---
title: 演算子について
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
ms.topic: overview
f1_keywords:
- Vis_DSS.chm82251824
localization_priority: Normal
ms.assetid: 43128ea2-c0d9-c45f-31e6-768a80ae59b2
description: 数式で演算子を使用すると、算術演算 (加算、減算、乗算など) や論理的な比較 (より大きい、より小さい、等しいなど) を実行できます。また式をかっこで囲むことで、数式内の評価の順序を制御できます。文字列を結合 (連結) するには、アンパサンド演算子を使用します。
ms.openlocfilehash: 3a14993ab317d19d0e4a8983e4714f587c235d57
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 06/11/2018
ms.locfileid: "19804739"
---
# <a name="about-operators"></a>演算子について

数式で演算子を使用すると、算術演算 (加算、減算、乗算など) や論理的な比較 (より大きい、より小さい、等しいなど) を実行できます。また式をかっこで囲むことで、数式内の評価の順序を制御できます。文字列を結合 (連結) するには、アンパサンド演算子を使用します。
  
Microsoft Visio では、演算や関数で特定の種類のデータが必要な場合、自動的にデータの種類が変換されます。たとえば、乗算演算子は数値の引数を必要とし、アンパサンド (文字列連結) 演算子は文字列の引数を必要とします。引数を必要なデータの種類に変換できない場合、既定値が使用されます。この既定値とは、それぞれのデータの種類で "なし" に相当する値を示します。たとえば、数値ではゼロ、ブール値では FALSE、文字列では "" になります。
  
次の表は、式とその結果の例です。
  
|**Expression**|**結果**|**説明**|
|:-----|:-----|:-----|
| 2 \* 5 &amp; 「円」  <br/> | "10 cents"  <br/> | &amp;演算子 (文字列連結) する必要があります文字列の引数をそのため 2 の数値の結果\*5 は、文字列「10」に自動的に変換します。  <br/> |
| 5 \* 2  <br/> | 10  <br/> | \*演算子 (乗算) では、文字列「2」は自動的に相当する数値 2 に変換するため数値の引数が必要です。  <br/> |
| 5 \* 「羊」  <br/> | 0  <br/> | \*演算子 (乗算) には、数値の引数が必要ですのでに相当する数値として 0 が使用されるため、文字列"sheep"は数値に変換することはできません、です。  <br/> |
   
## <a name="arithmetic-operators"></a>算術演算子

算術演算では、数値に対して計算を行います。プラス (+) およびマイナス (-) 演算子は、数値の符号を設定する単項演算子として単独で使用できます。パーセント (%) 演算子も単項演算子で、数値を割合として識別します。
  
|**演算子**|**アクション**|**例**|**結果**|
|:-----|:-----|:-----|:-----|
| +  <br/> | 単項の正  <br/> | +37  <br/> | 37  <br/> |
| -  <br/> | 単項の負  <br/> | -37  <br/> | -37  <br/> |
| %  <br/> | 単項の割合  <br/> | 37%  <br/> | .37  <br/> |
| ^  <br/> | 累乗  <br/> | 5 ^ 2  <br/> | 25  <br/> |
| \*  <br/> | 乗算  <br/> | 5 \* 2  <br/> | 10  <br/> |
| /  <br/> | 除算  <br/> | 5/2  <br/> | 2.5  <br/> |
| +  <br/> | 加算  <br/> | 5 + 2  <br/> | 7  <br/> |
| -  <br/> | 減算  <br/> | 5-2  <br/> | 3  <br/> |
   
## <a name="comparison-operators"></a>比較演算子

比較演算子は、論理式の作成に使用されます。論理式は TRUE または FALSE で評価されます。
  
|**演算子**|**代替手段**|**アクション**|**例**|**結果**|
|:-----|:-----|:-----|:-----|:-----|
| \>  <br/> | _GT_  <br/> | より大きい  <br/> | 5 \> 2  <br/> | TRUE  <br/> |
| \<  <br/> | _LT_  <br/> | より少ない  <br/> | 5 \< 2  <br/> | FALSE  <br/> |
| \>=  <br/> | _GE_  <br/> | 以上  <br/> | 5 \>= 2  <br/> | TRUE  <br/> |
| \<=  <br/> | _LE_  <br/> | 以下  <br/> | 5 \<= 2  <br/> | FALSE  <br/> |
| =  <br/> | _EQ_  <br/> | 等しい  <br/> | 5 = 2  <br/> | FALSE  <br/> |
| \<\>  <br/> | _NE_  <br/> | 等しくない  <br/> | 5 \< \> 2  <br/> | TRUE  <br/> |
   
シンボルの比較演算子 (\>、\<など) は、ほとんどの比較に最適です。 代替演算子 (_GT_、_薄い_など) では、15 桁の有効桁数の値を内部的に格納するのには Visio を使用する厳密な比較を実行します。
  
四捨五入された値や計算された値を代替演算子を使用して比較する場合、本来なら式が TRUE に評価される場合に FALSE が返されることがあります。
  
比較演算子を使用して文字列を比較する場合、文字列は最初に数値に変換されます。文字列が変換できない場合は値 0 が返されます。このため比較が安定せず、予期した結果が得られないことがあります。標準的な文字列比較を行うには、STRSAME または STRSAMEEX 関数を使用します。
  
## <a name="order-of-evaluation"></a>評価の順序

数式に複数の式が含まれている場合、実行される演算子に応じた順序で、式が評価されます。次の表は、Visio での演算子の優先順位です。
  
|**Order**|**アクション**|**演算子**|
|:-----|:-----|:-----|
|第 1  <br/> |正  <br/> |+ (単項)  <br/> |
||負  <br/> |- (単項)  <br/> |
||Percent/パーセント  <br/> |% (単項)  <br/> |
|第 2  <br/> |累乗  <br/> |^  <br/> |
|第 3  <br/> |乗算  <br/> |\*  <br/> |
||部署  <br/> |/  <br/> |
|第 4  <br/> |加算  <br/> |+  <br/> |
||減算  <br/> |-  <br/> |
|5 番目  <br/> |文字列の連結  <br/> |&amp;  <br/> |
|6 番目  <br/> |不等号 (より大きい)  <br/> |\>または GT  <br/> |
||以上  <br/> |\>= または GE  <br/> |
||より少ない  <br/> |\<または LT  <br/> |
||以下  <br/> |\<= または LE  <br/> |
|7 番目  <br/> |等しい  <br/> |= または EQ  <br/> |
||等しくない  <br/> |\<\>または NE  <br/> |
   
式をかっこで囲んで優先順位を変更できます。最初にかっこ内の式が左から右の順に評価されます。たとえば、次のようになります。
  
4 + 5 \* 6 = 4 + 30 = 34
  
(4 + 5)\* 6 = 9 \* 6 = 54
  
かっこ内の式がネストされている場合、最も内側のかっこ内にある式が最初に評価されます。
  
## <a name="ampersand-operator"></a>アンパサンド演算子

アンパサンド演算子は新しい文字列を返します。アンパサンド演算子を使用して、複合された単語や句を作成できます。次の構文を使用します。
  
"string1" &amp; 「文字列 2」
  
 **例**
  
"dog" &amp; 「ハウス」が"doghouse"を返します。
  

