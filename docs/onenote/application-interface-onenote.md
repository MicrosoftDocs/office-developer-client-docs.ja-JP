---
title: Application インターフェイス (OneNote)
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
ms.topic: overview
ms.assetid: 87926f7d-e1dc-41d5-8805-6ba91fc7b154
description: Application インターフェイスには、OneNote の情報とコンテンツの取得、操作、および更新に役立つメソッドが含まれています。 こうしたメソッドは、次の 4 つの一般的なカテゴリに分けられます。
localization_priority: Priority
ms.openlocfilehash: 295db4fcb64541ccf461fbd8d48dc19b89e6b1f8
ms.sourcegitcommit: e7b38e37a9d79becfd679e10420a19890165606d
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 05/29/2019
ms.locfileid: "34537823"
---
# <a name="application-interface-onenote"></a><span data-ttu-id="eb2c9-104">Application インターフェイス (OneNote)</span><span class="sxs-lookup"><span data-stu-id="eb2c9-104">Application interface (OneNote)</span></span>

<span data-ttu-id="eb2c9-105">**Application** インターフェイスには、OneNote の情報とコンテンツの取得、操作、および更新に役立つメソッドが含まれています。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-105">The **Application** interface includes methods help retrieve, manipulate, and update OneNote information and content.</span></span> <span data-ttu-id="eb2c9-106">こうしたメソッドは、次の 4 つの一般的なカテゴリに分けられます。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-106">The methods are in four general categories:</span></span> 
  
- <span data-ttu-id="eb2c9-107">**ノートブック構造** &ndash; ノートブックの構造を操作するためのメソッド。ノートブック、セクション グループ、およびセクションの探索、オープン、変更、クローズ、および削除に対応するメソッドが含まれます。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-107">**Notebook structure** &ndash; Methods for working with notebook structure, including those for discovering, opening, modifying, closing, and deleting notebooks, section groups, and sections.</span></span> 
    
- <span data-ttu-id="eb2c9-108">**ページ コンテンツ** &ndash; ページおよびページ コンテンツを操作するためのメソッド。ページ コンテンツの探索、変更、保存、および削除に対応するメソッドが含まれます。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-108">**Page content** &ndash; Methods for working with pages and page content, including those for discovering, modifying, saving, and deleting page content.</span></span> <span data-ttu-id="eb2c9-109">ページ コンテンツには、バイナリ オブジェクト (インクやイメージなど)、およびテキスト オブジェクト (アウトラインなど) が含まれます。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-109">Page content includes binary objects, such as ink and images, and text objects, such as outlines.</span></span> 
    
- <span data-ttu-id="eb2c9-110">**ナビゲーション** &ndash; ページおよびオブジェクトの検索、リンク、およびナビゲーションのためのメソッド。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-110">**Navigation** &ndash; Methods for finding, linking to, and navigating to pages and objects.</span></span> 
    
- <span data-ttu-id="eb2c9-111">**機能性** &ndash; その他すべてのメソッド。OneNote の特定のアクションを実行したり、パラメーターを設定したりするメソッドです。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-111">**Functional** &ndash; All other methods that perform certain actions or set parameters in OneNote.</span></span> 
    
<span data-ttu-id="eb2c9-112">さらに、**Application** インターフェイスには、いくつかの*プロパティ*と*イベント*が含まれています。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-112">In addition, the **Application** interface includes a number of  *properties*  and  *events*  .</span></span> 
  
## <a name="notebook-structure-methods"></a><span data-ttu-id="eb2c9-113">ノートブック構造のメソッド</span><span class="sxs-lookup"><span data-stu-id="eb2c9-113">Notebook Structure methods</span></span>
<span data-ttu-id="eb2c9-114"><a name="ON14DevRef_Application_NotebookStructure"> </a></span><span class="sxs-lookup"><span data-stu-id="eb2c9-114"><a name="ON14DevRef_Application_NotebookStructure"> </a></span></span>

<span data-ttu-id="eb2c9-115">このセクションで説明するメソッドを使用すると、OneNote のノートブック、セクション グループ、およびセクションを探索、オープン、変更、クローズ、および削除できます。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-115">The methods described in this section enable you to discover, open, modify, close, and delete OneNote notebooks, section groups, and sections.</span></span>
  
### <a name="gethierarchy-method"></a><span data-ttu-id="eb2c9-116">GetHierarchy メソッド</span><span class="sxs-lookup"><span data-stu-id="eb2c9-116">GetHierarchy method</span></span>

|||
|:-----|:-----|
|<span data-ttu-id="eb2c9-117">**説明**</span><span class="sxs-lookup"><span data-stu-id="eb2c9-117">**Description**</span></span> <br/> |<span data-ttu-id="eb2c9-118">ノートブックのノード階層構造を取得します。指定したノード (すべてのノートブックまたは単一のノートブック、セクション グループ、またはセクション) から指定したレベルまでのすべての子孫を取得します。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-118">Gets the notebook node hierarchy structure, starting from the node you specify (all notebooks or a single notebook, section group, or section), and extending downward to all descendants at the level you specify.</span></span>  <br/> |
|<span data-ttu-id="eb2c9-119">**構文**</span><span class="sxs-lookup"><span data-stu-id="eb2c9-119">**Syntax**</span></span> <br/> | `HRESULT GetHierarchy(`<br/>`[in]BSTR bstrStartNodeID,`<br/>`[in]HierarchyScope hsScope,`<br/>`[out]BSTR * pbstrHierarchyXmlOut,`<br/>`[in,defaultvalue(xs2013)]XMLSchema xsSchema);` <br/> |
|<span data-ttu-id="eb2c9-120">**パラメーター**</span><span class="sxs-lookup"><span data-stu-id="eb2c9-120">**Parameters**</span></span> <br/> | <span data-ttu-id="eb2c9-121">_bstrStartNodeID_ &ndash; 取得対象の子孫を持つノード (ノートブック、セクション グループ、またはセクション)。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-121">_bstrStartNodeID_ &ndash; The node (notebook, section group, or section) whose descendants you want.</span></span> <span data-ttu-id="eb2c9-122">Null 文字列 ("") を渡すと、このメソッドではルート ノード以下のすべてのノード (すべてのノートブック、セクション グループ、およびセクション) が取得されます。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-122">If you pass a null string (""), the method gets all nodes below the root node (that is, all notebooks, section groups, and sections).</span></span> <span data-ttu-id="eb2c9-123">ノートブック、セクション グループ、またはセクションのノードを指定すると、そのノードの子孫のみが取得されます。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-123">If you specify a notebook, section group, or section node, the method gets only descendants of that node.</span></span>  <br/><br/><span data-ttu-id="eb2c9-124">_hsScope_ &ndash; 取得対象の最下位の子孫ノードのレベル。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-124">_hsScope_ &ndash; The lowest descendant node level you want.</span></span> <span data-ttu-id="eb2c9-125">たとえば、ページを指定すると、このメソッドではページ レベルまでのすべてのノードが取得されます。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-125">For example, if you specify pages, the method gets all nodes as far down as the page level.</span></span> <span data-ttu-id="eb2c9-126">セクションを指定すると、ノートブックの下位にあるセクション ノードのみが取得されます。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-126">If you specify sections, the method gets only section nodes below the notebook.</span></span> <span data-ttu-id="eb2c9-127">詳細については、「[列挙型](enumerations-onenote-developer-reference.md#odc_HierarchyScope)」トピックの **HierarchyScope** 列挙型を参照してください。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-127">For more information, see the **HierarchyScope** enumeration in the [Enumerations](enumerations-onenote-developer-reference.md#odc_HierarchyScope) topic.</span></span>  <br/><br/><span data-ttu-id="eb2c9-128">_pbstrHierarchyXmlOut_ &ndash; (出力パラメーター) 文字列へのポインター。OneNote は、その文字列に XML 出力を書き込みます。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-128">_pbstrHierarchyXmlOut_ &ndash; (Output parameter) A pointer to the string in which you want OneNote to write the XML output.</span></span>  <br/><br/><span data-ttu-id="eb2c9-129">_xsSchema_ &ndash; (省略可能) 出力する OneNote XML スキーマのバージョン (**XMLSchema** 型)。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-129">_xsSchema_ &ndash; (Optional) The version of the OneNote XML schema, of type **XMLSchema**, that you want to be output.</span></span> <span data-ttu-id="eb2c9-130">XML スキーマのバージョンは、2013、2010、2007、または現行のバージョンを指定できます。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-130">You can specify whether you want XML Schema version 2013, 2010, 2007, or the current version.</span></span>  <br/><br/><span data-ttu-id="eb2c9-131">**注**: OneNote の将来のバージョンでもアドインが動作するように、**xsCurrent** を使用したり、空白のままにしたりするのではなく、OneNote のバージョン (**xs2013**) を指定するようにしてください。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-131">**NOTE**:  We recommend specifying a version of OneNote (such as **xs2013**) instead of using **xsCurrent** or leaving it blank, because this will allow your add-in to work with future versions of OneNote.</span></span>           |
   
<span data-ttu-id="eb2c9-132">GetHierarchy メソッドは、既定で OneNote 2013 XML 形式の文字列を返します。また、省略可能な _xsSchema_ パラメーターを使用すると、適切な XML スキーマのバージョンを設定できます。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-132">The GetHierarchy method returns a string in OneNote 2013 XML format by default or you can set the preferred XML schema version by using the optional  _xsSchema_ parameter.</span></span> 
  
<span data-ttu-id="eb2c9-133">どのパラメーターを渡すかによって、**GetHierarchy** メソッドは異なるリストを返すようになります (たとえば、すべてのノートブック、すべてのノートブックに含まれるすべてのセクション、特定のセクション内のすべてのページ、特定のノートブック内のすべてのページなど)。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-133">Depending on the parameters you pass, the **GetHierarchy** method can return various lists (for example all notebooks, all sections in all notebooks, all pages within a given section, or all pages within a given notebook).</span></span> <span data-ttu-id="eb2c9-134">それぞれのノードごとに、プロパティ (セクションやページのタイトル、ID、最終更新時刻など) の情報を示す XML 文字列が返されます。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-134">For each node, the XML string returned provides properties (for example, the section or page title, ID, and last-modified time).</span></span> 
  
<span data-ttu-id="eb2c9-135">開始ノードと範囲の組み合わせには有効でないものがあります。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-135">Not all combinations of start node and scope are valid.</span></span> <span data-ttu-id="eb2c9-136">たとえば、セクションの開始ノードとノートブックの範囲を指定すると、ノード階層でのノートブックはセクションよりも上位になるため、**GetHierarchy** は Null の結果を返します。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-136">For example, if you specify a section start node and a notebook scope, **GetHierarchy** returns a null result because a notebook is higher in the node hierarchy than a section.</span></span> 
  
<span data-ttu-id="eb2c9-137">次の C# の例は、**GetHierarchy** メソッドを使用して、すべてのノートブックを含む OneNote 階層全体をページ レベルまで取得する方法を示しています。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-137">The following C# example shows how to use the **GetHierarchy** method to get the entire OneNote hierarchy, including all notebooks, down to the page level.</span></span> <span data-ttu-id="eb2c9-138">出力文字列はクリップボードにコピーされるため、その文字列はテキスト エディターに貼り付けて確認してください。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-138">It copies the output string to the Clipboard, from which you can paste the string into a text editor for review.</span></span> 
  
```cs
static void GetEntireHierarchy()
    {
        String strXML;
        OneNote.Application onApplication = new OneNote.Application();
        onApplication.GetHierarchy(null, 
            OneNote.HierarchyScope.hsPages, out strXML);
        Clipboard.SetText(strXML);
        MessageBox.Show("The XML has been copied to the clipboard");
    }

```

### <a name="updatehierarchy-method"></a><span data-ttu-id="eb2c9-139">UpdateHierarchy メソッド</span><span class="sxs-lookup"><span data-stu-id="eb2c9-139">UpdateHierarchy method</span></span>

|||
|:-----|:-----|
|<span data-ttu-id="eb2c9-140">**説明**</span><span class="sxs-lookup"><span data-stu-id="eb2c9-140">**Description**</span></span>|<span data-ttu-id="eb2c9-141">ノートブックの階層を変更または更新します。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-141">Modifies or updates the hierarchy of notebooks.</span></span> <span data-ttu-id="eb2c9-142">たとえば、ノートブックへのセクションまたはセクション グループの追加、新しいノートブックの追加、ノートブック内でのセクションの移動、セクション名の変更、セクションへのページの追加、セクション内でのページ順序の変更などが可能です。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-142">For example, you can add sections or section groups to a notebook, add a new notebook, move sections within a notebook, change the name of a section, add pages to a section, or change the order of pages within sections.</span></span>|
|<span data-ttu-id="eb2c9-143">**構文**</span><span class="sxs-lookup"><span data-stu-id="eb2c9-143">**Syntax**</span></span>| `HRESULT UpdateHierarchy(`<br/>`[in]BSTR bstrChangesXmlIn,`<br/>`[in,defaultvalue(xsCurrent)] XMLSchema xsSchema);`|
|<span data-ttu-id="eb2c9-144">**パラメーター**</span><span class="sxs-lookup"><span data-stu-id="eb2c9-144">**Parameters**</span></span>| <span data-ttu-id="eb2c9-145">_bstrChangesXmlIn_ &ndash; 階層への変更を指定する OneNote XML コードが含まれている文字列。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-145">_bstrChangesXmlIn_ &ndash; A string that contains OneNote XML code that specifies the hierarchy changes to make.</span></span> <span data-ttu-id="eb2c9-146">たとえば、新しいセクションを挿入する場合は、この XML 文字列に **Section** 要素を追加して、新しいセクションの追加位置を指定します。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-146">For example, if you want to insert a new section, you can add a **Section** element in the XML string to indicate where you want the new section to be added.</span></span> <span data-ttu-id="eb2c9-147">また、既存のセクションの名前を変更する場合は、XML コード内でセクション ID を変更せずに、そのセクションの **name** 属性を変更します。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-147">Alternatively, if you want to change the name of an existing section, you can keep the same section ID and change its **name** attribute in the XML code.</span></span><br/><br/><span data-ttu-id="eb2c9-148">_xsSchema_ &ndash; (省略可能) 文字列 _bstrChangesXmln_ の OneNote スキーマ バージョン。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-148">_xsSchema_ &ndash; (Optional) The OneNote schema version of the string  _bstrChangesXmln_.</span></span> <span data-ttu-id="eb2c9-149">この省略可能な値は、_bstrChangesXmlIn_ 文字列の OneNote XML スキーマ バージョンを指定するために使用します。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-149">This optional value is used to specify the version of the OneNote XML schema that the  _bstrChangesXmlIn_ string is in.</span></span> <span data-ttu-id="eb2c9-150">この値が指定されてないと、OneNote は XML のスキーマ バージョンが _xsCurrent_ であると仮定します。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-150">If this value is not specified, OneNote will assume that the XML is in schema version  _xsCurrent_.</span></span> <br/><br/><span data-ttu-id="eb2c9-151">**注**: OneNote の将来のバージョンでもアドインが動作するように、**xsCurrent** を使用したり、空白のままにしたりするのではなく、OneNote のバージョン (**xs2013**) を指定するようにしてください。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-151">**NOTE**:  We recommend specifying a version of OneNote (such as **xs2013**) instead of using **xsCurrent** or leaving it blank, because this will allow your add-in to work with future versions of OneNote.</span></span>           |
   
<span data-ttu-id="eb2c9-152">_bstrChangesXmlIn_ パラメーターに部分的な OneNote XML 文字列のみを渡すと、OneNote によって変更部分の推測が試行されます。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-152">If you pass only a partial OneNote XML string for the  _bstrChangesXmlIn_ parameter, OneNote attempts to infer the changes you want.</span></span> <span data-ttu-id="eb2c9-153">たとえば、1 つのセクションのみを含む **Notebook** 要素を含めると、OneNote は、そのセクションを既存のセクションの最後に追加します。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-153">For example, if you include a **Notebook** element that contains only one section, OneNote adds the section after any existing sections.</span></span> <span data-ttu-id="eb2c9-154">ただし、あいまいな操作の指定については、その結果を判断することが困難になります。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-154">However, if the operation you specify is ambiguous, the result can be hard to determine.</span></span> <span data-ttu-id="eb2c9-155">たとえば、既存のノートブックに 4 つのセクションが含まれているときに、そのノートブックと 4 番目のセクションおよび 1 番目のセクションのみが (この順序で) 含まれている XML 文字列を渡すと、OneNote は 2 番目と 3 番目のセクションを 4 番目のセクションの前に配置することも、1 番目のセクションの後に配置することもあります。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-155">For example, if an existing notebook contains four sections, and the XML string you pass includes the notebook and only the fourth and first sections (in that order), OneNote might place the second and third sections before the fourth section or after the first section.</span></span> 
  
<span data-ttu-id="eb2c9-156">**UpdateHierarchy** メソッドを使用して、ノートブックの一部を削除することはできません。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-156">You cannot use the **UpdateHierarchy** method to delete part of a notebook.</span></span> <span data-ttu-id="eb2c9-157">つまり、既存の階層の一部のみを含む XML 文字列を渡しても、その文字列に含まれていないセクションは削除されません。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-157">That is, passing an XML string that includes only part of an existing hierarchy does not delete sections that are not included in the string.</span></span> <span data-ttu-id="eb2c9-158">階層の一部を削除する場合は、**DeleteHierarchy** メソッドを使用してください。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-158">To delete part of a hierarchy, use the **DeleteHierarchy** method.</span></span> 
  
<span data-ttu-id="eb2c9-159">次の C# コードは、**UpdateHierarchy** メソッドを使用して OneNote 階層を変更する方法の一例を示しています。このコードでは、既存のセクションの名前を変更します。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-159">The following C# code shows one way to use the **UpdateHierarchy** method to change the OneNote hierarchy, by changing the name of an existing section.</span></span> <span data-ttu-id="eb2c9-160">ここでは、ドライブ C のルートにある ChangeSectionName.xml というサンプル ファイルから XML コードを読み取って、XML ドキュメントに読み込んでから、そのドキュメントの XML 構造をメソッドに渡しています。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-160">It reads XML code from a sample file named ChangeSectionName.xml at the root of drive C, loads it into an XML document, and then passes the XML structure of that document to the method.</span></span> 
  
```cs
static void UpdateExistingHierarchy()
    {
        OneNote.Application onApplication = new OneNote.Application();
        
        // Get the XML from the file.
        XmlTextReader reader = new XmlTextReader("C:\\ChangeSectionName.xml");
        reader.WhitespaceHandling = WhitespaceHandling.None;
        XmlDocument xmlDocIn = new XmlDocument();
        xmlDocIn.Load(reader);
        
        // Update the hierarchy.
        onApplication.UpdateHierarchy(xmlDocIn.OuterXml,
        OneNote.XMLSchema.xs2007);   
    }

```

<span data-ttu-id="eb2c9-161">次の XML コードは、前述の C# コードでメソッドに渡した ChangeSectionName.xml ファイルの抜粋です。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-161">The following XML code is an excerpt of the ChangeSectionName.xml file that the previous C# code passes to the method.</span></span> <span data-ttu-id="eb2c9-162">この XML を **UpdateHierarchy** メソッドに渡すと、既存の階層に含まれるセクションの 1 つの名前が変更されます (**name** 属性の値が "My Renamed Section" に変更されます)。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-162">When the XML is passed to the **UpdateHierarchy** method, it changes the name of one of the sections in the existing hierarchy (by changing the value of the **name** attribute to "My Renamed Section").</span></span> <span data-ttu-id="eb2c9-163">その後で、名前を変更したもの以外のすべてのセクションが削除されます。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-163">It then removes all the sections except the one whose name was changed.</span></span> <span data-ttu-id="eb2c9-164">さらに、このコードではターゲットの **Section** 要素から不要な属性 (**lastModifiedTime**、**isCurrentlyViewed**、**color** などの属性) が削除され、属性の **name**、**ID**、および **path** のみがそのまま残されます。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-164">In addition, the code removes unnecessary attributes from the target **Section** element, including the **lastModifiedTime**, **isCurrentlyViewed**, and **color** attributes, leaving only the **name**, **ID**, and **path** attributes intact.</span></span> 
  
```XML
<?xml version="1.0" ?> 
    <one:Notebooks xmlns:one="http://schemas.microsoft.com/office/onenote/12/2004/onenote"> 
        <one:Notebook name="My Notebook" nickname="My Notebook" ID="{0B8E7305-AC2C-4BCB-8651-1CDA55AAE14C}{1}{B0}"> 
            <one:Section name="My Renamed Section" ID="{5F4E2908-44BA-4C02-91FE-49FC665E9A33}{1}{B0}" path="C:\My Section.one" /> 
        </one:Notebook> 
    </one:Notebooks>
```

<span data-ttu-id="eb2c9-165">前述の XML コードは、**GetHierarchy** メソッドの例で示したコードを使用して取得したものですが、範囲をセクションに限定するために、次に示す変更が加えられています。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-165">The preceding XML code was obtained by using the code shown in the example for the **GetHierarchy** method, which is modified, as follows, to limit the scope to sections.</span></span> 
  
```cs
static void GetAllSections()
    {
        String strXML;
        OneNote.Application onApplication = new OneNote.Application();
        onApplication.GetHierarchy(System.String.Empty, 
            OneNote.HierarchyScope.hsSections, out strXML);
        Clipboard.SetText(strXML.ToString());
        MessageBox.Show("The XML has been copied to the Clipboard");
    }

```

<span data-ttu-id="eb2c9-166">次の C# の例は、完全なコンソール アプリケーションを示しています。この例では、"`Sample_Section`" という名前のセクションを検索して、そのセクションの新しい名前を入力するようにユーザーに求め、**UpdateHierarchy** メソッドを使用して、セクション名をユーザーが入力した名前に変更します。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-166">The following C# example shows a complete console application that searches for a section named " `Sample_Section`", prompts the user to input a new name for the section, and then uses the **UpdateHierarchy** method to change the section name to the name that the user typed.</span></span> <span data-ttu-id="eb2c9-167">このコードの実行前に、OneNote 階層に存在するセクションの名前を "`Sample_Section`" に変更しておいてください。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-167">Before running the code, change "  `Sample_Section`" to the name of a section that exists in your OneNote hierarchy.</span></span>
  
```cs
    static void Main(string[] args)
    {
        
        // OneNote 2013 Schema namespace.
        string strNamespace = "http://schemas.microsoft.com/office/onenote/2013/onenote";
        string outputXML;
        Application onApplication = new Application();
        onApplication.GetHierarchy(null, HierarchyScope.hsSections, out outputXML);
        // Load a new XmlDocument.
        XmlDocument xmlDoc = new XmlDocument();
        xmlDoc.LoadXml(outputXML);
        XmlNamespaceManager nsmgr = new XmlNamespaceManager(xmlDoc.NameTable);
            nsmgr.AddNamespace("one", strNamespace);
        // Search for the section named "Sample_Section".
        XmlNode xmlNode = xmlDoc.SelectSingleNode("//one:Section[@name='Sample_Section']", nsmgr);
        // Prompt for a new section title.
        System.Console.Write("Please enter a new title for the section: ");
        string input = System.Console.ReadLine();
        xmlNode.Attributes["name"].Value = input; 
        // Update the section with the new title.
        onApp.UpdateHierarchy(xmlNode.OuterXml);
        System.Console.Write("Done!\n");
    }

```

### <a name="openhierarchy-method"></a><span data-ttu-id="eb2c9-168">OpenHierarchy メソッド</span><span class="sxs-lookup"><span data-stu-id="eb2c9-168">OpenHierarchy method</span></span>

|||
|:-----|:-----|
|<span data-ttu-id="eb2c9-169">**説明**</span><span class="sxs-lookup"><span data-stu-id="eb2c9-169">**Description**</span></span> <br/> |<span data-ttu-id="eb2c9-170">指定したセクション グループまたはセクションを開きます。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-170">Opens a section group or section that you specify.</span></span>  <br/> |
|<span data-ttu-id="eb2c9-171">**構文**</span><span class="sxs-lookup"><span data-stu-id="eb2c9-171">**Syntax**</span></span> <br/> | `HRESULT OpenHierarchy(`<br/>`[in]BSTR bstrPath,`<br/>`[in]BSTR bstrRelativeToObjectID,`<br/>`[out]BSTR * pbstrObjectID,`<br/>`[in,defaultvalue(cftNone)]CreateFileType cftIfNotExist);` <br/> |
|<span data-ttu-id="eb2c9-172">**パラメーター**</span><span class="sxs-lookup"><span data-stu-id="eb2c9-172">**Parameters**</span></span> <br/> | <span data-ttu-id="eb2c9-173">_bstrPath_ &ndash; 開くパス。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-173">_bstrPath_ &ndash; The path that you want to open.</span></span> <span data-ttu-id="eb2c9-174">ノートブックの場合やノートブック内のセクション グループの場合、_bstrPath_ は .one セクション ファイルへのパスにすることも、フォルダー パスにすることもできます。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-174">For a notebook, or for a section group in a notebook,  _bstrPath_ can be a folder path or the path to an .one section file.</span></span> <span data-ttu-id="eb2c9-175">.one セクション ファイルへのパスを指定する場合は、ファイル パス文字列に .one 拡張子を含める必要があります。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-175">If you specify the path to an .one section file, you must include the .one extension on the file-path string.</span></span>  <br/><br/><span data-ttu-id="eb2c9-176">_bstrRelativeToObjectID_ &ndash; 新しく開くオブジェクトの親オブジェクト (ノートブックまたはセクション グループ) の OneNote ID。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-176">_bstrRelativeToObjectID_ &ndash; The OneNote ID of the parent object (notebook or section group) under which you want the new object to open.</span></span> <span data-ttu-id="eb2c9-177">_bstrPath_ パラメーターが絶対パスの場合は、空の文字列 ("") の _bstrRelativeToObjectID_ を渡すことができます。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-177">If the  _bstrPath_ parameter is an absolute path, you can pass an empty string ("") for  _bstrRelativeToObjectID_.</span></span> <span data-ttu-id="eb2c9-178">また、作成するオブジェクト (セクションまたはセクション グループ) の格納先ノートブックまたはセクション グループのオブジェクト ID を渡して、その親オブジェクトの下に作成するオブジェクトのファイル名 (section1.one など) を指定することもできます。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-178">Alternatively, you can pass the object ID of the notebook or section group that should contain the object (section or section group) that you want to create, and then specify the file name (for example, section1.one) of the object that you want to create under that parent object.</span></span>  <br/><br/><span data-ttu-id="eb2c9-179">_pbstrObjectID_ &ndash; (出力パラメーター) **OpenHierarchy** メソッドで開くノートブック、セクション グループ、またはセクションに対応する OneNote から返されるオブジェクト ID。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-179">_pbstrObjectID_ &ndash; (Output parameter) The object ID that OneNote returns for the notebook, section group, or section that the **OpenHierarchy** method opens.</span></span> <span data-ttu-id="eb2c9-180">このパラメーターは、このメソッドが ID を書き込む文字列へのポインターです。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-180">This parameter is a pointer to the string into which you want the method to write the ID.</span></span>  <br/><br/><span data-ttu-id="eb2c9-181">_cftlfNotExist_ &ndash; (省略可能) [CreateFileType](enumerations-onenote-developer-reference.md#odc_CreateFileType) 列挙型の列挙値。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-181">_cftlfNotExist_ &ndash; (Optional) An enumerated value from the [CreateFileType](enumerations-onenote-developer-reference.md#odc_CreateFileType) enumeration.</span></span> <span data-ttu-id="eb2c9-182">_cftIfNotExist_ で値を渡すと、**OpenHierarchy** メソッドは指定したパスにセクション グループまたはセクションのファイルを作成します (そのファイルが存在しない場合のみ)。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-182">If you pass a value for  _cftIfNotExist_, the **OpenHierarchy** method creates the section group or section file at the specified path only if the file does not already exist.</span></span>  <br/> |
   
<span data-ttu-id="eb2c9-183">開いているノートブックに含まれていないセクション グループを指定すると、**OpenHierarchy** メソッドはセクション グループをノートブックとして開きます。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-183">If you specify a section group that is not in an open notebook, the **OpenHierarchy** method opens the section group as a notebook.</span></span> <span data-ttu-id="eb2c9-184">開いているノートブックに含まれていないセクションを指定すると、**OpenHierarchy** メソッドは Recent Opened Sections セクション グループにセクションを開きます。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-184">If you specify a section that is not in an open notebook, the **OpenHierarchy** method opens the section in the Recent Opened Sections section group.</span></span> <span data-ttu-id="eb2c9-185">開いているノートブックに含まれているセクション グループまたはセクションを指定しても何も起こりません。そのセクション グループまたはセクションは既に開いています。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-185">If you specify a section group or section that is already in an open notebook, nothing happens because the section group or section is already open, as well.</span></span> <span data-ttu-id="eb2c9-186">どの場合も、**OpenHierarchy** は指定されたセクション グループ、ノートブック、またはセクションのオブジェクト ID を返します。その ID は別の操作で使用できます。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-186">In any case, **OpenHierarchy** returns the object ID for the section group, notebook, or section that you specify, so that you can use it in other operations.</span></span> 
  
<span data-ttu-id="eb2c9-187">また、新しいセクションを作成するために XML をインポートするのではなく、**OpenHierarchy** メソッドを使用することもできます。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-187">You can also use the **OpenHierarchy** method to create new sections, instead of doing so by importing XML.</span></span> 
  
<span data-ttu-id="eb2c9-188">次のコードは、**OpenHierarchy** メソッドを使用して、Work ノートブックの Meetings セクションを開いて、そのセクションの ID を取得する方法を示しています。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-188">The following code shows how to use the **OpenHierarchy** method to open the Meetings section in the Work notebook and get the ID for the section.</span></span> <span data-ttu-id="eb2c9-189">そのセクションが存在していない場合は、OneNote によって指定の場所にセクションが作成されます。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-189">If the section does not already exist, OneNote creates it in the location that you specify.</span></span> 
  
```cs
static void OpenSection()
    {
        String strID;
        OneNote.Application onApplication = new OneNote.Application();
        onApplication.OpenHierarchy("C:\\Documents and Settings\\user\\My Documents\\OneNote Notebooks\\Work\\Meetings.one", 
        System.String.Empty, out strID, OneNote.CreateFileType.cftSection);
    }

```

### <a name="deletehierarchy-method"></a><span data-ttu-id="eb2c9-190">DeleteHierarchy メソッド</span><span class="sxs-lookup"><span data-stu-id="eb2c9-190">DeleteHierarchy method</span></span>

|||
|:-----|:-----|
|<span data-ttu-id="eb2c9-191">**説明**</span><span class="sxs-lookup"><span data-stu-id="eb2c9-191">**Description**</span></span> <br/> |<span data-ttu-id="eb2c9-192">OneNote ノートブック階層から階層オブジェクト (セクション グループ、セクション、またはページ) を削除します。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-192">Deletes any hierarchy object (a section group, section, or page) from the OneNote notebook hierarchy.</span></span>  <br/> |
|<span data-ttu-id="eb2c9-193">**構文**</span><span class="sxs-lookup"><span data-stu-id="eb2c9-193">**Syntax**</span></span> <br/> | `HRESULT DeleteHierarchy(`<br/>`[in]BSTR bstrObjectID,`<br/>`[in,defaultvalue(0)]DATE dateExpectedLastModified,`<br/>`[in,defaultvalue(false)]VARIANT_BOOL deletePermanently);` <br/> |
|<span data-ttu-id="eb2c9-194">**パラメーター**</span><span class="sxs-lookup"><span data-stu-id="eb2c9-194">**Parameters**</span></span> <br/> | <span data-ttu-id="eb2c9-195">_bstrObjectID_ &ndash; 削除するオブジェクトの OneNote ID。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-195">_bstrObjectID_ &ndash; The OneNote ID of the object you want to delete.</span></span> <span data-ttu-id="eb2c9-196">このオブジェクトは、セクション グループ、セクション、またはページです。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-196">The object can be a section group, section, or page.</span></span>  <br/><br/><span data-ttu-id="eb2c9-197">_dateExpectedLastModified_ &ndash; (省略可能) 削除するオブジェクトの最終更新日時と見なす日付と時刻。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-197">_dateExpectedLastModified_ &ndash; (Optional) The date and time that you think the object you want to delete was last modified.</span></span> <span data-ttu-id="eb2c9-198">このパラメーターに 0 以外の値を渡すと、OneNote は、渡された値とオブジェクトの実際の最終更新日時が一致する場合にのみ更新操作を続行します。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-198">If you pass a non-zero value for this parameter, OneNote proceeds with the update only if the value you pass matches the actual date and time the object was last modified.</span></span> <span data-ttu-id="eb2c9-199">このパラメーターで値を渡すと、オブジェクトの最終更新時以降にユーザーが編集した内容の意図しない上書きを防止できます。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-199">Passing a value for this parameter helps prevent accidentally overwriting edits users made since the last time the object was modified.</span></span>  <br/><br/><span data-ttu-id="eb2c9-200">_deletePermanently_ &ndash; (省略可能) コンテンツを完全に削除する場合は **true**。コンテンツを対応するノートブックの OneNote ごみ箱に移動する場合は **false** (既定)。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-200">_deletePermanently_ &ndash; (Optional) **true** to permanently delete the content; **false** to move the content into the OneNote recycle bin for the corresponding Notebook (the default).</span></span> <span data-ttu-id="eb2c9-201">ノートブックが OneNote 2007 形式の場合は、ごみ箱が存在しないため、コンテンツは完全に削除されます。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-201">If the Notebook is in OneNote 2007 format, no recycle bin exists, so the content is permanently deleted.</span></span>  <br/> |
   
### <a name="createnewpage-method"></a><span data-ttu-id="eb2c9-202">CreateNewPage メソッド</span><span class="sxs-lookup"><span data-stu-id="eb2c9-202">CreateNewPage method</span></span>

|||
|:-----|:-----|
|<span data-ttu-id="eb2c9-203">**説明**</span><span class="sxs-lookup"><span data-stu-id="eb2c9-203">**Description**</span></span> <br/> |<span data-ttu-id="eb2c9-204">指定したセクションに新しいページを追加します。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-204">Adds a new page to the section you specify.</span></span> <span data-ttu-id="eb2c9-205">新しいページは、セクションの最後のページとして追加されます。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-205">The new page is added as the last page of the section</span></span>  <br/> |
|<span data-ttu-id="eb2c9-206">**構文**</span><span class="sxs-lookup"><span data-stu-id="eb2c9-206">**Syntax**</span></span> <br/> | `HRESULT CreateNewPage(`<br/>`[in]BSTR bstrSectionID,`<br/>`[out]BSTR * pbstrPageID);`<br/>`[in,defaultvalue(npsDefault)]NewPageStyle npsNewPageStyle);` <br/> |
|<span data-ttu-id="eb2c9-207">**パラメーター**</span><span class="sxs-lookup"><span data-stu-id="eb2c9-207">**Parameters**</span></span> <br/> | <span data-ttu-id="eb2c9-208">_bstrSectionID_ &ndash; 新しいページの作成先セクションの OneNote ID を格納する文字列。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-208">_bstrSectionID_ &ndash; A string that contains the OneNote ID of the section in which you want to create the new page.</span></span>  <br/><br/><span data-ttu-id="eb2c9-209">_pbstrPageID_ &ndash; (出力パラメーター) 文字列へのポインター。このメソッドは、その文字列に新しく作成したページの OneNote ID を書き込みます。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-209">_pbstrPageID_ &ndash; (Output parameter) A pointer to the string into which the method writes the OneNote ID for the newly created page.</span></span>  <br/><br/><span data-ttu-id="eb2c9-210">_npsNewPageStyle_ &ndash; **NewPageStyle** 列挙型の値。この値で、作成するページのスタイルを指定します。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-210">_npsNewPageStyle_ &ndash; A value from the **NewPageStyle** enumeration that specifies the style of the page to be created.</span></span>  <br/> |
   
<span data-ttu-id="eb2c9-211">OneNote API の **CreateNewPage** メソッドは、利便性を目的として含まれています。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-211">The OneNote API includes the **CreateNewPage** method as a convenience.</span></span> <span data-ttu-id="eb2c9-212">**UpdateHierarchy** メソッドを呼び出すことで、同じ結果が得られます。この場合は、新しいページの階層内での配置方法を細かく制御できます。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-212">You can achieve the same result, with greater control over how the new page is positioned in the hierarchy, by calling the **UpdateHierarchy** method.</span></span> <span data-ttu-id="eb2c9-213">また、**UpdateHierarchy** メソッドを使用すると、新しいページの作成と同時にサブページも作成できます。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-213">The **UpdateHierarchy** method also lets you create subpages at the same time as you create a new page.</span></span> 
  
### <a name="closenotebook-method"></a><span data-ttu-id="eb2c9-214">CloseNotebook メソッド</span><span class="sxs-lookup"><span data-stu-id="eb2c9-214">CloseNotebook method</span></span>

|||
|:-----|:-----|
|<span data-ttu-id="eb2c9-215">**説明**</span><span class="sxs-lookup"><span data-stu-id="eb2c9-215">**Description**</span></span> <br/> |<span data-ttu-id="eb2c9-216">指定したノートブックを閉じます。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-216">Closes the specified notebook.</span></span>  <br/> |
|<span data-ttu-id="eb2c9-217">**構文**</span><span class="sxs-lookup"><span data-stu-id="eb2c9-217">**Syntax**</span></span> <br/> | `HRESULT CloseNotebook(`<br/>`[in]BSTR bstrNotebookID,`<br/>`[in,defaultvalue(false)]VARIANT_BOOL force);` <br/> |
|<span data-ttu-id="eb2c9-218">**パラメーター**</span><span class="sxs-lookup"><span data-stu-id="eb2c9-218">**Parameters**</span></span> <br/> | <span data-ttu-id="eb2c9-219">_bstrNotebookID_ &ndash; 閉じるノートブックの OneNote ID。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-219">_bstrNotebookID_ &ndash; The OneNote ID of the notebook you want to close.</span></span>  <br/><br/><span data-ttu-id="eb2c9-220">_force_ &ndash; (省略可能) ノートブックを閉じる前に OneNote では同期できない変更があったとしてもノートブックを閉じる場合は **true**。それ以外の場合は **false** (既定)。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-220">_force_ &ndash; (Optional) **true** to close the notebook, even if there are changes in the notebook that OneNote cannot sync before closing; otherwise, **false** (the default).</span></span>  <br/> |
   
<span data-ttu-id="eb2c9-221">**CloseNotebook** メソッドを使用すると、指定したノートブックを閉じることができます。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-221">You can use the **CloseNotebook** method to close the notebook you specify.</span></span> <span data-ttu-id="eb2c9-222">このメソッドを呼び出すと、OneNote はオフラインのファイルを現在のノートブック コンテンツと同期します (同期が必要な場合)。その後で、指定のノートブックを閉じます。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-222">When you call this method, OneNote synchronizes any offline files with current notebook content, if necessary, and then closes the specified notebook.</span></span> <span data-ttu-id="eb2c9-223">このメソッドから復帰すると、そのノートブックは OneNote ユーザー インターフェイス (UI) の開いているノートブックのリストに表示されなくなります。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-223">After the method returns, the notebook no longer appears in the list of open notebooks in the OneNote user interface (UI).</span></span> 
  
### <a name="gethierarchyparent-method"></a><span data-ttu-id="eb2c9-224">GetHierarchyParent メソッド</span><span class="sxs-lookup"><span data-stu-id="eb2c9-224">GetHierarchyParent method</span></span>

|||
|:-----|:-----|
|<span data-ttu-id="eb2c9-225">**説明**</span><span class="sxs-lookup"><span data-stu-id="eb2c9-225">**Description**</span></span> <br/> |<span data-ttu-id="eb2c9-226">OneNote オブジェクトの親オブジェクトの OneNote ID を取得します。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-226">Gets the OneNote ID for the parent object of a OneNote object.</span></span>  <br/> |
|<span data-ttu-id="eb2c9-227">**構文**</span><span class="sxs-lookup"><span data-stu-id="eb2c9-227">**Syntax**</span></span> <br/> | `HRESULT GetHierarchyParent (`<br/>`[in]BSTR bstrObjectID,`<br/>`[out]BSTR * pbstrParentID);` <br/> |
|<span data-ttu-id="eb2c9-228">**パラメーター**</span><span class="sxs-lookup"><span data-stu-id="eb2c9-228">**Parameters**</span></span> <br/> | <span data-ttu-id="eb2c9-229">_bstrObjectID_ &ndash; オブジェクトの OneNote ID を格納する文字列。このオブジェクトの親オブジェクトを見つけます。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-229">_bstrObjectID_ &ndash; A string that contains the OneNote ID of the object of which you want to find the parent object.</span></span>  <br/><br/><span data-ttu-id="eb2c9-230">_pbstrParentID_ &ndash; (出力パラメーター) 文字列へのポインター。このメソッドは、その文字列に親オブジェクトの OneNote ID を書き込みます。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-230">_pbstrParentID_ &ndash; (Output parameter) A pointer to the string into which the method writes the OneNote ID of the parent object.</span></span>  <br/> |
   
<span data-ttu-id="eb2c9-231">親オブジェクトが存在しない OneNote オブジェクトの場合 (ユーザーがノートブックの親オブジェクトを取得しようとした場合など)、例外がスローされます。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-231">If the OneNote object has no parent object (for example, when a user wants to get the parent of a Notebook), an exception is thrown.</span></span>
  
### <a name="getspeciallocation-method"></a><span data-ttu-id="eb2c9-232">GetSpecialLocation メソッド</span><span class="sxs-lookup"><span data-stu-id="eb2c9-232">GetSpecialLocation method</span></span>

|||
|:-----|:-----|
|<span data-ttu-id="eb2c9-233">**説明**</span><span class="sxs-lookup"><span data-stu-id="eb2c9-233">**Description**</span></span> <br/> |<span data-ttu-id="eb2c9-234">OneNote の特定の特別なアイテム (バックアップ、落書きノート、既定のノートブックなど) の保存場所へのパスを見つけます。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-234">Finds the path to the location where OneNote stores certain special items, such as backups, unfiled notes, and the default notebook.</span></span>  <br/> |
|<span data-ttu-id="eb2c9-235">**構文**</span><span class="sxs-lookup"><span data-stu-id="eb2c9-235">**Syntax**</span></span> <br/> | `HRESULT GetSpecialLocation(`<br/>`[in]SpecialLocation slToGet,`<br/>`[out]BSTR * pbstrSpecialLocationPath);` <br/> |
|<span data-ttu-id="eb2c9-236">**パラメーター**</span><span class="sxs-lookup"><span data-stu-id="eb2c9-236">**Parameters**</span></span> <br/> | <span data-ttu-id="eb2c9-237">_slToGet_ &ndash; [SpecialLocation](enumerations-onenote-developer-reference.md#odc_SpecialLocation) 列挙型の値。この値で、取得する特別なフォルダーの場所を指定します。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-237">_slToGet_ &ndash; One of the [SpecialLocation](enumerations-onenote-developer-reference.md#odc_SpecialLocation) enumeration values that specifies the special folder location to get.</span></span>  <br/><br/><span data-ttu-id="eb2c9-238">_pbstrSpecialLocationPath_ &ndash; (出力パラメーター) 文字列へのポインター。OneNote は、その文字列に特別なフォルダーのパスを書き込みます。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-238">_pbstrSpecialLocationPath_ &ndash; (Output parameter) A pointer to the string into which you want OneNote to write the path of the special folder.</span></span>  <br/> |
   
<span data-ttu-id="eb2c9-239">このメソッドを使用すると、[落書きノート] フォルダーのディスク上の場所がわかります。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-239">You can use this method to determine the location on disk of the Unfiled Notes folder.</span></span> <span data-ttu-id="eb2c9-240">OneNote は、OneNote にアイテムをドラッグして作成したノートや、別のアプリケーションから取り込んだノート (Microsoft Outlook や Microsoft Internet Explorer の **[OneNote に送る]** をクリックした結果としてのノートなど) を、このフォルダーに保存します。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-240">That is the folder in which OneNote stores notes that are created when you drag an item into OneNote, as well as notes that come directly from other applications (such as those that result when you click **Send to OneNote** in Microsoft Outlook or Microsoft Internet Explorer).</span></span> 
  
## <a name="page-content-methods"></a><span data-ttu-id="eb2c9-241">ページ コンテンツのメソッド</span><span class="sxs-lookup"><span data-stu-id="eb2c9-241">Page Content methods</span></span>
<span data-ttu-id="eb2c9-242"><a name="ON14DevRef_Application_PageContent"> </a></span><span class="sxs-lookup"><span data-stu-id="eb2c9-242"><a name="ON14DevRef_Application_PageContent"> </a></span></span>

<span data-ttu-id="eb2c9-243">このセクションで説明するメソッドを使用すると、OneNote ノートブックのページにあるコンテンツを探索、更新、および削除できます。また、OneNote コンテンツを発行することもできます。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-243">The methods described in this section enable you to discover, update, and delete the content on pages in OneNote notebooks, as well as to publish OneNote content.</span></span>
  
### <a name="getpagecontent-method"></a><span data-ttu-id="eb2c9-244">GetPageContent メソッド</span><span class="sxs-lookup"><span data-stu-id="eb2c9-244">GetPageContent method</span></span>

|||
|:-----|:-----|
|<span data-ttu-id="eb2c9-245">**説明**</span><span class="sxs-lookup"><span data-stu-id="eb2c9-245">**Description**</span></span>|<span data-ttu-id="eb2c9-246">指定したページのすべてのコンテンツを取得します (OneNote XML 形式で取得)。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-246">Gets all of the content (in OneNote XML format) of the specified page.</span></span>|
|<span data-ttu-id="eb2c9-247">**構文**</span><span class="sxs-lookup"><span data-stu-id="eb2c9-247">**Syntax**</span></span>| `HRESULT GetPageContent(`<br/>`[in]BSTR bstrPageID,`<br/>`[out]BSTR * pbstrPageXmlOut,`<br/>`[in,defaultvalue(piBasic)]PageInfo pageInfoToExport,`<br/>`[in,defaultvalue(xsCurrent)]XMLSchema xsSchema);`|
|<span data-ttu-id="eb2c9-248">**パラメーター**</span><span class="sxs-lookup"><span data-stu-id="eb2c9-248">**Parameters**</span></span>| <span data-ttu-id="eb2c9-249">_bstrPageId_ &ndash; 取得するコンテンツが含まれているページの OneNote ID。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-249">_bstrPageId_ &ndash; The OneNote ID of the page whose content you want to get.</span></span><br/><br/><span data-ttu-id="eb2c9-250">_pbstrPageXmlOut_ &ndash; (出力パラメーター) 文字列へのポインター。OneNote は、その文字列に XML 出力を書き込みます。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-250">_pbstrPageXmlOut_ &ndash; (Output parameter) A pointer to the string into which you want OneNote to write the XML output.</span></span><br/><br/><span data-ttu-id="eb2c9-251">_pageInfoToExport_ &ndash; (省略可能) **GetPageContent** メソッドが、XML コードに埋め込まれた base-64 エンコードのバイナリ コンテンツを返すかどうかを指定します。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-251">_pageInfoToExport_ &ndash; (Optional) Specifies whether the **GetPageContent** method returns binary content, embedded in the XML code and base-64 encoded.</span></span> <span data-ttu-id="eb2c9-252">バイナリ コンテンツには、イメージやインクなどのデータを含めることができます。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-252">Binary content can include, for example, images and ink data.</span></span> <span data-ttu-id="eb2c9-253">また、_pageInfoToExport_ パラメーターでは、**GetPageContent** メソッドから返される XML コード内で選択部分をマーク アップするかどうかも指定します。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-253">The  _pageInfoToExport_ parameter also specifies whether to mark up the selection in the XML code that the **GetPageContent** method returns.</span></span> <span data-ttu-id="eb2c9-254">[PageInfo](enumerations-onenote-developer-reference.md#odc_PageInfo) 列挙型の列挙値を指定します。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-254">It takes an enumerated value from the [PageInfo](enumerations-onenote-developer-reference.md#odc_PageInfo) enumeration.</span></span><br/><br/><span data-ttu-id="eb2c9-255">_xsSchema_ &ndash; (省略可能) 出力する OneNote XML スキーマのバージョン (**XMLSchema** 型)。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-255">_xsSchema_ &ndash; (Optional) The version of the OneNote XML schema, of type **XMLSchema**, that you want to be output.</span></span> <span data-ttu-id="eb2c9-256">XML スキーマのバージョンは、2013、2010、2007、または現行のバージョンを指定できます。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-256">You can specify whether you want XML Schema version 2013, 2010, 2007, or the current version.</span></span> <br/><br/><span data-ttu-id="eb2c9-257">**注**: OneNote の将来のバージョンでもアドインが動作するように、**xsCurrent** を使用したり、空白のままにしたりするのではなく、OneNote のバージョン (**xs2013**) を指定するようにしてください。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-257">**NOTE**:  We recommend specifying a version of OneNote (such as **xs2013**) instead of using **xsCurrent** or leaving it blank, because this will allow your add-in to work with future versions of OneNote.</span></span>           |
   
<span data-ttu-id="eb2c9-258">既定では、過度に長い XML 文字列を返さないようにするために、OneNote は XML コードにバイナリ コンテンツを埋め込みません。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-258">By default, to avoid excess length in the XML string it returns, OneNote does not embed binary content in the XML code.</span></span> <span data-ttu-id="eb2c9-259">同じ理由から、現在の選択部分を選択属性でマーク アップすることもありません。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-259">For the same reason, it does not mark up the current selection with selection attributes.</span></span> <span data-ttu-id="eb2c9-260">バイナリ オブジェクトは、そのオブジェクトのタグに OneNote ID が含まれています。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-260">Binary objects include a OneNote ID in their tags.</span></span> <span data-ttu-id="eb2c9-261">バイナリ オブジェクトを取得するには、**GetBinaryPageContent** メソッドを呼び出して、**GetPageContent** メソッドから取得した OneNote ID を渡します。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-261">To get a binary object, you call the **GetBinaryPageContent** method and pass it the OneNote ID you get from the **GetPageContent** method.</span></span> <span data-ttu-id="eb2c9-262">**GetPageContent** メソッドは、その時点でバイナリ データが不要なときに使用します。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-262">You use the **GetPageContent** method when you do not need the binary data immediately.</span></span> 
  
### <a name="updatepagecontent-method"></a><span data-ttu-id="eb2c9-263">UpdatePageContent メソッド</span><span class="sxs-lookup"><span data-stu-id="eb2c9-263">UpdatePageContent method</span></span>

|||
|:-----|:-----|
|<span data-ttu-id="eb2c9-264">**説明**</span><span class="sxs-lookup"><span data-stu-id="eb2c9-264">**Description**</span></span>|<span data-ttu-id="eb2c9-265">ページのコンテンツを更新または変更します。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-265">Updates or modifies the content on the page.</span></span>|
|<span data-ttu-id="eb2c9-266">**構文**</span><span class="sxs-lookup"><span data-stu-id="eb2c9-266">**Syntax**</span></span>| `HRESULT UpdatePageContent(`<br/>`[in]BSTR bstrPageChangesXmlIn,`<br/>`[in,defaultvalue(0)]DATE dateExpectedLastModified,`<br/>`[in,defaultvalue(xsCurrent)]XMLSchema xsSchema,`<br/>`[in,defaultvalue(false)]VARIANT_BOOL force);`|
|<span data-ttu-id="eb2c9-267">**パラメーター**</span><span class="sxs-lookup"><span data-stu-id="eb2c9-267">**Parameters**</span></span>| <span data-ttu-id="eb2c9-268">_bstrPageChangesXmlIn_ &ndash; OneNote XML コードを格納する文字列。ページに対する変更内容は、このコードに含めます。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-268">_bstrPageChangesXmlIn_ &ndash; A string that contains OneNote XML code that includes the changes you want to make to the page.</span></span><br/><br/><span data-ttu-id="eb2c9-269">_dateExpectedLastModified_ &ndash; (省略可能) 更新するページの最終更新日時と見なす日付と時刻。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-269">_dateExpectedLastModified_ &ndash; (Optional) The date and time that you think the page you want to update was last modified.</span></span> <span data-ttu-id="eb2c9-270">このパラメーターに 0 以外の値を渡すと、OneNote は、渡された値とページの実際の最終更新日時が一致する場合にのみ更新操作を続行します。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-270">If you pass a non-zero value for this parameter, OneNote proceeds with the update only if the value you pass matches the actual date and time the page was last modified.</span></span> <span data-ttu-id="eb2c9-271">このパラメーターで値を渡すと、ページの最終更新時以降にユーザーが編集した内容の意図しない上書きを防止できます。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-271">Passing a value for this parameter helps prevent accidentally overwriting edits users made since the last time the page was modified.</span></span><br/><br/><span data-ttu-id="eb2c9-272">_xsSchema_ &ndash; (省略可能) 出力する OneNote XML スキーマのバージョン (**XMLSchema** 型)。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-272">_xsSchema_ &ndash; (Optional) The version of the OneNote XML schema, of type **XMLSchema**, that you want to be output.</span></span> <span data-ttu-id="eb2c9-273">XML スキーマのバージョンは、2013、2010、2007、または現行バージョンを指定できます。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-273">You can specify whether you want XML schema version 2013, 2010, 2007, or the current version.</span></span> <br/><br/><span data-ttu-id="eb2c9-274">**注**: OneNote の将来のバージョンでもアドインが動作するように、**xsCurrent** を使用したり、空白のままにしたりするのではなく、OneNote のバージョン (**xs2013**) を指定するようにしてください。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-274">**NOTE**:  We recommend specifying a version of OneNote (such as **xs2013**) instead of using **xsCurrent** or leaving it blank, because this will allow your add-in to work with future versions of OneNote.</span></span><br/><br/><span data-ttu-id="eb2c9-275">_force_ - (省略可能) OneNote の将来のバージョンからページに不明なデータが存在していてもページ コンテンツを更新する場合は **true**。それ以外の場合は **false** (既定)。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-275">_force_(Optional) **true** to update the page content, even if there is unknown data on the page from a future version of OneNote; otherwise, **false** (the default).</span></span> |
   
<span data-ttu-id="eb2c9-276">このメソッドを使用すると、さまざまな方法でページを変更できます。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-276">You can use this method to modify the page in various ways.</span></span> <span data-ttu-id="eb2c9-277">たとえば、**UpdatePageContent** メソッドは、ページへのアウトアインの追加、アウトラインのコンテンツの変更、イメージの追加、インクの追加、コンテンツの移動、アウトラインのテキストの変更などに使用できます。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-277">For example, you can use the **UpdatePageContent** method to add an outline to a page, change the content of an outline, add images, add ink, move content, or modify text in outlines.</span></span> 
  
<span data-ttu-id="eb2c9-278">具体的な例としては、**GetPageContent** メソッドを使用して既存のページをエクスポートし、ページの XML コードに変更を加えてから、**UpdatePageContent** メソッドを使用してページ全体を再度インポートします。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-278">As a more specific example, you might use the **GetPageContent** method to export an existing page, make some changes to the XML code for the page, and then use the **UpdatePageContent** method to import the entire page again.</span></span> <span data-ttu-id="eb2c9-279">また、このメソッドを使用して、新しいページ オブジェクト (イメージなど) を既存のページの下部に追加することもできます。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-279">Or, you might use this method to add new page objects, such as images, to the bottom of an existing page.</span></span> 
  
<span data-ttu-id="eb2c9-280">**UpdatePageContent** メソッドに渡す XML コードには、変更したページ レベルのオブジェクト (アウトライン、ページ上のイメージ、ページ上のインクなど) のみを含める必要があります。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-280">The only objects that you must include in the XML code that you pass to the **UpdatePageContent** method are page-level objects (such as outlines, images on the page, or ink on the page) that have changed.</span></span> <span data-ttu-id="eb2c9-281">このメソッドは、_bstrPageChangesXmlIn_ パラメーターで指定していないページ レベルのオブジェクトを変更または削除することはありません。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-281">This method does not modify or remove page-level objects that you do not specify in the  _bstrPageChangesXmlIn_ parameter.</span></span> <span data-ttu-id="eb2c9-282">このメソッドは、渡されたオブジェクトの ID と一致する ID を持つページ レベルのオブジェクト (アウトラインなど) を完全に置き換えます。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-282">The method entirely replaces page-level objects, such as outlines, whose IDs match those of the objects you pass.</span></span> <span data-ttu-id="eb2c9-283">そのため、コードでは、既存のコンテンツとそのコンテンツに加える変更内容を含めて、すべてのページ レベルのオブジェクトを完全に指定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-283">Consequently, you must fully specify all page-level objects in your code, including their existing content and changes you want to make to them.</span></span> 
  
<span data-ttu-id="eb2c9-284">たとえば、ページにアウトラインと背景ページ イメージが含まれている場合は、XML コードで既存のアウトラインの ID を使用してアウトラインを完全に指定して、そのコードにイメージを含めないようにすることで、イメージを変更することなく、アウトラインを置き換えることができます。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-284">For example, if your page contains an outline and a background page image, you can replace the outline and leave the image unchanged by completely specifying the outline in the XML code, using the ID of the existing outline, and not including the image in the code.</span></span> <span data-ttu-id="eb2c9-285">既存のアウトラインはコードに含まれる改訂したアウトラインで完全に置き換えられるため、そのアウトラインのすべてのコンテンツを含める必要があります。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-285">Because the revised outline you include in the code completely replaces the existing outline, you must include the entire contents of the outline.</span></span>
  
<span data-ttu-id="eb2c9-286">さらに、**UpdatePageContent** メソッドは、_bstrPageChangesXmlIn_ パラメーターで指定した要素のプロパティのみを変更します。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-286">Also, the **UpdatePageContent** method modifies only element properties that you specify in the  _bstrPageChangesXmlIn_ parameter.</span></span> <span data-ttu-id="eb2c9-287">たとえば、**PageSettings** 要素のすべてのプロパティではなく、一部のプロパティを指定すると、指定していないプロパティは変更されません。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-287">For example, if you specify some, but not all, properties of the **PageSettings** element, the properties that you do not specify remain unchanged.</span></span> 
  
<span data-ttu-id="eb2c9-288">次の例は、**UpdatePageContent** メソッドを使用して、ページのタイトルを変更し、そのページにいくつかのサンプル テキストを追加する方法を示しています。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-288">The following example shows how to use the **UpdatePageContent** method to change the title of a page and add some sample text to the page.</span></span> <span data-ttu-id="eb2c9-289">このコードの実行前に、自分のコンピューターでコードが動作するように、コード内に示したページ ID を有効なページ ID に置換してください。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-289">Before running the code, substitute a valid page ID for the page ID shown in the code, so that the code works on your computer.</span></span> <span data-ttu-id="eb2c9-290">ページのページ ID は、**GetHierarchy** メソッドを使用して出力を調べることでわかります。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-290">You can get the page ID for a page by using the **GetHierarchy** method and examining the output.</span></span> 
  
```cs
static void UpdatePageContent()
    {
        OneNote.Application onApplication = new OneNote.Application();
        String strImportXML;
        strImportXML = "<?xml version=\"1.0\"?>" +
            "<one:Page xmlns:one=\"http://schemas.microsoft.com/office/onenote/12/2004/onenote\" 
            ID=\"{3428B7BB-EF39-4B9C-A167-3FAE20630C37}{1}{B0}\">" +
            "    <one:PageSettings RTL=\"false\" color=\"automatic\">" +
            "        <one:PageSize>" +
            "            <one:Automatic/>" +
            "        </one:PageSize>" +
            "        <one:RuleLines visible=\"false\"/>" +
            "    </one:PageSettings>" +
            "    <one:Title style=\"font-family:Calibri;
                 font-size:17.0pt\" lang=\"en-US\">" +
            "        <one:OE alignment=\"left\">" +
            "            <one:T>" +
            "                <![CDATA[My Sample Page]]>" +
            "            </one:T>" +
            "        </one:OE>" +
            "    </one:Title>" +
            "    <one:Outline >" +
            "        <one:Position x=\"120\" y=\"160\"/>" +
            "        <one:Size width=\"120\" height=\"15\"/>" +
            "        <one:OEChildren>" +
            "            <one:OE alignment=\"left\">" +
            "                <one:T>" +
            "                    <![CDATA[Sample Text]]>" +
            "                </one:T>" +
            "            </one:OE>" +
            "        </one:OEChildren>" +
            "    </one:Outline>" +
            "</one:Page>";
        // Update the page content.
        onApplication.UpdatePageContent(strImportXML, System.DateTime.MinValue);
    }

```

### <a name="getbinarypagecontent-method"></a><span data-ttu-id="eb2c9-291">GetBinaryPageContent メソッド</span><span class="sxs-lookup"><span data-stu-id="eb2c9-291">GetBinaryPageContent method</span></span>

|||
|:-----|:-----|
|<span data-ttu-id="eb2c9-292">**説明**</span><span class="sxs-lookup"><span data-stu-id="eb2c9-292">**Description**</span></span> <br/> |<span data-ttu-id="eb2c9-293">OneNote ページ上のバイナリ オブジェクト (インクやイメージなど) を base-64 エンコード文字列として返します。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-293">Returns a binary object, such as ink or images, on an OneNote page as a base-64-encoded string.</span></span>  <br/> |
|<span data-ttu-id="eb2c9-294">**構文**</span><span class="sxs-lookup"><span data-stu-id="eb2c9-294">**Syntax**</span></span> <br/> | `HRESULT GetBinaryPageContent(`<br/>`[in]BSTR bstrPageID,`<br/>`[in]BSTR bstrCallbackID,`<br/>`[out]BSTR * pbstrBinaryObjectB64Out);` <br/> |
|<span data-ttu-id="eb2c9-295">**パラメーター**</span><span class="sxs-lookup"><span data-stu-id="eb2c9-295">**Parameters**</span></span> <br/> | <span data-ttu-id="eb2c9-296">_bstrPageID_ &ndash; 取得するバイナリ オブジェクトが含まれているページの OneNote ID。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-296">_bstrPageID_ &ndash; The OneNote ID of the page that contains the binary object to get.</span></span>  <br/><br/><span data-ttu-id="eb2c9-297">_bstrCallBackID_ &ndash; 取得するバイナリ オブジェクトの OneNote ID。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-297">_bstrCallBackID_ &ndash; The OneNote ID of the binary object you want to get.</span></span> <span data-ttu-id="eb2c9-298">この ID (**callbackID**) は、**GetPageContent** メソッドで返されるページの OneNote XML コードに含まれています。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-298">This ID, known as a **callbackID**, is in the OneNote XML code for a page returned by the **GetPageContent** method.</span></span>  <br/><br/><span data-ttu-id="eb2c9-299">_pbstrBinaryObectB64Out_ &ndash; (出力パラメーター) 文字列へのポインター。OneNote は、その文字列に base-64 エンコード文字列としてバイナリ オブジェクトを書き込みます。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-299">_pbstrBinaryObectB64Out_ &ndash; (Output parameter) A pointer to a string into which OneNote writes the binary object as a base-64-encoded string.</span></span>  <br/> |
   
### <a name="deletepagecontent-method"></a><span data-ttu-id="eb2c9-300">DeletePageContent メソッド</span><span class="sxs-lookup"><span data-stu-id="eb2c9-300">DeletePageContent method</span></span>

|||
|:-----|:-----|
|<span data-ttu-id="eb2c9-301">**説明**</span><span class="sxs-lookup"><span data-stu-id="eb2c9-301">**Description**</span></span> <br/> |<span data-ttu-id="eb2c9-302">ページから **Outline**、**Ink**、**Image** などのオブジェクトを削除します。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-302">Deletes an object &ndash; such as an **Outline**, **Ink**, or **Image** object from a page.</span></span>  <br/> |
|<span data-ttu-id="eb2c9-303">**構文**</span><span class="sxs-lookup"><span data-stu-id="eb2c9-303">**Syntax**</span></span> <br/> | `HRESULT DeletePageContent(`<br/>`[in]BSTR bstrPageID,`<br/>`[in]BSTR bstrObjectID,`<br/>`[in,defaultvalue(0)]DATE dateExpectedLastModified,`<br/>`[in,defaultvalue(#)]VARIANT_BOOL force);` <br/> |
|<span data-ttu-id="eb2c9-304">**パラメーター**</span><span class="sxs-lookup"><span data-stu-id="eb2c9-304">**Parameters**</span></span> <br/> | <span data-ttu-id="eb2c9-305">_bstrPageID_ &ndash; 削除するオブジェクトが含まれているページの OneNote ID。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-305">_bstrPageID_ &ndash; The OneNote ID of the page that contains the object to delete.</span></span>  <br/><br/><span data-ttu-id="eb2c9-306">_bstrObjectID_ &ndash; 削除するオブジェクトの OneNote ID。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-306">_bstrObjectID_ &ndash; The OneNote ID of the object that you want to delete.</span></span>  <br/><br/><span data-ttu-id="eb2c9-307">_dateExpectedLastModified_ &ndash; (省略可能) 削除するコンテンツの最終更新日時と見なす日付と時刻。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-307">_dateExpectedLastModified_ &ndash; (Optional) The date and time that you think the page that contains content you want to delete was last modified.</span></span> <span data-ttu-id="eb2c9-308">このパラメーターに 0 以外の値を渡すと、OneNote は、渡された値とページの実際の最終更新日時が一致する場合にのみ削除操作を続行します。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-308">If you pass a non-zero value for this parameter, OneNote proceeds with the deletion only if the value you pass matches the actual date and time the page was last modified.</span></span> <span data-ttu-id="eb2c9-309">このパラメーターで値を渡すと、ページの最終更新時以降にユーザーが編集した内容の意図しない上書きを防止できます。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-309">Passing a value for this parameter helps prevent accidentally overwriting edits made by users since the last time the page was modified.</span></span>  <br/><br/><span data-ttu-id="eb2c9-310">_force_ &ndash; (省略可能) OneNote の将来のバージョンからページに不明なデータが存在していてもページ コンテンツを更新する場合は **true**。それ以外の場合は **false** (既定)。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-310">_force_ &ndash; (Optional) **true** to update the page content, even if there is unknown data on the page from a future version of OneNote; otherwise, **false** (the default).</span></span>  <br/> |
   
### <a name="publish-method"></a><span data-ttu-id="eb2c9-311">Publish メソッド</span><span class="sxs-lookup"><span data-stu-id="eb2c9-311">Publish method</span></span>

|||
|:-----|:-----|
|<span data-ttu-id="eb2c9-312">**説明**</span><span class="sxs-lookup"><span data-stu-id="eb2c9-312">**Description**</span></span> <br/> |<span data-ttu-id="eb2c9-313">指定したページを OneNote がサポートしている形式でファイルにエクスポートします。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-313">Exports the page you specify to a file in any format that OneNote supports.</span></span>  <br/> |
|<span data-ttu-id="eb2c9-314">**構文**</span><span class="sxs-lookup"><span data-stu-id="eb2c9-314">**Syntax**</span></span> <br/> | `HRESULT Publish(`<br/>`[in]BSTR bstrHierarchyID,`<br/>`[in]BSTR bstrTargetFilePath,`<br/>`[in,defaultvalue(pfOneNote)]PublishFormat pfPublishFormat,`<br/>`[in,defaultvalue(0)]BSTR bstrCLSIDofExporter);` <br/> |
|<span data-ttu-id="eb2c9-315">**パラメーター**</span><span class="sxs-lookup"><span data-stu-id="eb2c9-315">**Parameters**</span></span> <br/> | <span data-ttu-id="eb2c9-316">_bstrHierarchyID_ &ndash; エクスポートする階層の OneNote ID。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-316">_bstrHierarchyID_ &ndash; The OneNote ID of the hierarchy you want to export.</span></span>  <br/><br/><span data-ttu-id="eb2c9-317">_bstrTargetFilePath_ &ndash; 結果の出力ファイルを保存する場所への絶対パス。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-317">_bstrTargetFilePath_ &ndash; The absolute path to the location where you want to save the resulting output file.</span></span> <span data-ttu-id="eb2c9-318">指定したファイルは、その場所に存在していないことが必要です。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-318">The file you specify must be one that does not already exist at that location.</span></span>  <br/><br/><span data-ttu-id="eb2c9-319">_pfPublishFormat_ &ndash; [PublishFormat](enumerations-onenote-developer-reference.md#odc_PublishFormat) 列挙型の値。この値で、発行するページの形式 (MTHML や PDF など) を指定します。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-319">_pfPublishFormat_ &ndash; One of the [PublishFormat](enumerations-onenote-developer-reference.md#odc_PublishFormat) enumeration values that specifies the format in which you want the published page to be (for example, MTHML, PDF, and so on).</span></span>  <br/><br/><span data-ttu-id="eb2c9-320">_bstrCLSIDofExporter_ &ndash; Microsoft Windows 拡張メタファイル (.emf) をエクスポートできる登録済み COM アプリケーションのクラス ID (CLSID)。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-320">_bstrCLSIDofExporter_ &ndash; The class ID (CLSID) of a registered COM application that can export Microsoft Windows enhanced metafiles (.emf).</span></span> <span data-ttu-id="eb2c9-321">この COM アプリケーションは、**IMsoDocExporter** インターフェイスを実装している必要があります。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-321">The COM application must implement the **IMsoDocExporter** interface.</span></span> <span data-ttu-id="eb2c9-322">このパラメーターは、サード パーティの開発者がカスタム形式で OneNote コンテンツを発行する独自のコードを作成できるようにするために含まれています。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-322">This parameter is included to permit third-party developers to write their own code to publish OneNote content in a custom format.</span></span> <span data-ttu-id="eb2c9-323">**IMsoDocExporter** インターフェイスの詳細については、「[Office (2007) 固定形式エクスポート機能の拡張](https://msdn.microsoft.com/library/office/aa338206%28v=office.12%29.aspx)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-323">For more information about the **IMsoDocExporter** interface, see [Extending the Office 2007 Fixed-Format Export Feature](https://msdn.microsoft.com/library/office/aa338206%28v=office.12%29.aspx).</span></span>  <br/> |
   
<span data-ttu-id="eb2c9-324">現在、OneNote では次のファイル形式をサポートしています。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-324">Currently, OneNote supports the following file formats:</span></span>
  
- <span data-ttu-id="eb2c9-325">MHTML ファイル (.mht)</span><span class="sxs-lookup"><span data-stu-id="eb2c9-325">MHTML files (.mht)</span></span>
- <span data-ttu-id="eb2c9-326">Adobe Acrobat PDF ファイル (.pdf)</span><span class="sxs-lookup"><span data-stu-id="eb2c9-326">Adobe Acrobat PDF files (.pdf)</span></span>
- <span data-ttu-id="eb2c9-327">XML Paper Specification (XPS) ファイル (.xps)</span><span class="sxs-lookup"><span data-stu-id="eb2c9-327">XML Paper Specification (XPS) files (.xps)</span></span>
- <span data-ttu-id="eb2c9-328">OneNote 2013、2010 または 2007 ファイル (.one)</span><span class="sxs-lookup"><span data-stu-id="eb2c9-328">OneNote 2013, 2010 or 2007 files (.one)</span></span>
- <span data-ttu-id="eb2c9-329">OneNote パッケージ ファイル (.onepkg)</span><span class="sxs-lookup"><span data-stu-id="eb2c9-329">OneNote Package files (.onepkg)</span></span>
- <span data-ttu-id="eb2c9-330">Microsoft Word 文書 (.doc or .docx)</span><span class="sxs-lookup"><span data-stu-id="eb2c9-330">Microsoft Word documents (.doc or .docx)</span></span>
- <span data-ttu-id="eb2c9-331">Microsoft Windows 拡張メタファイル (.emf)</span><span class="sxs-lookup"><span data-stu-id="eb2c9-331">Microsoft Windows Enhanced Metafiles (.emf)</span></span>
- <span data-ttu-id="eb2c9-332">HTML ファイル (.html)</span><span class="sxs-lookup"><span data-stu-id="eb2c9-332">HTML files (.html)</span></span>
    
<span data-ttu-id="eb2c9-333">このメソッドは、UI の **[発行]** をクリックして形式を指定した場合と、まったく同じ結果を生成します。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-333">This method produces exactly the same results you would get by clicking **Publish** in the UI and specifying the format.</span></span> 
  
## <a name="navigation-methods"></a><span data-ttu-id="eb2c9-334">ナビゲーションのメソッド</span><span class="sxs-lookup"><span data-stu-id="eb2c9-334">Navigation methods</span></span>
<span data-ttu-id="eb2c9-335"><a name="ON14DevRef_Application_Navigation"> </a></span><span class="sxs-lookup"><span data-stu-id="eb2c9-335"><a name="ON14DevRef_Application_Navigation"> </a></span></span>

<span data-ttu-id="eb2c9-336">このセクションで説明するメソッドを使用すると、OneNote ノートブック、セクション グループ、セクション、ページ、およびページ オブジェクトへのナビゲーション、リンク、および検索が可能になります。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-336">The methods described in this section enable you to find, navigate to, and link to OneNote notebooks, section groups, sections, pages, and page objects.</span></span>
  
### <a name="navigateto-method"></a><span data-ttu-id="eb2c9-337">NavigateTo メソッド</span><span class="sxs-lookup"><span data-stu-id="eb2c9-337">NavigateTo method</span></span>

|||
|:-----|:-----|
|<span data-ttu-id="eb2c9-338">**説明**</span><span class="sxs-lookup"><span data-stu-id="eb2c9-338">**Description**</span></span> <br/> |<span data-ttu-id="eb2c9-339">指定したオブジェクト (セクション、ページ、ページ内の **Outline** 要素など) にナビゲートします。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-339">Navigates to the specified object (for example, sections, pages, and **Outline** elements within pages).</span></span>  <br/> |
|<span data-ttu-id="eb2c9-340">**構文**</span><span class="sxs-lookup"><span data-stu-id="eb2c9-340">**Syntax**</span></span> <br/> | `HRESULT NavigateTo(`<br/>`[in]BSTR bstrHierarchyObjectID,`<br/>`[in,defaultvalue(#)]BSTR bstrObjectID,`<br/>`[in,defaultvalue(0)]VARIANT_BOOL fNewWindow);` <br/> |
|<span data-ttu-id="eb2c9-341">**パラメーター**</span><span class="sxs-lookup"><span data-stu-id="eb2c9-341">**Parameters**</span></span> <br/> | <span data-ttu-id="eb2c9-342">_bstrHierarchyObjectID_ &ndash; OneNote 階層内のナビゲート先オブジェクトの OneNote ID。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-342">_bstrHierarchyObjectID_ &ndash; The OneNote ID of the object you want to navigate to in the OneNote Hierarchy.</span></span>  <br/><br/><span data-ttu-id="eb2c9-343">_bstrObjectID_ &ndash; OneNote ページ上のナビゲート先オブジェクトの OneNote ID。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-343">_bstrObjectID_ &ndash; The OneNote ID of the object you want to navigate to on the OneNote page.</span></span>  <br/><br/><span data-ttu-id="eb2c9-344">_fNewWindow_ &ndash; (省略可能) 指定したオブジェクトを新しい OneNote ウィンドウで開く場合は **true**。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-344">_fNewWindow_ &ndash; (Optional) **true** to open specified object in a new OneNote window.</span></span> <span data-ttu-id="eb2c9-345">OneNote ウィンドウが開いているときには新しいウィンドウを開かない場合は **false**。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-345">**false** does not open a new OneNote window if one is open.</span></span>  <br/> |
   
### <a name="navigatetourl-method"></a><span data-ttu-id="eb2c9-346">NavigateToUrl メソッド</span><span class="sxs-lookup"><span data-stu-id="eb2c9-346">NavigateToUrl method</span></span>

|||
|:-----|:-----|
|<span data-ttu-id="eb2c9-347">**説明**</span><span class="sxs-lookup"><span data-stu-id="eb2c9-347">**Description**</span></span> <br/> |<span data-ttu-id="eb2c9-348">OneNote のリンクを渡された場合 (onenote://)、OneNote 内の対応する場所には、OneNote ウィンドウが開きます。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-348">If passed a OneNote link (onenote://), opens the OneNote window to the corresponding location in OneNote.</span></span> <span data-ttu-id="eb2c9-349">リンクが OneNote の外部へのリンク (https:// や file:// など) の場合は、セキュリティ ダイアログ ボックスが表示されます。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-349">If the link is external to OneNote (such as https:// or file://), a security dialog box will appear.</span></span> <span data-ttu-id="eb2c9-350">無視すると、OneNote はリンクを開こうとして、**HResult.hrObjectDoesNotExist** エラーが返されます。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-350">Upon dismissal, OneNote attempts to open the link and an **HResult.hrObjectDoesNotExist** error is returned.</span></span>  <br/> |
|<span data-ttu-id="eb2c9-351">**構文**</span><span class="sxs-lookup"><span data-stu-id="eb2c9-351">**Syntax**</span></span> <br/> | `HRESULT NavigateTo(`<br/>`[in]BSTR bstrUrl,`<br/>`[in,defaultvalue(0)]VARIANT_BOOL fNewWindow);` <br/> |
|<span data-ttu-id="eb2c9-352">**パラメーター**</span><span class="sxs-lookup"><span data-stu-id="eb2c9-352">**Parameters**</span></span> <br/> | <span data-ttu-id="eb2c9-353">_bstrUrl_ &ndash; ナビゲート先を示す文字列。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-353">_bstrUrl_ &ndash; A string that indicates where to navigate to.</span></span> <span data-ttu-id="eb2c9-354">これは、OneNote のリンクにすることも、それ以外の任意の URL (Web リンクやネットワークの場所など) にすることもできます。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-354">This could be a OneNote link, or any other URL, such as a web link or network location.</span></span>  <br/><br/><span data-ttu-id="eb2c9-355">_fNewWindow_ &ndash; (省略可能) 指定の URL を新しい OneNote ウィンドウで開く場合は **true**。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-355">_fNewWindow_ &ndash; (Optional) **true** to open the specified URL in a new OneNote window.</span></span> <span data-ttu-id="eb2c9-356">OneNote ウィンドウが開いているときには新しいウィンドウを開かない場合は **false**。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-356">**false** does not open a new OneNote window if one is open.</span></span>  <br/> |
   
### <a name="gethyperlinktoobject-method"></a><span data-ttu-id="eb2c9-357">GetHyperLinkToObject メソッド</span><span class="sxs-lookup"><span data-stu-id="eb2c9-357">GetHyperLinkToObject method</span></span>

|||
|:-----|:-----|
|<span data-ttu-id="eb2c9-358">**説明**</span><span class="sxs-lookup"><span data-stu-id="eb2c9-358">**Description**</span></span> <br/> |<span data-ttu-id="eb2c9-359">指定のノートブック、セクション グループ、セクション、ページ、またはページ オブジェクトへの OneNote ハイパーリンクを取得します。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-359">Gets a OneNote hyperlink to the specified notebook, section group, section, page, or page object.</span></span>  <br/> |
|<span data-ttu-id="eb2c9-360">**構文**</span><span class="sxs-lookup"><span data-stu-id="eb2c9-360">**Syntax**</span></span> <br/> | `HRESULT GetHyperlinkToObject(`<br/>`[in] BSTR bstrHierarchyID,`<br/>`[in] BSTR bstrPageContentObjectID,`<br/>`[out] BSTR * pbstrHyperlinkOut);` <br/> |
|<span data-ttu-id="eb2c9-361">**パラメーター**</span><span class="sxs-lookup"><span data-stu-id="eb2c9-361">**Parameters**</span></span> <br/> | <span data-ttu-id="eb2c9-362">_bstrHierarchyID_ &ndash; ハイパーリンクの取得対象のノートブック、セクション グループ、またはページの OneNote ID。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-362">_bstrHierarchyID_ &ndash; The OneNote ID for the notebook, section group, section, or page for which you want a hyperlink.</span></span>  <br/><br/><span data-ttu-id="eb2c9-363">_bstrPageContentObjectID_ &ndash; (省略可能) ハイパーリンクの取得対象のページ内にあるオブジェクトの OneNote ID。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-363">_bstrPageContentObjectID_ &ndash; (Optional) The OneNote ID for the object within the page for which you want a hyperlink.</span></span> <span data-ttu-id="eb2c9-364">たとえば、このオブジェクトはアウトラインであることも、**Outline** 要素であることもあります。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-364">For example, the object can be an outline or **Outline** element.</span></span> <span data-ttu-id="eb2c9-365">空の文字列 ("") を渡すと、_bstrHierarchyID_ パラメーターで指定したノートブック、セクション グループ、セクション、またはページをポイントするリンクが返されます。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-365">If you pass an empty string (""), the returned link points to the notebook, section group, section, or page that you specified in the  _bstrHierarchyID_ parameter.</span></span> <span data-ttu-id="eb2c9-366">_bstrPageContentObjectID_ パラメーターで空白でない文字列を渡す場合、_bstrHierarchyID_ パラメーターは指定したオブジェクトが含まれているページへの参照であることが必要です。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-366">If you pass a non-empty string for the  _bstrPageContentObjectID_ parameter, the  _bstrHierarchyID_ parameter must be a reference to the page that contains the specified object.</span></span>  <br/><br/><span data-ttu-id="eb2c9-367">_pbstrHyperlinkOut_ &ndash; (出力パラメーター) 文字列へのポインター。**GetHyperlinkToObject** メソッドは、その文字列に出力のハイパーリンク テキストを書き込みます。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-367">_pbstrHyperlinkOut_ &ndash; (Output parameter) A pointer to a string into which the **GetHyperlinkToObject** method writes the output hyperlink text.</span></span>  <br/> |
   
<span data-ttu-id="eb2c9-368">結果のリンク先にナビゲートしようとすると、OneNote は指定のオブジェクトをブラウザーで開いて表示します。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-368">When you attempt to navigate to the resulting link, OneNote opens and displays the specified object in the browser.</span></span>
  
### <a name="getwebhyperlinktoobject-method"></a><span data-ttu-id="eb2c9-369">GetWebHyperlinktoObject メソッド</span><span class="sxs-lookup"><span data-stu-id="eb2c9-369">GetWebHyperlinktoObject method</span></span>

|||
|:-----|:-----|
|<span data-ttu-id="eb2c9-370">**説明**</span><span class="sxs-lookup"><span data-stu-id="eb2c9-370">**Description**</span></span> <br/> |<span data-ttu-id="eb2c9-371">OneNote Web クライアントで開いたオブジェクトへのハイパーリンクを返します。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-371">Returns a hyperlink to an object that opens in the OneNote Web Client.</span></span>  <br/> |
|<span data-ttu-id="eb2c9-372">**構文**</span><span class="sxs-lookup"><span data-stu-id="eb2c9-372">**Syntax**</span></span> <br/> | `HRESULT GetWebHyperlinkToObject (`<br/>`[in] BSTR bstrHierarchyID,`<br/>`[in] BSTR bstrPageContentObjectID,`<br/>`[out] BSTR * pbstrHyperlinkOut);` <br/> |
|<span data-ttu-id="eb2c9-373">**パラメーター**</span><span class="sxs-lookup"><span data-stu-id="eb2c9-373">**Parameters**</span></span> <br/> | <span data-ttu-id="eb2c9-374">_bstrHierarchyID_ &ndash; Web ハイパーリンクの取得対象のノートブック、セクション グループ、セクションまたはページの OneNote ID。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-374">_bstrHierarchyID_ &ndash; The OneNote ID for the notebook, section group, section or page for which you want a web hyperlink.</span></span>  <br/><br/><span data-ttu-id="eb2c9-375">_bstrPageContentObjectID_ &ndash; (省略可能) ハイパーリンクの取得対象のページ内にあるオブジェクトの OneNote ID。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-375">_bstrPageContentObjectID_ &ndash; (Optional) The OneNote ID for the object within the page for which you want a hyperlink.</span></span> <span data-ttu-id="eb2c9-376">たとえば、このオブジェクトはアウトラインであることも、**Outline** 要素であることもあります。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-376">For example, the object can be an outline or **Outline** element.</span></span> <span data-ttu-id="eb2c9-377">空の文字列 ("") を渡すと、_bstrHierarchyID_ パラメーターで指定したノートブック、セクション グループ、セクション、またはページをポイントするリンクが返されます。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-377">If you pass an empty string (""), the returned link points to the notebook, section group, section, or page that you specified in the  _bstrHierarchyID_ parameter.</span></span> <span data-ttu-id="eb2c9-378">_bstrPageContentObjectID_ パラメーターで空白でない文字列を渡す場合、_bstrHierarchyID_ パラメーターは指定したオブジェクトが含まれているページへの参照であることが必要です。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-378">If you pass a non-empty string for the  _bstrPageContentObjectID_ parameter, the  _bstrHierarchyID_ parameter must be a reference to the page that contains the specified object.</span></span>  <br/><br/><span data-ttu-id="eb2c9-379">_pbstrHyperlinkOut_ &ndash; (出力パラメーター) 文字列へのポインター。**GetWebHyperlinkToObject** メソッドは、その文字列に出力のハイパーリンク テキストを書き込みます。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-379">_pbstrHyperlinkOut_ &ndash; (Output parameter) A pointer to a string into which the **GetWebHyperlinkToObject** method writes the output hyperlink text.</span></span> <span data-ttu-id="eb2c9-380">ノートブックに対する Web ハイパーリンクが作成できない場合は、Null 値が返されます。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-380">If a web hyperlink cannot be created for the notebook, a null value is returned.</span></span>  <br/> |
   
### <a name="findpages-method"></a><span data-ttu-id="eb2c9-381">FindPages メソッド</span><span class="sxs-lookup"><span data-stu-id="eb2c9-381">FindPages method</span></span>

|||
|:-----|:-----|
|<span data-ttu-id="eb2c9-382">**説明**</span><span class="sxs-lookup"><span data-stu-id="eb2c9-382">**Description**</span></span>|<span data-ttu-id="eb2c9-383">指定したクエリ条件と一致するページのリストを返します。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-383">Returns a list of pages that match the specified query term.</span></span>|
|<span data-ttu-id="eb2c9-384">**構文**</span><span class="sxs-lookup"><span data-stu-id="eb2c9-384">**Syntax**</span></span>| `HRESULT FindPages(`<br/>`[in]BSTR bstrStartNodeID,`<br/>`[in]BSTR bstrSearchBSTR,`<br/>`[out]BSTR * pbstrHierarchyXmlOut,`<br/>`[in,defaultvalue(#)]VARIANT_BOOL fIncludeUnindexedPages,`<br/>`[in,defaultvalue(0)]VARIANT_BOOL fDisplay,`<br/>`[in,defaultvalue(#)]XMLSchema xsSchema);`|
|<span data-ttu-id="eb2c9-385">**パラメーター**</span><span class="sxs-lookup"><span data-stu-id="eb2c9-385">**Parameters**</span></span>| <span data-ttu-id="eb2c9-386">_bstrStartNodeID_ &ndash; コンテンツの検索対象にする最上位のノード (ルート、ノートブック、セクション グループ、セクション)。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-386">_bstrStartNodeID_ &ndash; The node (root, notebook, section group, or section) below which to search for content.</span></span> <span data-ttu-id="eb2c9-387">このパラメーターによって、検索の範囲を設定します。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-387">This parameter sets the scope for the search.</span></span><br/><br/><span data-ttu-id="eb2c9-388">_bstrSearchString_ &ndash; 検索文字列。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-388">_bstrSearchString_ &ndash; The search string.</span></span> <span data-ttu-id="eb2c9-389">OneNote UI の検索ボックスに入力する場合とまったく同じ文字列を渡します。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-389">Pass exactly the same string that you would type into the search box in the OneNote UI.</span></span> <span data-ttu-id="eb2c9-390">ビットごとの演算子 (**AND** や **OR** など) を使用できます。この演算子は、大文字表記にする必要があります。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-390">You can use bitwise operators, such as **AND** and **OR**, which must be all uppercase.</span></span><br/><br/><span data-ttu-id="eb2c9-391">_pbstrHierarchyXmlOut_ &ndash; (出力パラメーター) 文字列へのポインター。OneNote は、その文字列に出力 XML 文字列を書き込みます。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-391">_pbstrHierarchyXmlOut_ &ndash; (Output parameter) A pointer to a string into which you want OneNote to write the output XML string.</span></span> <span data-ttu-id="eb2c9-392">結果の XML 文字列には、ルートから下位方向に検索文字列と一致するページまでのノートブック階層が格納されています。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-392">The resulting XML string contains the notebook hierarchy from the root downward to, and including, any pages that match the search string.</span></span> <span data-ttu-id="eb2c9-393">たとえば、**FindPages** メソッドは、階層内で一致するページが存在しないセクションはリスト出力しません。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-393">For example, the **FindPages** method does not list sections that have no page matches in the hierarchy.</span></span> <span data-ttu-id="eb2c9-394">さらに、1 つのセクションの 1 つのページのみが文字列と一致する場合に返される階層には、そのセクションとページへのパスが含まれますが、それ以外のノートブック階層の部分へのパスは含まれません。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-394">Also, if only one page in a single section matches the string, the returned hierarchy includes the path to that section and page, but to no other parts of the notebook hierarchy.</span></span><br/><br/><span data-ttu-id="eb2c9-395">_fIncludeUnindexedPages_ &ndash; (省略可能) Windows Search でインデックスが作成されていないページを検索する場合は **true**。それ以外の場合は **false**。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-395">_fIncludeUnindexedPages_ &ndash; (Optional) **true** to search pages that have not been indexed by Windows Search; otherwise, **false**.</span></span><br/><br/><span data-ttu-id="eb2c9-396">_fDisplay_ &ndash; (省略可能) ユーザーが入力した場合と同じように UI でも検索を実行する場合は **true**。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-396">_fDisplay_ &ndash; (Optional) **true** to also run the search in the UI for the user, just as if the user had typed it themselves.</span></span> <span data-ttu-id="eb2c9-397">UI の変化なしにクエリを実行する場合は **false** (既定)。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-397">**false** to perform the query with no change to the UI (the default).</span></span><br/><br/><span data-ttu-id="eb2c9-398">_xsSchema_ &ndash; (省略可能) 文字列 _pbstrHierarchyXmlOut_ の OneNote スキーマ バージョン。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-398">_xsSchema_ &ndash; (Optional) The OneNote schema version of the string  _pbstrHierarchyXmlOut_.</span></span> <span data-ttu-id="eb2c9-399">この省略可能な値は、_pbstrHierarchyXmlOut_ 文字列を格納する OneNote XML スキーマのバージョンを指定するために使用します。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-399">This optional value is used to specify the version of the OneNote XML schema that contains the  _pbstrHierarchyXmlOut_ string.</span></span> <span data-ttu-id="eb2c9-400">この値が指定されてないと、OneNote は XML のスキーマ バージョンが _xsCurrent_ であると仮定します。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-400">If this value is not specified, OneNote will assume that the XML is in schema version  _xsCurrent_.</span></span> <br/><br/><span data-ttu-id="eb2c9-401">**注**: OneNote の将来のバージョンでもアドインが動作するように、**xsCurrent** を使用したり、空白のままにしたりするのではなく、OneNote のバージョン (**xs2013**) を指定するようにしてください。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-401">**NOTE**:  We recommend specifying a version of OneNote (such as **xs2013**) instead of using **xsCurrent** or leaving it blank, because this will allow your add-in to work with future versions of OneNote.</span></span>           |
   
 <span data-ttu-id="eb2c9-402">**FindPages** は、コンピューターに Microsoft Search 3.0 または 4.0 がインストールされている場合にのみ動作します。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-402">**FindPages** works only if you have Microsoft Search 3.0 or 4.0 installed on your computer.</span></span> <span data-ttu-id="eb2c9-403">Windows Vista および Windows 7 には、このコンポーネントが組み込まれています。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-403">Windows Vista and Windows 7 include this component.</span></span> <span data-ttu-id="eb2c9-404">ただし、それより前のバージョンの Windows を実行している場合は、**FindPages** が動作するように、[Windows Search](https://www.microsoft.com/windows/products/winfamily/desktopsearch/getitnow.mspx) をインストールする必要があります。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-404">However, if you are running an earlier version of Windows, you must install [Windows Search](https://www.microsoft.com/windows/products/winfamily/desktopsearch/getitnow.mspx) for **FindPages** to work.</span></span> 
  
### <a name="findmeta-method"></a><span data-ttu-id="eb2c9-405">FindMeta メソッド</span><span class="sxs-lookup"><span data-stu-id="eb2c9-405">FindMeta method</span></span>

|||
|:-----|:-----|
|<span data-ttu-id="eb2c9-406">**説明**</span><span class="sxs-lookup"><span data-stu-id="eb2c9-406">**Description**</span></span>|<span data-ttu-id="eb2c9-407">指定したクエリ条件と一致するメタデータを含んでいる OneNote オブジェクトのリストを返します。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-407">Returns a list of OneNote objects that contain metadata that matches the specified query term.</span></span>|
|<span data-ttu-id="eb2c9-408">**構文**</span><span class="sxs-lookup"><span data-stu-id="eb2c9-408">**Syntax**</span></span>| `HRESULT FindMeta (`<br/>`[in]BSTR bstrStartNodeID,`<br/>`[in]BSTR bstrSearchBSTRName,`<br/>`[out]BSTR * pbstrHierarchyXmlOut,`<br/>`[in,defaultvalue(#)]VARIANT_BOOL fIncludeUnindexedPages,`<br/>`[in,defaultvalue(#)]XMLSchema xsSchema);`|
|<span data-ttu-id="eb2c9-409">**パラメーター**</span><span class="sxs-lookup"><span data-stu-id="eb2c9-409">**Parameters**</span></span>| <span data-ttu-id="eb2c9-410">_bstrStartNodeID_ &ndash; コンテンツの検索対象にする最上位のノード (ルート、ノートブック、セクション グループ、セクション)。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-410">_bstrStartNodeID_ &ndash; The node (root, notebook, section group, or section) below which to search for content.</span></span> <span data-ttu-id="eb2c9-411">このパラメーターによって、検索の範囲を設定します。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-411">This parameter sets the scope for the search.</span></span><br/><br/><span data-ttu-id="eb2c9-412">_bstrSearchStringName_ &ndash; 検索文字列。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-412">_bstrSearchStringName_ &ndash; The search string.</span></span> <span data-ttu-id="eb2c9-413">メタデータ名の任意の部分を渡します。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-413">Pass in any part of the metadata name.</span></span> <span data-ttu-id="eb2c9-414">空の文字列または Null 値を渡すと、メタデータが存在するすべてのオブジェクトがクエリと一致します。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-414">If you pass in an empty string or a null value, all objects that have metadata will match the query.</span></span><br/><br/><span data-ttu-id="eb2c9-415">_pbstrHierarchyXmlOut_ &ndash; (出力パラメーター) 文字列へのポインター。OneNote は、その文字列に出力 XML 文字列を書き込みます。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-415">_pbstrHierarchyXmlOut_ &ndash; (Output parameter) A pointer to a string into which you want OneNote to write the output XML string.</span></span> <span data-ttu-id="eb2c9-416">結果の XML 文字列には、ルートから下位方向に検索文字列と一致するページまでのノートブック階層が格納されています。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-416">The resulting XML string contains the notebook hierarchy from the root downward to, and including, any pages that match the search string.</span></span> <span data-ttu-id="eb2c9-417">たとえば、**FindPages** メソッドは、階層内で一致するページが存在しないセクションはリスト出力しません。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-417">For example, the **FindPages** method does not list sections that have no page matches in the hierarchy.</span></span> <span data-ttu-id="eb2c9-418">さらに、1 つのセクションの 1 つのページのみが文字列と一致する場合に返される階層には、そのセクションとページへのパスが含まれますが、それ以外のノートブック階層の部分へのパスは含まれません。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-418">Also, if only one page in a single section matches the string, the returned hierarchy includes the path to that section and page, but to no other parts of the notebook hierarchy.</span></span>  <br/><br/><span data-ttu-id="eb2c9-419">_fIncludeUnindexedPages_ &ndash; (省略可能) Windows Search でインデックスが作成されていないページを検索する場合は **true**。それ以外の場合は **false**。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-419">_fIncludeUnindexedPages_ &ndash; (Optional) **true** to search pages that have not been indexed by Windows Search; otherwise, **false**.</span></span><br/><br/><span data-ttu-id="eb2c9-420">_xsSchema_ &ndash; (省略可能) 文字列 _pbstrHierarchyXmlOut_ の OneNote スキーマ バージョン。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-420">_xsSchema_ &ndash; (Optional) The OneNote schema version of the string  _pbstrHierarchyXmlOut_.</span></span> <span data-ttu-id="eb2c9-421">この省略可能な値は、_pbstrHierarchyXmlOut_ 文字列を格納する OneNote XML スキーマのバージョンを指定するために使用します。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-421">This optional value is used to specify the version of the OneNote XML schema that contains the  _pbstrHierarchyXmlOut_ string.</span></span> <span data-ttu-id="eb2c9-422">この値が指定されてないと、OneNote は XML のスキーマ バージョンが _xsCurrent_ であると仮定します。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-422">If this value is not specified, OneNote will assume that the XML is in schema version  _xsCurrent_.</span></span> <br/><br/><span data-ttu-id="eb2c9-423">**注**: OneNote の将来のバージョンでもアドインが動作するように、**xsCurrent** を使用したり、空白のままにしたりするのではなく、OneNote のバージョン (**xs2013**) を指定するようにしてください。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-423">**NOTE**:  We recommend specifying a version of OneNote (such as **xs2013**) instead of using **xsCurrent** or leaving it blank, because this will allow your add-in to work with future versions of OneNote.</span></span>           |
   
<span data-ttu-id="eb2c9-424">**FindMeta** は、コンピューターに Microsoft Windows Search 3.0 または 4.0 がインストールされている場合にのみ動作します。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-424">**FindMeta** works only if you have Microsoft Windows Search 3.0 or 4.0 installed on your computer.</span></span> <span data-ttu-id="eb2c9-425">Windows Vista および Windows 7 には、このコンポーネントが組み込まれています。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-425">Windows Vista and Windows 7 include this component.</span></span> <span data-ttu-id="eb2c9-426">ただし、それより前のバージョンの Windows を実行している場合は、**FindMeta** が動作するように、[Windows Search](https://www.microsoft.com/windows/products/winfamily/desktopsearch/getitnow.mspx) をインストールする必要があります。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-426">However, if you are running an earlier version of Windows, you must install [Windows Search](https://www.microsoft.com/windows/products/winfamily/desktopsearch/getitnow.mspx) for **FindMeta** to work.</span></span> 
  
## <a name="functional-methods"></a><span data-ttu-id="eb2c9-427">機能性のメソッド</span><span class="sxs-lookup"><span data-stu-id="eb2c9-427">Functional methods</span></span>
<span data-ttu-id="eb2c9-428"><a name="ON14DevRef_Application_Functional"> </a></span><span class="sxs-lookup"><span data-stu-id="eb2c9-428"><a name="ON14DevRef_Application_Functional"> </a></span></span>

<span data-ttu-id="eb2c9-429">このセクションで説明するメソッドを使用すると、OneNote アプリケーションで特定のアクションを実行することやパラメーターを設定することができます。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-429">The methods described in this section enable you to perform certain actions or set parameters within the OneNote application.</span></span>
  
### <a name="mergefiles-method"></a><span data-ttu-id="eb2c9-430">MergeFiles メソッド</span><span class="sxs-lookup"><span data-stu-id="eb2c9-430">MergeFiles method</span></span>

|||
|:-----|:-----|
|<span data-ttu-id="eb2c9-431">**説明**</span><span class="sxs-lookup"><span data-stu-id="eb2c9-431">**Description**</span></span> <br/> |<span data-ttu-id="eb2c9-432">ユーザーが同じファイルの変更内容を 1 つに結合できるようにします。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-432">Allows users to merge changes for the same file into one.</span></span> <span data-ttu-id="eb2c9-433">複数のファイルが同一であると見なされるには、それらの OneNote ID が同じであることが必要です。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-433">For the files to be considered the same, they must have the same OneNote ID.</span></span>  <br/> |
|<span data-ttu-id="eb2c9-434">**構文**</span><span class="sxs-lookup"><span data-stu-id="eb2c9-434">**Syntax**</span></span> <br/> | `HRESULT MergeFiles (`<br/>`[in]BSTR bstrBaseFile,`<br/>`[in]BSTR bstrClientFile,`<br/>`[in]BSTR bstrServerFile,`<br/>`[in]BSTR bstrTargetFile);` <br/> |
|<span data-ttu-id="eb2c9-435">**パラメーター**</span><span class="sxs-lookup"><span data-stu-id="eb2c9-435">**Parameters**</span></span> <br/> | <span data-ttu-id="eb2c9-436">_bstrBaseFile_ &ndash; 初期状態のファイルの .one ファイルの場所へのパス文字列。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-436">_bstrBaseFile_ &ndash; The path string to the .one file location of the initial state of the file.</span></span>  <br/><br/><span data-ttu-id="eb2c9-437">_bstrClientFile_ &ndash; サーバー ファイルの変更がベースと結合された後でベース ファイルと結合される 2 番目の変更セットを含む .one ファイルの場所へのパス文字列。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-437">_bstrClientFile_ &ndash; The path string to the .one file location of the second set of changes to be merged with the base file after the server file changes are merged with the base.</span></span>  <br/><br/><span data-ttu-id="eb2c9-438">_bstrServerFile_ &ndash; ベース ファイルと結合される最初の変更セットを含む .one ファイルの場所へのパス文字列。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-438">_bstrServerFile_ &ndash; The path string to the .one file location of the first set of changes to be merged with the base file.</span></span>  <br/><br/><span data-ttu-id="eb2c9-439">_bstrTargetFile_ &ndash; 変更が結合されたファイルの .one ファイルの場所へのパス文字列。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-439">_bstrTargetFile_ &ndash; The path string to the .one file location of the file with the merged changes.</span></span>  <br/> |
   
<span data-ttu-id="eb2c9-440">**MergeFiles** メソッドは、複数バージョンの OneNote ファイルが存在する可能性のあるモバイル シナリオに向けられたものです。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-440">The **MergeFiles** method was intended for mobile scenarios in which multiple versions of an OneNote file may exist.</span></span> 
  
### <a name="mergesections-method"></a><span data-ttu-id="eb2c9-441">MergeSections メソッド</span><span class="sxs-lookup"><span data-stu-id="eb2c9-441">MergeSections method</span></span>

|||
|:-----|:-----|
|<span data-ttu-id="eb2c9-442">**説明**</span><span class="sxs-lookup"><span data-stu-id="eb2c9-442">**Description**</span></span> <br/> |<span data-ttu-id="eb2c9-443">セクションのコンテンツを OneNote の別のセクションに結合します。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-443">Merges the content of one section into another in OneNote.</span></span>  <br/> |
|<span data-ttu-id="eb2c9-444">**構文**</span><span class="sxs-lookup"><span data-stu-id="eb2c9-444">**Syntax**</span></span> <br/> | `HRESULT MergeSections (`<br/>`[in]BSTR bstrSectionSourceId,`<br/>`[in]BSTR bstrSectionDestinationId);` <br/> |
|<span data-ttu-id="eb2c9-445">**パラメーター**</span><span class="sxs-lookup"><span data-stu-id="eb2c9-445">**Parameters**</span></span> <br/> | <span data-ttu-id="eb2c9-446">_bstrSectionSourceId_ &ndash; 結合されるセクションの OneNote ID。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-446">_bstrSectionSourceId_ &ndash; The OneNote ID of the section to be merged.</span></span>  <br/><br/><span data-ttu-id="eb2c9-447">_bstrSectionDestinationId_ &ndash; 結合先のセクションの OneNote ID。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-447">_bstrSectionDestinationId_ &ndash; The OneNote ID of the section to be merged into.</span></span> <span data-ttu-id="eb2c9-448">結合元のセクションが、この結合先セクションに結合されます。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-448">The source section will be merged into this destination section.</span></span>  <br/> |
   
<span data-ttu-id="eb2c9-449">このメソッドは、セクションを右クリックしたときに表示される **[別のセクションに結合]** 機能と同じ操作を実行します。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-449">This method performs the same operation as the **Merge into Another Section** feature that is visible when you right-click a section.</span></span> 
  
### <a name="quickfiling-method"></a><span data-ttu-id="eb2c9-450">QuickFiling メソッド</span><span class="sxs-lookup"><span data-stu-id="eb2c9-450">QuickFiling method</span></span>

|||
|:-----|:-----|
|<span data-ttu-id="eb2c9-451">**説明**</span><span class="sxs-lookup"><span data-stu-id="eb2c9-451">**Description**</span></span> <br/> |<span data-ttu-id="eb2c9-452">[IQuickFilingDialog](quick-filing-dialog-box-interfaces-onenote.md#odc_IQuickFilingDialog) ダイアログ ボックスのインスタンスを返します。このダイアログ ボックスは、OneNote 階層ツリーの場所を選択する際に使用できます。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-452">Returns an instance of the [IQuickFilingDialog](quick-filing-dialog-box-interfaces-onenote.md#odc_IQuickFilingDialog) dialog box, which can be used to select a location within the OneNote hierarchy tree.</span></span>  <br/> |
|<span data-ttu-id="eb2c9-453">**構文**</span><span class="sxs-lookup"><span data-stu-id="eb2c9-453">**Syntax**</span></span> <br/> | `HRESULT QuickFiling (`<br/>` );` <br/> |
   
### <a name="synchierarchy-method"></a><span data-ttu-id="eb2c9-454">SyncHierarchy メソッド</span><span class="sxs-lookup"><span data-stu-id="eb2c9-454">SyncHierarchy method</span></span>

|||
|:-----|:-----|
|<span data-ttu-id="eb2c9-455">**説明**</span><span class="sxs-lookup"><span data-stu-id="eb2c9-455">**Description**</span></span> <br/> |<span data-ttu-id="eb2c9-456">指定したオブジェクトとディスク上のソース ファイルを OneNote で強制的に同期します。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-456">Forces OneNote to sync the specified object with the source file on disk.</span></span>  <br/> |
|<span data-ttu-id="eb2c9-457">**構文**</span><span class="sxs-lookup"><span data-stu-id="eb2c9-457">**Syntax**</span></span> <br/> | `HRESULT SyncHierarchy (`<br/>`[in]BSTR bstrHierarchyID);` <br/> |
|<span data-ttu-id="eb2c9-458">**パラメーター**</span><span class="sxs-lookup"><span data-stu-id="eb2c9-458">**Parameters**</span></span> <br/> | <span data-ttu-id="eb2c9-459">_bstrHierarchyID_ &ndash; 同期対象オブジェクトの OneNote ID。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-459">_bstrHierarchyID_ &ndash; The OneNote ID of the object to be synced.</span></span>  <br/> |
   
### <a name="setfilinglocation-method"></a><span data-ttu-id="eb2c9-460">SetFilingLocation メソッド</span><span class="sxs-lookup"><span data-stu-id="eb2c9-460">SetFilingLocation method</span></span>

|||
|:-----|:-----|
|<span data-ttu-id="eb2c9-461">**説明**</span><span class="sxs-lookup"><span data-stu-id="eb2c9-461">**Description**</span></span> <br/> |<span data-ttu-id="eb2c9-462">ユーザーが OneNote で特定の種類のコンテンツを分類整理する場所と方法を指定できるようにします。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-462">Allows users to specify where and how certain types of content should be filed in OneNote.</span></span>  <br/> |
|<span data-ttu-id="eb2c9-463">**構文**</span><span class="sxs-lookup"><span data-stu-id="eb2c9-463">**Syntax**</span></span> <br/> | `HRESULT SetFilingLocation (`<br/>`[in]FilingLocation flToSet,`<br/>`[in]FilingLocationType fltToSet,`<br/>`[in]BSTR bstrFilingSectionID);`           <br/> |
|<span data-ttu-id="eb2c9-464">**パラメーター**</span><span class="sxs-lookup"><span data-stu-id="eb2c9-464">**Parameters**</span></span> <br/> | <span data-ttu-id="eb2c9-465">_flToSet_ &ndash; 設定する分類整理の場所のオブジェクトの種類。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-465">_flToSet_ &ndash; The object type of the filing location to set.</span></span>  <br/><br/><span data-ttu-id="eb2c9-466">_fltToSet_ &ndash; その種類を分類整理する場所。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-466">_fltToSet_ &ndash; The location in which to file the type.</span></span>  <br/><br/><span data-ttu-id="eb2c9-467">_bstrFilingSectionID_ &ndash; 設定する場所のセクションまたはページの OneNote ID。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-467">_bstrFilingSectionID_ &ndash; The OneNote ID of the section or page at which location you want to set.</span></span> <span data-ttu-id="eb2c9-468">該当しない場合、ユーザーは Null または空の文字列を渡すことができます。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-468">If not applicable, the user can pass in null or an empty string.</span></span>  <br/> |
   
<span data-ttu-id="eb2c9-469">分類整理できるコンテンツの種類には、Outlook アイテムおよび Internet Explorer からの Web ノートが含まれます。これらは、それぞれのアプリケーションの **[OneNote に送る]** コマンドで OneNote にインポートします。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-469">The types of content that can be filed include Outlook items and Web Notes from Internet Explorer that are imported to OneNote through the **Send to OneNote** command in each application.</span></span> <span data-ttu-id="eb2c9-470">OneNote に出力するアイテムをファイリングする場所は、このメソッドで設定することもできます。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-470">The filing location of items that are printed into OneNote can also be set with this method.</span></span> 
  
## <a name="properties"></a><span data-ttu-id="eb2c9-471">プロパティ</span><span class="sxs-lookup"><span data-stu-id="eb2c9-471">Properties</span></span>
<span data-ttu-id="eb2c9-472"><a name="ON14DevRef_Application_Properties"> </a></span><span class="sxs-lookup"><span data-stu-id="eb2c9-472"><a name="ON14DevRef_Application_Properties"> </a></span></span>

<span data-ttu-id="eb2c9-473">このセクションでは、**Application** インターフェイスのプロパティについて説明します。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-473">This section describes the properties of the **Application** interface.</span></span> 
  
|<span data-ttu-id="eb2c9-474">**Property**</span><span class="sxs-lookup"><span data-stu-id="eb2c9-474">**Property**</span></span>|<span data-ttu-id="eb2c9-475">**説明**</span><span class="sxs-lookup"><span data-stu-id="eb2c9-475">**Description**</span></span>|
|:-----|:-----|
|<span data-ttu-id="eb2c9-476">**Windows**</span><span class="sxs-lookup"><span data-stu-id="eb2c9-476">**Windows**</span></span> <br/> |<span data-ttu-id="eb2c9-477">開いている OneNote ウィンドウにユーザーがアクセスできるようにします。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-477">Gives users access to opened OneNote windows.</span></span> <span data-ttu-id="eb2c9-478">このプロパティによって、ユーザーが OneNote ウィンドウのセットを列挙して、特定のウィンドウのプロパティを変更できるようになります。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-478">This property allows users to enumerate through the set of OneNote windows and modify certain window properties.</span></span> <span data-ttu-id="eb2c9-479">詳細については、「[Windows インターフェイス](window-interfaces-onenote.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-479">For more information, see [Windows Interfaces](window-interfaces-onenote.md).</span></span>  <br/> |
|<span data-ttu-id="eb2c9-480">**COMAddIns**</span><span class="sxs-lookup"><span data-stu-id="eb2c9-480">**COMAddIns**</span></span> <br/> |<span data-ttu-id="eb2c9-481">OneNote の **COMAddIns** コレクションを返します。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-481">Returns the **COMAddIns** collection for OneNote.</span></span> <span data-ttu-id="eb2c9-482">このコレクションには、OneNote で使用可能なすべての COM アドインが含まれています。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-482">This collection contains all of the COM add-ins that are available to OneNote.</span></span> <span data-ttu-id="eb2c9-483">**COMAddins** コレクションの **Count** プロパティは、使用可能な COM アドインの数を返します。詳細については、「[COMAddIns](https://msdn.microsoft.com/library/office/ff865489.aspx) オブジェクト」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-483">The **Count** property of the **COMAddins** collection returns the number of available COM add-ins. For more information, see the [COMAddIns](https://msdn.microsoft.com/library/office/ff865489.aspx) object.</span></span>  <br/> |
|<span data-ttu-id="eb2c9-484">**LanguageSettings**</span><span class="sxs-lookup"><span data-stu-id="eb2c9-484">**LanguageSettings**</span></span> <br/> |<span data-ttu-id="eb2c9-485">OneNote の共通言語の設定を変更する一部の API にアクセスできます。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-485">Enables you to access some APIs to change the common language settings of OneNote.</span></span>  <br/> |
   
## <a name="events"></a><span data-ttu-id="eb2c9-486">イベント</span><span class="sxs-lookup"><span data-stu-id="eb2c9-486">Events</span></span>
<span data-ttu-id="eb2c9-487"><a name="ON14DevRef_Application_Events"> </a></span><span class="sxs-lookup"><span data-stu-id="eb2c9-487"><a name="ON14DevRef_Application_Events"> </a></span></span>

<span data-ttu-id="eb2c9-488">このセクションでは、Application インターフェイスのイベントについて説明します。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-488">This section describes the events of the Application interface.</span></span>
  
> [!CAUTION]
> <span data-ttu-id="eb2c9-489">現時点では、マネージ コードにイベントを追加することはできません。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-489">Events cannot currently be added in managed code.</span></span> 
  
### <a name="onnavigate-event"></a><span data-ttu-id="eb2c9-490">OnNavigate イベント</span><span class="sxs-lookup"><span data-stu-id="eb2c9-490">OnNavigate event</span></span>

|||
|:-----|:-----|
|<span data-ttu-id="eb2c9-491">**説明**</span><span class="sxs-lookup"><span data-stu-id="eb2c9-491">**Description**</span></span> <br/> |<span data-ttu-id="eb2c9-492">現在の OneNote の場所から別の場所に OneNote UI がナビゲートされたときに呼び出す関数をユーザーが割り当てできます。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-492">Allows a user to assign a function to be called when the OneNote UI is navigated away from the current OneNote location.</span></span>  <br/> |
|<span data-ttu-id="eb2c9-493">**構文**</span><span class="sxs-lookup"><span data-stu-id="eb2c9-493">**Syntax**</span></span> <br/> | `Event OnNavigate (`<br/>` );` <br/> |
   
### <a name="onhierarchychange-method"></a><span data-ttu-id="eb2c9-494">OnHierarchyChange メソッド</span><span class="sxs-lookup"><span data-stu-id="eb2c9-494">OnHierarchyChange method</span></span>

|||
|:-----|:-----|
|<span data-ttu-id="eb2c9-495">**説明**</span><span class="sxs-lookup"><span data-stu-id="eb2c9-495">**Description**</span></span> <br/> |<span data-ttu-id="eb2c9-496">OneNote 階層が変更されたとき (ページの追加時または削除時、セクションの移動時など) に必ず呼び出される関数をユーザーが割り当てできます。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-496">Allows a user to assign a function to be called any time the OneNote hierarchy changes (for example, adding or deleting pages, or moving sections).</span></span> <span data-ttu-id="eb2c9-497">階層の変更は一括処理されるため、複数の変更が同時またはほぼ同時に発生すると、OneNote はこのイベントを 1 回発せさせます。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-497">Hierarchy changes are batched, so if multiple changes occur at or near the same time, OneNote raises the event once.</span></span>  <br/> |
|<span data-ttu-id="eb2c9-498">**構文**</span><span class="sxs-lookup"><span data-stu-id="eb2c9-498">**Syntax**</span></span> <br/> | `Event OnHierarchyChange (`<br/>` BSTR bstrActivePageID);` <br/> |
|<span data-ttu-id="eb2c9-499">**パラメーター**</span><span class="sxs-lookup"><span data-stu-id="eb2c9-499">**Parameters**</span></span> <br/> | <span data-ttu-id="eb2c9-500">_bstrActivePageID_ &ndash; アクティブなページの OneNote ID を渡します。</span><span class="sxs-lookup"><span data-stu-id="eb2c9-500">_bstrActivePageID_ &ndash; Passes the OneNote ID of the active page.</span></span>  <br/> |
   
## <a name="see-also"></a><span data-ttu-id="eb2c9-501">関連項目</span><span class="sxs-lookup"><span data-stu-id="eb2c9-501">See also</span></span>

- [<span data-ttu-id="eb2c9-502">OneNote 開発者用リファレンス</span><span class="sxs-lookup"><span data-stu-id="eb2c9-502">OneNote developer reference</span></span>](onenote-developer-reference.md)

