---
title: Recordset オブジェクト (ADO)
TOCTitle: Recordset object (ADO)
ms:assetid: 0f963bf8-f066-dc8a-b754-f427de712df1
ms:mtpsurl: https://msdn.microsoft.com/library/JJ248865(v=office.15)
ms:contentKeyID: 48543267
ms.date: 09/18/2015
mtps_version: v=office.15
localization_priority: Normal
ms.openlocfilehash: 636681cf8e0c20f078387b21974141a9cb66cfcd
ms.sourcegitcommit: d6695c94415fa47952ee7961a69660abc0904434
ms.translationtype: Auto
ms.contentlocale: ja-JP
ms.lasthandoff: 01/17/2019
ms.locfileid: "28719996"
---
# <a name="recordset-object-ado"></a><span data-ttu-id="5471e-102">Recordset オブジェクト (ADO)</span><span class="sxs-lookup"><span data-stu-id="5471e-102">Recordset object (ADO)</span></span>

<span data-ttu-id="5471e-103">**適用されます**Access 2013、Office 2013。</span><span class="sxs-lookup"><span data-stu-id="5471e-103">**Applies to**: Access 2013, Office 2013</span></span>

<span data-ttu-id="5471e-p101">基になるテーブルのレコードセット全体、またはコマンドの実行によって返された結果を表します。 **Recordset** オブジェクトでは、常にレコードセット内の 1 つのレコードのみをカレント レコードとして参照します。</span><span class="sxs-lookup"><span data-stu-id="5471e-p101">Represents the entire set of records from a base table or the results of an executed command. At any time, the **Recordset** object refers to only a single record within the set as the current record.</span></span>

## <a name="remarks"></a><span data-ttu-id="5471e-106">備考</span><span class="sxs-lookup"><span data-stu-id="5471e-106">Remarks</span></span>

<span data-ttu-id="5471e-p102">プロバイダーのデータを操作するには、 **Recordset** オブジェクトを使用します。ADO を使用する場合は、 **Recordset** オブジェクトを使用してほぼすべてのデータを操作します。すべての **Recordset** オブジェクトは、レコード (行) とフィールド (列) から構成されています。プロバイダーがサポートする機能によっては、一部の **Recordset** のメソッドまたはプロパティを使用できない場合があります。</span><span class="sxs-lookup"><span data-stu-id="5471e-p102">You use **Recordset** objects to manipulate data from a provider. When you use ADO, you manipulate data almost entirely using **Recordset** objects. All **Recordset** objects consist of records (rows) and fields (columns). Depending on the functionality supported by the provider, some **Recordset** methods or properties may not be available.</span></span>

<span data-ttu-id="5471e-p103">ADODB.Recordset は、 **Recordset** オブジェクトの作成時に使用する ProgID です。古くなった ADOR.Recordset ProgID を参照する既存のアプリケーションは、再コンパイルせずそのまま使用できますが、新たに開発するアプリケーションは、ADODB.Recordset を参照する必要があります。</span><span class="sxs-lookup"><span data-stu-id="5471e-p103">ADODB.Recordset is the ProgID that should be used to create a **Recordset** object. Existing applications that reference the outdated ADOR.Recordset ProgID will continue to work without recompiling, but new development should reference ADODB.Recordset.</span></span>

<span data-ttu-id="5471e-113">ADO では、次の 4 種類のカーソルが定義されています。</span><span class="sxs-lookup"><span data-stu-id="5471e-113">There are four different cursor types defined in ADO:</span></span>

  - <span data-ttu-id="5471e-114">**動的カーソル**: 他のユーザーによる追加、変更、および削除を表示でき、ブックマークに依存しない **Recordset** 内でのすべての種類の移動が可能で、プロバイダーがブックマークをサポートしている場合にブックマークを許可します。</span><span class="sxs-lookup"><span data-stu-id="5471e-114">**Dynamic cursor** — allows you to view additions, changes, and deletions by other users; allows all types of movement through the **Recordset** that doesn't rely on bookmarks; and allows bookmarks if the provider supports them.</span></span>

  - <span data-ttu-id="5471e-p104">**キーセット カーソル**: 他のユーザーが追加したレコードを表示できない点と、他のユーザーが削除したレコードにアクセスできない点を除けば、動的カーソルと同様に動作します。他のユーザーが変更したデータは表示できます。常にブックマークをサポートするため、 **Recordset** 内でのすべての種類の移動が可能です。</span><span class="sxs-lookup"><span data-stu-id="5471e-p104">**Keyset cursor** — behaves like a dynamic cursor, except that it prevents you from seeing records that other users add, and prevents access to records that other users delete. Data changes by other users will still be visible. It always supports bookmarks and therefore allows all types of movement through the **Recordset**.</span></span>

  - <span data-ttu-id="5471e-p105">**静的カーソル**: データの検索やレポートの生成に使用できるレコードのセットの静的コピーを提供します。常にブックマークを許可するため、 **Recordset** 内でのすべての種類の移動が可能です。他のユーザーによる追加、変更、または削除は表示されません。これは、クライアント側 **Recordset** オブジェクトを開いたときに許可されるただ 1 種類のカーソルです。</span><span class="sxs-lookup"><span data-stu-id="5471e-p105">**Static cursor** — provides a static copy of a set of records for you to use to find data or generate reports; always allows bookmarks and therefore allows all types of movement through the **Recordset**. Additions, changes, or deletions by other users will not be visible. This is the only type of cursor allowed when you open a client-side **Recordset** object.</span></span>

  - <span data-ttu-id="5471e-p106">**前方スクロール カーソル**: **Recordset** 内で前方向のスクロールのみ許可します。他のユーザーによる追加、変更、または削除は表示されません。 **Recordset** のスクロールが 1 回だけで十分な場合は、これによってパフォーマンスを向上できます。</span><span class="sxs-lookup"><span data-stu-id="5471e-p106">**Forward-only cursor** — allows you to only scroll forward through the **Recordset**. Additions, changes, or deletions by other users will not be visible. This improves performance in situations where you need to make only a single pass through a **Recordset**.</span></span>

<span data-ttu-id="5471e-124">カーソルの種類を選択する**レコード セット**を開く前に[CursorType](cursortype-property-ado.md)プロパティを設定するか、 [Open](open-method-ado-recordset.md)メソッドを使用して*CursorType*引数を渡します。</span><span class="sxs-lookup"><span data-stu-id="5471e-124">Set the [CursorType](cursortype-property-ado.md) property prior to opening the **Recordset** to choose the cursor type, or pass a *CursorType* argument with the [Open](open-method-ado-recordset.md) method.</span></span> <span data-ttu-id="5471e-125">プロバイダーによっては、カーソルのすべての種類をサポートしていないものもあります。</span><span class="sxs-lookup"><span data-stu-id="5471e-125">Some providers don't support all cursor types.</span></span> <span data-ttu-id="5471e-126">プロバイダーのマニュアルを確認してください。</span><span class="sxs-lookup"><span data-stu-id="5471e-126">Check the documentation for the provider.</span></span> <span data-ttu-id="5471e-127">カーソルの種類を指定しない場合、ADO では既定で前方スクロール カーソルが開かれます。</span><span class="sxs-lookup"><span data-stu-id="5471e-127">If you don't specify a cursor type, ADO opens a forward-only cursor by default.</span></span>

<span data-ttu-id="5471e-p108">[CursorLocation](cursorlocation-property-ado.md) プロパティを **adUseClient** に設定して **Recordset** を開く場合、 **Field** オブジェクトの [UnderlyingValue](field-object-ado.md) プロパティは、返された **Recordset** オブジェクトでは使用できません。一部のプロバイダーと共に使用すると (たとえば、Microsoft ODBC Provider for OLE DB を Microsoft SQL Server と組み合わせて)、 **Open** メソッドで接続文字列を渡すことによって、 [Recordset](connection-object-ado.md) オブジェクトを前に定義した **Connection** オブジェクトと無関係に作成できます。ADO は、この場合も [Connection](connection-object-ado.md) オブジェクトを作成しますが、このオブジェクトをオブジェクト変数に割り当てることはありません。ただし、同じ接続上で複数の **Recordset** オブジェクトを開く場合、明示的に **Connection** オブジェクトを作成して開く必要があります。こうすることで、 **Connection** オブジェクトがオブジェクト変数に割り当てられます。 **Recordset** オブジェクトを開くときにこのオブジェクト変数を使用しなかった場合、同じ接続文字列を渡しても、ADO によって新しい各 **Recordset** に新しい **Connection** オブジェクトが作成されます。</span><span class="sxs-lookup"><span data-stu-id="5471e-p108">If the [CursorLocation](cursorlocation-property-ado.md) property is set to **adUseClient** to open a **Recordset**, the **UnderlyingValue** property on [Field](field-object-ado.md) objects is not available in the returned **Recordset** object. When used with some providers (such as the Microsoft ODBC Provider for OLE DB in conjunction with Microsoft SQL Server), you can create **Recordset** objects independently of a previously defined [Connection](connection-object-ado.md) object by passing a connection string with the **Open** method. ADO still creates a [Connection](connection-object-ado.md) object, but it doesn't assign that object to an object variable. However, if you are opening multiple **Recordset** objects over the same connection, you should explicitly create and open a **Connection** object; this assigns the **Connection** object to an object variable. If you do not use this object variable when opening your **Recordset** objects, ADO creates a new **Connection** object for each new **Recordset**, even if you pass the same connection string.</span></span>

<span data-ttu-id="5471e-133">**Recordset** オブジェクトは必要な数だけ作成できます。</span><span class="sxs-lookup"><span data-stu-id="5471e-133">You can create as many **Recordset** objects as needed.</span></span>

<span data-ttu-id="5471e-p109">**Recordset** を開くと、カレント レコードは最初のレコード (ある場合) の位置に置かれ、 [BOF](bof-eof-properties-ado.md) プロパティと [EOF](bof-eof-properties-ado.md) プロパティは **False** に設定されます。レコードがない場合、 **BOF** プロパティと **EOF** プロパティの設定値は **True** になります。</span><span class="sxs-lookup"><span data-stu-id="5471e-p109">When you open a **Recordset**, the current record is positioned to the first record (if any) and the [BOF](bof-eof-properties-ado.md) and [EOF](bof-eof-properties-ado.md) properties are set to **False**. If there are no records, the **BOF** and **EOF** property settings are **True**.</span></span>

<span data-ttu-id="5471e-p110">[MoveFirst](movefirst-movelast-movenext-and-moveprevious-methods-ado.md)、**MoveLast**、**MoveNext** と **MovePrevious** の各メソッド、[Move](move-method-ado.md) メソッド、および [AbsolutePosition](absoluteposition-property-ado.md)、[AbsolutePage](absolutepage-property-ado.md) と [Filter](filter-property-ado.md) の各プロパティを使用すると、プロバイダーが関連する機能をサポートしているものとして、カレント レコードの位置を変更できます。前方スクロール タイプの **Recordset** オブジェクトは、[MoveNext](movefirst-movelast-movenext-and-moveprevious-methods-ado.md) メソッドのみをサポートします。**Move** メソッドを使用して各レコードに移動 (または **Recordset** を列挙) する場合、**BOF** プロパティと **EOF** プロパティを使用すると、**Recordset** の範囲を超えたかどうかを確認できます。</span><span class="sxs-lookup"><span data-stu-id="5471e-p110">You can use the [MoveFirst](movefirst-movelast-movenext-and-moveprevious-methods-ado.md), **MoveLast**, **MoveNext**, and **MovePrevious** methods; the [Move](move-method-ado.md) method; and the [AbsolutePosition](absoluteposition-property-ado.md), [AbsolutePage](absolutepage-property-ado.md), and [Filter](filter-property-ado.md) properties to reposition the current record, assuming the provider supports the relevant functionality. Forward-only **Recordset** objects support only the [MoveNext](movefirst-movelast-movenext-and-moveprevious-methods-ado.md) method. When you use the **Move** methods to visit each record (or enumerate the **Recordset**), you can use the **BOF** and **EOF** properties to determine if you've moved beyond the beginning or end of the **Recordset**.</span></span>

<span data-ttu-id="5471e-p111">**Recordset** オブジェクトは、イミディエイト更新とバッチ更新の 2 種類の更新をサポートできます。イミディエイト更新では、 [Update](update-method-ado.md) メソッドを呼び出すと、データに対するすべての変更が直ちに基になるデータ ソースに書き込まれます。また、 [AddNew](addnew-method-ado.md) メソッドと **Update** メソッドを使用して、値の配列をパラメーターとして渡し、レコード内の複数のフィールドを同時に更新することもできます。</span><span class="sxs-lookup"><span data-stu-id="5471e-p111">**Recordset** objects can support two types of updating: immediate and batched. In immediate updating, all changes to data are written immediately to the underlying data source once you call the [Update](update-method-ado.md) method. You can also pass arrays of values as parameters with the [AddNew](addnew-method-ado.md) and **Update** methods and simultaneously update several fields in a record.</span></span>

<span data-ttu-id="5471e-p112">プロバイダーがバッチ更新をサポートしている場合は、プロバイダーによって複数のレコードに対する変更をキャッシュしてから、[UpdateBatch](updatebatch-method-ado.md) メソッドを使用して、データベースを一度呼び出すだけで変更内容をまとめて転送できます。この操作は、 **AddNew** 、 **Update** 、および [Delete](delete-method-ado-recordset.md) の各メソッドを使用して変更を行った場合に適用されます。 **UpdateBatch** メソッドの呼び出し後、 [Status](status-property-ado-recordset.md) プロパティを使用すると、データの競合があるかどうかを確認して解決できます。</span><span class="sxs-lookup"><span data-stu-id="5471e-p112">If a provider supports batch updating, you can have the provider cache changes to more than one record and then transmit them in a single call to the database with the [UpdateBatch](updatebatch-method-ado.md) method. This applies to changes made with the **AddNew**, **Update**, and [Delete](delete-method-ado-recordset.md) methods. After you call the **UpdateBatch** method, you can use the [Status](status-property-ado-recordset.md) property to check for any data conflicts in order to resolve them.</span></span>

> [!NOTE]
> <span data-ttu-id="5471e-p113">[!メモ] [Command](command-object-ado.md) オブジェクトを使用せずにクエリを実行するには、クエリ文字列を **Recordset** オブジェクトの **Open** メソッドに渡します。ただし、コマンド テキストを永続化して再実行するか、クエリ パラメーターを使用する場合は、 **Command** オブジェクトが必要となります。</span><span class="sxs-lookup"><span data-stu-id="5471e-p113">To execute a query without using a [Command](command-object-ado.md) object, pass a query string to the **Open** method of a **Recordset** object. However, a **Command** object is required when you want to persist the command text and re-execute it, or use query parameters.</span></span>

<span data-ttu-id="5471e-147">[Mode](mode-property-ado.md) プロパティは、アクセス権限を制御します。</span><span class="sxs-lookup"><span data-stu-id="5471e-147">The [Mode](mode-property-ado.md) property governs access permissions.</span></span>

<span data-ttu-id="5471e-p114">**Fields** コレクションは **Recordset** オブジェクトの既定のメンバーです。結果として、次の 2 つのコード ステートメントは同じになります。</span><span class="sxs-lookup"><span data-stu-id="5471e-p114">The **Fields** collection is the default member of the **Recordset** object. As a result, the following two code statements are equivalent.</span></span>

```vb
    Debug.Print objRs.Fields.Item(0)  ' Both statements print 
    Debug.Print objRs(0)              '  the Value of Item(0).
```
