---
title: HelloData details (Access デスクトップデータベースリファレンス)
TOCTitle: HelloData details
ms:assetid: db51e15c-1b5b-c64a-2f84-34dd0e78c6cf
ms:mtpsurl: https://msdn.microsoft.com/library/JJ250105(v=office.15)
ms:contentKeyID: 48548103
ms.date: 09/18/2015
mtps_version: v=office.15
localization_priority: Normal
ms.openlocfilehash: 78b04b74d4e2b8d9c215235d6e7ccebed4fa2ef2
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/23/2019
ms.locfileid: "32292000"
---
# <a name="hellodata-details"></a><span data-ttu-id="7ff16-102">HelloData の詳細</span><span class="sxs-lookup"><span data-stu-id="7ff16-102">HelloData details</span></span>


<span data-ttu-id="7ff16-103">**適用先:** Access 2013、Office 2013</span><span class="sxs-lookup"><span data-stu-id="7ff16-103">**Applies to**: Access 2013, Office 2013</span></span>

<span data-ttu-id="7ff16-p101">The HelloData application steps through the basic operations of a typical ADO application: getting, examining, editing, and updating data. When you start the application, click the first button, **Get Data**. This will run the GetData() subroutine.</span><span class="sxs-lookup"><span data-stu-id="7ff16-p101">The HelloData application steps through the basic operations of a typical ADO application: getting, examining, editing, and updating data. When you start the application, click the first button, **Get Data**. This will run the GetData() subroutine.</span></span>

## <a name="getdata"></a><span data-ttu-id="7ff16-107">GetData</span><span class="sxs-lookup"><span data-stu-id="7ff16-107">GetData</span></span>

<span data-ttu-id="7ff16-108">GetData は、有効な接続文字列をモジュールレベルの変数*m\_sconnstr*に格納します。</span><span class="sxs-lookup"><span data-stu-id="7ff16-108">GetData places a valid connection string into a module-level variable, *m\_sConnStr*.</span></span> <span data-ttu-id="7ff16-109">接続文字列の詳細については、「 [接続文字列を作成する](creating-the-connection-string.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="7ff16-109">For more information about connection strings, see [Creating the Connection String](creating-the-connection-string.md).</span></span>

<span data-ttu-id="7ff16-110">Assign an error handler using a Visual Basic **OnError** statement.</span><span class="sxs-lookup"><span data-stu-id="7ff16-110">Assign an error handler using a Visual Basic **OnError** statement.</span></span> <span data-ttu-id="7ff16-111">For more information about error handling in ADO, see [Chapter 6: Error Handling](chapter-6-error-handling.md).</span><span class="sxs-lookup"><span data-stu-id="7ff16-111">For more information about error handling in ADO, see [Chapter 6: Error Handling](chapter-6-error-handling.md).</span></span> <span data-ttu-id="7ff16-112">新しい**Connection**オブジェクトが作成され、HelloData \*\*\*\* の例では切断された*Recordset*が作成されるので、このプロパティは**adUseClient**に設定されています。</span><span class="sxs-lookup"><span data-stu-id="7ff16-112">A new **Connection** object is created, and the **CursorLocation** property is set to **adUseClient** because the HelloData example creates a *disconnected Recordset*.</span></span> <span data-ttu-id="7ff16-113">This means that once the data has been fetched from the data source, the physical connection with the data source is broken, but you can still work with the data that is cached locally in your **Recordset** object.</span><span class="sxs-lookup"><span data-stu-id="7ff16-113">This means that once the data has been fetched from the data source, the physical connection with the data source is broken, but you can still work with the data that is cached locally in your **Recordset** object.</span></span>

<span data-ttu-id="7ff16-114">接続後、SQL 文字列を変数 (sSQL) に割り当てます。</span><span class="sxs-lookup"><span data-stu-id="7ff16-114">After the connection has been opened, assign a SQL string to a variable (sSQL).</span></span> <span data-ttu-id="7ff16-115">その後、新しい**Recordset**オブジェクト m\_oRecordset1 をインスタンス化します。</span><span class="sxs-lookup"><span data-stu-id="7ff16-115">Then instantiate a new **Recordset** object, m\_oRecordset1 .</span></span> <span data-ttu-id="7ff16-116">次のコード行で、既存の**接続**を介して**Recordset**を開き、を渡します。</span><span class="sxs-lookup"><span data-stu-id="7ff16-116">In the next line of code, open the **Recordset** over the existing **Connection**, passing in .</span></span> <span data-ttu-id="7ff16-117">コードの次の行で、既存の**接続**を介して**recordset**を開き、 **recordset**のソースとして ssql を渡します。</span><span class="sxs-lookup"><span data-stu-id="7ff16-117">In the next line of code, open the **Recordset** over the existing **Connection**, passing in sSQL as the source of the **Recordset**.</span></span> <span data-ttu-id="7ff16-118">You assist ADO in making the determination that the SQL string you have passed as the source for the **Recordset** is a textual definition of a command by passing **adCmdText** in the final argument to the **Recordset** **Open** method.</span><span class="sxs-lookup"><span data-stu-id="7ff16-118">You assist ADO in making the determination that the SQL string you have passed as the source for the **Recordset** is a textual definition of a command by passing **adCmdText** in the final argument to the **Recordset** **Open** method.</span></span> <span data-ttu-id="7ff16-119">This line also sets the **LockType** and **CursorType** associated with the **Recordset**.</span><span class="sxs-lookup"><span data-stu-id="7ff16-119">This line also sets the **LockType** and **CursorType** associated with the **Recordset**.</span></span>

<span data-ttu-id="7ff16-120">次の行のコードでは、 **MarshalOptions** プロパティを **adMarshalModifiedOnly** に設定します。</span><span class="sxs-lookup"><span data-stu-id="7ff16-120">The next line of code sets the **MarshalOptions** property equal to **adMarshalModifiedOnly**.</span></span> <span data-ttu-id="7ff16-121">**marshaloptions**は、中間層 (または web サーバー) にマーシャリングするレコードを示します。</span><span class="sxs-lookup"><span data-stu-id="7ff16-121">**MarshalOptions** indicates which records should be marshaled to the middle tier (or web server).</span></span> <span data-ttu-id="7ff16-122">マーシャリングの詳細については、COM のマニュアルを参照してください。</span><span class="sxs-lookup"><span data-stu-id="7ff16-122">For more information about marshaling, see the COM documentation.</span></span> <span data-ttu-id="7ff16-123">クライアント側カーソル ([cursor location](cursorlocation-property-ado.md) = **adUseClient**) で**adMarshalModifiedOnly**を使用する場合、クライアント上で変更されたレコードのみが中間層に書き戻されます。</span><span class="sxs-lookup"><span data-stu-id="7ff16-123">When using **adMarshalModifiedOnly** with a client-side cursor ([CursorLocation](cursorlocation-property-ado.md) = **adUseClient**), only records that have been modified on the client are written back to the middle tier.</span></span> <span data-ttu-id="7ff16-124">**MarshalOptions** を **adMarshalModifiedOnly** に設定すると、マーシャリングされる行が少なくなり、パフォーマンスが向上する場合があります。</span><span class="sxs-lookup"><span data-stu-id="7ff16-124">Setting **MarshalOptions** to **adMarshalModifiedOnly** can improve performance because fewer rows are marshaled.</span></span>

<span data-ttu-id="7ff16-p106">次に、 **ActiveConnection** プロパティを **Nothing** に設定して **Recordset** を切断します。詳細については、「5 章: データを更新し、保存する」の「 [レコードセットを切断し、再接続する](disconnecting-and-reconnecting-the-recordset.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="7ff16-p106">Next, disconnect the **Recordset** by setting its **ActiveConnection** property equal to **Nothing**. For more information, see [Disconnecting and Reconnecting the Recordset](disconnecting-and-reconnecting-the-recordset.md) in Chapter 5: Updating and Persisting Data.</span></span>

<span data-ttu-id="7ff16-127">データ ソースへの接続を閉じ、既存の **Connection** オブジェクトを破棄して、使用していたリソースを解放します。</span><span class="sxs-lookup"><span data-stu-id="7ff16-127">Close the connection to the data source and destroy the existing **Connection** object, thereby releasing the resources it consumed.</span></span>

<span data-ttu-id="7ff16-128">最後に、フォーム上で Microsoft DataBound Grid Control の **DataSource** として **Recordset** を設定し、 **Recordset** のデータをフォームに簡単に表示できるようにします。</span><span class="sxs-lookup"><span data-stu-id="7ff16-128">The final step is to set the **Recordset** as the **DataSource** for the Microsoft DataBound Grid Control on the form so that you can easily display the data from the **Recordset** on the form.</span></span>

<span data-ttu-id="7ff16-p107">Click the second button, **Examine Data**. This runs the ExamineData subroutine.</span><span class="sxs-lookup"><span data-stu-id="7ff16-p107">Click the second button, **Examine Data**. This runs the ExamineData subroutine.</span></span>

## <a name="examinedata"></a><span data-ttu-id="7ff16-131">ExamineData</span><span class="sxs-lookup"><span data-stu-id="7ff16-131">ExamineData</span></span>

<span data-ttu-id="7ff16-p108">ExamineData では、**Recordset** オブジェクトのさまざまなメソッドやプロパティを使用して、**Recordset** のデータに関する情報を表示します。**RecordCount** プロパティを使用してレコード数を表示します。**Recordset** をループ処理し、フォームの表示テキスト ボックスに **AbsolutePosition** プロパティの値を表示します。また、ループ処理中に、3 番目のレコードの **Bookmark** プロパティの値が、後で使用するために、バリアント型の変数 *vBookmark* に配置されます。</span><span class="sxs-lookup"><span data-stu-id="7ff16-p108">ExamineData uses various methods and properties of the **Recordset** object to display information about the data in the **Recordset**. It reports the number of records by using the **RecordCount** property. It loops through the **Recordset** and prints the value of the **AbsolutePosition** property in the display text box on the form. Also while in the loop, the value of the **Bookmark** property for the third record is placed into a variant variable, *vBookmark*, for later use.</span></span>

<span data-ttu-id="7ff16-p109">ルーチンの処理は、前に格納されたブックマーク変数を使用して、直接 3 番目のレコードに戻ります。WalkFields サブルーチンを呼び出して、 **Recordset** の **Fields** コレクションをループ処理し、コレクション内の各 **Field** の詳細を表示します。</span><span class="sxs-lookup"><span data-stu-id="7ff16-p109">The routine navigates directly back to the third record using the bookmark variable that it stored earlier. The routine calls the WalkFields subroutine, which loops through the **Fields** collection of the **Recordset** and displays details about each **Field** in the collection.</span></span>

<span data-ttu-id="7ff16-p110">最後に、ExamineData は **Recordset** の **Filter** プロパティを使用して、CategoryId が 2 のレコードのみを表示します。このフィルターを適用した結果は、フォームの表示グリッドですぐに確認できます。</span><span class="sxs-lookup"><span data-stu-id="7ff16-p110">Finally, ExamineData uses the **Filter** property of the **Recordset** to screen for only those records with a CategoryId equal to 2. The result of applying this filter is immediately visible in the display grid on the form.</span></span>

<span data-ttu-id="7ff16-140">ExamineData サブルーチンで使用されている機能の詳細については、「[3 章: データを調べる](chapter-3-examining-data.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="7ff16-140">For more information about the functionality shown in the ExamineData subroutine, see [Chapter 3: Examining Data](chapter-3-examining-data.md).</span></span>

<span data-ttu-id="7ff16-p111">Next, click the third button, **Edit Data**. This will run the EditData subroutine.</span><span class="sxs-lookup"><span data-stu-id="7ff16-p111">Next, click the third button, **Edit Data**. This will run the EditData subroutine.</span></span>

## <a name="editdata"></a><span data-ttu-id="7ff16-143">EditData</span><span class="sxs-lookup"><span data-stu-id="7ff16-143">EditData</span></span>

<span data-ttu-id="7ff16-p112">EditData サブルーチンが実行されるときも、 **Recordset** には CategoryId が 2 というフィルターが適用されたままなので、フィルター条件を満たす項目だけが表示されます。まず、 **Recordset** をループ処理し、 **Recordset** の表示項目の価格を 10% ずつ増やします。 **Price** フィールドの値を変更するには、そのフィールドの **Value** プロパティを新しい有効な金額に設定します。</span><span class="sxs-lookup"><span data-stu-id="7ff16-p112">When the code enters the EditData subroutine, the **Recordset** is still filtered on CategoryId equal to 2, so only those items that meet the filter criteria are visible. It first loops through the **Recordset** and increases the price of each visible item in the **Recordset** by 10 percent. The value of the **Price** field is changed by setting the **Value** property for that field equal to a new, valid amount.</span></span>

<span data-ttu-id="7ff16-p113">**Recordset** はデータ ソースからは切断されています。EditData による変更は、ローカルにキャッシュされたデータのコピーにのみ適用されます。詳細については、「 [4 章: データを編集する](chapter-4-editing-data.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="7ff16-p113">Remember that the **Recordset** is disconnected from the data source. The changes made in EditData are made only to the locally cached copy of the data. For more information, see [Chapter 4: Editing Data](chapter-4-editing-data.md).</span></span>

<span data-ttu-id="7ff16-p114">The changes will not be made on the data source until you click the fourth button, **Update Data**. This will run the UpdateData subroutine.</span><span class="sxs-lookup"><span data-stu-id="7ff16-p114">The changes will not be made on the data source until you click the fourth button, **Update Data**. This will run the UpdateData subroutine.</span></span>

## <a name="updatedata"></a><span data-ttu-id="7ff16-152">UpdateData</span><span class="sxs-lookup"><span data-stu-id="7ff16-152">UpdateData</span></span>

<span data-ttu-id="7ff16-153">UpdateData は、まず **Recordset** に適用されたフィルターを削除します。</span><span class="sxs-lookup"><span data-stu-id="7ff16-153">UpdateData first removes the filter that has been applied to the **Recordset**.</span></span> <span data-ttu-id="7ff16-154">このコードは、フィルターを使用しない**Recordset**がグリッドに表示されるように、フォーム上の Microsoft Bound DataGrid の**DataSource**として削除およびリセットします。</span><span class="sxs-lookup"><span data-stu-id="7ff16-154">The code removes and resets as the **DataSource** for the Microsoft Bound DataGrid on the form so that the unfiltered **Recordset** appears in the grid.</span></span>

<span data-ttu-id="7ff16-155">次に、 **adMovePrevious** 引数を持つ **Supports** メソッドを使用して、 **Recordset** 内で後方へ移動できるかどうかを確認します。</span><span class="sxs-lookup"><span data-stu-id="7ff16-155">The code then checks to see whether you can move backward in the **Recordset** by using the **Supports** method with the **adMovePrevious** argument.</span></span>

<span data-ttu-id="7ff16-p116">ルーチンは **MoveFirst** メソッドを使用して最初のレコードに移動し、 **Field** オブジェクトの **OriginalValue** プロパティと **Value** プロパティを使用して、フィールドの元の値と現在の値を表示します。これらのプロパティと **UnderlyingValue** プロパティ (ここでは使用しません) については、「 [5 章: データを更新し、保存する](chapter-5-updating-and-persisting-data.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="7ff16-p116">The routine moves to the first record using the **MoveFirst** method and displays the field's original and current values, using the **OriginalValue** and **Value** properties of the **Field** object. These properties, along with the **UnderlyingValue** property (not used here), are discussed in [Chapter 5: Updating and Persisting Data](chapter-5-updating-and-persisting-data.md).</span></span>

<span data-ttu-id="7ff16-p117">次に、新しい **Connection** オブジェクトが作成され、このオブジェクトを使用してデータ ソースへの接続が再確立されます。 **Recordset** をデータ ソースに再接続するには、新しい **Connection** を **Recordset** の **ActiveConnection** として設定します。更新内容をサーバーに送信するために、 **Recordset** の **UpdateBatch** を呼び出します。</span><span class="sxs-lookup"><span data-stu-id="7ff16-p117">Next, a new **Connection** object is created and used to reestablish a connection to the data source. You reconnect the **Recordset** to the data source by setting the new **Connection** as the **ActiveConnection** for the **Recordset**. To send the updates to the server, the code calls **UpdateBatch** on the **Recordset**.</span></span>

<span data-ttu-id="7ff16-161">バッチ更新が正常に終了すると、モジュールレベルのフラグ変数が True に設定されます。</span><span class="sxs-lookup"><span data-stu-id="7ff16-161">If the batch update succeeds, a module-level flag variable, , is set to True.</span></span> <span data-ttu-id="7ff16-162">これは、データベースに対して行ったすべての変更を後で取り消すための目印になります。</span><span class="sxs-lookup"><span data-stu-id="7ff16-162">This will remind you later to clean up all changes made to the database.</span></span>

<span data-ttu-id="7ff16-p119">最後に、 **Recordset** 内の最初のレコードに戻り、元の値と現在の値を表示します。値は、 **UpdateBatch** を呼び出した後と同じです。</span><span class="sxs-lookup"><span data-stu-id="7ff16-p119">Finally, the code moves back to the first record in the **Recordset** and displays the original and current values. The values are the same after the call to **UpdateBatch**.</span></span>

<span data-ttu-id="7ff16-165">**Recordset** の切断中にサーバーのデータが変更された場合の対処など、データの更新の詳細については、「 [5 章: データを更新し、保存する](chapter-5-updating-and-persisting-data.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="7ff16-165">For more detailed information about updating data, including what to do when data on the server changes while your **Recordset** is disconnected, see [Chapter 5: Updating and Persisting Data](chapter-5-updating-and-persisting-data.md).</span></span>

## <a name="formunload"></a><span data-ttu-id="7ff16-166">フォーム\_のアンロード</span><span class="sxs-lookup"><span data-stu-id="7ff16-166">Form\_Unload</span></span>

<span data-ttu-id="7ff16-167">Form\_Unload サブルーチンは、いくつかの理由から重要です。</span><span class="sxs-lookup"><span data-stu-id="7ff16-167">The Form\_Unload subroutine is important for several reasons.</span></span> <span data-ttu-id="7ff16-168">最初に、これはサンプルアプリケーションなので\_、フォームのアンロードでは、アプリケーションが終了する前にデータベースに加えられた変更がクリーンアップされます。</span><span class="sxs-lookup"><span data-stu-id="7ff16-168">First, because this is a sample application, Form\_Unload cleans up the changes made to the database before the application exits.</span></span> <span data-ttu-id="7ff16-169">次に、開いている **Connection** オブジェクトから **Execute** メソッドを使用してコマンドを直接実行する方法を示していることです。</span><span class="sxs-lookup"><span data-stu-id="7ff16-169">Second, the code shows how a command can be executed directly from an open **Connection** object using the **Execute** method.</span></span> <span data-ttu-id="7ff16-170">最後に、データ ソースに対して行を返さないクエリ (UPDATE クエリ) を実行する例を示していることです。</span><span class="sxs-lookup"><span data-stu-id="7ff16-170">Finally, it shows an example of executing a non-row–returning query (an UPDATE query) against the data source.</span></span>

