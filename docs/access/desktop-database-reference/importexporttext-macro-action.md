---
title: ImportExportText マクロ アクション
TOCTitle: ImportExportText Macro Action
ms:assetid: 366fa095-6f09-7c22-e734-bfa585cfe79e
ms:mtpsurl: https://msdn.microsoft.com/library/Ff192475(v=office.15)
ms:contentKeyID: 48544171
ms.date: 09/18/2015
mtps_version: v=office.15
f1_keywords:
- vbaac10.chm168097
f1_categories:
- Office.Version=v15
ms.openlocfilehash: 5ded11512def101bc27dfb843d2315f9f4105fb5
ms.sourcegitcommit: c557bbcccf37a6011f89aae1ddd399dfe549d087
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 11/01/2018
ms.locfileid: "25891227"
---
# <a name="importexporttext-macro-action"></a>ImportExportText マクロ アクション

**適用されます**Access 2013、Office 2013。

**ImportExportText**アクションは、インポートまたはエクスポートする現在の Microsoft Access データベース (.mdb または .accdb) または Access プロジェクト (.adp) とテキスト ファイルの間のテキストを使用できます。 現在の Access データベースにテキスト ファイル内のデータをリンクすることもできます。 リンクしたテキスト ファイルをアクセスを許可する完全なデータをワード プロセッシング プログラムの中に Access でテキスト データを表示できます。 インポート、エクスポート、およびリンクできますテーブルまたは HTML ファイル内のリストに (\*.html)。

> [!NOTE]
> テキスト ファイルまたは HTML ファイルのデータにリンクする場合、Access ではデータが読み取り専用になります。
> 
> [!メモ] データベースが信頼されていない場合、このアクションは許可されません。 

## <a name="setting"></a>設定

**ImportExportText** アクションの引数は次のとおりです。

<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th><p>アクションの引数</p></th>
<th><p>説明</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p><strong>Transfer Type/変換の種類</strong></p></td>
<td><p>変換の種類を指定します。 インポート、エクスポート、または区切り記号付きまたは固定長テキスト ファイルまたは HTML ファイルのデータにリンクできます。 定型書簡や宛名ラベルなどの差し込み文書を作成するのには Word の差し込み印刷機能を使用することができます、Microsoft Word の差し込み印刷のデータ ファイルにデータをエクスポートすることもできます。 <strong>インポートの区切り</strong><strong>インポートの幅を固定する</strong>、 <strong>HTML をインポート</strong>、<strong>区切り記号付きエクスポート</strong>、<strong>固定長エクスポート</strong> <strong>HTML をエクスポートする</strong>、 <strong>Windows の印刷用の Word にエクスポート</strong><strong>リンクの区切り</strong>を、選択して<strong>のリンクの幅を固定します。</strong>、または [マクロ ビルダー] ウィンドウの [<strong>転送の種類</strong>] ボックス、[<strong>アクションの引数</strong>] セクションで [<strong>リンクの HTML</strong>です。 既定では、<strong>インポートの区切りです</strong>。</p>

> [!NOTE]
> <P>Access プロジェクト (.adp) でサポートされている変換の種類は、[<STRONG>区切り記号付きインポート</STRONG>]、[<STRONG>固定長インポート</STRONG>]、[<STRONG>区切り記号付きエクスポート</STRONG>]、[<STRONG>固定長エクスポート</STRONG>]、または [<STRONG>Word 差し込みデータ エクスポート</STRONG>] だけです。</P>


<p></p></td>
</tr>
<tr class="even">
<td><p><strong>Specification Name/定義名</strong></p></td>
<td><p>テキスト ファイルをインポートまたはリンクする方法を決定するオプション セットの定義名を指定します。固定幅テキスト ファイルの場合、引数を指定するか、インポートまたはリンクするテキスト ファイルと同じフォルダーにある schema.ini ファイルを使用する必要があります。</p>
<p>テキスト ファイルをインポートまたはリンクするための定義を作成するには、次の操作を行います。</p>
<ol>
<li><p>[<strong>外部データの取り込み</strong>] ダイアログ ボックスで、[<strong>ファイル名</strong>] ボックスにソース テキスト ファイルのパスを入力します。</p></li>
<li><p>データの格納に必要なオプション (インポート、追加、またはリンク) をクリックし、[<strong>OK</strong>] をクリックします。</p></li>
<li><p>[<strong>テキスト インポート ウィザード</strong>] ダイアログ ボックスの [<strong>設定</strong>] をクリックします。</p></li>
<li><p>この定義に必要なオプションを指定し、[<strong>名前を付けて保存</strong>] をクリックします。</p></li>
<li><p>この定義の名前を入力し、[<strong>OK</strong>] をクリックします。</p></li>
<li><p>定義のダイアログ ボックスで [<strong>定義</strong>] をクリックすると、既存の定義を管理できます。</p></li>
<li><p>[<strong>OK</strong>] をクリックして定義のダイアログ ボックスを閉じます。</p></li>
</ol>
<p></p>
<p>次に、この引数に設定済みの定義名を入力すると、その定義に対応する形式のテキスト ファイルをインポートまたはエクスポートできます。 インポート、エクスポート、または、この引数に定義名を入力しなくても区切り記号付きテキスト ファイルをリンクすることができます。 この例では、ウィザードのダイアログ ボックスの既定値が使用されます。 これまででは、これらの種類のファイルをエクスポートする場合、この引数に定義名を入力する必要はありませんので、差し込み印刷データ ファイルの定義済みの形式が使用されます。 HTML ファイルでは、インポート/エクスポート定義を使用することができますが、部分のみが適用される仕様は、データ型の書式の仕様です。</p></td>
</tr>
<tr class="odd">
<td><p><strong>Table Name/テーブル名</strong></p></td>
<td><p>テキスト データをテキスト データのエクスポートまたはリンクするテキスト データをインポートするのには Access のテーブルの名前です。 データをエクスポートする Access クエリの名前を入力することもできます。 この引数は省略できません。 <strong>インポートで区切られた</strong>、<strong>固定幅のインポート</strong>または<strong>転送の種類</strong>] ボックスで、 <strong>HTML のインポート</strong>をクリックするとアクセスはテーブルが既に存在する場合、このテーブルにテキスト データを追加します。 それ以外の場合、テキスト データを含む新しいテーブルが作成されます。 <strong>ImportExportText</strong>アクションを使用しているときにエクスポートするデータを指定するのには、SQL ステートメントを使うことはできません。 SQL ステートメントを使うのではなく、クエリを作成してから、 <strong>Table Name/テーブル名</strong> 引数にそのクエリの名前を指定する必要があります。</p></td>
</tr>
<tr class="even">
<td><p><strong>ファイル名</strong></p></td>
<td><p>インポート元、エクスポート先、またはリンクするテキスト ファイルの名前です。 ファイル名が既存のワークシートの名前と同じ場合、既存のワークシートが置き換えられます。 この引数は省略できません。 アクセスからデータをエクスポートするときに、新しいテキスト ファイルが作成されます。 ファイル名が既存のテキスト ファイルの名前と同じ場合は、アクセスには、既存のテキスト ファイルが置き換えられます。 特定のテーブルまたはリストを HTML ファイルにインポートまたはリンクする場合は、 <strong>HTML テーブルの Name</strong>引数を使用できます。</p></td>
</tr>
<tr class="odd">
<td><p><strong>Has Field Names/フィールド名の設定</strong></p></td>
<td><p>テキスト ファイルの最初の行にフィールドの名前が含まれているかどうかを指定します。 <strong>[はい]</strong>を選択した場合に使用されます名この行 Access テーブルのフィールド名としてインポートまたはテキスト データをリンクする場合。 [ <strong>いいえ</strong>] を選択した場合は、先頭行が通常のデータ行として処理されます。 既定値は [ <strong>いいえ</strong>] です。 この引数は、先頭行に必ずフィールド名を含む Word の差し込みデータ ファイルに対しては無効です。 この引数に [<strong>はい</strong>] を指定した場合、Access のテーブルまたは選択クエリを区切り記号付きテキスト ファイルや固定幅テキスト ファイルにエクスポートすると、テーブルまたは選択クエリのフィールド名がテキスト ファイルの先頭行に挿入されます。 インポートするか、固定幅テキスト ファイルとリンク [<strong>はい]</strong>このボックスに、フィールド名を含む最初の行はそのインポート/エクスポート定義されている区切り記号をフィールド名の区切りに使用する必要があります。 固定幅テキスト ファイルをエクスポートして、この引数に<strong>[はい]</strong>を選択すると場合、は、この区切り記号を含むテキスト ファイルの最初の行にフィールド名が挿入されます。</p></td>
</tr>
<tr class="even">
<td><p><strong>HTML Table Name/HTML テーブル名</strong></p></td>
<td><p>テーブルまたはリストをインポートまたはリンクする HTML ファイル内の名前です。 <strong>転送の型</strong>引数は、HTML のインポートまたはリンクの HTML に設定されていない限り、この引数は無視されます。 この引数を空白のままにすると、HTML ファイル内の最初のテーブルまたはリストがインポートまたはリンクされます。 HTML ファイル内のテーブルまたはリストの名前は、指定した文字列によって決定されます、&lt;キャプション&gt;がある場合に、タグ付け、&lt;キャプション&gt;タグです。 &lt;CAPTION&gt; タグが存在しない場合、この名前は &lt;TITLE&gt; タグで指定されたテキストによって決まります。 1 つ以上のテーブルまたはリストの名前が同じ場合、それぞれの名前の末尾に番号を追加することによって区別されます。たとえば、社員 1 と社員 2 になります。</p></td>
</tr>
<tr class="odd">
<td><p><strong>コード ページ</strong></p></td>
<td><p>コード ページで使用する文字セットの名前を指定します。</p></td>
</tr>
</tbody>
</table>


## <a name="remarks"></a>解説

Access の選択クエリのデータをテキスト ファイルにエクスポートできます。クエリの結果セットもテーブルと同じようにエクスポートされます。

既存の Access のテーブルに追加するテキスト データは、テーブルの構造との互換性が必要です。

- テキストの各フィールドのデータ型は、テーブルの対応するフィールドのデータ型と同じにする必要があります。

- フィールドは同じ順序にする必要があります (ただし、**Has Field Names/フィールド名の設定**引数を [**はい**] に設定した場合は、テキストのフィールド名とテーブルのフィールド名を同じにする必要があります)。

このアクションの動作は、[**外部データ**] タブの [**インポート**] または [**エクスポート**] で [**テキスト ファイル**] をクリックした場合の動作と同じです。**ImportExportText** アクションの引数は、[**テキスト ファイル**] コマンドで開始するウィザードのオプションに対応しています。

> [!TIP]
> インポート定義およびエクスポート定義には、テキスト ファイルをインポート、エクスポート、またはリンクするのに必要な情報が保存されます。保存した定義は、同じ形式のテキスト ファイルをインポート、エクスポート、またはリンクする際に使用できます。たとえば、毎週の売上高をメインフレーム コンピューターから取り出してテキスト ファイルに変換するとします。このような変換の定義を作成して保存しておくと、この定義を使っていつでも Access データベースにデータを追加できます。

> [!NOTE]
> リンクしたテキスト ファイルに対してクエリを実行するか、フィルターを適用する場合は、大文字と小文字が区別されます。

Visual Basic for Applications (VBA) モジュールで **ImportExportText** アクションを実行するには、**DoCmd** オブジェクトの **TransferText** メソッドを使用します。

