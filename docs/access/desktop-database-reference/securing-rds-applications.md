---
title: RDS アプリケーションをセキュリティ保護する
TOCTitle: Securing RDS Applications
ms:assetid: 15f41cbb-d6e0-aca8-9c3a-97516d82c302
ms:mtpsurl: https://msdn.microsoft.com/library/JJ248922(v=office.15)
ms:contentKeyID: 48543423
ms.date: 09/18/2015
mtps_version: v=office.15
ms.openlocfilehash: 16dd0fd983d6e04f01c7d848a8d45f82b0f1c85a
ms.sourcegitcommit: 19aca09c5812cfb98b68b5d4604dcaa814479df7
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 10/09/2018
ms.locfileid: "25476677"
---
# <a name="securing-rds-applications"></a><span data-ttu-id="d5afc-102">RDS アプリケーションをセキュリティ保護する</span><span class="sxs-lookup"><span data-stu-id="d5afc-102">Securing RDS Applications</span></span>

<span data-ttu-id="d5afc-103">**適用されます**Access 2013 |。Office 2013</span><span class="sxs-lookup"><span data-stu-id="d5afc-103">**Applies to**: Access 2013 | Office 2013</span></span>

## <a name="microsoft-internet-explorer-security-issues"></a><span data-ttu-id="d5afc-104">Microsoft Internet Explorer のセキュリティの問題点</span><span class="sxs-lookup"><span data-stu-id="d5afc-104">Microsoft Internet Explorer Security Issues</span></span>

<span data-ttu-id="d5afc-p101">Microsoft® Internet Explorer に新しいセキュリティ機能が追加されたことに伴い、いくつかの ADO オブジェクトと RDS オブジェクトは "セーフ" モード環境でしか動作しなくなりました。そのため、ゾーンの相違、セキュリティ レベル、動作の制限、安全でない操作、カスタマイズされたセキュリティ設定などの問題に注意を払う必要があります。</span><span class="sxs-lookup"><span data-stu-id="d5afc-p101">With new security enhancements added to Microsoft® Internet Explorer, some ADO and RDS objects are restricted to running only in a "safe" mode environment. This requires that you are aware of these issues, including different zones, security levels, restrictive behavior, unsafe operations, and customized security settings.</span></span>

<span data-ttu-id="d5afc-107">これらの問題の詳細については、「ADO」 (英語) の「ADO and RDS Security Issues in Microsoft Internet Explorer」 (英語) を参照してください。</span><span class="sxs-lookup"><span data-stu-id="d5afc-107">For more information about these issues, see ADO and RDS Security Issues in Microsoft Internet Explorer under ActiveX Data Objects (ADO) Technical Articles.</span></span>

## <a name="security-and-your-web-server"></a><span data-ttu-id="d5afc-108">セキュリティと Web サーバー</span><span class="sxs-lookup"><span data-stu-id="d5afc-108">Security and Your Web Server</span></span>

<span data-ttu-id="d5afc-p102">インターネット Web サーバーで [DataFactory (RDSServer)](datafactory-object-rdsserver.md) オブジェクトを使う場合は、それによりセキュリティ上の潜在的なリスクが発生することに留意してください。有効なデータ ソース名 (DSN)、ユーザー ID、およびパスワードの情報を持っている外部ユーザーであれば、そのデータ ソースにクエリを送信するページを作成できます。データ ソースへのアクセスを制限する方法の 1 つとして、 **RDSServer.DataFactory** オブジェクト (msadcf.dll) の登録を解除して削除し、その代わりに、ハード コーディングされたクエリを使うカスタム ビジネス オブジェクトを使う方法があります。</span><span class="sxs-lookup"><span data-stu-id="d5afc-p102">If you use the [RDSServer.DataFactory](datafactory-object-rdsserver.md) object on your Internet Web server, remember that doing so creates a potential security risk. External users who obtain valid data source name (DSN), user ID, and password information could write pages to send any query to that data source. If you want more restricted access to a data source, one option is to unregister and delete the **RDSServer.DataFactory** object (msadcf.dll), and instead use custom business objects with hard-coded queries.</span></span>

<span data-ttu-id="d5afc-112">RDSServer.DataFactory オブジェクトを使用する場合のセキュリティへの影響の詳細については、[マイクロソフト セキュリティ web サイト](https://www.microsoft.com/en-us/security/default.aspx)マイクロソフト セキュリティ情報 MS99-025 を参照してください。</span><span class="sxs-lookup"><span data-stu-id="d5afc-112">For more information about the security implications of using the RDSServer.DataFactory object, see the Microsoft Security Bulletin MS99-025 on the [Microsoft Security website](https://www.microsoft.com/en-us/security/default.aspx).</span></span>

## <a name="client-impersonation-and-security"></a><span data-ttu-id="d5afc-113">クライアントの偽装とセキュリティ</span><span class="sxs-lookup"><span data-stu-id="d5afc-113">Client Impersonation and Security</span></span>

<span data-ttu-id="d5afc-114">(Windows NT 4.0) を Windows NT チャレンジ/レスポンス認証または統合 Windows 認証 (Windows 2000) を IIS Web サーバーの**パスワード認証**のプロパティが設定されている場合は、クライアントの [ビジネス オブジェクトが呼び出されます。セキュリティ コンテキストです。</span><span class="sxs-lookup"><span data-stu-id="d5afc-114">If the **Password Authentication** property for your IIS Web server is set to Windows NT Challenge/Response authentication (for Windows NT 4.0) or to Integrated Windows authentication (for Windows 2000), then business objects are invoked under the client's security context.</span></span> <span data-ttu-id="d5afc-115">これは、HTTP 経由でクライアントの偽装を可能にする RDS 1.5 の新機能です。</span><span class="sxs-lookup"><span data-stu-id="d5afc-115">This is a new feature in RDS 1.5 that allows Client Impersonation over HTTP.</span></span> <span data-ttu-id="d5afc-116">このモードで作業するとき、Web サーバー (IIS) へのログオンは匿名ではありませんが、ユーザー ID とクライアント コンピューターが実行されているパスワードを使用します。</span><span class="sxs-lookup"><span data-stu-id="d5afc-116">When working in this mode, the logon to the Web server (IIS) is not anonymous but uses the user ID and password that the client computer is running under.</span></span> <span data-ttu-id="d5afc-117">ODBC の Dsn が信頼関係接続を使用する設定はなど、SQL Server のデータベースへのアクセスは、クライアントのセキュリティ コンテキストの下で。</span><span class="sxs-lookup"><span data-stu-id="d5afc-117">If the ODBC DSNs are set up to use Trusted Connection, then access to databases, such as SQL Server, also happens under the client's security context.</span></span> <span data-ttu-id="d5afc-118">これはデータベースが、IIS と同じコンピューター上にある場合にのみ有効ですが、さらに別のコンピューター上でクライアントの資格情報を実行できません。</span><span class="sxs-lookup"><span data-stu-id="d5afc-118">But this only works if the database is on the same computer as the IIS; the client credentials cannot be carried over to yet another computer.</span></span>

<span data-ttu-id="d5afc-119">例では、クライアントの場合、John Doe では、ユーザー id =「JohnD」とパスワード =「シークレット」は、クライアント コンピューターにログオンします。</span><span class="sxs-lookup"><span data-stu-id="d5afc-119">For example, a client, John Doe, with userid="JohnD" and password="secret" is logged on to a client computer.</span></span> <span data-ttu-id="d5afc-120">彼は、IIS を実行している"MyServer"コンピューターで、SQL クエリを実行して[レコード セット](recordset-object-ado.md)を作成するのには**RDSServer.DataFactory**オブジェクトにアクセスする必要のあるブラウザー ベースのアプリケーションを実行します。</span><span class="sxs-lookup"><span data-stu-id="d5afc-120">He runs a browser-based application that needs to access the **RDSServer.DataFactory** object to create a [Recordset](recordset-object-ado.md) by executing an SQL query on the "MyServer" computer running IIS.</span></span> <span data-ttu-id="d5afc-121">MyServer を Windows NT Server 4.0 を実行しているシステムが Windows NT チャレンジ/レスポンス認証を使用する設定、その ODBC DSN"を使用して、信頼関係接続] が選択されているが、サーバーは、SQL Server データ ソースも含まれています。</span><span class="sxs-lookup"><span data-stu-id="d5afc-121">MyServer, a system running Windows NT Server 4.0, is set up to use Windows NT Challenge/Response authentication, its ODBC DSN has "Use Trusted Connection" selected, and the server also contains the SQL Server data source.</span></span> <span data-ttu-id="d5afc-122">Web サーバーに要求が受信されると、ユーザー ID とパスワードをクライアントに要求します。</span><span class="sxs-lookup"><span data-stu-id="d5afc-122">When a request is received on the Web server, it asks the client for the user ID and password.</span></span> <span data-ttu-id="d5afc-123">したがって、要求は、MyServer としてログオン「JohnD」から IUSER 代わりに「秘密」/\_MyServer (これは既定では匿名のパスワード認証がオンの場合)。</span><span class="sxs-lookup"><span data-stu-id="d5afc-123">Thus, the request is logged on MyServer as coming from "JohnD"/"Secret" instead of IUSER\_MyServer (which is the default when Anonymous Password Authentication is on).</span></span> <span data-ttu-id="d5afc-124">同様に、SQL Server、「JohnD」へのログオン時に「秘密」を使用します。</span><span class="sxs-lookup"><span data-stu-id="d5afc-124">Similarly, when logging on to SQL Server, "JohnD"/"Secret" is used.</span></span>

<span data-ttu-id="d5afc-p105">したがって、IIS の Windows NT チャレンジ/レスポンス認証モードでは、ユーザーはデータベースへのログオンに必要なユーザー ID とパスワードを明示的に要求されることなく HTML ページを作成できます。IIS の基本認証が使われている場合は、これらが要求されます。</span><span class="sxs-lookup"><span data-stu-id="d5afc-p105">Consequently, the IIS Windows NT Challenge/Response authentication mode allows HTML pages to be created without the user being explicitly prompted for the user ID and password information needed to log on to the database. If the IIS Basic Authentication were being used, then this also would be required.</span></span>

## <a name="password-authentication"></a><span data-ttu-id="d5afc-127">パスワード認証</span><span class="sxs-lookup"><span data-stu-id="d5afc-127">Password Authentication</span></span>

<span data-ttu-id="d5afc-p106">RDS は、匿名認証、基本認証、または Windows NT チャレンジ/レスポンス認証 (Windows 2000 では統合 Windows 認証) の 3 種類のパスワード認証モードのうち、どのモードで実行している IIS Web サーバーとも通信できます。これらの設定によって、たとえばクライアント コンピューターが NT Web サーバーに対して明示的なアクセス特権を持っている必要があるなど、Web サーバーがそのサーバーを介するアクセスを制御する方法が定義されます。</span><span class="sxs-lookup"><span data-stu-id="d5afc-p106">RDS can communicate with an IIS Web server running in any one of the three Password Authentication modes: Anonymous, Basic, or NT Challenge/Response authentication (called Integrated Windows authentication in Windows 2000). These settings define how a Web server controls access through it, such as requiring that a client computer have explicit access privileges on the NT Web server.</span></span>

