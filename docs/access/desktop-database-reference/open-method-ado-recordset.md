---
title: Open メソッド (ADO Recordset)
TOCTitle: Open method (ADO Recordset)
ms:assetid: 87ef19a4-28e1-dec7-ed33-4ae500b9c460
ms:mtpsurl: https://msdn.microsoft.com/library/JJ249591(v=office.15)
ms:contentKeyID: 48546119
ms.date: 09/18/2015
mtps_version: v=office.15
localization_priority: Normal
ms.openlocfilehash: e5f8dbdfa61a671e2efb9aac2596cfda5cd1727b
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/23/2019
ms.locfileid: "32288407"
---
# <a name="open-method-ado-recordset"></a><span data-ttu-id="6c52a-102">Open メソッド (ADO Recordset)</span><span class="sxs-lookup"><span data-stu-id="6c52a-102">Open method (ADO Recordset)</span></span>

<span data-ttu-id="6c52a-103">**適用先:** Access 2013、Office 2013</span><span class="sxs-lookup"><span data-stu-id="6c52a-103">**Applies to**: Access 2013, Office 2013</span></span>

<span data-ttu-id="6c52a-104">カーソルを開きます。</span><span class="sxs-lookup"><span data-stu-id="6c52a-104">Opens a cursor.</span></span>

## <a name="syntax"></a><span data-ttu-id="6c52a-105">構文</span><span class="sxs-lookup"><span data-stu-id="6c52a-105">Syntax</span></span>

<span data-ttu-id="6c52a-106">*recordset*。Open*Source*、 *ActiveConnection*、 *CursorType*、 *LockType*、 *Options*</span><span class="sxs-lookup"><span data-stu-id="6c52a-106">*recordset*.Open*Source*, *ActiveConnection*, *CursorType*, *LockType*, *Options*</span></span>

## <a name="parameters"></a><span data-ttu-id="6c52a-107">パラメーター</span><span class="sxs-lookup"><span data-stu-id="6c52a-107">Parameters</span></span>

|<span data-ttu-id="6c52a-108">パラメーター</span><span class="sxs-lookup"><span data-stu-id="6c52a-108">Parameter</span></span>|<span data-ttu-id="6c52a-109">説明</span><span class="sxs-lookup"><span data-stu-id="6c52a-109">Description</span></span>|
|:--------|:----------|
|<span data-ttu-id="6c52a-110">*Source*</span><span class="sxs-lookup"><span data-stu-id="6c52a-110">*Source*</span></span> |<span data-ttu-id="6c52a-p101">省略可能です。有効な **Command** オブジェクト、SQL ステートメント、テーブル名、ストアド プロシージャの呼び出し、URL、または永続的に保存された [Recordset](command-object-ado.md) を格納しているファイル名や [Stream](stream-object-ado.md) オブジェクト名に評価されるバリアント型 ( [Variant](recordset-object-ado.md) ) の値を指定します。</span><span class="sxs-lookup"><span data-stu-id="6c52a-p101">Optional. A **Variant** that evaluates to a valid [Command](command-object-ado.md) object, an SQL statement, a table name, a stored procedure call, a URL, or the name of a file or [Stream](stream-object-ado.md) object containing a persistently stored [Recordset](recordset-object-ado.md).</span></span>|
|<span data-ttu-id="6c52a-113">*ActiveConnection*</span><span class="sxs-lookup"><span data-stu-id="6c52a-113">*ActiveConnection*</span></span> |<span data-ttu-id="6c52a-p102">省略可能です。有効な **Connection** オブジェクトのオブジェクト変数名に評価されるバリアント型 ( [Variant](connection-object-ado.md) ) の値、または **ConnectionString** パラメーターを含む文字列型 ( [String](connectionstring-property-ado.md) ) の値を指定します。</span><span class="sxs-lookup"><span data-stu-id="6c52a-p102">Optional. Either a **Variant** that evaluates to a valid [Connection](connection-object-ado.md) object variable name, or a **String** that contains [ConnectionString](connectionstring-property-ado.md) parameters.</span></span>|
|<span data-ttu-id="6c52a-116">*CursorType*</span><span class="sxs-lookup"><span data-stu-id="6c52a-116">*CursorType*</span></span> |<span data-ttu-id="6c52a-p103">省略可能です。プロバイダーが [Recordset](cursortypeenum.md) を開くときに使用するカーソルの種類を決める **CursorTypeEnum** 値を指定します。既定値は **adOpenForwardOnly** です。</span><span class="sxs-lookup"><span data-stu-id="6c52a-p103">Optional. A [CursorTypeEnum](cursortypeenum.md) value that determines the type of cursor that the provider should use when opening the **Recordset**. The default value is **adOpenForwardOnly**.</span></span>|
|<span data-ttu-id="6c52a-120">*LockType*</span><span class="sxs-lookup"><span data-stu-id="6c52a-120">*LockType*</span></span> |<span data-ttu-id="6c52a-p104">省略可能です。プロバイダーが [Recordset](locktypeenum.md) を開くときに使用するロック (同時作用) の種類を決めるための **LockTypeEnum** 値を指定します。既定値は **adLockReadOnly** です。</span><span class="sxs-lookup"><span data-stu-id="6c52a-p104">Optional. A [LockTypeEnum](locktypeenum.md) value that determines what type of locking (concurrency) the provider should use when opening the **Recordset**. The default value is **adLockReadOnly**.</span></span>|
|<span data-ttu-id="6c52a-124">*Options*</span><span class="sxs-lookup"><span data-stu-id="6c52a-124">*Options*</span></span> |<span data-ttu-id="6c52a-p105">省略可能です。*Source* 引数が **Command** オブジェクト以外のソースを表す場合にプロバイダーがこの引数を評価する方法、または以前に保存されていたファイルから **Recordset** を復元する必要があることを示す長整数型 (**Long**) の値を指定します。1 つまたは複数の [CommandTypeEnum](commandtypeenum.md) 値または [ExecuteOptionEnum](executeoptionenum.md) 値を指定できます。これらの値は、ビット単位の AND 演算子で組み合わせて使用することができます。</span><span class="sxs-lookup"><span data-stu-id="6c52a-p105">Optional. A **Long** value that indicates how the provider should evaluate the *Source* argument if it represents something other than a **Command** object, or that the **Recordset** should be restored from a file where it was previously saved. Can be one or more [CommandTypeEnum](commandtypeenum.md) or [ExecuteOptionEnum](executeoptionenum.md) values, which can be combined with a bitwise AND operator.</span></span>|

> [!NOTE]
> <span data-ttu-id="6c52a-128">永続化された **Recordset** を含む **Stream** から **Recordset** を開く場合、**ExecuteOptionEnum** 値の **adAsyncFetchNonBlocking** を使用しても無効です。この場合、フェッチは同期であり、ブロッキングが行われます。</span><span class="sxs-lookup"><span data-stu-id="6c52a-128">If you open a **Recordset** from a **Stream** containing a persisted **Recordset**, using an **ExecuteOptionEnum** value of **adAsyncFetchNonBlocking** will not have an effect; the fetch will be synchronous and blocking.</span></span>

<span data-ttu-id="6c52a-129">**Open** メソッドを使用する場合は、**ExecuteOpenEnum** に **adExecuteNoRecords** または **adExecuteStream** を指定しないでください。</span><span class="sxs-lookup"><span data-stu-id="6c52a-129">The **ExecuteOpenEnum** values of **adExecuteNoRecords** or **adExecuteStream** should not be used with **Open**.</span></span>

## <a name="remarks"></a><span data-ttu-id="6c52a-130">注釈</span><span class="sxs-lookup"><span data-stu-id="6c52a-130">Remarks</span></span>

<span data-ttu-id="6c52a-131">ADO の **Recordset** の既定のカーソルは、サーバー側にある読み取り専用の前方スクロール カーソルです。</span><span class="sxs-lookup"><span data-stu-id="6c52a-131">The default cursor for an ADO **Recordset** is a forward-only, read-only cursor located on the server.</span></span>

<span data-ttu-id="6c52a-132">**Recordset** オブジェクトで **Open** メソッドを使用すると、ベース テーブルからのレコード、クエリの結果、または以前に保存された **Recordset** を表すカーソルを開くことができます。</span><span class="sxs-lookup"><span data-stu-id="6c52a-132">Using the **Open** method on a **Recordset** object opens a cursor that represents records from a base table, the results of a query, or a previously saved **Recordset**.</span></span>

<span data-ttu-id="6c52a-133">省略可能な*source*引数を使用して、 **Command**オブジェクト変数、SQL ステートメント、ストアドプロシージャ、テーブル名、URL、完全なファイルパス名のいずれかを使用して、データソースを指定します。</span><span class="sxs-lookup"><span data-stu-id="6c52a-133">Use the optional *Source* argument to specify a data source using one of the following: a **Command** object variable, an SQL statement, a stored procedure, a table name, a URL, or a complete file path name.</span></span> <span data-ttu-id="6c52a-134">*Source*がファイルパス名の場合は、相対パス ("c:\\dir\\file...") で指定できます。\\ファイル rst ")、または URL ("https://files/file.rst")。</span><span class="sxs-lookup"><span data-stu-id="6c52a-134">If *Source* is a file path name, it can be a full path ("c:\\dir\\file.rst"), a relative path ("..\\file.rst"), or a URL ("https://files/file.rst").</span></span>

<span data-ttu-id="6c52a-p107">**Open** メソッドの *Source* 引数を使用して、レコードを返さないアクション クエリを実行するのは、お勧めできません。これは、呼び出しが成功したかどうかを容易に判断できないためです。このようなクエリによって返された **Recordset** は閉じられます。SQL INSERT ステートメントのように、レコードを返さないクエリを実行する場合は、代わりに **Command** オブジェクトの [Execute](https://docs.microsoft.com/office/vba/access/concepts/miscellaneous/execute-method-ado-command) メソッドまたは **Connection** オブジェクトの [Execute](https://docs.microsoft.com/office/vba/access/concepts/miscellaneous/execute-method-ado-connection) メソッドを呼び出してください。</span><span class="sxs-lookup"><span data-stu-id="6c52a-p107">It is not a good idea to use the *Source* argument of the **Open** method to perform an action query that doesnt return records because there is no easy way to determine whether the call succeeded. The **Recordset** returned by such a query will be closed. Call the [Execute](https://docs.microsoft.com/office/vba/access/concepts/miscellaneous/execute-method-ado-command) method of a **Command** object or the [Execute](https://docs.microsoft.com/office/vba/access/concepts/miscellaneous/execute-method-ado-connection) method of a **Connection** object instead to perform a query that, such as a SQL INSERT statement, that doesnt return records.</span></span>

<span data-ttu-id="6c52a-138">*ActiveConnection* 引数は [ActiveConnection](activeconnection-property-ado.md) プロパティに対応し、**Recordset** オブジェクトを開く接続を指定します。</span><span class="sxs-lookup"><span data-stu-id="6c52a-138">The *ActiveConnection* argument corresponds to the [ActiveConnection](activeconnection-property-ado.md) property and specifies in which connection to open the **Recordset** object.</span></span> <span data-ttu-id="6c52a-139">この引数に接続の定義を指定すると、ADO により、指定されたパラメーターを使用して新しい接続が開かれます。</span><span class="sxs-lookup"><span data-stu-id="6c52a-139">If you pass a connection definition for this argument, ADO opens a new connection using the specified parameters.</span></span> <span data-ttu-id="6c52a-140">クライアント側カーソル (**cursor location** = **adUseClient**) を使用して**Recordset**を開いた後、このプロパティの値を変更して、別のプロバイダーに更新を送信することができます。</span><span class="sxs-lookup"><span data-stu-id="6c52a-140">After opening the **Recordset** with a client-side cursor (**CursorLocation** = **adUseClient**), you can change the value of this property to send updates to another provider.</span></span> <span data-ttu-id="6c52a-141">また、このプロパティを **Nothing** (Microsoft Visual Basic の場合) または NULL に設定すると、その **Recordset** を任意のプロバイダーから切断することができます。</span><span class="sxs-lookup"><span data-stu-id="6c52a-141">Or you can set this property to **Nothing** (in Microsoft Visual Basic) or NULL to disconnect the **Recordset** from any provider.</span></span> <span data-ttu-id="6c52a-142">ただし、サーバー側カーソルの **ActiveConnection** を変更すると、エラーが発生します。</span><span class="sxs-lookup"><span data-stu-id="6c52a-142">Changing **ActiveConnection** for a server-side cursor generates an error, however.</span></span>

<span data-ttu-id="6c52a-143">**Recordset** オブジェクトのプロパティに直接対応するその他の引数 (*Source*、*CursorType*、および *LockType*) と、プロパティの関係は次のとおりです。</span><span class="sxs-lookup"><span data-stu-id="6c52a-143">For the other arguments that correspond directly to properties of a **Recordset** object (*Source*, *CursorType*, and *LockType*), the relationship of the arguments to the properties is as follows:</span></span>

- <span data-ttu-id="6c52a-144">**Recordset** オブジェクトを開く前のプロパティは、読み取り/書き込み可能です。</span><span class="sxs-lookup"><span data-stu-id="6c52a-144">The property is read/write before the **Recordset** object is opened.</span></span>

- <span data-ttu-id="6c52a-p109">**Open** メソッドの実行時に、対応する引数を指定しないと、プロパティの設定値が使用されます。引数を指定した場合は、対応するプロパティの設定値が上書きされて引数の値に更新されます。</span><span class="sxs-lookup"><span data-stu-id="6c52a-p109">The property settings are used unless you pass the corresponding arguments when executing the **Open** method. If you pass an argument, it overrides the corresponding property setting, and the property setting is updated with the argument value.</span></span>

- <span data-ttu-id="6c52a-147">**Recordset** オブジェクトを開いた後、プロパティは読み取り専用になります。</span><span class="sxs-lookup"><span data-stu-id="6c52a-147">After you open the **Recordset** object, these properties become read-only.</span></span>

> [!NOTE]
> <span data-ttu-id="6c52a-148">**Recordset** オブジェクトの [Source](source-property-ado-recordset.md) プロパティに有効な **Command** オブジェクトが設定されている場合、その **Recordset** オブジェクトが開いていなくても、**ActiveConnection** プロパティは読み取り専用になります。</span><span class="sxs-lookup"><span data-stu-id="6c52a-148">The **ActiveConnection** property is read only for **Recordset** objects whose [Source](source-property-ado-recordset.md) property is set to a valid **Command** object, even if the **Recordset** object isn't open.</span></span>

<span data-ttu-id="6c52a-p110">*Source* 引数に **Command** オブジェクトを指定する場合、同時に *ActiveConnection* 引数を指定すると、エラーが発生します。**Command** オブジェクトの **ActiveConnection** プロパティは、あらかじめ有効な **Connection** オブジェクトまたは接続文字列に設定しておく必要があります。</span><span class="sxs-lookup"><span data-stu-id="6c52a-p110">If you pass a **Command** object in the *Source* argument and also pass an *ActiveConnection* argument, an error occurs. The **ActiveConnection** property of the **Command** object must already be set to a valid **Connection** object or connection string.</span></span>

<span data-ttu-id="6c52a-p111">*Source* 引数に **Command** オブジェクト以外のソースを指定する場合は、*Options* 引数を使用して *Source* 引数の評価を最適化することができます。*Options* 引数が定義されていない場合は、パフォーマンスが低下する可能性があります。これは、引数が SQL ステートメント、ストアド プロシージャ、URL、テーブル名のいずれであるかを判断するために、プロバイダーを呼び出す必要があるためです。使用する *Source* の種類がわかっている場合は、*Options* 引数を設定することにより、該当するコードに直接ジャンプすることができます。*Options* 引数が *Source* の種類と一致しない場合は、エラーが発生します。</span><span class="sxs-lookup"><span data-stu-id="6c52a-p111">If you pass something other than a **Command** object in the *Source* argument, you can use the *Options* argument to optimize evaluation of the *Source* argument. If the *Options* argument is not defined, you may experience diminished performance because ADO must make calls to the provider to determine if the argument is an SQL statement, a stored procedure, a URL, or a table name. If you know what *Source* type you're using, setting the *Options* argument instructs ADO to jump directly to the relevant code. If the *Options* argument does not match the *Source* type, an error occurs.</span></span>

<span data-ttu-id="6c52a-p112">*Source* 引数に **Stream** オブジェクトを指定する場合は、他の引数は指定しないでください。そのようにすると、エラーが発生します。**Stream** から **Recordset** を開く場合は、**ActiveConnection** の情報は保持されません。</span><span class="sxs-lookup"><span data-stu-id="6c52a-p112">If you pass a **Stream** object in the *Source* argument, you should not pass information into the other arguments. Doing so will generate an error. The **ActiveConnection** information is not retained when a **Recordset** is opened from a **Stream**.</span></span>

<span data-ttu-id="6c52a-p113">**Recordset** に接続が関連付けられていない場合、*Options* 引数の既定値は **adCmdFile** です。代表的な例では、永続的に保存された **Recordset** オブジェクトの場合がこれに該当します。</span><span class="sxs-lookup"><span data-stu-id="6c52a-p113">The default for the *Options* argument is **adCmdFile** if no connection is associated with the **Recordset**. This will typically be the case for persistently stored **Recordset** objects.</span></span>

<span data-ttu-id="6c52a-p114">データ ソースがレコードを返さない場合、プロバイダーは [BOF](bof-eof-properties-ado.md) プロパティと [EOF](bof-eof-properties-ado.md) プロパティを **True** に設定し、カレント レコードの位置が未定義になります。カーソルの種類によっては、この空の **Recordset** オブジェクトに新しいデータを追加することができます。</span><span class="sxs-lookup"><span data-stu-id="6c52a-p114">If the data source returns no records, the provider sets both the [BOF](bof-eof-properties-ado.md) and [EOF](bof-eof-properties-ado.md) properties to **True**, and the current record position is undefined. You can still add new data to this empty **Recordset** object if the cursor type allows it.</span></span>

<span data-ttu-id="6c52a-p115">開いている **Recordset** に対する操作が完了したら、[Close](close-method-ado.md) メソッドを使用して、関連するシステム リソースをすべて解放します。オブジェクトを閉じてもメモリからは削除されないので、そのオブジェクトのプロパティを変更したり、**Open** メソッドを使用してもう一度開いたりすることができます。オブジェクトをメモリから完全に削除するには、オブジェクト変数に *Nothing* を設定します。</span><span class="sxs-lookup"><span data-stu-id="6c52a-p115">When you have concluded your operations over an open **Recordset** object, use the [Close](close-method-ado.md) method to free any associated system resources. Closing an object does not remove it from memory; you can change its property settings and use the **Open** method to open it again later. To completely eliminate an object from memory, set the object variable to *Nothing*.</span></span>

<span data-ttu-id="6c52a-165">**ActiveConnection**プロパティを設定する前に、オペランドなしで**Open**を呼び出して、 **recordset** [fields](fields-collection-ado.md)コレクションにフィールドを追加することによって作成された**recordset**のインスタンスを作成します。</span><span class="sxs-lookup"><span data-stu-id="6c52a-165">Before the **ActiveConnection** property is set, call **Open** with no operands to create an instance of a **Recordset** created by appending fields to the **Recordset** [Fields](fields-collection-ado.md) collection.</span></span>

<span data-ttu-id="6c52a-166">[CursorLocation](cursorlocation-property-ado.md) プロパティを **adUseClient** に設定している場合は、非同期に行を取得できる方法が 2 つあります。</span><span class="sxs-lookup"><span data-stu-id="6c52a-166">If you have set the [CursorLocation](cursorlocation-property-ado.md) property to **adUseClient**, you can retrieve rows asynchronously in one of two ways.</span></span> <span data-ttu-id="6c52a-167">推奨される方法は、*Options* を **adAsyncFetch** に設定することです。</span><span class="sxs-lookup"><span data-stu-id="6c52a-167">The recommended method is to set *Options* to **adAsyncFetch**.</span></span> <span data-ttu-id="6c52a-168">もう 1 つの方法として、 [Properties](properties-collection-ado.md) コレクションで "非同期行セット処理" ダイナミック プロパティを使用することもできますが、 **Options** パラメーターを **adAsyncFetch** に設定していない場合は、関連して取得されたイベントが失われる可能性があります。</span><span class="sxs-lookup"><span data-stu-id="6c52a-168">Alternatively, you can use the "Asynchronous Rowset Processing" dynamic property in the [Properties](properties-collection-ado.md) collection, but related retrieved events can be lost if you do not set the **Options** parameter to **adAsyncFetch**.</span></span>

> [!NOTE]
> <span data-ttu-id="6c52a-169">MS Remote プロバイダーのバックグラウンド フェッチは、**Open** メソッドの *Options* パラメーターを通してのみサポートされます。</span><span class="sxs-lookup"><span data-stu-id="6c52a-169">Background fetching in the MS Remote provider is supported only through the **Open** method's *Options* parameter.</span></span>

> [!NOTE]
> <span data-ttu-id="6c52a-170">[!メモ] http スキームを使用している URL は、[Microsoft OLE DB Provider for Internet Publishing](microsoft-ole-db-provider-for-internet-publishing.md) を自動的に呼び出します。</span><span class="sxs-lookup"><span data-stu-id="6c52a-170">URLs using the http scheme will automatically invoke the [Microsoft OLE DB Provider for Internet Publishing](microsoft-ole-db-provider-for-internet-publishing.md).</span></span> <span data-ttu-id="6c52a-171">詳細については、「[絶対 url と相対 url](absolute-and-relative-urls.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="6c52a-171">For more information, see [Absolute and relative URLs](absolute-and-relative-urls.md).</span></span>


